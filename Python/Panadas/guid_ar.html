<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="github.css">
  <style>
    body {
      box-sizing: border-box;
      width: 800px;
      margin: 0 auto;
      padding: 40px;
      justify-self: center;
    }
    .markdown-body {
  --base-size-4: 0.25rem;
  --base-size-8: 0.5rem;
  --base-size-16: 1rem;
  --base-size-24: 1.5rem;
  --base-size-40: 2.5rem;
  --base-text-weight-normal: 400;
  --base-text-weight-medium: 500;
  --base-text-weight-semibold: 600;
  --fontStack-monospace: ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace;
  --fgColor-accent: Highlight;
}
@media (prefers-color-scheme: dark) {
  .markdown-body, [data-theme="dark"] {
    /* dark */
    color-scheme: dark;
    --focus-outlineColor: #1f6feb;
    --fgColor-default: #f0f6fc;
    --fgColor-muted: #9198a1;
    --fgColor-accent: #4493f8;
    --fgColor-success: #3fb950;
    --fgColor-attention: #d29922;
    --fgColor-danger: #f85149;
    --fgColor-done: #ab7df8;
    --bgColor-default: #0d1117;
    --bgColor-muted: #151b23;
    --bgColor-neutral-muted: #656c7633;
    --bgColor-attention-muted: #bb800926;
    --borderColor-default: #3d444d;
    --borderColor-muted: #3d444db3;
    --borderColor-neutral-muted: #3d444db3;
    --borderColor-accent-emphasis: #1f6feb;
    --borderColor-success-emphasis: #238636;
    --borderColor-attention-emphasis: #9e6a03;
    --borderColor-danger-emphasis: #da3633;
    --borderColor-done-emphasis: #8957e5;
    --color-prettylights-syntax-comment: #9198a1;
    --color-prettylights-syntax-constant: #79c0ff;
    --color-prettylights-syntax-constant-other-reference-link: #a5d6ff;
    --color-prettylights-syntax-entity: #d2a8ff;
    --color-prettylights-syntax-storage-modifier-import: #f0f6fc;
    --color-prettylights-syntax-entity-tag: #7ee787;
    --color-prettylights-syntax-keyword: #ff7b72;
    --color-prettylights-syntax-string: #a5d6ff;
    --color-prettylights-syntax-variable: #ffa657;
    --color-prettylights-syntax-brackethighlighter-unmatched: #f85149;
    --color-prettylights-syntax-brackethighlighter-angle: #9198a1;
    --color-prettylights-syntax-invalid-illegal-text: #f0f6fc;
    --color-prettylights-syntax-invalid-illegal-bg: #8e1519;
    --color-prettylights-syntax-carriage-return-text: #f0f6fc;
    --color-prettylights-syntax-carriage-return-bg: #b62324;
    --color-prettylights-syntax-string-regexp: #7ee787;
    --color-prettylights-syntax-markup-list: #f2cc60;
    --color-prettylights-syntax-markup-heading: #1f6feb;
    --color-prettylights-syntax-markup-italic: #f0f6fc;
    --color-prettylights-syntax-markup-bold: #f0f6fc;
    --color-prettylights-syntax-markup-deleted-text: #ffdcd7;
    --color-prettylights-syntax-markup-deleted-bg: #67060c;
    --color-prettylights-syntax-markup-inserted-text: #aff5b4;
    --color-prettylights-syntax-markup-inserted-bg: #033a16;
    --color-prettylights-syntax-markup-changed-text: #ffdfb6;
    --color-prettylights-syntax-markup-changed-bg: #5a1e02;
    --color-prettylights-syntax-markup-ignored-text: #f0f6fc;
    --color-prettylights-syntax-markup-ignored-bg: #1158c7;
    --color-prettylights-syntax-meta-diff-range: #d2a8ff;
    --color-prettylights-syntax-sublimelinter-gutter-mark: #3d444d;
  }
}
@media (prefers-color-scheme: light) {
  .markdown-body, [data-theme="light"] {
    /* light */
    color-scheme: light;
    --focus-outlineColor: #0969da;
    --fgColor-default: #1f2328;
    --fgColor-muted: #59636e;
    --fgColor-accent: #0969da;
    --fgColor-success: #1a7f37;
    --fgColor-attention: #9a6700;
    --fgColor-danger: #d1242f;
    --fgColor-done: #8250df;
    --bgColor-default: #ffffff;
    --bgColor-muted: #f6f8fa;
    --bgColor-neutral-muted: #818b981f;
    --bgColor-attention-muted: #fff8c5;
    --borderColor-default: #d1d9e0;
    --borderColor-muted: #d1d9e0b3;
    --borderColor-neutral-muted: #d1d9e0b3;
    --borderColor-accent-emphasis: #0969da;
    --borderColor-success-emphasis: #1a7f37;
    --borderColor-attention-emphasis: #9a6700;
    --borderColor-danger-emphasis: #cf222e;
    --borderColor-done-emphasis: #8250df;
    --color-prettylights-syntax-comment: #59636e;
    --color-prettylights-syntax-constant: #0550ae;
    --color-prettylights-syntax-constant-other-reference-link: #0a3069;
    --color-prettylights-syntax-entity: #6639ba;
    --color-prettylights-syntax-storage-modifier-import: #1f2328;
    --color-prettylights-syntax-entity-tag: #0550ae;
    --color-prettylights-syntax-keyword: #cf222e;
    --color-prettylights-syntax-string: #0a3069;
    --color-prettylights-syntax-variable: #953800;
    --color-prettylights-syntax-brackethighlighter-unmatched: #82071e;
    --color-prettylights-syntax-brackethighlighter-angle: #59636e;
    --color-prettylights-syntax-invalid-illegal-text: #f6f8fa;
    --color-prettylights-syntax-invalid-illegal-bg: #82071e;
    --color-prettylights-syntax-carriage-return-text: #f6f8fa;
    --color-prettylights-syntax-carriage-return-bg: #cf222e;
    --color-prettylights-syntax-string-regexp: #116329;
    --color-prettylights-syntax-markup-list: #3b2300;
    --color-prettylights-syntax-markup-heading: #0550ae;
    --color-prettylights-syntax-markup-italic: #1f2328;
    --color-prettylights-syntax-markup-bold: #1f2328;
    --color-prettylights-syntax-markup-deleted-text: #82071e;
    --color-prettylights-syntax-markup-deleted-bg: #ffebe9;
    --color-prettylights-syntax-markup-inserted-text: #116329;
    --color-prettylights-syntax-markup-inserted-bg: #dafbe1;
    --color-prettylights-syntax-markup-changed-text: #953800;
    --color-prettylights-syntax-markup-changed-bg: #ffd8b5;
    --color-prettylights-syntax-markup-ignored-text: #d1d9e0;
    --color-prettylights-syntax-markup-ignored-bg: #0550ae;
    --color-prettylights-syntax-meta-diff-range: #8250df;
    --color-prettylights-syntax-sublimelinter-gutter-mark: #818b98;
  }
}

.markdown-body {
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  margin: 0;
  color: var(--fgColor-default);
  background-color: var(--bgColor-default);
  font-family: -apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";
  font-size: 16px;
  line-height: 1.5;
  word-wrap: break-word;
}

.markdown-body .octicon {
  display: inline-block;
  fill: currentColor;
  vertical-align: text-bottom;
}

.markdown-body h1:hover .anchor .octicon-link:before,
.markdown-body h2:hover .anchor .octicon-link:before,
.markdown-body h3:hover .anchor .octicon-link:before,
.markdown-body h4:hover .anchor .octicon-link:before,
.markdown-body h5:hover .anchor .octicon-link:before,
.markdown-body h6:hover .anchor .octicon-link:before {
  width: 16px;
  height: 16px;
  content: ' ';
  display: inline-block;
  background-color: currentColor;
  -webkit-mask-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' version='1.1' aria-hidden='true'><path fill-rule='evenodd' d='M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z'></path></svg>");
  mask-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' version='1.1' aria-hidden='true'><path fill-rule='evenodd' d='M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z'></path></svg>");
}

.markdown-body details,
.markdown-body figcaption,
.markdown-body figure {
  display: block;
}

.markdown-body summary {
  display: list-item;
}

.markdown-body [hidden] {
  display: none !important;
}

.markdown-body a {
  background-color: transparent;
  color: var(--fgColor-accent);
  text-decoration: none;
}

.markdown-body abbr[title] {
  border-bottom: none;
  -webkit-text-decoration: underline dotted;
  text-decoration: underline dotted;
}

.markdown-body b,
.markdown-body strong {
  font-weight: var(--base-text-weight-semibold, 600);
}

.markdown-body dfn {
  font-style: italic;
}

.markdown-body h1 {
  margin: .67em 0;
  font-weight: var(--base-text-weight-semibold, 600);
  padding-bottom: .3em;
  font-size: 2em;
  border-bottom: 1px solid var(--borderColor-muted);
}

.markdown-body mark {
  background-color: var(--bgColor-attention-muted);
  color: var(--fgColor-default);
}

.markdown-body small {
  font-size: 90%;
}

.markdown-body sub,
.markdown-body sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}

.markdown-body sub {
  bottom: -0.25em;
}

.markdown-body sup {
  top: -0.5em;
}

.markdown-body img {
  border-style: none;
  max-width: 100%;
  box-sizing: content-box;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre,
.markdown-body samp {
  font-family: monospace;
  font-size: 1em;
}

.markdown-body figure {
  margin: 1em var(--base-size-40);
}

.markdown-body hr {
  box-sizing: content-box;
  overflow: hidden;
  background: transparent;
  border-bottom: 1px solid var(--borderColor-muted);
  height: .25em;
  padding: 0;
  margin: var(--base-size-24) 0;
  background-color: var(--borderColor-default);
  border: 0;
}

.markdown-body input {
  font: inherit;
  margin: 0;
  overflow: visible;
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}

.markdown-body [type=button],
.markdown-body [type=reset],
.markdown-body [type=submit] {
  -webkit-appearance: button;
  appearance: button;
}

.markdown-body [type=checkbox],
.markdown-body [type=radio] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body [type=number]::-webkit-inner-spin-button,
.markdown-body [type=number]::-webkit-outer-spin-button {
  height: auto;
}

.markdown-body [type=search]::-webkit-search-cancel-button,
.markdown-body [type=search]::-webkit-search-decoration {
  -webkit-appearance: none;
  appearance: none;
}

.markdown-body ::-webkit-input-placeholder {
  color: inherit;
  opacity: .54;
}

.markdown-body ::-webkit-file-upload-button {
  -webkit-appearance: button;
  appearance: button;
  font: inherit;
}

.markdown-body a:hover {
  text-decoration: underline;
}

.markdown-body ::placeholder {
  color: var(--fgColor-muted);
  opacity: 1;
}

.markdown-body hr::before {
  display: table;
  content: "";
}

.markdown-body hr::after {
  display: table;
  clear: both;
  content: "";
}

.markdown-body table {
  border-spacing: 0;
  border-collapse: collapse;
  display: block;
  width: max-content;
  max-width: 100%;
  overflow: auto;
  font-variant: tabular-nums;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body details summary {
  cursor: pointer;
}

.markdown-body a:focus,
.markdown-body [role=button]:focus,
.markdown-body input[type=radio]:focus,
.markdown-body input[type=checkbox]:focus {
  outline: 2px solid var(--focus-outlineColor);
  outline-offset: -2px;
  box-shadow: none;
}

.markdown-body a:focus:not(:focus-visible),
.markdown-body [role=button]:focus:not(:focus-visible),
.markdown-body input[type=radio]:focus:not(:focus-visible),
.markdown-body input[type=checkbox]:focus:not(:focus-visible) {
  outline: solid 1px transparent;
}

.markdown-body a:focus-visible,
.markdown-body [role=button]:focus-visible,
.markdown-body input[type=radio]:focus-visible,
.markdown-body input[type=checkbox]:focus-visible {
  outline: 2px solid var(--focus-outlineColor);
  outline-offset: -2px;
  box-shadow: none;
}

.markdown-body a:not([class]):focus,
.markdown-body a:not([class]):focus-visible,
.markdown-body input[type=radio]:focus,
.markdown-body input[type=radio]:focus-visible,
.markdown-body input[type=checkbox]:focus,
.markdown-body input[type=checkbox]:focus-visible {
  outline-offset: 0;
}

.markdown-body kbd {
  display: inline-block;
  padding: var(--base-size-4);
  font: 11px var(--fontStack-monospace, ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace);
  line-height: 10px;
  color: var(--fgColor-default);
  vertical-align: middle;
  background-color: var(--bgColor-muted);
  border: solid 1px var(--borderColor-neutral-muted);
  border-bottom-color: var(--borderColor-neutral-muted);
  border-radius: 6px;
  box-shadow: inset 0 -1px 0 var(--borderColor-neutral-muted);
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: var(--base-size-24);
  margin-bottom: var(--base-size-16);
  font-weight: var(--base-text-weight-semibold, 600);
  line-height: 1.25;
}

.markdown-body h2 {
  font-weight: var(--base-text-weight-semibold, 600);
  padding-bottom: .3em;
  font-size: 1.5em;
  border-bottom: 1px solid var(--borderColor-muted);
}

.markdown-body h3 {
  font-weight: var(--base-text-weight-semibold, 600);
  font-size: 1.25em;
}

.markdown-body h4 {
  font-weight: var(--base-text-weight-semibold, 600);
  font-size: 1em;
}

.markdown-body h5 {
  font-weight: var(--base-text-weight-semibold, 600);
  font-size: .875em;
}

.markdown-body h6 {
  font-weight: var(--base-text-weight-semibold, 600);
  font-size: .85em;
  color: var(--fgColor-muted);
}

.markdown-body p {
  margin-top: 0;
  margin-bottom: 10px;
}

.markdown-body blockquote {
  margin: 0;
  padding: 0 1em;
  color: var(--fgColor-muted);
  border-left: .25em solid var(--borderColor-default);
}

.markdown-body ul,
.markdown-body ol {
  margin-top: 0;
  margin-bottom: 0;
  padding-left: 2em;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body tt,
.markdown-body code,
.markdown-body samp {
  font-family: var(--fontStack-monospace, ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace);
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
  font-family: var(--fontStack-monospace, ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace);
  font-size: 12px;
  word-wrap: normal;
}

.markdown-body .octicon {
  display: inline-block;
  overflow: visible !important;
  vertical-align: text-bottom;
  fill: currentColor;
}

.markdown-body input::-webkit-outer-spin-button,
.markdown-body input::-webkit-inner-spin-button {
  margin: 0;
  appearance: none;
}

.markdown-body .mr-2 {
  margin-right: var(--base-size-8, 8px) !important;
}

.markdown-body::before {
  display: table;
  content: "";
}

.markdown-body::after {
  display: table;
  clear: both;
  content: "";
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body a:not([href]) {
  color: inherit;
  text-decoration: none;
}

.markdown-body .absent {
  color: var(--fgColor-danger);
}

.markdown-body .anchor {
  float: left;
  padding-right: var(--base-size-4);
  margin-left: -20px;
  line-height: 1;
}

.markdown-body .anchor:focus {
  outline: none;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre,
.markdown-body details {
  margin-top: 0;
  margin-bottom: var(--base-size-16);
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
  color: var(--fgColor-default);
  vertical-align: middle;
  visibility: hidden;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
  text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
  visibility: visible;
}

.markdown-body h1 tt,
.markdown-body h1 code,
.markdown-body h2 tt,
.markdown-body h2 code,
.markdown-body h3 tt,
.markdown-body h3 code,
.markdown-body h4 tt,
.markdown-body h4 code,
.markdown-body h5 tt,
.markdown-body h5 code,
.markdown-body h6 tt,
.markdown-body h6 code {
  padding: 0 .2em;
  font-size: inherit;
}

.markdown-body summary h1,
.markdown-body summary h2,
.markdown-body summary h3,
.markdown-body summary h4,
.markdown-body summary h5,
.markdown-body summary h6 {
  display: inline-block;
}

.markdown-body summary h1 .anchor,
.markdown-body summary h2 .anchor,
.markdown-body summary h3 .anchor,
.markdown-body summary h4 .anchor,
.markdown-body summary h5 .anchor,
.markdown-body summary h6 .anchor {
  margin-left: -40px;
}

.markdown-body summary h1,
.markdown-body summary h2 {
  padding-bottom: 0;
  border-bottom: 0;
}

.markdown-body ul.no-list,
.markdown-body ol.no-list {
  padding: 0;
  list-style-type: none;
}

.markdown-body ol[type="a s"] {
  list-style-type: lower-alpha;
}

.markdown-body ol[type="A s"] {
  list-style-type: upper-alpha;
}

.markdown-body ol[type="i s"] {
  list-style-type: lower-roman;
}

.markdown-body ol[type="I s"] {
  list-style-type: upper-roman;
}

.markdown-body ol[type="1"] {
  list-style-type: decimal;
}

.markdown-body div>ol:not([type]) {
  list-style-type: decimal;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: var(--base-size-16);
}

.markdown-body li+li {
  margin-top: .25em;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: var(--base-size-16);
  font-size: 1em;
  font-style: italic;
  font-weight: var(--base-text-weight-semibold, 600);
}

.markdown-body dl dd {
  padding: 0 var(--base-size-16);
  margin-bottom: var(--base-size-16);
}

.markdown-body table th {
  font-weight: var(--base-text-weight-semibold, 600);
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid var(--borderColor-default);
}

.markdown-body table td>:last-child {
  margin-bottom: 0;
}

.markdown-body table tr {
  background-color: var(--bgColor-default);
  border-top: 1px solid var(--borderColor-muted);
}

.markdown-body table tr:nth-child(2n) {
  background-color: var(--bgColor-muted);
}

.markdown-body table img {
  background-color: transparent;
}

.markdown-body img[align=right] {
  padding-left: 20px;
}

.markdown-body img[align=left] {
  padding-right: 20px;
}

.markdown-body .emoji {
  max-width: none;
  vertical-align: text-top;
  background-color: transparent;
}

.markdown-body span.frame {
  display: block;
  overflow: hidden;
}

.markdown-body span.frame>span {
  display: block;
  float: left;
  width: auto;
  padding: 7px;
  margin: 13px 0 0;
  overflow: hidden;
  border: 1px solid var(--borderColor-default);
}

.markdown-body span.frame span img {
  display: block;
  float: left;
}

.markdown-body span.frame span span {
  display: block;
  padding: 5px 0 0;
  clear: both;
  color: var(--fgColor-default);
}

.markdown-body span.align-center {
  display: block;
  overflow: hidden;
  clear: both;
}

.markdown-body span.align-center>span {
  display: block;
  margin: 13px auto 0;
  overflow: hidden;
  text-align: center;
}

.markdown-body span.align-center span img {
  margin: 0 auto;
  text-align: center;
}

.markdown-body span.align-right {
  display: block;
  overflow: hidden;
  clear: both;
}

.markdown-body span.align-right>span {
  display: block;
  margin: 13px 0 0;
  overflow: hidden;
  text-align: right;
}

.markdown-body span.align-right span img {
  margin: 0;
  text-align: right;
}

.markdown-body span.float-left {
  display: block;
  float: left;
  margin-right: 13px;
  overflow: hidden;
}

.markdown-body span.float-left span {
  margin: 13px 0 0;
}

.markdown-body span.float-right {
  display: block;
  float: right;
  margin-left: 13px;
  overflow: hidden;
}

.markdown-body span.float-right>span {
  display: block;
  margin: 13px auto 0;
  overflow: hidden;
  text-align: right;
}

.markdown-body code,
.markdown-body tt {
  padding: .2em .4em;
  margin: 0;
  font-size: 85%;
  white-space: break-spaces;
  background-color: var(--bgColor-neutral-muted);
  border-radius: 6px;
}

.markdown-body code br,
.markdown-body tt br {
  display: none;
}

.markdown-body del code {
  text-decoration: inherit;
}

.markdown-body samp {
  font-size: 85%;
}

.markdown-body pre code {
  font-size: 100%;
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .highlight {
  margin-bottom: var(--base-size-16);
}

.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body .highlight pre,
.markdown-body pre {
  padding: var(--base-size-16);
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  color: var(--fgColor-default);
  background-color: var(--bgColor-muted);
  border-radius: 6px;
}

.markdown-body pre code,
.markdown-body pre tt {
  display: inline;
  max-width: auto;
  padding: 0;
  margin: 0;
  overflow: visible;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body .csv-data td,
.markdown-body .csv-data th {
  padding: 5px;
  overflow: hidden;
  font-size: 12px;
  line-height: 1;
  text-align: left;
  white-space: nowrap;
}

.markdown-body .csv-data .blob-num {
  padding: 10px var(--base-size-8) 9px;
  text-align: right;
  background: var(--bgColor-default);
  border: 0;
}

.markdown-body .csv-data tr {
  border-top: 0;
}

.markdown-body .csv-data th {
  font-weight: var(--base-text-weight-semibold, 600);
  background: var(--bgColor-muted);
  border-top: 0;
}

.markdown-body [data-footnote-ref]::before {
  content: "[";
}

.markdown-body [data-footnote-ref]::after {
  content: "]";
}

.markdown-body .footnotes {
  font-size: 12px;
  color: var(--fgColor-muted);
  border-top: 1px solid var(--borderColor-default);
}

.markdown-body .footnotes ol {
  padding-left: var(--base-size-16);
}

.markdown-body .footnotes ol ul {
  display: inline-block;
  padding-left: var(--base-size-16);
  margin-top: var(--base-size-16);
}

.markdown-body .footnotes li {
  position: relative;
}

.markdown-body .footnotes li:target::before {
  position: absolute;
  top: calc(var(--base-size-8)*-1);
  right: calc(var(--base-size-8)*-1);
  bottom: calc(var(--base-size-8)*-1);
  left: calc(var(--base-size-24)*-1);
  pointer-events: none;
  content: "";
  border: 2px solid var(--borderColor-accent-emphasis);
  border-radius: 6px;
}

.markdown-body .footnotes li:target {
  color: var(--fgColor-default);
}

.markdown-body .footnotes .data-footnote-backref g-emoji {
  font-family: monospace;
}

.markdown-body body:has(:modal) {
  padding-right: var(--dialog-scrollgutter) !important;
}

.markdown-body .pl-c {
  color: var(--color-prettylights-syntax-comment);
}

.markdown-body .pl-c1,
.markdown-body .pl-s .pl-v {
  color: var(--color-prettylights-syntax-constant);
}

.markdown-body .pl-e,
.markdown-body .pl-en {
  color: var(--color-prettylights-syntax-entity);
}

.markdown-body .pl-smi,
.markdown-body .pl-s .pl-s1 {
  color: var(--color-prettylights-syntax-storage-modifier-import);
}

.markdown-body .pl-ent {
  color: var(--color-prettylights-syntax-entity-tag);
}

.markdown-body .pl-k {
  color: var(--color-prettylights-syntax-keyword);
}

.markdown-body .pl-s,
.markdown-body .pl-pds,
.markdown-body .pl-s .pl-pse .pl-s1,
.markdown-body .pl-sr,
.markdown-body .pl-sr .pl-cce,
.markdown-body .pl-sr .pl-sre,
.markdown-body .pl-sr .pl-sra {
  color: var(--color-prettylights-syntax-string);
}

.markdown-body .pl-v,
.markdown-body .pl-smw {
  color: var(--color-prettylights-syntax-variable);
}

.markdown-body .pl-bu {
  color: var(--color-prettylights-syntax-brackethighlighter-unmatched);
}

.markdown-body .pl-ii {
  color: var(--color-prettylights-syntax-invalid-illegal-text);
  background-color: var(--color-prettylights-syntax-invalid-illegal-bg);
}

.markdown-body .pl-c2 {
  color: var(--color-prettylights-syntax-carriage-return-text);
  background-color: var(--color-prettylights-syntax-carriage-return-bg);
}

.markdown-body .pl-sr .pl-cce {
  font-weight: bold;
  color: var(--color-prettylights-syntax-string-regexp);
}

.markdown-body .pl-ml {
  color: var(--color-prettylights-syntax-markup-list);
}

.markdown-body .pl-mh,
.markdown-body .pl-mh .pl-en,
.markdown-body .pl-ms {
  font-weight: bold;
  color: var(--color-prettylights-syntax-markup-heading);
}

.markdown-body .pl-mi {
  font-style: italic;
  color: var(--color-prettylights-syntax-markup-italic);
}

.markdown-body .pl-mb {
  font-weight: bold;
  color: var(--color-prettylights-syntax-markup-bold);
}

.markdown-body .pl-md {
  color: var(--color-prettylights-syntax-markup-deleted-text);
  background-color: var(--color-prettylights-syntax-markup-deleted-bg);
}

.markdown-body .pl-mi1 {
  color: var(--color-prettylights-syntax-markup-inserted-text);
  background-color: var(--color-prettylights-syntax-markup-inserted-bg);
}

.markdown-body .pl-mc {
  color: var(--color-prettylights-syntax-markup-changed-text);
  background-color: var(--color-prettylights-syntax-markup-changed-bg);
}

.markdown-body .pl-mi2 {
  color: var(--color-prettylights-syntax-markup-ignored-text);
  background-color: var(--color-prettylights-syntax-markup-ignored-bg);
}

.markdown-body .pl-mdr {
  font-weight: bold;
  color: var(--color-prettylights-syntax-meta-diff-range);
}

.markdown-body .pl-ba {
  color: var(--color-prettylights-syntax-brackethighlighter-angle);
}

.markdown-body .pl-sg {
  color: var(--color-prettylights-syntax-sublimelinter-gutter-mark);
}

.markdown-body .pl-corl {
  text-decoration: underline;
  color: var(--color-prettylights-syntax-constant-other-reference-link);
}

.markdown-body [role=button]:focus:not(:focus-visible),
.markdown-body [role=tabpanel][tabindex="0"]:focus:not(:focus-visible),
.markdown-body button:focus:not(:focus-visible),
.markdown-body summary:focus:not(:focus-visible),
.markdown-body a:focus:not(:focus-visible) {
  outline: none;
  box-shadow: none;
}

.markdown-body [tabindex="0"]:focus:not(:focus-visible),
.markdown-body details-dialog:focus:not(:focus-visible) {
  outline: none;
}

.markdown-body g-emoji {
  display: inline-block;
  min-width: 1ch;
  font-family: "Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";
  font-size: 1em;
  font-style: normal !important;
  font-weight: var(--base-text-weight-normal, 400);
  line-height: 1;
  vertical-align: -0.075em;
}

.markdown-body g-emoji img {
  width: 1em;
  height: 1em;
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item label {
  font-weight: var(--base-text-weight-normal, 400);
}

.markdown-body .task-list-item.enabled label {
  cursor: pointer;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: var(--base-size-4);
}

.markdown-body .task-list-item .handle {
  display: none;
}

.markdown-body .task-list-item-checkbox {
  margin: 0 .2em .25em -1.4em;
  vertical-align: middle;
}

.markdown-body ul:dir(rtl) .task-list-item-checkbox {
  margin: 0 -1.6em .25em .2em;
}

.markdown-body ol:dir(rtl) .task-list-item-checkbox {
  margin: 0 -1.6em .25em .2em;
}

.markdown-body .contains-task-list:hover .task-list-item-convert-container,
.markdown-body .contains-task-list:focus-within .task-list-item-convert-container {
  display: block;
  width: auto;
  height: 24px;
  overflow: visible;
  clip: auto;
}

.markdown-body ::-webkit-calendar-picker-indicator {
  filter: invert(50%);
}

.markdown-body .markdown-alert {
  padding: var(--base-size-8) var(--base-size-16);
  margin-bottom: var(--base-size-16);
  color: inherit;
  border-left: .25em solid var(--borderColor-default);
}

.markdown-body .markdown-alert>:first-child {
  margin-top: 0;
}

.markdown-body .markdown-alert>:last-child {
  margin-bottom: 0;
}

.markdown-body .markdown-alert .markdown-alert-title {
  display: flex;
  font-weight: var(--base-text-weight-medium, 500);
  align-items: center;
  line-height: 1;
}

.markdown-body .markdown-alert.markdown-alert-note {
  border-left-color: var(--borderColor-accent-emphasis);
}

.markdown-body .markdown-alert.markdown-alert-note .markdown-alert-title {
  color: var(--fgColor-accent);
}

.markdown-body .markdown-alert.markdown-alert-important {
  border-left-color: var(--borderColor-done-emphasis);
}

.markdown-body .markdown-alert.markdown-alert-important .markdown-alert-title {
  color: var(--fgColor-done);
}

.markdown-body .markdown-alert.markdown-alert-warning {
  border-left-color: var(--borderColor-attention-emphasis);
}

.markdown-body .markdown-alert.markdown-alert-warning .markdown-alert-title {
  color: var(--fgColor-attention);
}

.markdown-body .markdown-alert.markdown-alert-tip {
  border-left-color: var(--borderColor-success-emphasis);
}

.markdown-body .markdown-alert.markdown-alert-tip .markdown-alert-title {
  color: var(--fgColor-success);
}

.markdown-body .markdown-alert.markdown-alert-caution {
  border-left-color: var(--borderColor-danger-emphasis);
}

.markdown-body .markdown-alert.markdown-alert-caution .markdown-alert-title {
  color: var(--fgColor-danger);
}

.markdown-body>*:first-child>.heading-element:first-child {
  margin-top: 0 !important;
}

.markdown-body .highlight pre:has(+.zeroclipboard-container) {
  min-height: 52px;
}

  </style>
</head>
<body class="markdown-body">
  <div dir="rtl">
<h1 id="الفهرس-الدليل-الشامل-لمكتبة-pandas">📚 <strong>الفهرس : الدليل الشامل لمكتبة Pandas</strong></h1>
<h2 id="الجزء-1-الأساسيات-من-الصفر-إلى-المتوسط">الجزء 1: الأساسيات (من الصفر إلى المتوسط)</h2>
<ol type="1">
<li><strong>الدرس 1: تعريف DataFrame وكيفية إنشائه</strong>
<ul>
<li>ما هو DataFrame؟</li>
<li>إنشاء DataFrame من قاموس</li>
<li>إنشاء DataFrame من قائمة</li>
<li>إنشاء DataFrame من مصفوفة NumPy</li>
<li>خصائص DataFrame</li>
<li>الأخطاء الشائعة عند الإنشاء</li>
</ul></li>
<li><strong>الدرس 2: قراءة البيانات من ملفات CSV وExcel وJSON</strong>
<ul>
<li>قراءة ملف CSV باستخدام <code>read_csv()</code></li>
<li>قراءة ملف Excel باستخدام <code>read_excel()</code></li>
<li>قراءة ملف JSON باستخدام <code>read_json()</code></li>
<li>خيارات مهمة: <code>sep</code>, <code>encoding</code>, <code>index_col</code></li>
<li>الأخطاء الشائعة عند القراءة</li>
</ul></li>
<li><strong>الدرس 3: فحص معلومات الجدول</strong>
<ul>
<li><code>df.info()</code> – عرض معلومات عامة</li>
<li><code>df.dtypes</code> – أنواع البيانات</li>
<li><code>df.describe()</code> – الإحصاءات الوصفية</li>
<li><code>df.isnull()</code> و<code>df.notnull()</code> – اكتشاف القيم المفقودة</li>
<li>تمارين تطبيقية على جودة البيانات</li>
</ul></li>
<li><strong>الدرس 4: الوصول إلى الأعمدة والصفوف باستخدام <code>loc</code> و <code>iloc</code></strong>
<ul>
<li>الفرق بين <code>loc</code> و <code>iloc</code></li>
<li>الوصول إلى عمود أو صف</li>
<li>استخدام <code>loc</code> مع شروط</li>
<li>أمثلة عملية على الاستخراج</li>
</ul></li>
<li><strong>الدرس 5: الفلترة الشرطية</strong>
<ul>
<li>الفلترة باستخدام الشروط البسيطة</li>
<li>استخدام <code>&amp;</code> (و) و <code>|</code> (أو)</li>
<li>استخدام <code>~</code> (ليس)</li>
<li>دوال مساعدة: <code>isin()</code> و <code>between()</code></li>
<li>الأخطاء الشائعة في الفلترة</li>
</ul></li>
<li><strong>الدرس 6: التعديل داخل DataFrame</strong>
<ul>
<li>إنشاء أعمدة جديدة</li>
<li>التعديل على القيم</li>
<li>حذف أعمدة وصفوف</li>
<li>إعادة تسمية الأعمدة باستخدام <code>rename()</code></li>
<li>استخدام <code>inplace=True</code></li>
</ul></li>
<li><strong>الدرس 7: التعامل مع القيم المفقودة</strong>
<ul>
<li>اكتشاف القيم المفقودة بـ <code>isnull()</code></li>
<li>حذف الصفوف/الأعمدة بـ <code>dropna()</code></li>
<li>ملء القيم المفقودة بـ <code>fillna()</code></li>
<li>استراتيجيات التعامل مع <code>NaN</code></li>
<li>تمارين على جودة البيانات</li>
</ul></li>
<li><strong>الدرس 8: التجميع باستخدام <code>groupby()</code></strong>
<ul>
<li>التجميع حسب عمود</li>
<li>حساب المجموع، المتوسط، العدد</li>
<li>استخدام <code>agg()</code> لدوال متعددة</li>
<li>التجميع حسب أكثر من عمود</li>
<li>تطبيقات على المبيعات والموظفين</li>
</ul></li>
<li><strong>الدرس 9: ترتيب البيانات باستخدام <code>sort_values()</code></strong>
<ul>
<li>الترتيب التصاعدي والتنازلي</li>
<li>الترتيب حسب أكثر من عمود</li>
<li>التحكم في القيم المفقودة: <code>na_position</code></li>
<li>استخدام <code>sort_index()</code></li>
<li>تمارين على ترتيب النتائج</li>
</ul></li>
<li><strong>الدرس 10: دمج وربط البيانات باستخدام <code>merge</code> و <code>concat</code></strong>
<ul>
<li>الدمج الرأسي باستخدام <code>concat()</code></li>
<li>الدمج الأفقي</li>
<li>الربط باستخدام <code>merge()</code> (مثل JOIN)</li>
<li>أنواع الدمج: <code>inner</code>, <code>left</code>, <code>outer</code>, <code>right</code></li>
<li>تطبيقات على الطلبات والعملاء</li>
</ul></li>
<li><strong>الدرس 11: التعامل مع الأعمدة الزمنية</strong>
<ul>
<li>تحويل النص إلى تاريخ بـ <code>pd.to_datetime()</code></li>
<li>استخراج السنة، الشهر، اليوم باستخدام <code>.dt</code></li>
<li>تصفية البيانات حسب التواريخ</li>
<li>استخدام <code>between()</code> مع التواريخ</li>
<li>تمارين على المبيعات الزمنية</li>
</ul></li>
<li><strong>الدرس 12: حفظ البيانات إلى ملفات</strong>
<ul>
<li>حفظ إلى CSV باستخدام <code>to_csv()</code></li>
<li>خيارات مهمة: <code>index=False</code>, <code>encoding='utf-8-sig'</code>, <code>mode='a'</code></li>
<li>حفظ إلى Excel باستخدام <code>to_excel()</code></li>
<li>استخدام <code>ExcelWriter</code> لأكثر من ورقة</li>
<li>حفظ إلى JSON باستخدام <code>to_json()</code></li>
<li>الأخطاء الشائعة عند الحفظ</li>
</ul></li>
</ol>
<hr />
<h2 id="الجزء-2-المستوى-المتقدم">الجزء 2: المستوى المتقدم</h2>
<ol start="13" type="1">
<li><strong>الدرس 13: معالجة متعددة المستويات (MultiIndex)</strong>
<ul>
<li>إنشاء <code>MultiIndex</code> من <code>from_tuples</code> و <code>from_product</code></li>
<li>الوصول إلى البيانات باستخدام <code>loc</code> و <code>xs()</code></li>
<li>استخدام <code>stack()</code> و <code>unstack()</code></li>
<li>تبديل المستويات بـ <code>swaplevel()</code></li>
<li>تطبيقات على تحليل متعدد الأبعاد</li>
</ul></li>
<li><strong>الدرس 14: العمليات الإحصائية المتقدمة</strong>
<ul>
<li>النافذة المتحركة: <code>rolling().mean()</code>, <code>std()</code></li>
<li>التوسع التراكمي: <code>expanding()</code></li>
<li>المتوسط المرجح أسيًا: <code>ewm()</code></li>
<li>التباين وارتباط بيرسون: <code>cov()</code>, <code>corr()</code></li>
<li>الرتبة والتقييم: <code>rank()</code>, <code>nlargest()</code>, <code>nsmallest</code></li>
</ul></li>
<li><strong>الدرس 15: Pivot والتحليل العميق</strong>
<ul>
<li>استخدام <code>pivot()</code> للبيانات الفريدة</li>
<li>استخدام <code>pivot_table()</code> مع التكرارات</li>
<li>إضافة دالة تجميع: <code>aggfunc</code></li>
<li>ملء القيم المفقودة: <code>fill_value</code></li>
<li>إضافة الإجماليات: <code>margins=True</code></li>
<li>استخدام <code>crosstab()</code> لجداول التقابل</li>
</ul></li>
<li><strong>الدرس 16: التجهيز للذكاء الاصطناعي (ML)</strong>
<ul>
<li>الترميز الوهمي: <code>get_dummies()</code></li>
<li>تقسيم الأرقام: <code>cut()</code> و <code>qcut()</code></li>
<li>استبدال القيم: <code>map()</code> و <code>replace()</code></li>
<li>تغيير نوع البيانات: <code>astype()</code></li>
<li>تصفية متقدمة: <code>query()</code> و <code>eval()</code></li>
</ul></li>
<li><strong>الدرس 17: البيانات الزمنية المتقدمة</strong>
<ul>
<li>إعادة عينة البيانات: <code>resample('D')</code>, <code>resample('W')</code></li>
<li>تغيير التردد: <code>asfreq()</code></li>
<li>الإزاحة الزمنية: <code>shift()</code> (Lag/Lead)</li>
<li>الفرق بين القيم: <code>diff()</code></li>
<li>النسبة المئوية: <code>pct_change()</code></li>
</ul></li>
<li><strong>الدرس 18: التعامل مع الأخطاء والنسخ الآمن</strong>
<ul>
<li>فهم <code>SettingWithCopyWarning</code></li>
<li>الحل: استخدام <code>.copy()</code></li>
<li>الفرق بين <code>deep=True</code> و <code>deep=False</code></li>
<li>تجنب الأخطاء باستخدام <code>errors='ignore'</code></li>
<li>كتم التحذيرات (بشكل آمن)</li>
</ul></li>
<li><strong>الدرس 19: الوظائف المتقدمة</strong>
<ul>
<li><code>apply()</code> على الصفوف والأعمدة</li>
<li><code>pipe()</code> لبناء أنابيب معالجة</li>
<li><code>transform()</code> مع <code>groupby</code></li>
<li><code>filter()</code> لتصفية الأعمدة بالاسم</li>
<li>أمثلة على أنظمة معالجة تلقائية</li>
</ul></li>
<li><strong>الدرس 20: مشروع تطبيقي: تحليل بيانات أسهم</strong>
<ul>
<li>توليد بيانات وهمية لسهم</li>
<li>حساب المؤشرات الفنية (متوسطات متحركة)</li>
<li>تحليل متعدد المستويات</li>
<li>إنشاء Pivot Table و crosstab</li>
<li>تجهيز البيانات لنموذج ML</li>
<li>بناء أنبوب معالجة باستخدام <code>pipe</code></li>
</ul></li>
</ol>
<hr />
<h2 id="الملحقات">الملحقات</h2>
<ul>
<li><strong>جدول مرجعي سريع لأهم دوال Pandas</strong></li>
<li><strong>نصائح احترافية للمبتدئين والمحترفين</strong></li>
<li><strong>تمارين تطبيقية واقعية</strong></li>
<li><strong>أمثلة من عالم المبيعات، التداول، والموارد البشرية</strong></li>
</ul>
<h1 id="الدليل-الكامل-pandas-من-الصفر-إلى-المستوى-المتوسط">📚 الدليل الكامل: Pandas من الصفر إلى المستوى المتوسط</h1>
<blockquote>
<p>✅ <strong>إجمالي الدروس: 12</strong><br />
✅ <strong>عدد الكلمات: أكثر من 16,700</strong></p>
</blockquote>
<hr />
<h2 id="الدرس-1-تعريف-dataframe-وكيفية-إنشائه-من-قائمة-أو-قاموس-أو-numpy">📘 <strong>الدرس 1: تعريف DataFrame وكيفية إنشائه من قائمة أو قاموس أو NumPy</strong></h2>
<ul>
<li>مقدمة: لماذا Pandas؟ ولماذا DataFrame؟</li>
<li>ما هو DataFrame؟ (شرح نظري مفصل)
<ul>
<li>خصائص الـ DataFrame</li>
<li>تشبيه بسيط: السجل المدرسي</li>
</ul></li>
<li>كيفية إنشاء DataFrame؟
<ul>
<li>الطريقة 1: من قاموس (Dict) — الأسهل والأكثر شيوعًا</li>
<li>الطريقة 2: من قائمة (List of Lists)</li>
<li>الطريقة 3: من مصفوفة NumPy</li>
<li>الطريقة 4: من قائمة من القواميس</li>
</ul></li>
<li>فهم نوع البيانات (dtypes) عند الإنشاء</li>
<li>الأخطاء الشائعة عند الإنشاء (تحليل معمق)</li>
<li>تمارين تطبيقية (من السهل إلى الصعب)</li>
<li>الربط بالواقع: مشروع صغير — إدارة متجر</li>
<li>نصائح احترافية للمبتدئين</li>
<li>أسئلة مراجعة</li>
<li>مراجعة سريعة (ملخص الدرس)</li>
</ul>
<hr />
<h2 id="الدرس-2-قراءة-البيانات-من-ملفات-csv-وexcel-وjson">📘 <strong>الدرس 2: قراءة البيانات من ملفات CSV وExcel وJSON</strong></h2>
<ul>
<li>مقدمة: لماذا نقرأ من ملفات؟</li>
<li>قراءة ملف CSV باستخدام <code>pd.read_csv()</code>
<ul>
<li>ما هو ملف CSV؟</li>
<li>مثال عملي</li>
</ul></li>
<li>خيارات مهمة في <code>read_csv</code>
<ul>
<li><code>sep</code>, <code>header</code>, <code>index_col</code>, <code>encoding</code>, <code>nrows</code>, <code>skiprows</code></li>
</ul></li>
<li>قراءة ملف Excel باستخدام <code>pd.read_excel()</code>
<ul>
<li>ما هو ملف إكسل؟</li>
<li>مثال عملي</li>
<li>قراءة عدة أوراق (sheets)</li>
</ul></li>
<li>قراءة ملف JSON باستخدام <code>pd.read_json()</code>
<ul>
<li>ما هو JSON؟</li>
<li>مثال عملي</li>
</ul></li>
<li>الأخطاء الشائعة (تحليل معمق)</li>
<li>تمارين تطبيقية</li>
<li>الربط بالواقع: تحليل مبيعات شهرية</li>
<li>نصائح احترافية</li>
<li>أسئلة مراجعة</li>
<li>مراجعة سريعة (ملخص الدرس)</li>
</ul>
<hr />
<h2 id="الدرس-3-فحص-معلومات-الجدول-info-و-describe-و-dtypes-و-isnull">📘 <strong>الدرس 3: فحص معلومات الجدول: <code>info()</code> و <code>describe()</code> و <code>dtypes</code> و <code>isnull()</code></strong></h2>
<ul>
<li>مقدمة: لماذا نفحص الجدول؟</li>
<li><code>df.info()</code> — فحص عام للجدول
<ul>
<li>تحليل الناتج</li>
</ul></li>
<li><code>df.dtypes</code> — معرفة نوع كل عمود</li>
<li><code>df.describe()</code> — الإحصاءات الوصفية
<ul>
<li>للبيانات الرقمية</li>
<li>للبيانات النصية (<code>include='object'</code>)</li>
</ul></li>
<li><code>df.isnull()</code> و <code>df.notnull()</code> — اكتشاف القيم المفقودة
<ul>
<li><code>isnull().sum()</code> لحساب القيم المفقودة</li>
</ul></li>
<li>الأخطاء الشائعة (تحليل معمق)</li>
<li>تمارين تطبيقية</li>
<li>الربط بالواقع: تحليل جودة البيانات في شركة</li>
<li>نصائح احترافية</li>
<li>أسئلة مراجعة</li>
<li>مراجعة سريعة (ملخص الدرس)</li>
</ul>
<hr />
<h2 id="الدرس-4-الوصول-إلى-الأعمدة-والصفوف-باستخدام-loc-و-iloc">📘 <strong>الدرس 4: الوصول إلى الأعمدة والصفوف باستخدام <code>loc</code> و <code>iloc</code></strong></h2>
<ul>
<li>مقدمة: لماذا نحتاج إلى <code>loc</code> و <code>iloc</code>؟</li>
<li>الوصول إلى عمود واحد أو أكثر
<ul>
<li><code>df['العمود']</code> vs <code>df[['العمود']]</code></li>
</ul></li>
<li><code>df.loc[]</code> — الوصول بالاسم (العلامة)
<ul>
<li>مثال: صف واحد، نطاق، مع شرط</li>
</ul></li>
<li><code>df.iloc[]</code> — الوصول بالرقم (الفهرس العددي)
<ul>
<li>مثال: أول صف، آخر صف، نطاق</li>
</ul></li>
<li>مقارنة بين <code>loc</code> و <code>iloc</code></li>
<li>الأخطاء الشائعة (تحليل معمق)</li>
<li>تمارين تطبيقية</li>
<li>الربط بالواقع: تحليل مبيعات متجر إلكتروني</li>
<li>نصائح احترافية</li>
<li>أسئلة مراجعة</li>
<li>مراجعة سريعة (ملخص الدرس)</li>
</ul>
<hr />
<h2 id="الدرس-5-الفلترة-الشرطية-باستخدام-و-و-isin-و-between">📘 <strong>الدرس 5: الفلترة الشرطية باستخدام <code>&amp;</code> و <code>|</code> و <code>isin()</code> و <code>between()</code></strong></h2>
<ul>
<li>مقدمة: لماذا الفلترة مهمة؟</li>
<li>الفلترة الأساسية باستخدام الشروط المنطقية</li>
<li>الشروط المتعددة: <code>&amp;</code> (و) و <code>|</code> (أو)
<ul>
<li>القاعدة الذهبية: الأقواس</li>
</ul></li>
<li>استخدام <code>~</code> (NOT)</li>
<li><code>isin()</code> — التحقق من وجود القيمة في قائمة</li>
<li><code>between()</code> — التحقق من النطاق</li>
<li>الأخطاء الشائعة (تحليل معمق)</li>
<li>تمارين تطبيقية</li>
<li>الربط بالواقع: تحليل مبيعات متجر إلكتروني</li>
<li>نصائح احترافية</li>
<li>أسئلة مراجعة</li>
<li>مراجعة سريعة (ملخص الدرس)</li>
</ul>
<hr />
<h2 id="الدرس-6-التعديل-داخل-dataframe">📘 <strong>الدرس 6: التعديل داخل DataFrame</strong></h2>
<ul>
<li>مقدمة: لماذا نحتاج إلى التعديل؟</li>
<li>إنشاء عمود جديد
<ul>
<li>مباشرة بالاسم</li>
<li>باستخدام <code>assign()</code></li>
</ul></li>
<li>التعديل على قيم موجودة
<ul>
<li>بالوصول المباشر</li>
<li>بالشرط</li>
</ul></li>
<li>حذف أعمدة وصفوف
<ul>
<li>باستخدام <code>drop()</code></li>
<li>مع <code>inplace=True</code></li>
</ul></li>
<li>إعادة تسمية الأعمدة باستخدام <code>rename()</code>
<ul>
<li>بقاموس</li>
<li>دفعة واحدة</li>
</ul></li>
<li>الأخطاء الشائعة (تحليل معمق)</li>
<li>تمارين تطبيقية</li>
<li>الربط بالواقع: تحديث بيانات متجر إلكتروني</li>
<li>نصائح احترافية</li>
<li>أسئلة مراجعة</li>
<li>مراجعة سريعة (ملخص الدرس)</li>
</ul>
<hr />
<h2 id="الدرس-7-التعامل-مع-القيم-المفقودة-dropna-و-fillna-و-isnull">📘 <strong>الدرس 7: التعامل مع القيم المفقودة: <code>dropna</code> و <code>fillna</code> و <code>isnull</code></strong></h2>
<ul>
<li>مقدمة: لماذا القيم المفقودة مشكلة؟</li>
<li>ما هي القيم المفقودة؟</li>
<li>اكتشاف القيم المفقودة: <code>isnull()</code> و <code>notnull()</code>
<ul>
<li><code>isnull().sum()</code> و <code>sum().sum()</code></li>
</ul></li>
<li>حذف الصفوف أو الأعمدة: <code>dropna()</code>
<ul>
<li>حذف أي صف به قيمة مفقودة</li>
<li>حذف حسب عمود معين (<code>subset</code>)</li>
<li>حذف الأعمدة</li>
</ul></li>
<li>ملء القيم المفقودة: <code>fillna()</code>
<ul>
<li>بالقيمة 0</li>
<li>بقيم مختلفة لكل عمود</li>
<li>بالقيمة السابقة (<code>ffill</code>) أو التالية (<code>bfill</code>)</li>
</ul></li>
<li>الأخطاء الشائعة (تحليل معمق)</li>
<li>تمارين تطبيقية</li>
<li>الربط بالواقع: تحليل قاعدة بيانات موظفين</li>
<li>نصائح احترافية</li>
<li>أسئلة مراجعة</li>
<li>مراجعة سريعة (ملخص الدرس)</li>
</ul>
<hr />
<h2 id="الدرس-8-التجميع-باستخدام-groupby">📘 <strong>الدرس 8: التجميع باستخدام <code>groupby()</code></strong></h2>
<ul>
<li>مقدمة: لماذا نستخدم <code>groupby()</code>؟</li>
<li>المبدأ الأساسي لـ <code>groupby()</code></li>
<li>أمثلة عملية
<ul>
<li>المجموع حسب الفئة</li>
<li>المتوسط، العد، الحجم</li>
</ul></li>
<li>تجميع متعدد الأعمدة باستخدام <code>agg()</code></li>
<li>التجميع حسب أكثر من عمود</li>
<li>الأخطاء الشائعة (تحليل معمق)</li>
<li>تمارين تطبيقية</li>
<li>الربط بالواقع: تقرير مبيعات شهري</li>
<li>نصائح احترافية</li>
<li>أسئلة مراجعة</li>
<li>مراجعة سريعة (ملخص الدرس)</li>
</ul>
<hr />
<h2 id="الدرس-9-ترتيب-البيانات-باستخدام-sort_values">📘 <strong>الدرس 9: ترتيب البيانات باستخدام <code>sort_values()</code></strong></h2>
<ul>
<li>مقدمة: لماذا نحتاج إلى الترتيب؟</li>
<li>الترتيب الأساسي: تصاعدي وتنازلي</li>
<li>الترتيب حسب أكثر من عمود</li>
<li>الترتيب حسب الفهرس: <code>sort_index()</code></li>
<li>التحكم في وضع القيم المفقودة: <code>na_position</code></li>
<li>الأخطاء الشائعة (تحليل معمق)</li>
<li>تمارين تطبيقية</li>
<li>الربط بالواقع: قائمة أفضل الموظفين</li>
<li>نصائح احترافية</li>
<li>أسئلة مراجعة</li>
<li>مراجعة سريعة (ملخص الدرس)</li>
</ul>
<hr />
<h2 id="الدرس-10-دمج-وربط-البيانات-باستخدام-merge-و-concat">📘 <strong>الدرس 10: دمج وربط البيانات باستخدام <code>merge</code> و <code>concat</code></strong></h2>
<ul>
<li>مقدمة: لماذا نحتاج إلى دمج البيانات؟</li>
<li>الدمج الرأسي: <code>pd.concat()</code>
<ul>
<li>دمج عدة ملفات شهرية</li>
<li>دمج أفقي</li>
</ul></li>
<li>الربط بالعلاقة: <code>pd.merge()</code>
<ul>
<li><code>on=</code>، <code>how='inner'</code>, <code>'left'</code>, <code>'outer'</code>, <code>'right'</code></li>
</ul></li>
<li>أنواع الـ joins</li>
<li>الأخطاء الشائعة (تحليل معمق)</li>
<li>تمارين تطبيقية</li>
<li>الربط بالواقع: نظام مبيعات متكامل</li>
<li>نصائح احترافية</li>
<li>أسئلة مراجعة</li>
<li>مراجعة سريعة (ملخص الدرس)</li>
</ul>
<hr />
<h2 id="الدرس-11-التعامل-مع-الأعمدة-الزمنية-pd.to_datetime-و-.dt-و-تصفية-التواريخ">📘 <strong>الدرس 11: التعامل مع الأعمدة الزمنية: <code>pd.to_datetime()</code> و <code>.dt</code> و تصفية التواريخ</strong></h2>
<ul>
<li>مقدمة: لماذا التواريخ مهمة؟</li>
<li>تحويل النص إلى تاريخ: <code>pd.to_datetime()</code>
<ul>
<li>مع <code>format=</code></li>
</ul></li>
<li>استخراج مكونات التاريخ: <code>.dt</code>
<ul>
<li>السنة، الشهر، اليوم، اليوم من الأسبوع، الربع</li>
</ul></li>
<li>تصفية البيانات حسب التاريخ
<ul>
<li>بين تاريخين، حسب الشهر</li>
</ul></li>
<li><code>pd.Timestamp</code> و <code>pd.Timedelta</code></li>
<li>الأخطاء الشائعة (تحليل معمق)</li>
<li>تمارين تطبيقية</li>
<li>الربط بالواقع: تحليل مبيعات ربع سنوية</li>
<li>نصائح احترافية</li>
<li>أسئلة مراجعة</li>
<li>مراجعة سريعة (ملخص الدرس)</li>
</ul>
<hr />
<h2 id="الدرس-12-حفظ-البيانات-إلى-ملفات-باستخدام-to_csv-و-to_excel">📘 <strong>الدرس 12: حفظ البيانات إلى ملفات باستخدام <code>to_csv</code> و <code>to_excel</code></strong></h2>
<ul>
<li>مقدمة: لماذا نحفظ البيانات؟</li>
<li>حفظ إلى CSV: <code>to_csv()</code>
<ul>
<li><code>index=False</code>, <code>encoding='utf-8-sig'</code>, <code>mode='a'</code></li>
</ul></li>
<li>حفظ إلى إكسل: <code>to_excel()</code>
<ul>
<li><code>ExcelWriter</code> لعدة أوراق</li>
</ul></li>
<li>حفظ إلى JSON: <code>to_json()</code></li>
<li>الأخطاء الشائعة (تحليل معمق)</li>
<li>تمارين تطبيقية</li>
<li>الربط بالواقع: تصدير تقرير شهري</li>
<li>نصائح احترافية</li>
<li>أسئلة مراجعة</li>
<li>مراجعة سريعة (ملخص الدرس)</li>
</ul>
<h1 id="الدرس-1-تعريف-dataframe-وكيفية-إنشائه-من-قائمة-أو-قاموس-أو-numpy-1">📘 <strong>الدرس 1 : تعريف DataFrame وكيفية إنشائه من قائمة أو قاموس أو NumPy</strong></h1>
<h2 id="مقدمة-لماذا-pandas-ولماذا-dataframe">🔹 <strong>مقدمة: لماذا Pandas؟ ولماذا DataFrame؟</strong></h2>
<p>قبل أن نغوص في التفاصيل التقنية، دعنا نفهم السبب وراء وجود مكتبة مثل <strong>Pandas</strong>.</p>
<p>تخيل أنك تعمل في شركة تجارة إلكترونية، وتتلقى يوميًا ملفات تحتوي على: - منتجات تم بيعها - أسماء العملاء - تواريخ الشراء - الأسعار والكميات</p>
<p>هل ستستخدم <strong>قائمة Python</strong> أو <strong>قائمة من القوائم</strong> لتحليل هذه البيانات؟<br />
يمكنك ذلك، لكن ستصادف صعوبات كبيرة: - لا يمكن فصل الأعمدة بسهولة. - لا يمكن تطبيق العمليات الحسابية على عمود كامل بسهولة. - لا يمكن تصفية البيانات حسب شرط معين بسلاسة. - لا يمكن تجميع البيانات حسب فئة (مثل: مبيعات كل شهر).</p>
<p>هنا تأتي <strong>Pandas</strong> لحل هذه المشكلات.<br />
وأداة Pandas الأساسية هي الـ <strong>DataFrame</strong>.</p>
<hr />
<h2 id="ما-هو-dataframe-شرح-نظري-مفصل">🔹 <strong>ما هو DataFrame؟ (شرح نظري مفصل)</strong></h2>
<p>الـ <code>DataFrame</code> هو هيكل بيانات ثنائي الأبعاد (جدول) يشبه: - جدول في <strong>Excel</strong> - جدول في قاعدة بيانات مثل <strong>MySQL</strong> - مصفوفة متقدمة في الرياضيات</p>
<h3 id="خصائص-الـ-dataframe">✅ خصائص الـ DataFrame:</h3>
<table>
<thead>
<tr class="header">
<th>الخاصية</th>
<th>الوصف</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>أعمدة (Columns)</strong></td>
<td>كل عمود له اسم (مثل: “الاسم”، “السعر”)</td>
</tr>
<tr class="even">
<td><strong>صفوف (Rows)</strong></td>
<td>كل صف يمثل سجلًا (مثل: عميل واحد)</td>
</tr>
<tr class="odd">
<td><strong>فهرس (Index)</strong></td>
<td>رقم تسلسلي لكل صف (يبدأ من 0 غالبًا)</td>
</tr>
<tr class="even">
<td><strong>أنواع بيانات مختلفة</strong></td>
<td>يمكن أن يكون عمود رقمي، وآخر نصي، وثالث تواريخ</td>
</tr>
<tr class="odd">
<td><strong>قابل للتوسيع</strong></td>
<td>يمكن إضافة أعمدة أو صفوف بسهولة</td>
</tr>
</tbody>
</table>
<h3 id="تشبيه-بسيط">🎯 تشبيه بسيط:</h3>
<blockquote>
<p>💡 اعتبر أن الـ <code>DataFrame</code> هو <strong>سجل مدرسي</strong>: - الأعمدة: “الاسم”، “العمر”، “الصف”، “الدرجة” - الصفوف: كل طالب - الفهرس: الرقم التسلسلي للطالب</p>
</blockquote>
<hr />
<h2 id="كيفية-إنشاء-dataframe">🔹 <strong>كيفية إنشاء DataFrame؟</strong></h2>
<h3 id="الطريقة-1-من-قاموس-dict-الأسهل-والأكثر-شيوعا">✅ الطريقة 1: من قاموس (Dict) — الأسهل والأكثر شيوعًا</h3>
<p>القاموس في Python هو بنية بيانات تُخزن “مفتاح: قيمة”.<br />
في Pandas، نستخدم القاموس بحيث: - <strong>المفتاح</strong>: اسم العمود - <strong>القيمة</strong>: قائمة بالقيم في ذلك العمود</p>
<h4 id="المثال-1-إنشاء-dataframe-لطلاب">📌 المثال 1: إنشاء DataFrame لطلاب</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>data <span class="op">=</span> {</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a>    <span class="st">&#39;الاسم&#39;</span>: [<span class="st">&#39;خالد&#39;</span>, <span class="st">&#39;نورة&#39;</span>, <span class="st">&#39;فهد&#39;</span>, <span class="st">&#39;منى&#39;</span>],</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a>    <span class="st">&#39;العمر&#39;</span>: [<span class="dv">18</span>, <span class="dv">17</span>, <span class="dv">19</span>, <span class="dv">18</span>],</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a>    <span class="st">&#39;الصف&#39;</span>: [<span class="st">&#39;ثاني ثانوي&#39;</span>, <span class="st">&#39;أول ثانوي&#39;</span>, <span class="st">&#39;ثاني ثانوي&#39;</span>, <span class="st">&#39;ثالث ثانوي&#39;</span>],</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a>    <span class="st">&#39;الدرجة&#39;</span>: [<span class="dv">88</span>, <span class="dv">94</span>, <span class="dv">76</span>, <span class="dv">91</span>]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a>}</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a>df_students <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a><span class="bu">print</span>(df_students)</span></code></pre></div>
<h4 id="الناتج">🔍 <strong>الناتج:</strong></h4>
<pre><code>   الاسم  العمر       الصف  الدرجة
0   خالد     18  ثاني ثانوي     88
1   نورة     17  أول ثانوي     94
2   فهد     19  ثاني ثانوي     76
3   منى     18  ثالث ثانوي     91</code></pre>
<blockquote>
<p>✅ تم إنشاء جدول بـ 4 أعمدة و4 صفوف. الفهرس التلقائي من 0 إلى 3.</p>
</blockquote>
<hr />
<h3 id="الطريقة-2-من-قائمة-list-of-lists">✅ الطريقة 2: من قائمة (List of Lists)</h3>
<p>يمكنك إنشاء DataFrame من قائمة من الصفوف، حيث كل صف هو قائمة.</p>
<h4 id="المثال-2-من-قائمة">📌 المثال 2: من قائمة</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a>rows <span class="op">=</span> [</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>    [<span class="st">&#39;تفاح&#39;</span>, <span class="fl">3.5</span>, <span class="dv">50</span>],</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>    [<span class="st">&#39;موز&#39;</span>, <span class="fl">2.0</span>, <span class="dv">30</span>],</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>    [<span class="st">&#39;حليب&#39;</span>, <span class="fl">8.0</span>, <span class="dv">20</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a>columns <span class="op">=</span> [<span class="st">&#39;المنتج&#39;</span>, <span class="st">&#39;السعر&#39;</span>, <span class="st">&#39;الكمية&#39;</span>]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a>df_products <span class="op">=</span> pd.DataFrame(rows, columns<span class="op">=</span>columns)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a><span class="bu">print</span>(df_products)</span></code></pre></div>
<h4 id="الناتج-1">🔍 الناتج:</h4>
<pre><code>  المنتج  السعر  الكمية
0   تفاح    3.5     50
1   موز    2.0     30
2  حليب    8.0     20</code></pre>
<blockquote>
<p>⚠️ <strong>ملاحظة مهمة</strong>: إذا لم تُدخل <code>columns=</code>، فسيُسمى الأعمدة تلقائيًا: 0, 1, 2…</p>
</blockquote>
<hr />
<h3 id="الطريقة-3-من-مصفوفة-numpy">✅ الطريقة 3: من مصفوفة NumPy</h3>
<p>بما أن Pandas مبنية على NumPy، يمكنك استخدام مصفوفة NumPy.</p>
<h4 id="المثال-3-باستخدام-numpy">📌 المثال 3: باستخدام NumPy</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a>data_np <span class="op">=</span> np.array([</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a>    [<span class="st">&#39;أحمد&#39;</span>, <span class="dv">25</span>, <span class="st">&#39;الرياض&#39;</span>],</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a>    [<span class="st">&#39;سارة&#39;</span>, <span class="dv">30</span>, <span class="st">&#39;جدة&#39;</span>],</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>    [<span class="st">&#39;علي&#39;</span>, <span class="dv">22</span>, <span class="st">&#39;الدمام&#39;</span>]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a>])</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a>df_employees <span class="op">=</span> pd.DataFrame(data_np, columns<span class="op">=</span>[<span class="st">&#39;الاسم&#39;</span>, <span class="st">&#39;العمر&#39;</span>, <span class="st">&#39;المدينة&#39;</span>])</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a><span class="bu">print</span>(df_employees)</span></code></pre></div>
<h4 id="الناتج-2">🔍 الناتج:</h4>
<pre><code>  الاسم  العمر  المدينة
0   أحمد     25    الرياض
1   سارة     30      جدة
2   علي      22    الدمام</code></pre>
<blockquote>
<p>⚠️ <strong>تحذير</strong>: جميع القيم أصبحت من نوع <code>object</code> (نص) لأن NumPy يُجبر المصفوفة على نوع بيانات واحد. العمر هنا ليس رقمًا يمكن حسابه!</p>
</blockquote>
<hr />
<h3 id="الطريقة-4-من-قائمة-من-القواميس">✅ الطريقة 4: من قائمة من القواميس</h3>
<p>مفيد جدًا عند التعامل مع بيانات من APIs.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a>data_dicts <span class="op">=</span> [</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>    {<span class="st">&#39;اسم&#39;</span>: <span class="st">&#39;أحمد&#39;</span>, <span class="st">&#39;درجة&#39;</span>: <span class="dv">85</span>},</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a>    {<span class="st">&#39;اسم&#39;</span>: <span class="st">&#39;سارة&#39;</span>, <span class="st">&#39;درجة&#39;</span>: <span class="dv">92</span>},</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a>    {<span class="st">&#39;اسم&#39;</span>: <span class="st">&#39;علي&#39;</span>, <span class="st">&#39;درجة&#39;</span>: <span class="dv">78</span>}</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a>df_grades <span class="op">=</span> pd.DataFrame(data_dicts)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a><span class="bu">print</span>(df_grades)</span></code></pre></div>
<h4 id="الناتج-3">🔍 الناتج:</h4>
<pre><code>   اسم  درجة
0  أحمد    85
1  سارة    92
2   علي    78</code></pre>
<blockquote>
<p>✅ مفيد جدًا في تحليل بيانات JSON من الإنترنت.</p>
</blockquote>
<hr />
<h2 id="فهم-نوع-البيانات-dtypes-عند-الإنشاء">🔹 <strong>فهم نوع البيانات (dtypes) عند الإنشاء</strong></h2>
<p>لنفحص نوع البيانات:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="bu">print</span>(df_employees.dtypes)</span></code></pre></div>
<h4 id="الناتج-4">🔍 الناتج:</h4>
<pre><code>الاسم      object
العمر      object   ← ❌ ليس int!
المدينة    object
dtype: object</code></pre>
<blockquote>
<p>⚠️ <strong>المشكلة</strong>: العمر مُعامل كنص لأنه في مصفوفة نصوص.</p>
</blockquote>
<h3 id="الحل-تحويل-الأعمدة-يدويا">✅ الحل: تحويل الأعمدة يدويًا</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>df_employees[<span class="st">&#39;العمر&#39;</span>] <span class="op">=</span> df_employees[<span class="st">&#39;العمر&#39;</span>].astype(<span class="bu">int</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a><span class="bu">print</span>(df_employees.dtypes)</span></code></pre></div>
<blockquote>
<p>الآن العمر من نوع <code>int64</code>، ويمكنك حساب المتوسط:</p>
</blockquote>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;متوسط العمر:&quot;</span>, df_employees[<span class="st">&#39;العمر&#39;</span>].mean())  <span class="co"># 25.67</span></span></code></pre></div>
<hr />
<h2 id="الأخطاء-الشائعة-عند-الإنشاء-تحليل-معمق">🔹 <strong>الأخطاء الشائعة عند الإنشاء (تحليل معمق)</strong></h2>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 40%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>كيف تكتشفه</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ValueError: arrays must all be same length</code></td>
<td>أحد الأعمدة أطول من الآخر</td>
<td>عند تشغيل <code>pd.DataFrame()</code></td>
<td>تأكد أن كل قائمة لها نفس الطول</td>
</tr>
<tr class="even">
<td><code>KeyError</code> عند الوصول للعمود</td>
<td>خطأ إملائي في اسم العمود</td>
<td>عند استخدام <code>df['اسم']</code></td>
<td>تحقق من الأسماء باستخدام <code>df.columns</code></td>
</tr>
<tr class="odd">
<td><code>NameError: name 'pd' is not defined</code></td>
<td>لم تستورد Pandas</td>
<td>عند أول استخدام لـ <code>pd</code></td>
<td>تأكد من <code>import pandas as pd</code></td>
</tr>
<tr class="even">
<td><code>SettingWithCopyWarning</code></td>
<td>تعديل على نسخة من DataFrame</td>
<td>عند التعديل بعد الفلترة</td>
<td>استخدم <code>.copy()</code> أو <code>.loc</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-من-السهل-إلى-الصعب">🔹 <strong>تمارين تطبيقية (من السهل إلى الصعب)</strong></h2>
<h3 id="التمرين-1-إنشاء-dataframe-بسيط">✅ التمرين 1: إنشاء DataFrame بسيط</h3>
<p>أنشئ DataFrame يحتوي على: - الموظفين: [‘سليمان’, ‘هدى’, ‘راشد’] - الرواتب: [8000, 9500, 7000] - الإدارات: [‘مبيعات’, ‘تسويق’, ‘مبيعات’]</p>
<h3 id="التمرين-2-تصحيح-خطأ">✅ التمرين 2: تصحيح خطأ</h3>
<p>الكود التالي به خطأ. عيّنه وصحّحه:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a>data <span class="op">=</span> {</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>    <span class="st">&#39;city&#39;</span>: [<span class="st">&#39;Riyadh&#39;</span>, <span class="st">&#39;Jeddah&#39;</span>],</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>    <span class="st">&#39;temp&#39;</span>: [<span class="dv">38</span>, <span class="dv">35</span>, <span class="dv">40</span>]  <span class="co"># ← خطأ هنا</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>}</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame(data)</span></code></pre></div>
<h3 id="التمرين-3-من-قائمة-إلى-dataframe">✅ التمرين 3: من قائمة إلى DataFrame</h3>
<p>أنشئ DataFrame من القائمة التالية:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a>data <span class="op">=</span> [</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>    [<span class="st">&#39;Product A&#39;</span>, <span class="dv">100</span>, <span class="st">&#39;Electronics&#39;</span>],</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a>    [<span class="st">&#39;Product B&#39;</span>, <span class="dv">150</span>, <span class="st">&#39;Clothing&#39;</span>]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a>]</span></code></pre></div>
<h3 id="التمرين-4-من-numpy-مع-تحويل-نوع">✅ التمرين 4: من NumPy مع تحويل نوع</h3>
<p>استخدم <code>np.array</code> لإنشاء DataFrame، ثم حوّل عمود “السعر” إلى <code>float</code>.</p>
<hr />
<h2 id="الربط-بالواقع-مشروع-صغير-إدارة-متجر">🔹 <strong>الربط بالواقع: مشروع صغير — إدارة متجر</strong></h2>
<h3 id="الهدف-إنشاء-سجل-مبيعات-أولي">🎯 الهدف: إنشاء سجل مبيعات أولي</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a>sales_data <span class="op">=</span> {</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a>    <span class="st">&#39;التاريخ&#39;</span>: [<span class="st">&#39;2023-01-01&#39;</span>, <span class="st">&#39;2023-01-01&#39;</span>, <span class="st">&#39;2023-01-02&#39;</span>],</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;تفاح&#39;</span>, <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;حليب&#39;</span>],</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a>    <span class="st">&#39;السعر&#39;</span>: [<span class="fl">3.5</span>, <span class="fl">2.0</span>, <span class="fl">8.0</span>],</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a>    <span class="st">&#39;الكمية&#39;</span>: [<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">5</span>],</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a>    <span class="st">&#39;الفئة&#39;</span>: [<span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;ألبان&#39;</span>]</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a>}</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true"></a>df_sales <span class="op">=</span> pd.DataFrame(sales_data)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true"></a>df_sales[<span class="st">&#39;الإجمالي&#39;</span>] <span class="op">=</span> df_sales[<span class="st">&#39;السعر&#39;</span>] <span class="op">*</span> df_sales[<span class="st">&#39;الكمية&#39;</span>]</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true"></a><span class="bu">print</span>(df_sales)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;إجمالي المبيعات:&quot;</span>, df_sales[<span class="st">&#39;الإجمالي&#39;</span>].<span class="bu">sum</span>())</span></code></pre></div>
<h4 id="الناتج-5">🔍 الناتج:</h4>
<pre><code>      التاريخ  المنتج  السعر  الكمية   الفئة  الإجمالي
0  2023-01-01   تفاح    3.5     10   فواكه      35.0
1  2023-01-01   موز    2.0     15   فواكه      30.0
2  2023-01-02  حليب    8.0      5   ألبان      40.0

إجمالي المبيعات: 105.0</code></pre>
<blockquote>
<p>هذا هو الأساس لأي نظام تحليل مبيعات!</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-للمبتدئين">🔹 <strong>نصائح احترافية للمبتدئين</strong></h2>
<ol type="1">
<li>✅ <strong>استخدم <code>pd.DataFrame()</code> فقط مع بيانات منظمة</strong> — لا تجبر بيانات معقدة على أن تصبح DataFrame.</li>
<li>✅ <strong>تحقق من <code>dtypes</code> دائمًا</strong> — كثيرًا ما تكون الأرقام كنصوص.</li>
<li>✅ <strong>استخدم <code>df.head()</code> بعد الإنشاء</strong> — للتأكد من أن البيانات تبدو صحيحة.</li>
<li>✅ <strong>لا تنسَ <code>import pandas as pd</code></strong> — خطأ شائع جدًا.</li>
<li>✅ <strong>احفظ الكود في ملف <code>.py</code> أو <code>Jupyter Notebook</code></strong> — أسهل للتجربة.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>Series</code> و <code>DataFrame</code>؟</li>
<li>لماذا نستخدم <code>columns=</code> عند إنشاء DataFrame من قائمة؟</li>
<li>ماذا يحدث إذا كانت إحدى القوائم في القاموس أقصر من الأخرى؟</li>
<li>كيف تتأكد من أن عمود “السعر” رقمي وليس نصيًا؟</li>
<li>ما الفائدة من استخدام <code>df.copy()</code> عند الفلترة؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس">🔹 <strong>مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>المفهوم</th>
<th>الوصف</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>DataFrame</code></td>
<td>جدول بيانات ثنائي الأبعاد</td>
</tr>
<tr class="even">
<td><code>pd.DataFrame(dict)</code></td>
<td>الأسلوب الأكثر شيوعًا</td>
</tr>
<tr class="odd">
<td><code>columns=</code></td>
<td>لتحديد أسماء الأعمدة</td>
</tr>
<tr class="even">
<td><code>astype()</code></td>
<td>لتحويل نوع البيانات</td>
</tr>
<tr class="odd">
<td><code>dtypes</code></td>
<td>لمعرفة نوع كل عمود</td>
</tr>
<tr class="even">
<td><code>head()</code></td>
<td>لعرض أول 5 صفوف</td>
</tr>
</tbody>
</table>
<h1 id="الدرس-2-قراءة-البيانات-من-ملفات-csv-وexcel-وjson-1">📘 <strong>الدرس 2 : قراءة البيانات من ملفات CSV وExcel وJSON</strong></h1>
<hr />
<h2 id="مقدمة-لماذا-نقرأ-من-ملفات">🔹 <strong>مقدمة: لماذا نقرأ من ملفات؟</strong></h2>
<p>في العالم الحقيقي، <strong>نادرًا ما نُنشئ البيانات يدويًا</strong>.<br />
البيانات تأتي من: - ملفات CSV من أنظمة المحاسبة - ملفات إكسل من المبيعات - ملفات JSON من تطبيقات الجوال أو APIs</p>
<p>لذلك، <strong>قراءة البيانات</strong> هي أول خطوة في أي مشروع تحليل.</p>
<hr />
<h2 id="قراءة-ملف-csv-باستخدام-pd.read_csv">🔹 <strong>1. قراءة ملف CSV باستخدام <code>pd.read_csv()</code></strong></h2>
<h3 id="ما-هو-ملف-csv">✅ ما هو ملف CSV؟</h3>
<ul>
<li><strong>CSV</strong> = Comma-Separated Values</li>
<li>ملف نصي، كل صف يمثل سجل، وكل عمود يفصله فاصلة.</li>
<li>مثالي للبيانات الكبيرة.</li>
</ul>
<h3 id="المثال-1-قراءة-ملف-بسيط">📌 المثال 1: قراءة ملف بسيط</h3>
<p>افترض أن لديك ملف <code>employees.csv</code>:</p>
<pre class="csv"><code>الاسم,العمر,المدينة,الراتب
أحمد,25,الرياض,5000
سارة,30,جدة,7000
علي,22,الدمام,4000</code></pre>
<p>الكود:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;employees.csv&#39;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a><span class="bu">print</span>(df)</span></code></pre></div>
<h4 id="الناتج-6">🔍 الناتج:</h4>
<pre><code>  الاسم  العمر  المدينة  الراتب
0   أحمد     25    الرياض  5000
1   سارة     30      جدة  7000
2   علي      22    الدمام  4000</code></pre>
<blockquote>
<p>✅ تم تحميل البيانات بنجاح.</p>
</blockquote>
<hr />
<h3 id="خيارات-مهمة-في-read_csv">🔹 <strong>خيارات مهمة في <code>read_csv</code></strong></h3>
<table>
<thead>
<tr class="header">
<th>الخيار</th>
<th>الوظيفة</th>
<th>مثال</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>sep</code></td>
<td>تحديد الفاصل</td>
<td><code>sep=';'</code></td>
</tr>
<tr class="even">
<td><code>header</code></td>
<td>رقم صف العناوين</td>
<td><code>header=0</code></td>
</tr>
<tr class="odd">
<td><code>index_col</code></td>
<td>جعل عمود فهرسًا</td>
<td><code>index_col='الاسم'</code></td>
</tr>
<tr class="even">
<td><code>encoding</code></td>
<td>الترميز</td>
<td><code>encoding='utf-8'</code></td>
</tr>
<tr class="odd">
<td><code>skiprows</code></td>
<td>تخطي صفوف</td>
<td><code>skiprows=1</code></td>
</tr>
<tr class="even">
<td><code>nrows</code></td>
<td>قراءة عدد محدد من الصفوف</td>
<td><code>nrows=100</code></td>
</tr>
</tbody>
</table>
<h4 id="المثال-2-استخدام-خيارات-متقدمة">📌 المثال 2: استخدام خيارات متقدمة</h4>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a>df <span class="op">=</span> pd.read_csv(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a>    <span class="st">&#39;data.csv&#39;</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a>    sep<span class="op">=</span><span class="st">&#39;;&#39;</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a>    encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a>    index_col<span class="op">=</span><span class="st">&#39;ID&#39;</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a>    nrows<span class="op">=</span><span class="dv">500</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true"></a>)</span></code></pre></div>
<hr />
<h2 id="قراءة-ملف-excel-باستخدام-pd.read_excel">🔹 <strong>2. قراءة ملف Excel باستخدام <code>pd.read_excel()</code></strong></h2>
<h3 id="ما-هو-ملف-إكسل">✅ ما هو ملف إكسل؟</h3>
<ul>
<li>تنسيق <code>.xlsx</code> من Microsoft Excel.</li>
<li>يمكن أن يحتوي على عدة أوراق (sheets).</li>
<li>أكثر تعقيدًا من CSV.</li>
</ul>
<h3 id="المثال-3-قراءة-ورقة-واحدة">📌 المثال 3: قراءة ورقة واحدة</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a>df <span class="op">=</span> pd.read_excel(<span class="st">&#39;sales.xlsx&#39;</span>, sheet_name<span class="op">=</span><span class="st">&#39;يناير&#39;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a><span class="bu">print</span>(df.head())</span></code></pre></div>
<blockquote>
<p>⚠️ تحتاج تثبيت <code>openpyxl</code>:</p>
</blockquote>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="ex">pip</span> install openpyxl</span></code></pre></div>
<h3 id="المثال-4-قراءة-كل-الأوراق">📌 المثال 4: قراءة كل الأوراق</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a>all_sheets <span class="op">=</span> pd.read_excel(<span class="st">&#39;sales.xlsx&#39;</span>, sheet_name<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a><span class="cf">for</span> sheet_name, data <span class="kw">in</span> all_sheets.items():</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="ss">f&quot;--- ورقة: </span><span class="sc">{</span>sheet_name<span class="sc">}</span><span class="ss"> ---&quot;</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true"></a>    <span class="bu">print</span>(data.head())</span></code></pre></div>
<hr />
<h2 id="قراءة-ملف-json-باستخدام-pd.read_json">🔹 <strong>3. قراءة ملف JSON باستخدام <code>pd.read_json()</code></strong></h2>
<h3 id="ما-هو-json">✅ ما هو JSON؟</h3>
<ul>
<li>تنسيق شائع في واجهات برمجة التطبيقات (APIs).</li>
<li>يُخزن البيانات كـ كائنات أو مصفوفات.</li>
</ul>
<h3 id="المثال-5-من-ملف-json">📌 المثال 5: من ملف JSON</h3>
<p>ملف <code>users.json</code>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="ot">[</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a>  <span class="fu">{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Ahmed&quot;</span><span class="fu">,</span> <span class="dt">&quot;age&quot;</span><span class="fu">:</span> <span class="dv">25</span><span class="fu">,</span> <span class="dt">&quot;city&quot;</span><span class="fu">:</span> <span class="st">&quot;Riyadh&quot;</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a>  <span class="fu">{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Sara&quot;</span><span class="fu">,</span> <span class="dt">&quot;age&quot;</span><span class="fu">:</span> <span class="dv">30</span><span class="fu">,</span> <span class="dt">&quot;city&quot;</span><span class="fu">:</span> <span class="st">&quot;Jeddah&quot;</span><span class="fu">}</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true"></a><span class="ot">]</span></span></code></pre></div>
<p>الكود:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a>df <span class="op">=</span> pd.read_json(<span class="st">&#39;users.json&#39;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a><span class="bu">print</span>(df)</span></code></pre></div>
<blockquote>
<p>✅ يعمل بشكل جيد مع المصفوفات من الكائنات.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-تحليل-معمق">🔹 <strong>الأخطاء الشائعة (تحليل معمق)</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>FileNotFoundError</code></td>
<td>الملف غير موجود</td>
<td>تحقق من المسار والاسم</td>
</tr>
<tr class="even">
<td><code>UnicodeDecodeError</code></td>
<td>ترميز خاطئ</td>
<td>استخدم <code>encoding='utf-8'</code></td>
</tr>
<tr class="odd">
<td><code>EmptyDataError</code></td>
<td>الملف فارغ</td>
<td>تحقق من محتوى الملف</td>
</tr>
<tr class="even">
<td><code>ParserError</code></td>
<td>تنسيق CSV تالف</td>
<td>استخدم <code>error_bad_lines=False</code> (قديم) أو <code>on_bad_lines='skip'</code> (جديد)</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية">🔹 <strong>تمارين تطبيقية</strong></h2>
<ol type="1">
<li>أنشئ ملف CSV باسم <code>grades.csv</code> واملأه ببيانات طلاب، ثم اقرأه.</li>
<li>كيف تقرأ ورقة محددة من ملف إكسل به 3 أوراق؟</li>
<li>ما الفرق بين <code>read_csv</code> و <code>read_table</code>؟</li>
<li>كيف تقرأ أول 10 صفوف فقط من ملف كبير جدًا؟</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-تحليل-مبيعات-شهرية">🔹 <strong>الربط بالواقع: تحليل مبيعات شهرية</strong></h2>
<p>افترض أنك قرأت ملفات مبيعات من 3 أشهر:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a>jan <span class="op">=</span> pd.read_csv(<span class="st">&#39;jan.csv&#39;</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a>feb <span class="op">=</span> pd.read_csv(<span class="st">&#39;feb.csv&#39;</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true"></a>mar <span class="op">=</span> pd.read_csv(<span class="st">&#39;mar.csv&#39;</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true"></a>total_sales <span class="op">=</span> pd.concat([jan, feb, mar])</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;إجمالي المبيعات:&quot;</span>, total_sales[<span class="st">&#39;الإجمالي&#39;</span>].<span class="bu">sum</span>())</span></code></pre></div>
<blockquote>
<p>هذا هو الأساس لتحليل أداء الشركة!</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية">🔹 <strong>نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>df.shape</code> بعد القراءة — للتأكد من عدد الصفوف والأعمدة.</li>
<li>✅ استخدم <code>df.head()</code> و <code>df.tail()</code> — لفحص بداية ونهاية البيانات.</li>
<li>✅ احفظ مسارات الملفات في متغيرات — لسهولة التعديل.</li>
<li>✅ استخدم <code>try-except</code> عند القراءة — لتجنب توقف البرنامج.</li>
</ol>
<h1 id="الدرس-3-فحص-معلومات-الجدول-info-و-describe-و-dtypes-و-isnull-1">📘 <strong>الدرس 3 : فحص معلومات الجدول: <code>info()</code> و <code>describe()</code> و <code>dtypes</code> و <code>isnull()</code></strong></h1>
<h2 id="مقدمة-لماذا-نفحص-الجدول">🔹 <strong>مقدمة: لماذا نفحص الجدول؟</strong></h2>
<p>تخيل أنك طبيب، وتم إعطاؤك مريضًا جديدًا. أول ما تفعله هو: - فحص العلامات الحيوية - تحليل الدم - التأكد من عدم وجود أعراض خطيرة</p>
<p>نفس الشيء ينطبق على <strong>تحليل البيانات</strong>.<br />
قبل أن تبدأ في الحساب أو التصوير البياني، يجب أن <strong>تفحص الجدول جيدًا</strong> للتأكد من: - صحة الأنواع (هل العمر رقم أم نص؟) - وجود قيم مفقودة - عدد الصفوف والأعمدة - هل البيانات منطقية؟</p>
<p>هذا هو هدف هذا الدرس: <strong>الاستعداد الجيد لأي تحليل بيانات</strong>.</p>
<hr />
<h2 id="df.info-فحص-عام-للجدول">🔹 <strong>1. <code>df.info()</code> — فحص عام للجدول</strong></h2>
<h3 id="ماذا-يعرض-info">✅ ماذا يعرض <code>info()</code>؟</h3>
<ul>
<li>عدد الصفوف (الإدخالات)</li>
<li>عدد الأعمدة</li>
<li>اسم كل عمود</li>
<li>عدد القيم غير المفقودة (Non-Null Count)</li>
<li>نوع البيانات (dtype)</li>
<li>استهلاك الذاكرة</li>
</ul>
<h3 id="المثال-1-استخدام-info-على-بيانات-الموظفين">📌 المثال 1: استخدام <code>info()</code> على بيانات الموظفين</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true"></a>data <span class="op">=</span> {</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true"></a>    <span class="st">&#39;الاسم&#39;</span>: [<span class="st">&#39;أحمد&#39;</span>, <span class="st">&#39;سارة&#39;</span>, <span class="st">&#39;علي&#39;</span>, <span class="st">&#39;نورة&#39;</span>],</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true"></a>    <span class="st">&#39;العمر&#39;</span>: [<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">22</span>, <span class="dv">28</span>],</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true"></a>    <span class="st">&#39;المدينة&#39;</span>: [<span class="st">&#39;الرياض&#39;</span>, <span class="st">&#39;جدة&#39;</span>, <span class="st">&#39;الدمام&#39;</span>, <span class="va">None</span>],</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true"></a>    <span class="st">&#39;الراتب&#39;</span>: [<span class="dv">5000</span>, <span class="dv">7000</span>, <span class="dv">4000</span>, <span class="dv">6000</span>]</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true"></a>}</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true"></a>df.info()</span></code></pre></div>
<h4 id="الناتج-7">🔍 <strong>الناتج:</strong></h4>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 4 entries, 0 to 3
Data columns (total 4 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   الاسم     4 non-null      object 
 1   العمر     4 non-null      int64  
 2   المدينة    3 non-null      object 
 3   الراتب     4 non-null      int64  
dtypes: int64(2), object(2)
memory usage: 200.0+ bytes</code></pre>
<h3 id="تحليل-الناتج">🔍 <strong>تحليل الناتج:</strong></h3>
<ul>
<li>هناك 4 صفوف (من 0 إلى 3).</li>
<li>العمود “المدينة” به 3 قيم غير مفقودة فقط → هناك <strong>قيمة مفقودة واحدة</strong>.</li>
<li>العمر والراتب من نوع <code>int64</code> (أعداد صحيحة).</li>
<li>الاسم والمدينة من نوع <code>object</code> (غالبًا نصوص).</li>
<li>الذاكرة المستهلكة صغيرة جدًا (200 بايت).</li>
</ul>
<blockquote>
<p>✅ هذا الكشف عن القيمة المفقودة في “المدينة” هو <strong>معلومة حيوية</strong>!</p>
</blockquote>
<hr />
<h2 id="df.dtypes-معرفة-نوع-كل-عمود">🔹 <strong>2. <code>df.dtypes</code> — معرفة نوع كل عمود</strong></h2>
<h3 id="متى-نستخدمه">✅ متى نستخدمه؟</h3>
<p>عندما نريد التحقق بسرعة من أنواع البيانات، دون تفاصيل إضافية.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="bu">print</span>(df.dtypes)</span></code></pre></div>
<h4 id="الناتج-8">🔍 الناتج:</h4>
<pre><code>الاسم      object
العمر       int64
المدينة     object
الراتب       int64
dtype: object</code></pre>
<blockquote>
<p>⚠️ <strong>تحذير شائع</strong>: إذا كان عمود “العمر” من نوع <code>object</code>، فهذا يعني أنه <strong>نص</strong>، ولا يمكن حساب المتوسط عليه!</p>
</blockquote>
<h3 id="كيف-تكتشف-المشكلة">✅ كيف تكتشف المشكلة؟</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="cf">if</span> df[<span class="st">&#39;العمر&#39;</span>].dtype <span class="op">==</span> <span class="st">&#39;object&#39;</span>:</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="st">&quot;تحذير: العمر ليس رقمًا!&quot;</span>)</span></code></pre></div>
<hr />
<h2 id="df.describe-الإحصاءات-الوصفية">🔹 <strong>3. <code>df.describe()</code> — الإحصاءات الوصفية</strong></h2>
<h3 id="ماذا-يفعل">✅ ماذا يفعل؟</h3>
<p>يُظهر ملخصًا إحصائيًا <strong>للأعمدة الرقمية فقط</strong>: - العدد (count) - المتوسط (mean) - الانحراف المعياري (std) - القيم الدنيا والعليا (min, max) - الرباعيات (25%, 50%, 75%)</p>
<h3 id="المثال-2-وصف-الإحصائيات">📌 المثال 2: وصف الإحصائيات</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="bu">print</span>(df.describe())</span></code></pre></div>
<h4 id="الناتج-9">🔍 الناتج:</h4>
<pre><code>           العمر         الراتب
count   4.000000      4.000000
mean   26.250000   5500.000000
std     3.593977   1290.994427
min    22.000000   4000.000000
25%    24.250000   4750.000000
50%    26.500000   5500.000000
75%    27.500000   6250.000000
max    30.000000   7000.000000</code></pre>
<h3 id="تحليل-النتائج">🔍 <strong>تحليل النتائج:</strong></h3>
<ul>
<li>متوسط العمر: 26.25 سنة</li>
<li>أعلى راتب: 7000 ريال</li>
<li>75% من الرواتب أقل من 6250</li>
</ul>
<blockquote>
<p>✅ هذه المعلومات مفيدة جدًا في تقارير الموارد البشرية.</p>
</blockquote>
<hr />
<h3 id="كيف-تعرض-الأعمدة-النصية-في-describe">✅ كيف تعرض الأعمدة النصية في <code>describe()</code>؟</h3>
<p>باستخدام <code>include='object'</code>:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="bu">print</span>(df.describe(include<span class="op">=</span><span class="st">&#39;object&#39;</span>))</span></code></pre></div>
<h4 id="الناتج-10">🔍 الناتج:</h4>
<pre><code>       الاسم    المدينة     الراتب
count     4         3         4
unique    4         3         4
top     نورة      جدة      5000
freq      1         1         1</code></pre>
<blockquote>
<ul>
<li><code>unique</code>: عدد القيم المختلفة</li>
<li><code>top</code>: القيمة الأكثر تكرارًا</li>
<li><code>freq</code>: عدد مرات التكرار</li>
</ul>
</blockquote>
<hr />
<h2 id="df.isnull-و-df.notnull-اكتشاف-القيم-المفقودة">🔹 <strong>4. <code>df.isnull()</code> و <code>df.notnull()</code> — اكتشاف القيم المفقودة</strong></h2>
<h3 id="ما-هي-القيم-المفقودة">✅ ما هي القيم المفقودة؟</h3>
<ul>
<li>تمثّل بـ <code>NaN</code> (Not a Number)</li>
<li>تحدث بسبب: بيانات ناقصة، خطأ في الإدخال، عدم توفر المعلومات</li>
</ul>
<h3 id="المثال-3-استخدام-isnull">📌 المثال 3: استخدام <code>isnull()</code></h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a><span class="bu">print</span>(df.isnull())</span></code></pre></div>
<h4 id="الناتج-11">🔍 الناتج:</h4>
<pre><code>    الاسم   العمر  المدينة   الراتب
0  False  False   False   False
1  False  False   False   False
2  False  False   False   False
3  False  False    True   False</code></pre>
<blockquote>
<p>✅ فقط خلية “المدينة” في الصف 3 هي <code>NaN</code>.</p>
</blockquote>
<h3 id="كم-عدد-القيم-المفقودة-في-كل-عمود">✅ كم عدد القيم المفقودة في كل عمود؟</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>())</span></code></pre></div>
<h4 id="الناتج-12">🔍 الناتج:</h4>
<pre><code>الاسم      0
العمر      0
المدينة    1
الراتب      0
dtype: int64</code></pre>
<blockquote>
<p>مثالي للإبلاغ عن جودة البيانات.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-تحليل-معمق-1">🔹 <strong>الأخطاء الشائعة (تحليل معمق)</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>AttributeError: 'DataFrame' object has no attribute 'infos'</code></td>
<td>كتابة <code>info</code> بدون أقواس أو خطأ إملائي</td>
<td>تأكد من <code>df.info()</code></td>
</tr>
<tr class="even">
<td><code>describe()</code> لا يعرض عمودًا معينًا</td>
<td>لأن العمود نصي وليس رقمي</td>
<td>استخدم <code>include='all'</code> أو <code>'object'</code></td>
</tr>
<tr class="odd">
<td><code>isnull()</code> لا يُظهر شيئًا</td>
<td>لأن البيانات كاملة</td>
<td>جيّد! لا مشكلة</td>
</tr>
<tr class="even">
<td><code>dtypes</code> تُظهر <code>object</code> لعمود رقمي</td>
<td>بسبب وجود نصوص أو <code>NaN</code> في العمود</td>
<td>نظّف البيانات ثم حوّل النوع</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-1">🔹 <strong>تمارين تطبيقية</strong></h2>
<h3 id="التمرين-1-افحص-جدولك">✅ التمرين 1: افحص جدولك</h3>
<p>أنشئ DataFrame يحتوي على: - الطلاب: [‘خالد’, ‘منى’, ‘فهد’] - الدرجات: [85, None, 78] ثم استخدم <code>info()</code> و <code>isnull()</code> لتحديد المشكلة.</p>
<h3 id="التمرين-2-فهم-الناتج">✅ التمرين 2: فهم الناتج</h3>
<p>لماذا لا يظهر عمود “الاسم” في <code>describe()</code>؟ كيف تجعله يظهر؟</p>
<h3 id="التمرين-3-تحليل-جودة-البيانات">✅ التمرين 3: تحليل جودة البيانات</h3>
<p>ما الفرق بين <code>df.isnull().sum()</code> و <code>df.notnull().sum()</code>؟</p>
<h3 id="التمرين-4-تحليل-واقعي">✅ التمرين 4: تحليل واقعي</h3>
<p>لديك ملف مبيعات. استخدم <code>describe()</code> لمعرفة: - متوسط السعر - أقل كمية مباعة - التباين في الإيرادات</p>
<hr />
<h2 id="الربط-بالواقع-تحليل-جودة-البيانات-في-شركة">🔹 <strong>الربط بالواقع: تحليل جودة البيانات في شركة</strong></h2>
<h3 id="الهدف-إعداد-تقرير-جودة-البيانات">🎯 الهدف: إعداد تقرير جودة البيانات</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true"></a><span class="kw">def</span> quality_report(df):</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="st">&quot;=== تقرير جودة البيانات ===&quot;</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="ss">f&quot;عدد الصفوف: </span><span class="sc">{df.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="ss">f&quot;عدد الأعمدة: </span><span class="sc">{df.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="ss">f&quot;القيم المفقودة: </span><span class="ch">\n</span><span class="sc">{df.</span>isnull()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="ss">f&quot;أنواع البيانات: </span><span class="ch">\n</span><span class="sc">{df.</span>dtypes<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="ss">f&quot;الإحصاءات: </span><span class="ch">\n</span><span class="sc">{df.</span>describe()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true"></a>quality_report(df)</span></code></pre></div>
<blockquote>
<p>✅ هذا التقرير يُستخدم في المؤسسات الكبيرة قبل أي تحليل.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-1">🔹 <strong>نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>df.info()</code> أول شيء بعد قراءة الملف.</li>
<li>✅ استخدم <code>df.isnull().sum()</code> لتقييم جودة البيانات.</li>
<li>✅ لا تثق في <code>describe()</code> وحده — فاحص الأعمدة النصية يدويًا.</li>
<li>✅ إذا كان عمود رقمي يُعرض كـ <code>object</code>، فافحصه بـ <code>pd.to_numeric()</code>.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-1">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>info()</code> و <code>describe()</code>؟</li>
<li>كيف تعرف إذا كان عمود يحتوي على قيم مفقودة؟</li>
<li>لماذا لا يُعرض العمود النصي في <code>describe()</code> افتراضيًا؟</li>
<li>ما معنى <code>Non-Null Count</code> في <code>info()</code>؟</li>
<li>كيف تُظهر الإحصاءات للأعمدة النصية؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-1">🔹 <strong>مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>الدالة</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>df.info()</code></td>
<td>معلومات شاملة عن الجدول</td>
</tr>
<tr class="even">
<td><code>df.dtypes</code></td>
<td>أنواع البيانات لكل عمود</td>
</tr>
<tr class="odd">
<td><code>df.describe()</code></td>
<td>إحصائيات للأعمدة الرقمية (ويمكن تضمين النصية)</td>
</tr>
<tr class="even">
<td><code>df.isnull()</code></td>
<td>كشف القيم المفقودة</td>
</tr>
<tr class="odd">
<td><code>df.isnull().sum()</code></td>
<td>عدد القيم المفقودة لكل عمود</td>
</tr>
</tbody>
</table>
<h1 id="الدرس-4-الوصول-إلى-الأعمدة-والصفوف-باستخدام-loc-و-iloc-1">📘 <strong>الدرس 4 : الوصول إلى الأعمدة والصفوف باستخدام <code>loc</code> و <code>iloc</code></strong></h1>
<h2 id="مقدمة-لماذا-نحتاج-إلى-loc-و-iloc">🔹 <strong>مقدمة: لماذا نحتاج إلى <code>loc</code> و <code>iloc</code>؟</strong></h2>
<p>حتى الآن، تعلمت كيف: - تُنشئ DataFrame - تقرأ بيانات من ملفات - تفحص جودتها</p>
<p>لكن ماذا لو أردت: - استخراج <strong>اسم الموظف الثالث</strong>؟ - عرض <strong>السعر والكمية فقط</strong> لمنتج معين؟ - تعديل <strong>درجة طالب معين</strong>؟</p>
<p>هنا تأتي أهمية <strong>الوصول الدقيق إلى البيانات</strong>.</p>
<p>في Python، نستخدم الفهارس مثل <code>list[0]</code>، لكن في Pandas، لدينا أدوات أكثر ذكاءً: - <code>loc</code>: للوصول بالـ <strong>أسماء (العلامات)</strong> - <code>iloc</code>: للوصول بالـ <strong>الأرقام (الفهارس العددية)</strong></p>
<blockquote>
<p>💡 اعتبر أن <code>loc</code> مثل “البحث باسم”، و <code>iloc</code> مثل “البحث برقم التسلسل”.</p>
</blockquote>
<hr />
<h2 id="الوصول-إلى-عمود-واحد-أو-أكثر">🔹 <strong>1. الوصول إلى عمود واحد أو أكثر</strong></h2>
<h3 id="الطريقة-1-باستخدام-الأقواس-المربعة">✅ الطريقة 1: باستخدام الأقواس المربعة</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true"></a>data <span class="op">=</span> {</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true"></a>    <span class="st">&#39;الاسم&#39;</span>: [<span class="st">&#39;أحمد&#39;</span>, <span class="st">&#39;سارة&#39;</span>, <span class="st">&#39;علي&#39;</span>],</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true"></a>    <span class="st">&#39;العمر&#39;</span>: [<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">22</span>],</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true"></a>    <span class="st">&#39;المدينة&#39;</span>: [<span class="st">&#39;الرياض&#39;</span>, <span class="st">&#39;جدة&#39;</span>, <span class="st">&#39;الدمام&#39;</span>],</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true"></a>    <span class="st">&#39;الراتب&#39;</span>: [<span class="dv">5000</span>, <span class="dv">7000</span>, <span class="dv">4000</span>]</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true"></a>}</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true"></a><span class="co"># الوصول إلى عمود واحد</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true"></a><span class="bu">print</span>(df[<span class="st">&#39;الاسم&#39;</span>])</span></code></pre></div>
<h4 id="الناتج-series">🔍 الناتج (Series):</h4>
<pre><code>0    أحمد
1    سارة
2     علي
Name: الاسم, dtype: object</code></pre>
<blockquote>
<p>⚠️ ملاحظة: الناتج هو <code>Series</code> (عمود واحد)، وليس <code>DataFrame</code>.</p>
</blockquote>
<h3 id="الطريقة-2-لاسترجاع-عمود-كـ-dataframe">✅ الطريقة 2: لاسترجاع عمود كـ DataFrame</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true"></a><span class="bu">print</span>(df[[<span class="st">&#39;الاسم&#39;</span>]])</span></code></pre></div>
<h4 id="الناتج-dataframe">🔍 الناتج (DataFrame):</h4>
<pre><code>   الاسم
0   أحمد
1   سارة
2   علي</code></pre>
<blockquote>
<p>✅ الفرق: استخدام <strong>قوسين مربعين</strong> يجعل الناتج DataFrame.</p>
</blockquote>
<hr />
<h2 id="df.loc-الوصول-بالاسم-العلامة---label">🔹 <strong>2. <code>df.loc[]</code> — الوصول بالاسم (العلامة - label)</strong></h2>
<h3 id="الصيغة">✅ الصيغة:</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true"></a>df.loc[الصفوف, الأعمدة]</span></code></pre></div>
<h3 id="المثال-1-صف-واحد-عمود-واحد">📌 المثال 1: صف واحد، عمود واحد</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true"></a><span class="bu">print</span>(df.loc[<span class="dv">0</span>, <span class="st">&#39;الاسم&#39;</span>])  <span class="co"># أحمد</span></span></code></pre></div>
<hr />
<h3 id="المثال-2-نطاق-من-الصفوف-وأعمدة-محددة">📌 المثال 2: نطاق من الصفوف، وأعمدة محددة</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true"></a>result <span class="op">=</span> df.loc[<span class="dv">0</span>:<span class="dv">1</span>, [<span class="st">&#39;الاسم&#39;</span>, <span class="st">&#39;العمر&#39;</span>]]</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true"></a><span class="bu">print</span>(result)</span></code></pre></div>
<h4 id="الناتج-13">🔍 الناتج:</h4>
<pre><code>  الاسم  العمر
0   أحمد     25
1   سارة     30</code></pre>
<blockquote>
<p>✅ <code>loc</code> <strong>يشمل الحد الأخير</strong> (0:1 تعني الصف 0 و1 معًا).</p>
</blockquote>
<hr />
<h3 id="المثال-3-جميع-الصفوف-عمود-معين">📌 المثال 3: جميع الصفوف، عمود معين</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true"></a><span class="bu">print</span>(df.loc[:, <span class="st">&#39;الراتب&#39;</span>])</span></code></pre></div>
<blockquote>
<p>✅ <code>:</code> تعني “كل الصفوف” أو “كل الأعمدة”.</p>
</blockquote>
<hr />
<h3 id="المثال-4-شرط-ديناميكي-مزيج-من-الفلترة-والوصول">📌 المثال 4: شرط ديناميكي (مزيج من الفلترة والوصول)</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true"></a><span class="co"># أسماء الموظفين الذين رواتبهم أعلى من 5000</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true"></a>high_earners <span class="op">=</span> df.loc[df[<span class="st">&#39;الراتب&#39;</span>] <span class="op">&gt;</span> <span class="dv">5000</span>, <span class="st">&#39;الاسم&#39;</span>]</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true"></a><span class="bu">print</span>(high_earners)</span></code></pre></div>
<h4 id="الناتج-14">🔍 الناتج:</h4>
<pre><code>1    سارة
Name: الاسم, dtype: object</code></pre>
<blockquote>
<p>✅ هذا مزيج قوي: فلترة + استخراج عمود.</p>
</blockquote>
<hr />
<h2 id="df.iloc-الوصول-بالرقم-الفهرس-العددي---index">🔹 <strong>3. <code>df.iloc[]</code> — الوصول بالرقم (الفهرس العددي - index)</strong></h2>
<h3 id="الصيغة-1">✅ الصيغة:</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true"></a>df.iloc[الصفوف (برقم), الأعمدة (برقم)]</span></code></pre></div>
<h3 id="المثال-1-أول-صف-أول-عمود">📌 المثال 1: أول صف، أول عمود</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true"></a><span class="bu">print</span>(df.iloc[<span class="dv">0</span>, <span class="dv">0</span>])  <span class="co"># أحمد</span></span></code></pre></div>
<hr />
<h3 id="المثال-2-أول-صفوفين-أول-عمودين">📌 المثال 2: أول صفوفين، أول عمودين</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true"></a>result <span class="op">=</span> df.iloc[<span class="dv">0</span>:<span class="dv">2</span>, <span class="dv">0</span>:<span class="dv">2</span>]</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true"></a><span class="bu">print</span>(result)</span></code></pre></div>
<h4 id="الناتج-15">🔍 الناتج:</h4>
<pre><code>  الاسم  العمر
0   أحمد     25
1   سارة     30</code></pre>
<blockquote>
<p>⚠️ <code>iloc</code> <strong>لا يشمل الحد الأخير</strong> (0:2 تعني الصف 0 و1 فقط).</p>
</blockquote>
<hr />
<h3 id="المثال-3-آخر-صف-جميع-الأعمدة">📌 المثال 3: آخر صف، جميع الأعمدة</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true"></a><span class="bu">print</span>(df.iloc[<span class="op">-</span><span class="dv">1</span>, :])</span></code></pre></div>
<h4 id="الناتج-16">🔍 الناتج:</h4>
<pre><code>الاسم       علي
العمر        22
المدينة    الدمام
الراتب      4000
Name: 2, dtype: object</code></pre>
<hr />
<h3 id="المثال-4-أعمدة-محددة-برقم">📌 المثال 4: أعمدة محددة برقم</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true"></a><span class="co"># العودة إلى الأعمدة 1 و3 (العمر والراتب)</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true"></a><span class="bu">print</span>(df.iloc[:, [<span class="dv">1</span>, <span class="dv">3</span>]])</span></code></pre></div>
<h4 id="الناتج-17">🔍 الناتج:</h4>
<pre><code>   العمر  الراتب
0     25   5000
1     30   7000
2     22   4000</code></pre>
<hr />
<h2 id="مقارنة-بين-loc-و-iloc">🔹 <strong>مقارنة بين <code>loc</code> و <code>iloc</code></strong></h2>
<table>
<thead>
<tr class="header">
<th>الميزة</th>
<th><code>loc</code></th>
<th><code>iloc</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>الأساس</td>
<td>الاسم (العلامة)</td>
<td>الرقم (الفهرس)</td>
</tr>
<tr class="even">
<td>يشمل الحد الأخير؟</td>
<td>نعم</td>
<td>لا</td>
</tr>
<tr class="odd">
<td>يمكنه استخدام شروط؟</td>
<td>نعم (مثلاً <code>df['الراتب']&gt;5000</code>)</td>
<td>لا، فقط أرقام</td>
</tr>
<tr class="even">
<td>مثال</td>
<td><code>df.loc[0:2, 'الاسم':'العمر']</code></td>
<td><code>df.iloc[0:2, 0:2]</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>💡 تذكر:<br />
- <strong><code>loc</code> → label-based</strong><br />
- <strong><code>iloc</code> → integer-based</strong></p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-تحليل-معمق-2">🔹 <strong>الأخطاء الشائعة (تحليل معمق)</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>KeyError</code></td>
<td>اسم عمود غير موجود</td>
<td>تحقق من <code>df.columns</code></td>
</tr>
<tr class="even">
<td><code>IndexError</code></td>
<td>رقم صف/عمود خارج النطاق</td>
<td>تحقق من <code>df.shape</code></td>
</tr>
<tr class="odd">
<td><code>df.loc[0]</code> يُرجع Series</td>
<td>نعم، هذا السلوك الطبيعي</td>
<td>استخدم <code>df.loc[[0]]</code> للحصول على DataFrame</td>
</tr>
<tr class="even">
<td><code>df.loc['0']</code> لا يعمل</td>
<td>لأن الفهرس رقم، وليس نص</td>
<td>استخدم <code>iloc</code> أو تأكد من نوع الفهرس</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-2">🔹 <strong>تمارين تطبيقية</strong></h2>
<h3 id="التمرين-1-استخراج-البيانات">✅ التمرين 1: استخراج البيانات</h3>
<p>استخدم <code>iloc</code> لاستخراج: - الصف الثاني فقط - العمود الثالث (المدينة)</p>
<h3 id="التمرين-2-استخدام-loc-مع-شرط">✅ التمرين 2: استخدام <code>loc</code> مع شرط</h3>
<p>استخدم <code>loc</code> لعرض: - أسماء ورواتب الموظفين الذين أعمارهم أقل من 28</p>
<h3 id="التمرين-3-خطأ-شائع">✅ التمرين 3: خطأ شائع</h3>
<p>لماذا هذا الكود يعطي <code>KeyError</code>؟</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true"></a>df.loc[<span class="dv">0</span>, <span class="st">&#39;الإسم&#39;</span>]  <span class="co"># ملاحظة: همزة على الاسم</span></span></code></pre></div>
<h3 id="التمرين-4-دمج-loc-و-iloc">✅ التمرين 4: دمج <code>loc</code> و <code>iloc</code></h3>
<p>هل يمكن دمج <code>loc</code> و <code>iloc</code> في نفس العملية؟ لماذا؟</p>
<hr />
<h2 id="الربط-بالواقع-تحليل-مبيعات-متجر-إلكتروني">🔹 <strong>الربط بالواقع: تحليل مبيعات متجر إلكتروني</strong></h2>
<h3 id="الهدف-استخراج-معلومات-دقيقة-عن-المبيعات">🎯 الهدف: استخراج معلومات دقيقة عن المبيعات</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true"></a>sales <span class="op">=</span> pd.DataFrame({</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true"></a>    <span class="st">&#39;التاريخ&#39;</span>: [<span class="st">&#39;2023-01-01&#39;</span>, <span class="st">&#39;2023-01-01&#39;</span>, <span class="st">&#39;2023-01-02&#39;</span>],</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;تفاح&#39;</span>, <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;حليب&#39;</span>],</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true"></a>    <span class="st">&#39;السعر&#39;</span>: [<span class="fl">3.5</span>, <span class="fl">2.0</span>, <span class="fl">8.0</span>],</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true"></a>    <span class="st">&#39;الكمية&#39;</span>: [<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">5</span>],</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true"></a>    <span class="st">&#39;الفئة&#39;</span>: [<span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;ألبان&#39;</span>]</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true"></a>})</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true"></a><span class="co"># 1. أول عملية بيع (كـ سطر كامل)</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true"></a>first_sale <span class="op">=</span> sales.iloc[<span class="dv">0</span>, :]</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;أول عملية بيع:</span><span class="ch">\n</span><span class="st">&quot;</span>, first_sale)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true"></a><span class="co"># 2. المنتجات والأسعار فقط للصفوف من 0 إلى 1</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true"></a>products_prices <span class="op">=</span> sales.loc[<span class="dv">0</span>:<span class="dv">1</span>, [<span class="st">&#39;المنتج&#39;</span>, <span class="st">&#39;السعر&#39;</span>]]</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">المنتجات والأسعار:</span><span class="ch">\n</span><span class="st">&quot;</span>, products_prices)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true"></a><span class="co"># 3. كل المبيعات في فئة &quot;فواكه&quot;</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true"></a>fruits_sales <span class="op">=</span> sales.loc[sales[<span class="st">&#39;الفئة&#39;</span>] <span class="op">==</span> <span class="st">&#39;فواكه&#39;</span>, [<span class="st">&#39;المنتج&#39;</span>, <span class="st">&#39;الكمية&#39;</span>]]</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">مبيعات الفواكه:</span><span class="ch">\n</span><span class="st">&quot;</span>, fruits_sales)</span></code></pre></div>
<blockquote>
<p>✅ هذا النوع من الاستعلامات هو أساس تقارير الأعمال.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-2">🔹 <strong>نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>loc</code> عندما تعرف أسماء الأعمدة.</li>
<li>✅ استخدم <code>iloc</code> عندما تعمل برقم التسلسل (مثلاً: أول 5 صفوف).</li>
<li>✅ لا تخلط بين <code>df['العمود']</code> و <code>df[['العمود']]</code> — الأول يُرجع Series، الثاني DataFrame.</li>
<li>✅ استخدم <code>df.columns.tolist()</code> لرؤية أسماء الأعمدة بدقة.</li>
<li>✅ تجنب <code>df[0]</code> — لا يعمل إلا إذا كان الفهرس نصيًا.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-2">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>df['الاسم']</code> و <code>df[['الاسم']]</code>؟</li>
<li>لماذا <code>iloc[0:2]</code> يُرجع صفين فقط، بينما <code>loc[0:2]</code> يُرجع ثلاثة؟</li>
<li>كيف تُرجع آخر 3 صفوف باستخدام <code>iloc</code>؟</li>
<li>ما نوع البيانات الذي يُرجعه <code>loc</code> عندما تختار صفًا واحدًا؟</li>
<li>متى نستخدم <code>:</code> في <code>loc</code> أو <code>iloc</code>؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-2">🔹 <strong>مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>الأداة</th>
<th>الاستخدام</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>df['العمود']</code></td>
<td>عمود واحد كـ Series</td>
</tr>
<tr class="even">
<td><code>df[['العمود']]</code></td>
<td>عمود واحد كـ DataFrame</td>
</tr>
<tr class="odd">
<td><code>df.loc[แถว, عمود]</code></td>
<td>بالاسم</td>
</tr>
<tr class="even">
<td><code>df.iloc[رقم, رقم]</code></td>
<td>بالرقم</td>
</tr>
<tr class="odd">
<td><code>:</code></td>
<td>جميع الصفوف أو جميع الأعمدة</td>
</tr>
<tr class="even">
<td>شرط داخل <code>loc</code></td>
<td>دمج الفلترة مع الاستخراج</td>
</tr>
</tbody>
</table>
<h1 id="الدرس-5-الفلترة-الشرطية-باستخدام-و-و-isin-و-between-1">📘 <strong>الدرس 5 : الفلترة الشرطية باستخدام <code>&amp;</code> و <code>|</code> و <code>isin()</code> و <code>between()</code></strong></h1>
<h2 id="مقدمة-لماذا-الفلترة-مهمة">🔹 <strong>مقدمة: لماذا الفلترة مهمة؟</strong></h2>
<p>تخيل أنك مدير مبيعات، وتحصل على جدول يحتوي على 10,000 صف من عمليات البيع.<br />
لكنك ترغب فقط في معرفة:</p>
<ul>
<li>ما هي المبيعات التي <strong>تجاوز سعرها 100 ريال</strong>؟</li>
<li>ما هي المنتجات من نوع <strong>“إلكترونيات” أو “أجهزة منزلية”</strong>؟</li>
<li>ما هي المبيعات التي حدثت بين <strong>يناير ومارس</strong>؟</li>
</ul>
<p>هنا تأتي أهمية <strong>الفلترة الشرطية</strong>.</p>
<p>الفلترة هي عملية <strong>استخراج جزء من البيانات يطابق شرطًا معينًا</strong>، وهي واحدة من أكثر العمليات استخدامًا في تحليل البيانات.</p>
<hr />
<h2 id="الفلترة-الأساسية-باستخدام-الشروط-المنطقية">🔹 <strong>1. الفلترة الأساسية باستخدام الشروط المنطقية</strong></h2>
<h3 id="الطريقة-استخدام-الأقواس-مع-شرط">✅ الطريقة: استخدام الأقواس <code>[]</code> مع شرط</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true"></a>data <span class="op">=</span> {</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;تفاح&#39;</span>, <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;لابتوب&#39;</span>, <span class="st">&#39;سماعة&#39;</span>, <span class="st">&#39;حليب&#39;</span>],</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true"></a>    <span class="st">&#39;السعر&#39;</span>: [<span class="fl">3.5</span>, <span class="fl">2.0</span>, <span class="dv">2500</span>, <span class="dv">150</span>, <span class="fl">8.0</span>],</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true"></a>    <span class="st">&#39;الفئة&#39;</span>: [<span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;إلكترونيات&#39;</span>, <span class="st">&#39;إلكترونيات&#39;</span>, <span class="st">&#39;ألبان&#39;</span>],</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true"></a>    <span class="st">&#39;الكمية&#39;</span>: [<span class="dv">50</span>, <span class="dv">30</span>, <span class="dv">5</span>, <span class="dv">20</span>, <span class="dv">40</span>]</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true"></a>}</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true"></a><span class="co"># المبيعات التي السعر فيها أكبر من 100</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true"></a>expensive <span class="op">=</span> df[df[<span class="st">&#39;السعر&#39;</span>] <span class="op">&gt;</span> <span class="dv">100</span>]</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true"></a><span class="bu">print</span>(expensive)</span></code></pre></div>
<h4 id="الناتج-18">🔍 الناتج:</h4>
<pre><code>   المنتج    السعر       الفئة  الكمية
2   لابتوب  2500.0  إلكترونيات      5
3  سماعة   150.0  إلكترونيات     20</code></pre>
<blockquote>
<p>✅ فقط الصفوف التي تحقق الشرط تم عرضها.</p>
</blockquote>
<hr />
<h2 id="الشروط-المتعددة-و-و-أو">🔹 <strong>2. الشروط المتعددة: <code>&amp;</code> (و) و <code>|</code> (أو)</strong></h2>
<h3 id="القاعدة-الذهبية">✅ القاعدة الذهبية:</h3>
<ul>
<li>استخدم <code>&amp;</code> بدل <code>and</code></li>
<li>استخدم <code>|</code> بدل <code>or</code></li>
<li><strong>ضع كل شرط بين قوسين</strong></li>
</ul>
<h3 id="المثال-1-استخدام-and">📌 المثال 1: استخدام <code>&amp;</code> (AND)</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true"></a><span class="co"># منتجات في فئة &quot;إلكترونيات&quot; وسعرها أكثر من 200</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true"></a>electronics_high <span class="op">=</span> df[(df[<span class="st">&#39;الفئة&#39;</span>] <span class="op">==</span> <span class="st">&#39;إلكترونيات&#39;</span>) <span class="op">&amp;</span> (df[<span class="st">&#39;السعر&#39;</span>] <span class="op">&gt;</span> <span class="dv">200</span>)]</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true"></a><span class="bu">print</span>(electronics_high)</span></code></pre></div>
<h4 id="الناتج-19">🔍 الناتج:</h4>
<pre><code>  المنتج    السعر       الفئة  الكمية
2  لابتوب  2500.0  إلكترونيات      5</code></pre>
<blockquote>
<p>⚠️ بدون الأقواس: خطأ منطقي أو <code>TypeError</code>.</p>
</blockquote>
<hr />
<h3 id="المثال-2-استخدام-or">📌 المثال 2: استخدام <code>|</code> (OR)</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true"></a><span class="co"># منتجات إما &quot;فواكه&quot; أو سعرها أقل من 10</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true"></a>fruits_or_cheap <span class="op">=</span> df[(df[<span class="st">&#39;الفئة&#39;</span>] <span class="op">==</span> <span class="st">&#39;فواكه&#39;</span>) <span class="op">|</span> (df[<span class="st">&#39;السعر&#39;</span>] <span class="op">&lt;</span> <span class="dv">10</span>)]</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true"></a><span class="bu">print</span>(fruits_or_cheap)</span></code></pre></div>
<h4 id="الناتج-20">🔍 الناتج:</h4>
<pre><code>  المنتج  السعر  الفئة  الكمية
0   تفاح    3.5  فواكه     50
1   موز    2.0  فواكه     30
4  حليب    8.0   ألبان     40</code></pre>
<blockquote>
<p>✅ تم تضمين “حليب” لأنه رخيص، رغم أنه ليس فاكهة.</p>
</blockquote>
<hr />
<h3 id="المثال-3-استخدام-not">📌 المثال 3: استخدام <code>~</code> (NOT)</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true"></a><span class="co"># كل المنتجات ما عدا الفواكه</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true"></a>not_fruits <span class="op">=</span> df[<span class="op">~</span>(df[<span class="st">&#39;الفئة&#39;</span>] <span class="op">==</span> <span class="st">&#39;فواكه&#39;</span>)]</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true"></a><span class="bu">print</span>(not_fruits)</span></code></pre></div>
<h4 id="الناتج-21">🔍 الناتج:</h4>
<pre><code>   المنتج    السعر       الفئة  الكمية
2   لابتوب  2500.0  إلكترونيات      5
3  سماعة   150.0  إلكترونيات     20
4   حليب     8.0      ألبان     40</code></pre>
<blockquote>
<p>✅ <code>~</code> تعني “عكس الشرط”.</p>
</blockquote>
<hr />
<h2 id="isin-التحقق-من-وجود-القيمة-في-قائمة">🔹 <strong>3. <code>isin()</code> — التحقق من وجود القيمة في قائمة</strong></h2>
<p>مفيد جدًا عندما تريد تصفية حسب <strong>قائمة من القيم</strong>.</p>
<h3 id="المثال-4-استخدام-isin">📌 المثال 4: استخدام <code>isin()</code></h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true"></a><span class="co"># المنتجات التي اسمها &quot;تفاح&quot; أو &quot;موز&quot; أو &quot;حليب&quot;</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true"></a>selected <span class="op">=</span> df[df[<span class="st">&#39;المنتج&#39;</span>].isin([<span class="st">&#39;تفاح&#39;</span>, <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;حليب&#39;</span>])]</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true"></a><span class="bu">print</span>(selected)</span></code></pre></div>
<h4 id="الناتج-22">🔍 الناتج:</h4>
<pre><code>  المنتج  السعر  الفئة  الكمية
0   تفاح    3.5  فواكه     50
1   موز    2.0  فواكه     30
4  حليب    8.0   ألبان     40</code></pre>
<blockquote>
<p>✅ بديل أسرع من كتابة <code>==</code> متعددة.</p>
</blockquote>
<hr />
<h2 id="between-التحقق-من-النطاق-شامل-للنهايات">🔹 <strong>4. <code>between()</code> — التحقق من النطاق (شامل للنهايات)</strong></h2>
<p>مفيد للأسعار، التواريخ، الأعمار…</p>
<h3 id="المثال-5-استخدام-between">📌 المثال 5: استخدام <code>between()</code></h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true"></a><span class="co"># المنتجات التي سعرها بين 5 و200</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true"></a>mid_price <span class="op">=</span> df[df[<span class="st">&#39;السعر&#39;</span>].between(<span class="dv">5</span>, <span class="dv">200</span>)]</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true"></a><span class="bu">print</span>(mid_price)</span></code></pre></div>
<h4 id="الناتج-23">🔍 الناتج:</h4>
<pre><code>  المنتج  السعر       الفئة  الكمية
3  سماعة  150.0  إلكترونيات     20
4   حليب    8.0       ألبان     40</code></pre>
<blockquote>
<p>✅ <code>between()</code> يشمل القيم 5 و200.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-تحليل-معمق-3">🔹 <strong>5. الأخطاء الشائعة (تحليل معمق)</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>TypeError: cannot compare</code></td>
<td>نوع البيانات خاطئ (نص بدل رقم)</td>
<td>تأكد من <code>df.dtypes</code></td>
</tr>
<tr class="even">
<td><code>ValueError: The truth value of a Series is ambiguous</code></td>
<td>نسيان الأقواس حول الشروط</td>
<td>استخدم <code>(condition1) &amp; (condition2)</code></td>
</tr>
<tr class="odd">
<td><code>KeyError</code></td>
<td>اسم عمود غير موجود</td>
<td>تحقق من <code>df.columns</code></td>
</tr>
<tr class="even">
<td><code>isin()</code> لا يُرجع نتائج</td>
<td>القيم لا تطابق تمامًا (مثلاً: فراغات)</td>
<td>نظّف البيانات أولًا</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-3">🔹 <strong>تمارين تطبيقية</strong></h2>
<h3 id="التمرين-1-فلترة-مزدوجة">✅ التمرين 1: فلترة مزدوجة</h3>
<p>أوجد المنتجات التي: - الفئة: “إلكترونيات” - الكمية: أقل من 10</p>
<h3 id="التمرين-2-استخدام-isin-مع-أرقام">✅ التمرين 2: استخدام <code>isin()</code> مع أرقام</h3>
<p>استخدم <code>isin()</code> لعرض المنتجات التي كميتها 5 أو 20 أو 40.</p>
<h3 id="التمرين-3-خطأ-شائع-1">✅ التمرين 3: خطأ شائع</h3>
<p>لماذا هذا الكود لا يعمل؟</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true"></a>df[df[<span class="st">&#39;السعر&#39;</span>] <span class="op">&gt;</span> <span class="dv">100</span> <span class="kw">and</span> df[<span class="st">&#39;الفئة&#39;</span>] <span class="op">==</span> <span class="st">&#39;إلكترونيات&#39;</span>]</span></code></pre></div>
<h3 id="التمرين-4-نطاق-تواريخ-مقدمة">✅ التمرين 4: نطاق تواريخ (مقدمة)</h3>
<p>افترض أن لديك عمود تواريخ، كيف تُرجع الصفوف بين 2023-01-01 و2023-01-31؟ (سنشرح التواريخ لاحقًا)</p>
<hr />
<h2 id="الربط-بالواقع-تحليل-مبيعات-متجر-إلكتروني-1">🔹 <strong>الربط بالواقع: تحليل مبيعات متجر إلكتروني</strong></h2>
<h3 id="الهدف-تحديد-المنتجات-المستهدفة">🎯 الهدف: تحديد المنتجات المستهدفة</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true"></a><span class="co"># 1. المنتجات المربحة (سعر &gt; 1000)</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true"></a>profitable <span class="op">=</span> df[df[<span class="st">&#39;السعر&#39;</span>] <span class="op">&gt;</span> <span class="dv">1000</span>]</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;المنتجات المربحة:</span><span class="ch">\n</span><span class="st">&quot;</span>, profitable)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true"></a><span class="co"># 2. المنتجات الشائعة (كمية &gt; 30)</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true"></a>popular <span class="op">=</span> df[df[<span class="st">&#39;الكمية&#39;</span>] <span class="op">&gt;</span> <span class="dv">30</span>]</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">المنتجات الشائعة:</span><span class="ch">\n</span><span class="st">&quot;</span>, popular)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true"></a><span class="co"># 3. المنتجات في فئات معينة</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true"></a>target_categories <span class="op">=</span> df[df[<span class="st">&#39;الفئة&#39;</span>].isin([<span class="st">&#39;إلكترونيات&#39;</span>, <span class="st">&#39;فواكه&#39;</span>])]</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">الفئات المستهدفة:</span><span class="ch">\n</span><span class="st">&quot;</span>, target_categories)</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true"></a></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true"></a><span class="co"># 4. منتجات بسعر متوسط (بين 10 و500)</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true"></a>mid_range <span class="op">=</span> df[df[<span class="st">&#39;السعر&#39;</span>].between(<span class="dv">10</span>, <span class="dv">500</span>)]</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">السعر المتوسط:</span><span class="ch">\n</span><span class="st">&quot;</span>, mid_range)</span></code></pre></div>
<blockquote>
<p>✅ هذه الفلاتر تُستخدم في تقارير المبيعات، تحديد الحملات التسويقية، وإدارة المخزون.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-3">🔹 <strong>نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>()</code> حول كل شرط عند استخدام <code>&amp;</code> أو <code>|</code>.</li>
<li>✅ تجنب <code>and</code> و <code>or</code> — فهي لا تعمل مع Series.</li>
<li>✅ استخدم <code>isin()</code> بدل سلسلة من <code>==</code> مع <code>|</code>.</li>
<li>✅ تحقق من أنواع البيانات قبل الفلترة (خاصة السعر والعمر).</li>
<li>✅ استخدم <code>reset_index(drop=True)</code> بعد الفلترة إذا أردت فهرسًا جديدًا.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-3">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>&amp;</code> و <code>and</code> في Pandas؟</li>
<li>لماذا يجب وضع الأقواس حول الشروط عند استخدام <code>&amp;</code>؟</li>
<li>ماذا يفعل <code>~</code> في الفلترة؟</li>
<li>كيف تُرجع الصفوف التي لا تطابق شرطًا معينًا؟</li>
<li>ما الفرق بين <code>between(5, 10)</code> و <code>(df['x'] &gt;= 5) &amp; (df['x'] &lt;= 10)</code>؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-3">🔹 <strong>مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>الدالة</th>
<th>الاستخدام</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>df[condition]</code></td>
<td>الفلترة الأساسية</td>
</tr>
<tr class="even">
<td><code>&amp;</code></td>
<td>AND (مع أقواس)</td>
</tr>
<tr class="odd">
<td><code>|</code></td>
<td>OR (مع أقواس)</td>
</tr>
<tr class="even">
<td><code>~</code></td>
<td>NOT</td>
</tr>
<tr class="odd">
<td><code>.isin(list)</code></td>
<td>التحقق من وجود في قائمة</td>
</tr>
<tr class="even">
<td><code>.between(a, b)</code></td>
<td>التحقق من النطاق (شامل)</td>
</tr>
</tbody>
</table>
<h1 id="الدرس-6-التعديل-داخل-dataframe-إنشاء-أعمدة-جديدة-التعديل-على-قيم-موجودة-حذف-أعمدة-وصفوف-إعادة-التسمية">📘 <strong>الدرس 6 : التعديل داخل DataFrame: إنشاء أعمدة جديدة، التعديل على قيم موجودة، حذف أعمدة وصفوف، إعادة التسمية</strong></h1>
<h2 id="مقدمة-لماذا-نحتاج-إلى-التعديل">🔹 <strong>مقدمة: لماذا نحتاج إلى التعديل؟</strong></h2>
<p>حتى الآن، تعلمت كيف: - تُنشئ DataFrame - تقرأ البيانات - تفحصها - تستخرج جزءًا منها بالفلترة</p>
<p>لكن في الواقع، <strong>نادرًا ما تكون البيانات جاهزة تمامًا</strong>.<br />
غالبًا ما نحتاج إلى: - إضافة عمود جديد (مثل: “الإجمالي = السعر × الكمية”) - تعديل قيمة خاطئة - حذف عمود غير مفيد - تغيير اسم عمود ليكون أكثر وضوحًا</p>
<p>هذا هو هدف هذا الدرس: <strong>تحويل البيانات إلى شكل تحليلي مفيد</strong>.</p>
<hr />
<h2 id="إنشاء-عمود-جديد">🔹 <strong>1. إنشاء عمود جديد</strong></h2>
<h3 id="الطريقة-1-مباشرة-بالاسم">✅ الطريقة 1: مباشرة بالاسم</h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true"></a>data <span class="op">=</span> {</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;تفاح&#39;</span>, <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;لابتوب&#39;</span>],</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true"></a>    <span class="st">&#39;السعر&#39;</span>: [<span class="fl">3.5</span>, <span class="fl">2.0</span>, <span class="dv">2500</span>],</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true"></a>    <span class="st">&#39;الكمية&#39;</span>: [<span class="dv">50</span>, <span class="dv">30</span>, <span class="dv">5</span>]</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true"></a>}</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true"></a><span class="co"># إنشاء عمود &quot;الإجمالي&quot;</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true"></a>df[<span class="st">&#39;الإجمالي&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>] <span class="op">*</span> df[<span class="st">&#39;الكمية&#39;</span>]</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true"></a><span class="bu">print</span>(df)</span></code></pre></div>
<h4 id="الناتج-24">🔍 الناتج:</h4>
<pre><code>  المنتج  السعر  الكمية  الإجمالي
0   تفاح    3.5     50    175.0
1   موز    2.0     30     60.0
2  لابتوب  2500     5  12500.0</code></pre>
<blockquote>
<p>✅ تم إنشاء العمود الجديد تلقائيًا.</p>
</blockquote>
<hr />
<h3 id="الطريقة-2-باستخدام-assign-غير-مدمر---لا-يعدل-الأصل">✅ الطريقة 2: باستخدام <code>assign()</code> (غير مدمر - لا يُعدّل الأصل)</h3>
<p>مفيد في الأنابيب (pipelines).</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true"></a>df_new <span class="op">=</span> df.assign(ضريبة <span class="op">=</span> df[<span class="st">&#39;الإجمالي&#39;</span>] <span class="op">*</span> <span class="fl">0.15</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true"></a><span class="bu">print</span>(df_new)</span></code></pre></div>
<h4 id="الناتج-25">🔍 الناتج:</h4>
<pre><code>  المنتج  السعر  الكمية  الإجمالي   ضريبة
0   تفاح    3.5     50    175.0   26.25
1   موز    2.0     30     60.0    9.00
2  لابتوب  2500     5  12500.0 1875.00</code></pre>
<blockquote>
<p>✅ <code>assign()</code> يُعيد نسخة جديدة، ولا يُعدّل الأصل.</p>
</blockquote>
<hr />
<h2 id="التعديل-على-قيم-موجودة">🔹 <strong>2. التعديل على قيم موجودة</strong></h2>
<h3 id="الطريقة-1-بالوصول-المباشر">✅ الطريقة 1: بالوصول المباشر</h3>
<div class="sourceCode" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true"></a><span class="co"># تصحيح سعر الموز</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true"></a>df.loc[<span class="dv">1</span>, <span class="st">&#39;السعر&#39;</span>] <span class="op">=</span> <span class="fl">2.5</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true"></a><span class="bu">print</span>(df)</span></code></pre></div>
<h4 id="الناتج-26">🔍 الناتج:</h4>
<pre><code>  المنتج  السعر  الكمية  الإجمالي
0   تفاح    3.5     50    175.0
1   موز    2.5     30     75.0  ← تغير
2  لابتوب  2500     5  12500.0</code></pre>
<blockquote>
<p>✅ تم تعديل القيمة بنجاح.</p>
</blockquote>
<hr />
<h3 id="الطريقة-2-بالشرط-مثلا-رفع-السعر-10-على-المنتجات-الرخيصة">✅ الطريقة 2: بالشرط (مثلاً: رفع السعر 10% على المنتجات الرخيصة)</h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true"></a><span class="co"># رفع السعر 10% على المنتجات التي أقل من 10</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true"></a>df.loc[df[<span class="st">&#39;السعر&#39;</span>] <span class="op">&lt;</span> <span class="dv">10</span>, <span class="st">&#39;السعر&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>] <span class="op">*</span> <span class="fl">1.1</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true"></a><span class="co"># تحديث &quot;الإجمالي&quot; بعد التغيير</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true"></a>df[<span class="st">&#39;الإجمالي&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>] <span class="op">*</span> df[<span class="st">&#39;الكمية&#39;</span>]</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true"></a><span class="bu">print</span>(df)</span></code></pre></div>
<h4 id="الناتج-27">🔍 الناتج:</h4>
<pre><code>  المنتج  السعر  الكمية  الإجمالي
0   تفاح    3.85     50    192.5
1   موز    2.75     30     82.5
2  لابتوب  2500.00    5  12500.0</code></pre>
<blockquote>
<p>✅ التعديل الشرطي مفيد جدًا في التحديثات الدفعية.</p>
</blockquote>
<hr />
<h2 id="حذف-أعمدة-وصفوف">🔹 <strong>3. حذف أعمدة وصفوف</strong></h2>
<h3 id="حذف-أعمدة-باستخدام-drop">✅ حذف أعمدة باستخدام <code>drop()</code></h3>
<div class="sourceCode" id="cb84"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true"></a><span class="co"># حذف عمود &quot;الإجمالي&quot;</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">&#39;الإجمالي&#39;</span>])</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true"></a><span class="bu">print</span>(df)</span></code></pre></div>
<blockquote>
<p>✅ يمكن حذف أكثر من عمود: <code>columns=['A', 'B']</code></p>
</blockquote>
<hr />
<h3 id="حذف-صفوف-باستخدام-drop">✅ حذف صفوف باستخدام <code>drop()</code></h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true"></a><span class="co"># حذف الصف رقم 2 (اللابتوب)</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true"></a>df <span class="op">=</span> df.drop(index<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true"></a><span class="bu">print</span>(df)</span></code></pre></div>
<h4 id="الناتج-28">🔍 الناتج:</h4>
<pre><code>  المنتج  السعر  الكمية
0   تفاح    3.85     50
1   موز    2.75     30</code></pre>
<blockquote>
<p>⚠️ <code>drop()</code> لا يُعدّل الجدول الأصلي إلا إذا استخدمت <code>inplace=True</code>.</p>
</blockquote>
<hr />
<h3 id="استخدام-inplacetrue">✅ استخدام <code>inplace=True</code></h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true"></a>df.drop(columns<span class="op">=</span>[<span class="st">&#39;الكمية&#39;</span>], inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<blockquote>
<p>✅ لا يُعيد DataFrame، بل يُعدّل الأصل مباشرة.</p>
</blockquote>
<hr />
<h2 id="إعادة-تسمية-الأعمدة-باستخدام-rename">🔹 <strong>4. إعادة تسمية الأعمدة باستخدام <code>rename()</code></strong></h2>
<h3 id="الطريقة-1-بقاموس-الأفضل">✅ الطريقة 1: بقاموس (الأفضل)</h3>
<div class="sourceCode" id="cb88"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true"></a>df <span class="op">=</span> df.rename(columns<span class="op">=</span>{<span class="st">&#39;المنتج&#39;</span>: <span class="st">&#39;الصنف&#39;</span>, <span class="st">&#39;السعر&#39;</span>: <span class="st">&#39;السعر النهائي&#39;</span>})</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true"></a><span class="bu">print</span>(df)</span></code></pre></div>
<h4 id="الناتج-29">🔍 الناتج:</h4>
<pre><code>   الصنف  السعر النهائي
0    تفاح         3.85
1     موز         2.75</code></pre>
<hr />
<h3 id="الطريقة-2-إعادة-تسمية-كل-الأعمدة-دفعة-واحدة">✅ الطريقة 2: إعادة تسمية كل الأعمدة دفعة واحدة</h3>
<div class="sourceCode" id="cb90"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true"></a>df.columns <span class="op">=</span> [<span class="st">&#39;Product&#39;</span>, <span class="st">&#39;Price&#39;</span>]</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true"></a><span class="bu">print</span>(df)</span></code></pre></div>
<blockquote>
<p>⚠️ خطر إذا تغير ترتيب الأعمدة لاحقًا.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-تحليل-معمق-4">🔹 <strong>الأخطاء الشائعة (تحليل معمق)</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>SettingWithCopyWarning</code></td>
<td>تعديل على نسخة من DataFrame</td>
<td>استخدم <code>.copy()</code> أو <code>loc</code></td>
</tr>
<tr class="even">
<td><code>KeyError</code> عند الحذف</td>
<td>اسم عمود غير موجود</td>
<td>تحقق من <code>df.columns</code></td>
</tr>
<tr class="odd">
<td><code>inplace=True</code> لا يعمل مع <code>assign()</code></td>
<td>لأن <code>assign()</code> لا يدعمه</td>
<td>احفظ الناتج: <code>df = df.assign(...)</code></td>
</tr>
<tr class="even">
<td>تعديل لا يظهر</td>
<td>لأنك لم تُعدّل الأصل أو لم تُستخدم <code>inplace</code></td>
<td>تحقق من إرجاع القيمة</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-4">🔹 <strong>تمارين تطبيقية</strong></h2>
<h3 id="التمرين-1-إنشاء-عمود-جديد">✅ التمرين 1: إنشاء عمود جديد</h3>
<p>أضف عمودًا جديدًا اسمه “الضريبة” = 15% من “الإجمالي”.</p>
<h3 id="التمرين-2-تعديل-شرطي">✅ التمرين 2: تعديل شرطي</h3>
<p>ارفع السعر 20% على المنتجات التي “الإجمالي” فيها أقل من 100.</p>
<h3 id="التمرين-3-حذف-متعدد">✅ التمرين 3: حذف متعدد</h3>
<p>احذف العمودين “السعر” و“الكمية” دفعة واحدة.</p>
<h3 id="التمرين-4-إعادة-تسمية">✅ التمرين 4: إعادة تسمية</h3>
<p>غيّر أسماء جميع الأعمدة إلى إنجليزية:<br />
<code>{'المنتج': 'Product', 'السعر': 'Price', 'الكمية': 'Quantity'}</code></p>
<hr />
<h2 id="الربط-بالواقع-تحديث-بيانات-متجر-إلكتروني">🔹 <strong>الربط بالواقع: تحديث بيانات متجر إلكتروني</strong></h2>
<h3 id="الهدف-تحضير-البيانات-للتحليل-النهائي">🎯 الهدف: تحضير البيانات للتحليل النهائي</h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true"></a><span class="co"># 1. إضافة عمود &quot;الإجمالي&quot;</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true"></a>df[<span class="st">&#39;Total&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Price&#39;</span>] <span class="op">*</span> df[<span class="st">&#39;Quantity&#39;</span>]</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true"></a></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true"></a><span class="co"># 2. تصحيح سعر منتج خاطئ</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true"></a>df.loc[df[<span class="st">&#39;Product&#39;</span>] <span class="op">==</span> <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;Price&#39;</span>] <span class="op">=</span> <span class="fl">3.0</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true"></a><span class="co"># 3. حذف عمود غير مطلوب</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">&#39;Temp_Code&#39;</span>], errors<span class="op">=</span><span class="st">&#39;ignore&#39;</span>)  <span class="co"># errors=&#39;ignore&#39; يتجاهل الخطأ إذا لم يوجد</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true"></a></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true"></a><span class="co"># 4. إعادة تسمية الأعمدة لتكون موحدة</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true"></a>df <span class="op">=</span> df.rename(columns<span class="op">=</span><span class="bu">str</span>.capitalize)  <span class="co"># يجعل الحرف الأول كبيرًا</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true"></a></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true"></a><span class="co"># 5. عرض النتيجة النهائية</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;البيانات النهائية جاهزة للتحليل:</span><span class="ch">\n</span><span class="st">&quot;</span>, df)</span></code></pre></div>
<blockquote>
<p>✅ هذا النوع من المعالجة هو ما يحدث يوميًا في الشركات قبل إرسال البيانات إلى التقارير.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-4">🔹 <strong>نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>inplace=True</code> بحذر — يُعدّل الأصل ولا يمكن التراجع.</li>
<li>✅ استخدم <code>errors='ignore'</code> مع <code>drop()</code> لتجنب الأخطاء إذا كان العمود غير موجود.</li>
<li>✅ لا تستخدم <code>df['column'] = ...</code> داخل دالة بدون <code>copy()</code> — قد تُعدّل نسخة.</li>
<li>✅ استخدم <code>assign()</code> في الأنابيب: <code>df.assign(...).merge(...).groupby(...)</code>.</li>
<li>✅ تحقق من <code>df.shape</code> قبل وبعد الحذف.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-4">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>df['new_col'] = ...</code> و <code>df.assign()</code>؟</li>
<li>لماذا نستخدم <code>inplace=True</code>؟ وما مخاطره؟</li>
<li>كيف تحذف صفًا بناءً على شرط؟ (مثلاً: حذف المنتجات التي الكمية = 0)</li>
<li>ما الفرق بين <code>df.drop()</code> و <code>del df['col']</code>؟</li>
<li>كيف تُعيد تسمية جميع الأعمدة دفعة واحدة؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-4">🔹 <strong>مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>العملية</th>
<th>الطريقة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>إنشاء عمود</td>
<td><code>df['new'] = ...</code> أو <code>assign()</code></td>
</tr>
<tr class="even">
<td>تعديل قيمة</td>
<td><code>df.loc[row, col] = value</code></td>
</tr>
<tr class="odd">
<td>حذف عمود</td>
<td><code>df.drop(columns=[...])</code></td>
</tr>
<tr class="even">
<td>حذف صف</td>
<td><code>df.drop(index=[...])</code></td>
</tr>
<tr class="odd">
<td>إعادة التسمية</td>
<td><code>df.rename(columns={})</code></td>
</tr>
<tr class="even">
<td>تعديل الأصل</td>
<td>استخدم <code>inplace=True</code> أو إعادة التعيين</td>
</tr>
</tbody>
</table>
<h1 id="الدرس-7-التعامل-مع-القيم-المفقودة-dropna-و-fillna-و-isnull-1">📘 <strong>الدرس 7 : التعامل مع القيم المفقودة: <code>dropna()</code> و <code>fillna()</code> و <code>isnull()</code></strong></h1>
<h2 id="مقدمة-لماذا-القيم-المفقودة-مشكلة">🔹 <strong>مقدمة: لماذا القيم المفقودة مشكلة؟</strong></h2>
<p>تخيل أنك تحاول حساب <strong>متوسط رواتب الموظفين</strong>، لكن: - راتب “سارة” غير مسجل - عمر “علي” ناقص - مدينة “نورة” مفقودة</p>
<p>إذا تجاهلت هذه القيم، قد تحصل على نتائج: - غير دقيقة - مضللة - تؤثر على قرارات مهمة (مثل التوظيف أو المكافآت)</p>
<p>لذلك، <strong>إدارة القيم المفقودة</strong> (Missing Data) هي واحدة من أهم مهارات تحليل البيانات.</p>
<hr />
<h2 id="ما-هي-القيم-المفقودة-1">🔹 <strong>1. ما هي القيم المفقودة؟</strong></h2>
<ul>
<li>تُمثل بـ <code>NaN</code> (Not a Number) في Pandas</li>
<li>تحدث بسبب:
<ul>
<li>خطأ في إدخال البيانات</li>
<li>عدم توفر المعلومات</li>
<li>فشل في جمع البيانات من مصدر ما</li>
</ul></li>
<li>يمكن أن تكون في أي عمود: نص، رقم، تاريخ</li>
</ul>
<hr />
<h2 id="اكتشاف-القيم-المفقودة-isnull-و-notnull">🔹 <strong>2. اكتشاف القيم المفقودة: <code>isnull()</code> و <code>notnull()</code></strong></h2>
<h3 id="df.isnull-يرجع-true-إذا-كانت-القيمة-مفقودة">✅ <code>df.isnull()</code> — يُرجع <code>True</code> إذا كانت القيمة مفقودة</h3>
<div class="sourceCode" id="cb92"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true"></a>data <span class="op">=</span> {</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true"></a>    <span class="st">&#39;الاسم&#39;</span>: [<span class="st">&#39;أحمد&#39;</span>, <span class="st">&#39;سارة&#39;</span>, <span class="st">&#39;علي&#39;</span>, <span class="st">&#39;نورة&#39;</span>],</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true"></a>    <span class="st">&#39;العمر&#39;</span>: [<span class="dv">25</span>, <span class="dv">30</span>, np.nan, <span class="dv">28</span>],</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true"></a>    <span class="st">&#39;المدينة&#39;</span>: [<span class="st">&#39;الرياض&#39;</span>, np.nan, <span class="st">&#39;الدمام&#39;</span>, <span class="st">&#39;مكة&#39;</span>],</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true"></a>    <span class="st">&#39;الراتب&#39;</span>: [<span class="dv">5000</span>, <span class="dv">7000</span>, <span class="dv">4000</span>, np.nan]</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true"></a>}</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true"></a></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true"></a><span class="bu">print</span>(df.isnull())</span></code></pre></div>
<h4 id="الناتج-30">🔍 الناتج:</h4>
<pre><code>    الاسم   العمر  المدينة   الراتب
0  False  False   False   False
1  False  False    True   False
2  False   True   False   False
3  False  False   False    True</code></pre>
<blockquote>
<p>✅ كل <code>True</code> يشير إلى قيمة مفقودة.</p>
</blockquote>
<hr />
<h3 id="df.isnull.sum-عدد-القيم-المفقودة-لكل-عمود">✅ <code>df.isnull().sum()</code> — عدد القيم المفقودة لكل عمود</h3>
<div class="sourceCode" id="cb94"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>())</span></code></pre></div>
<h4 id="الناتج-31">🔍 الناتج:</h4>
<pre><code>الاسم      0
العمر      1
المدينة    1
الراتب      1
dtype: int64</code></pre>
<blockquote>
<p>✅ أداة حيوية لتقييم جودة البيانات.</p>
</blockquote>
<hr />
<h3 id="df.isnull.sum.sum-العدد-الكلي-للقيم-المفقودة">✅ <code>df.isnull().sum().sum()</code> — العدد الكلي للقيم المفقودة</h3>
<div class="sourceCode" id="cb96"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true"></a>total_missing <span class="op">=</span> df.isnull().<span class="bu">sum</span>().<span class="bu">sum</span>()</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true"></a><span class="bu">print</span>(<span class="ss">f&quot;إجمالي القيم المفقودة: </span><span class="sc">{</span>total_missing<span class="sc">}</span><span class="ss">&quot;</span>)  <span class="co"># 3</span></span></code></pre></div>
<hr />
<h2 id="حذف-الصفوف-أو-الأعمدة-dropna">🔹 <strong>3. حذف الصفوف أو الأعمدة: <code>dropna()</code></strong></h2>
<h3 id="الطريقة-1-حذف-أي-صف-يحتوي-على-قيمة-مفقودة">✅ الطريقة 1: حذف أي صف يحتوي على قيمة مفقودة</h3>
<div class="sourceCode" id="cb97"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true"></a>df_clean <span class="op">=</span> df.dropna()</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true"></a><span class="bu">print</span>(df_clean)</span></code></pre></div>
<h4 id="الناتج-32">🔍 الناتج:</h4>
<pre><code>   الاسم  العمر  المدينة  الراتب
0   أحمد   25.0    الرياض  5000.0</code></pre>
<blockquote>
<p>⚠️ تم حذف 3 صفوف! فقدان كبير للبيانات.</p>
</blockquote>
<hr />
<h3 id="الطريقة-2-حذف-الصفوف-التي-جميع-قيمها-مفقودة">✅ الطريقة 2: حذف الصفوف التي جميع قيمها مفقودة</h3>
<div class="sourceCode" id="cb99"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true"></a>df.dropna(how<span class="op">=</span><span class="st">&#39;all&#39;</span>)  <span class="co"># نادرًا ما يحدث</span></span></code></pre></div>
<hr />
<h3 id="الطريقة-3-حذف-الصفوف-التي-تحتوي-على-قيمة-مفقودة-في-عمود-معين">✅ الطريقة 3: حذف الصفوف التي تحتوي على قيمة مفقودة في عمود معين</h3>
<div class="sourceCode" id="cb100"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true"></a><span class="co"># احذف الصفوف التي العمر فيها مفقود</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true"></a>df.dropna(subset<span class="op">=</span>[<span class="st">&#39;العمر&#39;</span>])</span></code></pre></div>
<h4 id="الناتج-33">🔍 الناتج:</h4>
<pre><code>   الاسم  العمر  المدينة  الراتب
0   أحمد   25.0    الرياض  5000.0
1   سارة   30.0     جدة   7000.0
3   نورة   28.0     مكة     NaN</code></pre>
<blockquote>
<p>✅ فقط الصف 2 (علي) تم حذفه.</p>
</blockquote>
<hr />
<h3 id="الطريقة-4-حذف-الأعمدة-التي-تحتوي-على-قيم-مفقودة">✅ الطريقة 4: حذف الأعمدة التي تحتوي على قيم مفقودة</h3>
<div class="sourceCode" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true"></a>df.dropna(axis<span class="op">=</span><span class="dv">1</span>)  <span class="co"># axis=1 تعني &quot;العمود&quot;</span></span></code></pre></div>
<h4 id="الناتج-34">🔍 الناتج:</h4>
<pre><code>   الاسم
0   أحمد
1   سارة
2   علي
3   نورة</code></pre>
<blockquote>
<p>⚠️ تم حذف 3 أعمدة! فقدان كبير للمعلومات.</p>
</blockquote>
<hr />
<h2 id="ملء-القيم-المفقودة-fillna">🔹 <strong>4. ملء القيم المفقودة: <code>fillna()</code></strong></h2>
<h3 id="الطريقة-1-ملء-بالقيمة-0">✅ الطريقة 1: ملء بالقيمة 0</h3>
<div class="sourceCode" id="cb104"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true"></a>df_filled <span class="op">=</span> df.fillna(<span class="dv">0</span>)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true"></a><span class="bu">print</span>(df_filled)</span></code></pre></div>
<h4 id="الناتج-35">🔍 الناتج:</h4>
<pre><code>   الاسم  العمر  المدينة  الراتب
0   أحمد   25.0    الرياض  5000.0
1   سارة   30.0       0  7000.0
2   علي     0.0    الدمام  4000.0
3   نورة   28.0     مكة     0.0</code></pre>
<blockquote>
<p>⚠️ قد لا يكون 0 منطقيًا (مثلاً: عمر 0؟)</p>
</blockquote>
<hr />
<h3 id="الطريقة-2-ملء-بقيمة-معينة-لكل-عمود">✅ الطريقة 2: ملء بقيمة معينة لكل عمود</h3>
<div class="sourceCode" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true"></a>values <span class="op">=</span> {<span class="st">&#39;العمر&#39;</span>: <span class="dv">25</span>, <span class="st">&#39;المدينة&#39;</span>: <span class="st">&#39;غير معروفة&#39;</span>, <span class="st">&#39;الراتب&#39;</span>: df[<span class="st">&#39;الراتب&#39;</span>].mean()}</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true"></a>df_filled <span class="op">=</span> df.fillna(value<span class="op">=</span>values)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true"></a><span class="bu">print</span>(df_filled)</span></code></pre></div>
<h4 id="الناتج-36">🔍 الناتج:</h4>
<pre><code>   الاسم  العمر        المدينة  الراتب
0   أحمد   25.0         الرياض  5000.0
1   سارة   30.0    غير معروفة  7000.0
2   علي    25.0        الدمام  4000.0
3   نورة   28.0           مكة  5333.333</code></pre>
<blockquote>
<p>✅ استخدام المتوسط للراتب منطقي.</p>
</blockquote>
<hr />
<h3 id="الطريقة-3-ملء-بالقيمة-السابقة-أو-التالية-للمتسلسلات-الزمنية">✅ الطريقة 3: ملء بالقيمة السابقة أو التالية (للمتسلسلات الزمنية)</h3>
<div class="sourceCode" id="cb108"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true"></a><span class="co"># ملء بالقيمة السابقة (ffill)</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true"></a>df.fillna(method<span class="op">=</span><span class="st">&#39;ffill&#39;</span>)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true"></a><span class="co"># ملء بالقيمة التالية (bfill)</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true"></a>df.fillna(method<span class="op">=</span><span class="st">&#39;bfill&#39;</span>)</span></code></pre></div>
<blockquote>
<p>مفيد في بيانات الأسهم أو الطقس.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-تحليل-معمق-5">🔹 <strong>5. الأخطاء الشائعة (تحليل معمق)</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>SettingWithCopyWarning</code> بعد <code>fillna()</code></td>
<td>التعديل على نسخة</td>
<td>استخدم <code>.copy()</code> أو <code>inplace=True</code></td>
</tr>
<tr class="even">
<td><code>fillna()</code> لا يعمل على عمود نصي</td>
<td>لأن <code>mean()</code> لا يُحسب على نص</td>
<td>استخدم نصًا افتراضيًا مثل “مجهول”</td>
</tr>
<tr class="odd">
<td><code>dropna()</code> يحذف بيانات مهمة</td>
<td>لأن القيم المفقودة يمكن استنتاجها</td>
<td>فكّر في “الملء” بدل “الحذف”</td>
</tr>
<tr class="even">
<td><code>np.nan</code> لا يساوي نفسه</td>
<td><code>np.nan == np.nan</code> → <code>False</code></td>
<td>استخدم <code>pd.isna(x)</code> بدل <code>x == np.nan</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-5">🔹 <strong>تمارين تطبيقية</strong></h2>
<h3 id="التمرين-1-احسب-جودة-البيانات">✅ التمرين 1: احسب جودة البيانات</h3>
<ul>
<li>أنشئ DataFrame به قيم مفقودة</li>
<li>احسب نسبة القيم المفقودة لكل عمود</li>
</ul>
<h3 id="التمرين-2-ملء-ذكي">✅ التمرين 2: ملء ذكي</h3>
<p>املأ عمود “العمر” بالمتوسط، و“المدينة” بـ “غير معروف”.</p>
<h3 id="التمرين-3-حذف-آمن">✅ التمرين 3: حذف آمن</h3>
<p>احذف فقط الصفوف التي <strong>جميع</strong> قيمها مفقودة.</p>
<h3 id="التمرين-4-تحليل-واقعي-1">✅ التمرين 4: تحليل واقعي</h3>
<p>لماذا قد نختار <code>fillna()</code> بدل <code>dropna()</code> في تحليل الموارد البشرية؟</p>
<hr />
<h2 id="الربط-بالواقع-تحليل-قاعدة-بيانات-موظفين">🔹 <strong>الربط بالواقع: تحليل قاعدة بيانات موظفين</strong></h2>
<h3 id="الهدف-إعداد-البيانات-للتحليل-الإحصائي">🎯 الهدف: إعداد البيانات للتحليل الإحصائي</h3>
<div class="sourceCode" id="cb109"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true"></a><span class="co"># 1. تقرير جودة البيانات</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;عدد القيم المفقودة:&quot;</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>())</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true"></a></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true"></a><span class="co"># 2. اتخاذ القرار</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true"></a><span class="cf">if</span> df[<span class="st">&#39;العمر&#39;</span>].isnull().<span class="bu">sum</span>() <span class="op">&lt;</span> <span class="dv">5</span>:</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true"></a>    <span class="co"># ملء بالمتوسط</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true"></a>    df[<span class="st">&#39;العمر&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;العمر&#39;</span>].fillna(df[<span class="st">&#39;العمر&#39;</span>].mean())</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true"></a><span class="cf">else</span>:</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true"></a>    <span class="co"># حذف الصفوف</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true"></a>    df <span class="op">=</span> df.dropna(subset<span class="op">=</span>[<span class="st">&#39;العمر&#39;</span>])</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true"></a></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true"></a><span class="co"># 3. معالجة المدينة</span></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true"></a>df[<span class="st">&#39;المدينة&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;المدينة&#39;</span>].fillna(<span class="st">&#39;غير معروفة&#39;</span>)</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true"></a></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true"></a><span class="co"># 4. حساب متوسط الراتب بعد المعالجة</span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true"></a>avg_salary <span class="op">=</span> df[<span class="st">&#39;الراتب&#39;</span>].mean()</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true"></a><span class="bu">print</span>(<span class="ss">f&quot;متوسط الراتب بعد المعالجة: </span><span class="sc">{</span>avg_salary<span class="sc">:,.2f}</span><span class="ss"> ريال&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا الأسلوب يُستخدم في المؤسسات لضمان دقة التقارير.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-5">🔹 <strong>نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ لا تحذف البيانات بسرعة — فكّر في “الاستنتاج” أولًا.</li>
<li>✅ استخدم <code>fillna()</code> مع قيم منطقية (متوسط، وسط، أحدث قيمة).</li>
<li>✅ تجنب ملء القيم المفقودة بـ 0 إلا إذا كان ذلك منطقيًا.</li>
<li>✅ استخدم <code>inplace=True</code> بحذر: <code>df.fillna(0, inplace=True)</code>.</li>
<li>✅ وثّق كل خطوة: “تم ملء العمر بالمتوسط بسبب نقص 2% من البيانات”.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-5">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>isnull()</code> و <code>notnull()</code>؟</li>
<li>متى نستخدم <code>dropna()</code> ومتى نستخدم <code>fillna()</code>؟</li>
<li>لماذا <code>np.nan == np.nan</code> يُرجع <code>False</code>؟</li>
<li>ما معنى <code>axis=0</code> و <code>axis=1</code> في <code>dropna()</code>؟</li>
<li>كيف تملأ القيم المفقودة في عمود نصي؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-5">🔹 <strong>مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>الأداة</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>isnull()</code></td>
<td>كشف القيم المفقودة</td>
</tr>
<tr class="even">
<td><code>isnull().sum()</code></td>
<td>عدد القيم المفقودة لكل عمود</td>
</tr>
<tr class="odd">
<td><code>dropna()</code></td>
<td>حذف الصفوف/الأعمدة التي بها قيم مفقودة</td>
</tr>
<tr class="even">
<td><code>fillna()</code></td>
<td>ملء القيم المفقودة بقيمة معينة</td>
</tr>
<tr class="odd">
<td><code>method='ffill'</code></td>
<td>ملء بالقيمة السابقة</td>
</tr>
<tr class="even">
<td><code>subset=[...]</code></td>
<td>تطبيق على عمود معين فقط</td>
</tr>
</tbody>
</table>
<h1 id="الدرس-8-التجميع-باستخدام-groupby-كيفية-حساب-المتوسط-المجموع-عدد-التكرارات-حسب-فئات-معينة">📘 <strong>الدرس 8 : التجميع باستخدام <code>groupby()</code>: كيفية حساب المتوسط، المجموع، عدد التكرارات حسب فئات معينة</strong></h1>
<h2 id="مقدمة-لماذا-نستخدم-groupby">🔹 <strong>مقدمة: لماذا نستخدم <code>groupby()</code>؟</strong></h2>
<p>تخيل أنك مدير مبيعات، ولديك جدول يحتوي على 10,000 صف من عمليات البيع.<br />
تريد الإجابة على أسئلة مثل: - ما <strong>إجمالي المبيعات لكل فئة منتج</strong>؟ - ما <strong>متوسط سعر المنتج في كل مدينة</strong>؟ - كم <strong>عدد العملاء في كل فرع</strong>؟</p>
<p>هنا تأتي أهمية <strong><code>groupby()</code></strong> — وهي واحدة من أقوى أدوات Pandas.</p>
<p>تُستخدم <code>groupby()</code> لـ: &gt; <strong>تقسيم البيانات إلى مجموعات، ثم تطبيق دالة تجميع (مثل المجموع أو المتوسط) على كل مجموعة.</strong></p>
<hr />
<h2 id="المبدأ-الأساسي-لـ-groupby">🔹 <strong>1. المبدأ الأساسي لـ <code>groupby()</code></strong></h2>
<p>العملية تشبه: 1. <strong>تقسيم</strong> البيانات إلى مجموعات (مثلاً: حسب “الفئة”) 2. <strong>تطبيق</strong> دالة (مثل <code>sum</code> أو <code>mean</code>) 3. <strong>دمج</strong> النتائج في جدول جديد</p>
<h3 id="الصيغة-العامة">✅ الصيغة العامة:</h3>
<div class="sourceCode" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true"></a>df.groupby(<span class="st">&#39;العمود_الذي_نجمع_به&#39;</span>)[<span class="st">&#39;العمود_المراد_تجميعه&#39;</span>].دالة_تجميع()</span></code></pre></div>
<hr />
<h2 id="أمثلة-عملية">🔹 <strong>2. أمثلة عملية</strong></h2>
<h3 id="المثال-1-إجمالي-المبيعات-لكل-فئة-منتج">📌 المثال 1: إجمالي المبيعات لكل فئة منتج</h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true"></a>data <span class="op">=</span> {</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;تفاح&#39;</span>, <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;لابتوب&#39;</span>, <span class="st">&#39;سماعة&#39;</span>, <span class="st">&#39;حليب&#39;</span>, <span class="st">&#39;شاشة&#39;</span>],</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true"></a>    <span class="st">&#39;الفئة&#39;</span>: [<span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;إلكترونيات&#39;</span>, <span class="st">&#39;إلكترونيات&#39;</span>, <span class="st">&#39;ألبان&#39;</span>, <span class="st">&#39;إلكترونيات&#39;</span>],</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true"></a>    <span class="st">&#39;السعر&#39;</span>: [<span class="fl">3.5</span>, <span class="fl">2.0</span>, <span class="dv">2500</span>, <span class="dv">150</span>, <span class="fl">8.0</span>, <span class="dv">800</span>],</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true"></a>    <span class="st">&#39;الكمية&#39;</span>: [<span class="dv">50</span>, <span class="dv">30</span>, <span class="dv">5</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">3</span>],</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true"></a>    <span class="st">&#39;المدينة&#39;</span>: [<span class="st">&#39;الرياض&#39;</span>, <span class="st">&#39;جدة&#39;</span>, <span class="st">&#39;الرياض&#39;</span>, <span class="st">&#39;جدة&#39;</span>, <span class="st">&#39;الدمام&#39;</span>, <span class="st">&#39;الرياض&#39;</span>]</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true"></a>}</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true"></a></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true"></a>df[<span class="st">&#39;الإجمالي&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>] <span class="op">*</span> df[<span class="st">&#39;الكمية&#39;</span>]</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true"></a></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true"></a><span class="co"># إجمالي المبيعات لكل فئة</span></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true"></a>total_by_category <span class="op">=</span> df.groupby(<span class="st">&#39;الفئة&#39;</span>)[<span class="st">&#39;الإجمالي&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true"></a><span class="bu">print</span>(total_by_category)</span></code></pre></div>
<h4 id="الناتج-37">🔍 الناتج:</h4>
<pre><code>الفئة
ألبان           320.0
إلكترونيات   17800.0
فواكه          235.0
Name: الإجمالي, dtype: float64</code></pre>
<blockquote>
<p>✅ الفئات الإلكترونية هي الأعلى مبيعًا.</p>
</blockquote>
<hr />
<h3 id="المثال-2-متوسط-السعر-لكل-فئة">📌 المثال 2: متوسط السعر لكل فئة</h3>
<div class="sourceCode" id="cb113"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true"></a>avg_price <span class="op">=</span> df.groupby(<span class="st">&#39;الفئة&#39;</span>)[<span class="st">&#39;السعر&#39;</span>].mean()</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true"></a><span class="bu">print</span>(avg_price)</span></code></pre></div>
<h4 id="الناتج-38">🔍 الناتج:</h4>
<pre><code>الفئة
ألبان           8.0
إلكترونيات  1116.666667
فواكه          2.75
Name: السعر, dtype: float64</code></pre>
<blockquote>
<p>✅ متوسط سعر الإلكترونيات مرتفع جدًا.</p>
</blockquote>
<hr />
<h3 id="المثال-3-عدد-المنتجات-في-كل-فئة">📌 المثال 3: عدد المنتجات في كل فئة</h3>
<div class="sourceCode" id="cb115"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true"></a>count_by_category <span class="op">=</span> df.groupby(<span class="st">&#39;الفئة&#39;</span>).size()</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true"></a><span class="bu">print</span>(count_by_category)</span></code></pre></div>
<h4 id="الناتج-39">🔍 الناتج:</h4>
<pre><code>الفئة
ألبان           1
إلكترونيات     3
فواكه          2
dtype: int64</code></pre>
<blockquote>
<p>✅ <code>size()</code> يحسب عدد الصفوف في كل مجموعة.</p>
</blockquote>
<hr />
<h3 id="المثال-4-استخدام-count-بدل-size">📌 المثال 4: استخدام <code>count()</code> بدل <code>size()</code></h3>
<div class="sourceCode" id="cb117"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true"></a>count_values <span class="op">=</span> df.groupby(<span class="st">&#39;الفئة&#39;</span>)[<span class="st">&#39;المنتج&#39;</span>].count()</span></code></pre></div>
<blockquote>
<p>✅ الفرق: <code>count()</code> لا يحسب القيم المفقودة، بينما <code>size()</code> يحسب كل الصفوف.</p>
</blockquote>
<hr />
<h2 id="تجميع-متعدد-الأعمدة">🔹 <strong>3. تجميع متعدد الأعمدة</strong></h2>
<h3 id="المثال-5-مجموع-وعدد-وحدات-المبيعات-لكل-مدينة">📌 المثال 5: مجموع وعدد وحدات المبيعات لكل مدينة</h3>
<div class="sourceCode" id="cb118"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true"></a>summary <span class="op">=</span> df.groupby(<span class="st">&#39;المدينة&#39;</span>).agg({</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true"></a>    <span class="st">&#39;الكمية&#39;</span>: [<span class="st">&#39;sum&#39;</span>, <span class="st">&#39;mean&#39;</span>],</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true"></a>    <span class="st">&#39;الإجمالي&#39;</span>: <span class="st">&#39;sum&#39;</span>,</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: <span class="st">&#39;count&#39;</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true"></a>})</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true"></a><span class="bu">print</span>(summary)</span></code></pre></div>
<h4 id="الناتج-40">🔍 الناتج:</h4>
<pre><code>           الكمية            الإجمالي  المنتج
              sum  mean         sum   count
المدينة                                     
الدمام         40  40.0         320        1
الرياض        58  19.333    13875.0        3
جدة           50  25.0      3960.0        2</code></pre>
<blockquote>
<p>✅ استخدام <code>agg()</code> يسمح بتطبيق دوال مختلفة على أعمدة مختلفة.</p>
</blockquote>
<hr />
<h2 id="التجميع-حسب-أكثر-من-عمود">🔹 <strong>4. التجميع حسب أكثر من عمود</strong></h2>
<h3 id="المثال-6-متوسط-السعر-لكل-فئة-في-كل-مدينة">📌 المثال 6: متوسط السعر لكل فئة في كل مدينة</h3>
<div class="sourceCode" id="cb120"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true"></a>multi_group <span class="op">=</span> df.groupby([<span class="st">&#39;المدينة&#39;</span>, <span class="st">&#39;الفئة&#39;</span>])[<span class="st">&#39;السعر&#39;</span>].mean()</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true"></a><span class="bu">print</span>(multi_group)</span></code></pre></div>
<h4 id="الناتج-41">🔍 الناتج:</h4>
<pre><code>المدينة  الفئة       
الدمام    ألبان           8.0
الرياض   إلكترونيات  1650.0
         فواكه          3.5
جدة      إلكترونيات   150.0
         فواكه          2.0
Name: السعر, dtype: float64</code></pre>
<blockquote>
<p>✅ يمكنك التجميع حسب أكثر من عمود باستخدام قائمة.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-تحليل-معمق-6">🔹 <strong>5. الأخطاء الشائعة (تحليل معمق)</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>KeyError</code></td>
<td>اسم عمود غير موجود</td>
<td>تحقق من <code>df.columns</code></td>
</tr>
<tr class="even">
<td><code>No numeric types to aggregate</code></td>
<td>تحاول تطبيق <code>sum</code> على عمود نصي</td>
<td>تأكد من نوع البيانات</td>
</tr>
<tr class="odd">
<td>الناتج غير مرتب</td>
<td>لا توجد ترتيبات</td>
<td>استخدم <code>.sort_values()</code> لاحقًا</td>
</tr>
<tr class="even">
<td><code>groupby</code> لا يُظهر النتائج</td>
<td>لأن الناتج Series</td>
<td>استخدم <code>.reset_index()</code> لتحويله إلى DataFrame</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-6">🔹 <strong>تمارين تطبيقية</strong></h2>
<h3 id="التمرين-1-مبيعات-كل-مدينة">✅ التمرين 1: مبيعات كل مدينة</h3>
<p>احسب <strong>إجمالي المبيعات لكل مدينة</strong>.</p>
<h3 id="التمرين-2-متوسط-الكمية">✅ التمرين 2: متوسط الكمية</h3>
<p>احسب <strong>متوسط الكمية المباعة لكل فئة منتج</strong>.</p>
<h3 id="التمرين-3-عدد-المنتجات">✅ التمرين 3: عدد المنتجات</h3>
<p>كم عدد المنتجات في كل فئة؟ استخدم <code>size()</code> و <code>count()</code>، وقارن النتائج.</p>
<h3 id="التمرين-4-تجميع-متقدم">✅ التمرين 4: تجميع متقدم</h3>
<p>أنشئ تقريرًا يُظهر: - المجموع والحد الأقصى للسعر - متوسط الكمية لكل فئة منتج.</p>
<hr />
<h2 id="الربط-بالواقع-تقرير-مبيعات-شهري">🔹 <strong>الربط بالواقع: تقرير مبيعات شهري</strong></h2>
<h3 id="الهدف-إعداد-تقرير-إداري">🎯 الهدف: إعداد تقرير إداري</h3>
<div class="sourceCode" id="cb122"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true"></a><span class="co"># 1. إجمالي المبيعات لكل فئة</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true"></a>sales_by_category <span class="op">=</span> df.groupby(<span class="st">&#39;الفئة&#39;</span>)[<span class="st">&#39;الإجمالي&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true"></a></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true"></a><span class="co"># 2. متوسط سعر البيع لكل مدينة</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true"></a>avg_price_city <span class="op">=</span> df.groupby(<span class="st">&#39;المدينة&#39;</span>)[<span class="st">&#39;السعر&#39;</span>].mean()</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true"></a><span class="co"># 3. عدد المنتجات المباعة لكل فرع</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true"></a>products_per_city <span class="op">=</span> df.groupby(<span class="st">&#39;المدينة&#39;</span>).size()</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true"></a></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true"></a><span class="co"># 4. تقرير نهائي</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true"></a>report <span class="op">=</span> pd.DataFrame({</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true"></a>    <span class="st">&#39;إجمالي المبيعات&#39;</span>: df.groupby(<span class="st">&#39;المدينة&#39;</span>)[<span class="st">&#39;الإجمالي&#39;</span>].<span class="bu">sum</span>(),</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true"></a>    <span class="st">&#39;متوسط السعر&#39;</span>: df.groupby(<span class="st">&#39;المدينة&#39;</span>)[<span class="st">&#39;السعر&#39;</span>].mean(),</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true"></a>    <span class="st">&#39;عدد المنتجات&#39;</span>: df.groupby(<span class="st">&#39;المدينة&#39;</span>).size()</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true"></a>}).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true"></a></span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📊 تقرير أداء الفروع:&quot;</span>)</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true"></a><span class="bu">print</span>(report)</span></code></pre></div>
<h4 id="الناتج-42">🔍 الناتج:</h4>
<pre><code>📊 تقرير أداء الفروع:
         إجمالي المبيعات  متوسط السعر  عدد المنتجات
المدينة                                     
الدمام           320.0          8.0             1
الرياض         13875.0       1653.5             3
جدة           3960.0        152.0             2</code></pre>
<blockquote>
<p>✅ هذا التقرير يمكن عرضه في اجتماعات الإدارة.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-6">🔹 <strong>نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>reset_index()</code> لتحويل الناتج إلى DataFrame قابل للحفظ.</li>
<li>✅ استخدم <code>round(2)</code> لتقريب الأرقام.</li>
<li>✅ تجنب <code>groupby</code> على أعمدة بها كثير من القيم الفريدة (مثل الأسماء).</li>
<li>✅ استخدم <code>agg()</code> عند الحاجة إلى دوال متعددة.</li>
<li>✅ تحقق من أنواع البيانات قبل التجميع.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-6">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>sum()</code> و <code>count()</code> في <code>groupby()</code>؟</li>
<li>لماذا نستخدم <code>reset_index()</code> بعد <code>groupby()</code>؟</li>
<li>كيف تُرجع متوسط عمودين معًا في <code>groupby()</code>؟</li>
<li>ما معنى <code>.agg()</code>؟</li>
<li>كيف تُرجع أعلى قيمة في كل مجموعة؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-6">🔹 <strong>مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>الدالة</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>groupby('col')</code></td>
<td>التجميع حسب عمود</td>
</tr>
<tr class="even">
<td><code>.sum()</code></td>
<td>المجموع</td>
</tr>
<tr class="odd">
<td><code>.mean()</code></td>
<td>المتوسط</td>
</tr>
<tr class="even">
<td><code>.count()</code></td>
<td>عدد القيم غير المفقودة</td>
</tr>
<tr class="odd">
<td><code>.size()</code></td>
<td>عدد الصفوف (بما في ذلك المفقودة)</td>
</tr>
<tr class="even">
<td><code>.agg()</code></td>
<td>تطبيق دوال متعددة</td>
</tr>
<tr class="odd">
<td><code>reset_index()</code></td>
<td>تحويل الناتج إلى DataFrame</td>
</tr>
</tbody>
</table>
<h1 id="الدرس-9-ترتيب-البيانات-باستخدام-sort_values-1">📘 <strong>الدرس 9 : ترتيب البيانات باستخدام <code>sort_values()</code></strong></h1>
<h2 id="مقدمة-لماذا-نحتاج-إلى-الترتيب">🔹 <strong>مقدمة: لماذا نحتاج إلى الترتيب؟</strong></h2>
<p>تخيل أنك تنظر إلى قائمة مبيعات غير مرتبة: - منتجات بأسعار عشوائية - تواريخ غير منظمة - رواتب موظفين غير مصنفة</p>
<p>من الصعب جدًا: - اكتشاف أعلى راتب - معرفة أحدث عملية بيع - تحديد أفضل 5 منتجات مبيعًا</p>
<p>لهذا، <strong>ترتيب البيانات</strong> هو خطوة أساسية في أي تحليل.<br />
والأداة الرئيسية في Pandas لذلك هي:<br />
&gt; ✅ <code>sort_values()</code></p>
<hr />
<h2 id="الترتيب-الأساسي-ترتيب-عمود-واحد">🔹 <strong>1. الترتيب الأساسي: ترتيب عمود واحد</strong></h2>
<h3 id="الطريقة-df.sort_valuesالعمود">✅ الطريقة: <code>df.sort_values('العمود')</code></h3>
<div class="sourceCode" id="cb124"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true"></a>data <span class="op">=</span> {</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;تفاح&#39;</span>, <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;لابتوب&#39;</span>, <span class="st">&#39;سماعة&#39;</span>],</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true"></a>    <span class="st">&#39;السعر&#39;</span>: [<span class="fl">3.5</span>, <span class="fl">2.0</span>, <span class="dv">2500</span>, <span class="dv">150</span>],</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true"></a>    <span class="st">&#39;الكمية&#39;</span>: [<span class="dv">50</span>, <span class="dv">30</span>, <span class="dv">5</span>, <span class="dv">20</span>]</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true"></a>}</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true"></a></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true"></a><span class="co"># ترتيب حسب السعر (تصاعديًا - الافتراضي)</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true"></a>sorted_df <span class="op">=</span> df.sort_values(<span class="st">&#39;السعر&#39;</span>)</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true"></a><span class="bu">print</span>(sorted_df)</span></code></pre></div>
<h4 id="الناتج-43">🔍 الناتج:</h4>
<pre><code>   المنتج  السعر  الكمية
1     موز    2.0     30
0    تفاح    3.5     50
3   سماعة  150.0     20
2   لابتوب 2500.0      5</code></pre>
<blockquote>
<p>✅ تم ترتيب الصفوف من الأقل سعرًا إلى الأعلى.</p>
</blockquote>
<hr />
<h2 id="الترتيب-التنازلي-ascendingfalse">🔹 <strong>2. الترتيب التنازلي: <code>ascending=False</code></strong></h2>
<div class="sourceCode" id="cb126"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true"></a><span class="co"># ترتيب حسب السعر من الأعلى إلى الأدنى</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true"></a>sorted_desc <span class="op">=</span> df.sort_values(<span class="st">&#39;السعر&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true"></a><span class="bu">print</span>(sorted_desc)</span></code></pre></div>
<h4 id="الناتج-44">🔍 الناتج:</h4>
<pre><code>   المنتج    السعر  الكمية
2   لابتوب  2500.0      5
3   سماعة   150.0     20
0    تفاح     3.5     50
1     موز     2.0     30</code></pre>
<blockquote>
<p>✅ مفيد لعرض “أعلى 5 مبيعات” أو “أعلى الرواتب”.</p>
</blockquote>
<hr />
<h2 id="الترتيب-حسب-أكثر-من-عمود">🔹 <strong>3. الترتيب حسب أكثر من عمود</strong></h2>
<h3 id="الطريقة-تمرير-قائمة-من-الأعمدة">✅ الطريقة: تمرير قائمة من الأعمدة</h3>
<div class="sourceCode" id="cb128"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true"></a><span class="co"># ترتيب حسب الفئة، ثم حسب السعر داخل كل فئة</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true"></a>data[<span class="st">&#39;الفئة&#39;</span>] <span class="op">=</span> [<span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;إلكترونيات&#39;</span>, <span class="st">&#39;إلكترونيات&#39;</span>]</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true"></a></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true"></a>sorted_multi <span class="op">=</span> df.sort_values([<span class="st">&#39;الفئة&#39;</span>, <span class="st">&#39;السعر&#39;</span>], ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>])</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true"></a><span class="bu">print</span>(sorted_multi)</span></code></pre></div>
<h4 id="الناتج-45">🔍 الناتج:</h4>
<pre><code>   المنتج       الفئة  السعر  الكمية
3   سماعة  إلكترونيات  150.0     20
2   لابتوب  إلكترونيات 2500.0      5
0    تفاح        فواكه    3.5     50
1     موز        فواكه    2.0     30</code></pre>
<blockquote>
<p>✅ أولاً: تُرتب الفئات (إلكترونيات أولًا، ثم فواكه)<br />
ثانيًا: داخل كل فئة، يُرتب السعر تنازليًا.</p>
</blockquote>
<hr />
<h2 id="الترتيب-حسب-الفهرس-index-sort_index">🔹 <strong>4. الترتيب حسب الفهرس (Index): <code>sort_index()</code></strong></h2>
<p>مفيد عندما تريد إعادة ترتيب الجدول حسب التسلسل الأصلي بعد عملية فلترة أو إعادة ترتيب.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true"></a><span class="co"># افترض أنك فلترت وحذفت بعض الصفوف</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true"></a>filtered <span class="op">=</span> df[df[<span class="st">&#39;السعر&#39;</span>] <span class="op">&gt;</span> <span class="dv">100</span>]</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true"></a><span class="co"># الفهارس أصبحت: 2, 3</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true"></a></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true"></a><span class="co"># إعادة الترتيب حسب الفهرس</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true"></a>sorted_by_index <span class="op">=</span> filtered.sort_index()</span></code></pre></div>
<blockquote>
<p>✅ يُستخدم غالبًا بعد <code>reset_index()</code>.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-تحليل-معمق-7">🔹 <strong>5. الأخطاء الشائعة (تحليل معمق)</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>KeyError</code></td>
<td>اسم عمود غير موجود</td>
<td>تحقق من <code>df.columns</code></td>
</tr>
<tr class="even">
<td>لا يتغير الجدول الأصلي</td>
<td>لأن <code>sort_values()</code> لا يُعدّل الأصل</td>
<td>استخدم <code>inplace=True</code> أو احفظ الناتج</td>
</tr>
<tr class="odd">
<td>الترتيب غير دقيق على النصوص</td>
<td>لأن الحروف الكبيرة تُرتب قبل الصغيرة</td>
<td>استخدم <code>.str.lower()</code> قبل الترتيب</td>
</tr>
<tr class="even">
<td>الترتيب على عمود به <code>NaN</code></td>
<td>القيم المفقودة تظهر في النهاية</td>
<td>استخدم <code>na_position='first'</code> إذا أردتها في البداية</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="التحكم-في-وضع-القيم-المفقودة-na_position">🔹 <strong>6. التحكم في وضع القيم المفقودة: <code>na_position</code></strong></h2>
<div class="sourceCode" id="cb131"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true"></a>data_with_nan <span class="op">=</span> {</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true"></a>    <span class="st">&#39;الاسم&#39;</span>: [<span class="st">&#39;أحمد&#39;</span>, <span class="st">&#39;سارة&#39;</span>, <span class="st">&#39;علي&#39;</span>],</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true"></a>    <span class="st">&#39;الراتب&#39;</span>: [<span class="dv">5000</span>, np.nan, <span class="dv">4000</span>]</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true"></a>}</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true"></a>df_nan <span class="op">=</span> pd.DataFrame(data_with_nan)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true"></a></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true"></a><span class="co"># وضع القيم المفقودة في البداية</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true"></a>sorted_nan <span class="op">=</span> df_nan.sort_values(<span class="st">&#39;الراتب&#39;</span>, na_position<span class="op">=</span><span class="st">&#39;first&#39;</span>)</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true"></a><span class="bu">print</span>(sorted_nan)</span></code></pre></div>
<h4 id="الناتج-46">🔍 الناتج:</h4>
<pre><code>   الاسم  الراتب
1   سارة    NaN
2   علي  4000.0
0   أحمد  5000.0</code></pre>
<blockquote>
<p>✅ مفيد عندما تريد اكتشاف القيم الناقصة أولًا.</p>
</blockquote>
<hr />
<h2 id="تمارين-تطبيقية-7">🔹 <strong>تمارين تطبيقية</strong></h2>
<h3 id="التمرين-1-ترتيب-تصاعدي">✅ التمرين 1: ترتيب تصاعدي</h3>
<p>رتب الجدول حسب “الكمية” من الأقل إلى الأكثر.</p>
<h3 id="التمرين-2-ترتيب-متعدد">✅ التمرين 2: ترتيب متعدد</h3>
<p>رتب الجدول حسب “الفئة” (تصاعدي)، ثم “السعر” (تنازلي).</p>
<h3 id="التمرين-3-قمة-المبيعات">✅ التمرين 3: قمة المبيعات</h3>
<p>أظهر أفضل 3 منتجات من حيث “الإجمالي” (بعد حسابه).</p>
<h3 id="التمرين-4-ترتيب-بالفهرس">✅ التمرين 4: ترتيب بالفهرس</h3>
<p>بعد فلترة الجدول، كيف تُعيد ترتيب الفهارس؟</p>
<hr />
<h2 id="الربط-بالواقع-قائمة-أفضل-الموظفين">🔹 <strong>الربط بالواقع: قائمة أفضل الموظفين</strong></h2>
<h3 id="الهدف-إعداد-تقرير-مكافآت">🎯 الهدف: إعداد تقرير مكافآت</h3>
<div class="sourceCode" id="cb133"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true"></a><span class="co"># بيانات الموظفين</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true"></a>employees <span class="op">=</span> pd.DataFrame({</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true"></a>    <span class="st">&#39;الاسم&#39;</span>: [<span class="st">&#39;أحمد&#39;</span>, <span class="st">&#39;سارة&#39;</span>, <span class="st">&#39;علي&#39;</span>, <span class="st">&#39;نورة&#39;</span>, <span class="st">&#39;خالد&#39;</span>],</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true"></a>    <span class="st">&#39;القسم&#39;</span>: [<span class="st">&#39;مبيعات&#39;</span>, <span class="st">&#39;مبيعات&#39;</span>, <span class="st">&#39;تسويق&#39;</span>, <span class="st">&#39;مبيعات&#39;</span>, <span class="st">&#39;تسويق&#39;</span>],</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true"></a>    <span class="st">&#39;الأداء&#39;</span>: [<span class="dv">88</span>, <span class="dv">94</span>, <span class="dv">76</span>, <span class="dv">91</span>, <span class="dv">82</span>],</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true"></a>    <span class="st">&#39;الراتب&#39;</span>: [<span class="dv">5000</span>, <span class="dv">7000</span>, <span class="dv">4000</span>, <span class="dv">6000</span>, <span class="dv">4500</span>]</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true"></a>})</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true"></a></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true"></a><span class="co"># ترتيب حسب القسم، ثم حسب الأداء (من الأعلى)</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true"></a>top_performers <span class="op">=</span> employees.sort_values([<span class="st">&#39;القسم&#39;</span>, <span class="st">&#39;الأداء&#39;</span>], ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>])</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true"></a></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;🏆 أفضل الموظفين حسب القسم:&quot;</span>)</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true"></a><span class="bu">print</span>(top_performers)</span></code></pre></div>
<h4 id="الناتج-47">🔍 الناتج:</h4>
<pre><code>   الاسم   القسم  الأداء  الراتب
1   سارة  مبيعات     94   7000
3   نورة  مبيعات     91   6000
0   أحمد  مبيعات     88   5000
4   خالد  تسويق     82   4500
2   علي   تسويق     76   4000</code></pre>
<blockquote>
<p>✅ هذا التقرير يُستخدم في توزيع المكافآت.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-7">🔹 <strong>نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>inplace=True</code> إذا كنت لا تحتاج النسخة الأصلية:<br />
<code>df.sort_values('السعر', inplace=True)</code></li>
<li>✅ استخدم <code>head(n)</code> بعد الترتيب للحصول على “أفضل n عنصر”.</li>
<li>✅ تجنب الترتيب على أعمدة نصية بدون تحويلها إلى صغيرة:<br />
<code>df.sort_values(df['الاسم'].str.lower())</code></li>
<li>✅ استخدم <code>reset_index(drop=True)</code> بعد الترتيب إذا أردت فهرسًا جديدًا.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-7">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>sort_values()</code> و <code>sort_index()</code>؟</li>
<li>كيف تُرتب تنازليًا؟</li>
<li>ما معنى <code>na_position='first'</code>؟</li>
<li>كيف تُرتب حسب عمودين معًا؟</li>
<li>لماذا لا يتغير الجدول الأصلي عند استخدام <code>sort_values()</code>؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-7">🔹 <strong>مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>الدالة</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>sort_values('col')</code></td>
<td>ترتيب حسب عمود</td>
</tr>
<tr class="even">
<td><code>ascending=False</code></td>
<td>ترتيب تنازلي</td>
</tr>
<tr class="odd">
<td><code>sort_values(['A','B'])</code></td>
<td>ترتيب متعدد</td>
</tr>
<tr class="even">
<td><code>na_position='first'</code></td>
<td>وضع القيم المفقودة في البداية</td>
</tr>
<tr class="odd">
<td><code>sort_index()</code></td>
<td>ترتيب حسب الفهرس</td>
</tr>
<tr class="even">
<td><code>inplace=True</code></td>
<td>تعديل الجدول الأصلي</td>
</tr>
</tbody>
</table>
<h1 id="الدرس-10-دمج-وربط-البيانات-باستخدام-merge-و-concat-1">📘 <strong>الدرس 10 : دمج وربط البيانات باستخدام <code>merge</code> و <code>concat</code></strong></h1>
<h2 id="مقدمة-لماذا-نحتاج-إلى-دمج-البيانات">🔹 <strong>مقدمة: لماذا نحتاج إلى دمج البيانات؟</strong></h2>
<p>في العالم الحقيقي، <strong>نادرًا ما تكون البيانات في جدول واحد</strong>.<br />
غالبًا ما تكون مقسمة على: - ملفات منفصلة (مبيعات يناير، فبراير، مارس) - جداول مختلفة (بيانات العملاء، بيانات الطلبات) - مصادر متعددة (قاعدة بيانات، ملف إكسل، API)</p>
<p>لذلك، نحتاج إلى أدوات لـ: - <strong>دمج الجداول رأسيًا</strong> (إضافة صفوف): مثل دمج بيانات 3 أشهر - <strong>دمج الجداول أفقيًا</strong> (إضافة أعمدة): مثل ربط العميل بطلبه</p>
<p>هنا تأتي أهمية: &gt; ✅ <code>pd.concat()</code> للدمج العام<br />
&gt; ✅ <code>pd.merge()</code> للربط بالعلاقة (مثل JOIN في SQL)</p>
<hr />
<h2 id="الدمج-الرأسي-pd.concat">🔹 <strong>1. الدمج الرأسي: <code>pd.concat()</code></strong></h2>
<p>يُستخدم لـ <strong>تجميع جداول فوق بعضها</strong> (مثل دمج عدة ملفات).</p>
<h3 id="المثال-1-دمج-3-جداول-مبيعات-شهرية">📌 المثال 1: دمج 3 جداول مبيعات شهرية</h3>
<div class="sourceCode" id="cb135"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true"></a>jan <span class="op">=</span> pd.DataFrame({</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;تفاح&#39;</span>, <span class="st">&#39;موز&#39;</span>],</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true"></a>    <span class="st">&#39;الكمية&#39;</span>: [<span class="dv">100</span>, <span class="dv">150</span>],</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true"></a>    <span class="st">&#39;الشهر&#39;</span>: <span class="st">&#39;يناير&#39;</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true"></a>})</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true"></a></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true"></a>feb <span class="op">=</span> pd.DataFrame({</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;تفاح&#39;</span>, <span class="st">&#39;حليب&#39;</span>],</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true"></a>    <span class="st">&#39;الكمية&#39;</span>: [<span class="dv">120</span>, <span class="dv">80</span>],</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true"></a>    <span class="st">&#39;الشهر&#39;</span>: <span class="st">&#39;فبراير&#39;</span></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true"></a>})</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true"></a></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true"></a>mar <span class="op">=</span> pd.DataFrame({</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;موز&#39;</span>, <span class="st">&#39;لابتوب&#39;</span>],</span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true"></a>    <span class="st">&#39;الكمية&#39;</span>: [<span class="dv">200</span>, <span class="dv">5</span>],</span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true"></a>    <span class="st">&#39;الشهر&#39;</span>: <span class="st">&#39;مارس&#39;</span></span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true"></a>})</span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true"></a></span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true"></a><span class="co"># دمج الجداول رأسيًا</span></span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true"></a>total_sales <span class="op">=</span> pd.concat([jan, feb, mar], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true"></a><span class="bu">print</span>(total_sales)</span></code></pre></div>
<h4 id="الناتج-48">🔍 الناتج:</h4>
<pre><code>   المنتج  الكمية    الشهر
0    تفاح     100    يناير
1     موز     150    يناير
2    تفاح     120   فبراير
3    حليب      80   فبراير
4     موز     200    مارس
5   لابتوب      5    مارس</code></pre>
<blockquote>
<p>✅ <code>ignore_index=True</code> لإعادة ترقيم الصفوف من 0.</p>
</blockquote>
<hr />
<h3 id="خيارات-مهمة-في-concat">✅ خيارات مهمة في <code>concat()</code></h3>
<table>
<thead>
<tr class="header">
<th>الخيار</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>axis=0</code></td>
<td>دمج رأسي (الافتراضي)</td>
</tr>
<tr class="even">
<td><code>axis=1</code></td>
<td>دمج أفقي (جنبًا إلى جنب)</td>
</tr>
<tr class="odd">
<td><code>ignore_index=True</code></td>
<td>تجاهل الفهارس القديمة</td>
</tr>
<tr class="even">
<td><code>sort=False</code></td>
<td>عدم فرز الأعمدة تلقائيًا</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="المثال-2-دمج-أفقي-نادر-الاستخدام">📌 المثال 2: دمج أفقي (نادر الاستخدام)</h3>
<div class="sourceCode" id="cb137"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true"></a>names <span class="op">=</span> pd.DataFrame({<span class="st">&#39;الاسم&#39;</span>: [<span class="st">&#39;أحمد&#39;</span>, <span class="st">&#39;سارة&#39;</span>]})</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true"></a>ages <span class="op">=</span> pd.DataFrame({<span class="st">&#39;العمر&#39;</span>: [<span class="dv">25</span>, <span class="dv">30</span>]})</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true"></a></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true"></a>combined <span class="op">=</span> pd.concat([names, ages], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true"></a><span class="bu">print</span>(combined)</span></code></pre></div>
<h4 id="الناتج-49">🔍 الناتج:</h4>
<pre><code>   الاسم  العمر
0   أحمد     25
1   سارة     30</code></pre>
<blockquote>
<p>⚠️ يجب أن يكون عدد الصفوف متطابقًا.</p>
</blockquote>
<hr />
<h2 id="الربط-بالعلاقة-pd.merge-مثل-join-في-sql">🔹 <strong>2. الربط بالعلاقة: <code>pd.merge()</code> (مثل JOIN في SQL)</strong></h2>
<p>يُستخدم لربط جدولين بناءً على <strong>عمود مشترك</strong> (مفتاح).</p>
<h3 id="المثال-3-ربط-طلبات-بالعملاء">📌 المثال 3: ربط طلبات بالعملاء</h3>
<div class="sourceCode" id="cb139"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true"></a><span class="co"># جدول العملاء</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true"></a>customers <span class="op">=</span> pd.DataFrame({</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true"></a>    <span class="st">&#39;ID&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true"></a>    <span class="st">&#39;الاسم&#39;</span>: [<span class="st">&#39;أحمد&#39;</span>, <span class="st">&#39;سارة&#39;</span>, <span class="st">&#39;علي&#39;</span>],</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true"></a>    <span class="st">&#39;المدينة&#39;</span>: [<span class="st">&#39;الرياض&#39;</span>, <span class="st">&#39;جدة&#39;</span>, <span class="st">&#39;الدمام&#39;</span>]</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true"></a>})</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true"></a></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true"></a><span class="co"># جدول الطلبات</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true"></a>orders <span class="op">=</span> pd.DataFrame({</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true"></a>    <span class="st">&#39;OrderID&#39;</span>: [<span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">103</span>],</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true"></a>    <span class="st">&#39;ID&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>],</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;لابتوب&#39;</span>, <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;تفاح&#39;</span>],</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true"></a>    <span class="st">&#39;السعر&#39;</span>: [<span class="dv">2500</span>, <span class="fl">2.0</span>, <span class="fl">3.5</span>]</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true"></a>})</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true"></a></span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true"></a><span class="co"># ربط الطلبات باسم العميل</span></span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true"></a>merged <span class="op">=</span> pd.merge(orders, customers, on<span class="op">=</span><span class="st">&#39;ID&#39;</span>)</span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true"></a><span class="bu">print</span>(merged)</span></code></pre></div>
<h4 id="الناتج-50">🔍 الناتج:</h4>
<pre><code>   OrderID  ID  المنتج  السعر  الاسم  المدينة
0      101   1  لابتوب  2500.0  أحمد   الرياض
1      102   2    موز     2.0  سارة     جدة
2      103   1   تفاح     3.5  أحمد   الرياض</code></pre>
<blockquote>
<p>✅ تم إضافة اسم ومكان العميل لكل طلب.</p>
</blockquote>
<hr />
<h2 id="أنواع-الـ-merge-joins">🔹 <strong>3. أنواع الـ <code>merge</code> (joins)</strong></h2>
<table>
<thead>
<tr class="header">
<th>النوع</th>
<th>الوصف</th>
<th>الاستخدام</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>inner</code> (الافتراضي)</td>
<td>يُرجع الصفوف المشتركة فقط</td>
<td><code>how='inner'</code></td>
</tr>
<tr class="even">
<td><code>outer</code></td>
<td>يُرجع كل الصفوف، inclusive</td>
<td><code>how='outer'</code></td>
</tr>
<tr class="odd">
<td><code>left</code></td>
<td>يُرجع كل صفوف الجدول الأيسر</td>
<td><code>how='left'</code></td>
</tr>
<tr class="even">
<td><code>right</code></td>
<td>يُرجع كل صفوف الجدول الأيمن</td>
<td><code>how='right'</code></td>
</tr>
</tbody>
</table>
<h3 id="المثال-4-left-join-إظهار-جميع-الطلبات-حتى-لو-لم-يعرف-العميل">📌 المثال 4: <code>left join</code> – إظهار جميع الطلبات، حتى لو لم يُعرف العميل</h3>
<div class="sourceCode" id="cb141"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true"></a><span class="co"># افترض أن هناك طلبًا لـ ID=4 (غير موجود في العملاء)</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true"></a>orders_new <span class="op">=</span> pd.DataFrame({</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true"></a>    <span class="st">&#39;OrderID&#39;</span>: [<span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">104</span>],</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true"></a>    <span class="st">&#39;ID&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>],</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;لابتوب&#39;</span>, <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;شاشة&#39;</span>]</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true"></a>})</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true"></a></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true"></a>left_merge <span class="op">=</span> pd.merge(orders_new, customers, on<span class="op">=</span><span class="st">&#39;ID&#39;</span>, how<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true"></a><span class="bu">print</span>(left_merge)</span></code></pre></div>
<h4 id="الناتج-51">🔍 الناتج:</h4>
<pre><code>   OrderID  ID  المنتج  الاسم  المدينة
0      101   1  لابتوب   أحمد   الرياض
1      102   2    موز   سارة     جدة
2      104   4  شاشة   NaN     NaN</code></pre>
<blockquote>
<p>✅ مفيد للكشف عن الطلبات بدون عميل.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-تحليل-معمق-8">🔹 <strong>4. الأخطاء الشائعة (تحليل معمق)</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>KeyError</code> في <code>on=</code></td>
<td>العمود غير موجود في أحد الجداول</td>
<td>تحقق من <code>df.columns</code></td>
</tr>
<tr class="even">
<td><code>concat()</code> يُكرر الفهارس</td>
<td>لأن الفهارس الأصلية تم الحفاظ عليها</td>
<td>استخدم <code>ignore_index=True</code></td>
</tr>
<tr class="odd">
<td><code>merge()</code> يُنتج صفوفًا أكثر</td>
<td>بسبب تكرار المفاتيح (مثلاً: عميل له عدة طلبات)</td>
<td>هذا طبيعي، وليس خطأ</td>
</tr>
<tr class="even">
<td>دمج أفقي بـ <code>concat</code> يُنتج <code>NaN</code></td>
<td>لأن عدد الصفوف غير متساوٍ</td>
<td>تأكد من تطابق الأحجام</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-8">🔹 <strong>تمارين تطبيقية</strong></h2>
<h3 id="التمرين-1-دمج-شهري">✅ التمرين 1: دمج شهري</h3>
<p>أنشئ جدولين لشهر يناير وفبراير، ثم ادمجهما باستخدام <code>concat</code>.</p>
<h3 id="التمرين-2-ربط-بيانات">✅ التمرين 2: ربط بيانات</h3>
<p>لديك جدول “المنتجات” وجدول “المخزون”، اربطهما بـ <code>merge</code> باستخدام “المنتج”.</p>
<h3 id="التمرين-3-left-join">✅ التمرين 3: left join</h3>
<p>استخدم <code>how='left'</code> لعرض جميع الطلبات، حتى التي لا يُعرف فيها العميل.</p>
<h3 id="التمرين-4-دمج-أفقي">✅ التمرين 4: دمج أفقي</h3>
<p>ادمج عمود “الراتب” مع جدول “الموظفين” أفقيًا.</p>
<hr />
<h2 id="الربط-بالواقع-نظام-مبيعات-متكامل">🔹 <strong>الربط بالواقع: نظام مبيعات متكامل</strong></h2>
<h3 id="الهدف-بناء-تقرير-مبيعات-شامل">🎯 الهدف: بناء تقرير مبيعات شامل</h3>
<div class="sourceCode" id="cb143"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true"></a><span class="co"># 1. دمج بيانات 3 أشهر</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true"></a>q1_sales <span class="op">=</span> pd.concat([jan, feb, mar], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true"></a><span class="co"># 2. ربط الطلبات بالعملاء</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true"></a>detailed_orders <span class="op">=</span> pd.merge(orders, customers, on<span class="op">=</span><span class="st">&#39;ID&#39;</span>, how<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true"></a></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true"></a><span class="co"># 3. حساب الإجمالي</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true"></a>detailed_orders[<span class="st">&#39;الإجمالي&#39;</span>] <span class="op">=</span> detailed_orders[<span class="st">&#39;الكمية&#39;</span>] <span class="op">*</span> detailed_orders[<span class="st">&#39;السعر&#39;</span>]</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true"></a></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true"></a><span class="co"># 4. تقرير نهائي</span></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true"></a>final_report <span class="op">=</span> detailed_orders[[<span class="st">&#39;الاسم&#39;</span>, <span class="st">&#39;المدينة&#39;</span>, <span class="st">&#39;المنتج&#39;</span>, <span class="st">&#39;الإجمالي&#39;</span>]]</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📌 تقرير المبيعات التفصيلي:&quot;</span>)</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true"></a><span class="bu">print</span>(final_report)</span></code></pre></div>
<blockquote>
<p>✅ هذا هو الشكل النهائي لتحليل البيانات في الشركات.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-8">🔹 <strong>نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>merge()</code> عندما يكون هناك علاقة منطقية (مفتاح مشترك).</li>
<li>✅ استخدم <code>concat()</code> لدمج بيانات متجانسة (مثل بيانات شهرية).</li>
<li>✅ تحقق من أنواع البيانات في العمود المشترك (مثلاً: <code>ID</code> يجب أن يكون نفس النوع).</li>
<li>✅ استخدم <code>validate='one_to_many'</code> للتأكد من نوع العلاقة.</li>
<li>✅ وثّق نوع الـ join المستخدم في التقرير.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-8">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>concat</code> و <code>merge</code>؟</li>
<li>متى نستخدم <code>how='left'</code>؟</li>
<li>ما معنى <code>ignore_index=True</code> في <code>concat</code>؟</li>
<li>كيف تدمج جدولين ليس لهما نفس الأعمدة؟</li>
<li>ماذا يحدث إذا كان العمود المشترك به تكرار؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-8">🔹 <strong>مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>الأداة</th>
<th>الاستخدام</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pd.concat()</code></td>
<td>دمج جداول رأسيًا أو أفقيًا</td>
</tr>
<tr class="even">
<td><code>pd.merge()</code></td>
<td>ربط جدولين بعمود مشترك</td>
</tr>
<tr class="odd">
<td><code>how='inner'</code></td>
<td>فقط الصفوف المشتركة</td>
</tr>
<tr class="even">
<td><code>how='left'</code></td>
<td>كل صفوف الجدول الأيسر</td>
</tr>
<tr class="odd">
<td><code>on='col'</code></td>
<td>العمود المشترك</td>
</tr>
<tr class="even">
<td><code>ignore_index=True</code></td>
<td>إعادة ترقيم الصفوف</td>
</tr>
</tbody>
</table>
<h1 id="الدرس-11-التعامل-مع-الأعمدة-الزمنية-pd.to_datetime-و-.dt-و-تصفية-التواريخ-1">📘 <strong>الدرس 11 : التعامل مع الأعمدة الزمنية: <code>pd.to_datetime()</code> و <code>.dt</code> و تصفية التواريخ</strong></h1>
<h2 id="مقدمة-لماذا-التواريخ-مهمة-في-تحليل-البيانات">🔹 <strong>مقدمة: لماذا التواريخ مهمة في تحليل البيانات؟</strong></h2>
<p>في أي مشروع تحليل بيانات — سواء في <strong>المبيعات، التداول، أو الموارد البشرية</strong> — فإن <strong>الزمن</strong> هو بُعد حاسم.</p>
<p>أسئلة مثل: - ما إجمالي المبيعات في <strong>الربع الأول</strong>؟ - متى كان <strong>أعلى نشاط تداول</strong>؟ - كم عدد الموظفين الذين انضموا في <strong>الشهر الماضي</strong>؟</p>
<p>تتطلب جميعها <strong>فهمًا دقيقًا للتواريخ</strong>.</p>
<p>لهذا، Pandas توفر أدوات قوية جدًا للتعامل مع البيانات الزمنية.</p>
<hr />
<h2 id="تحويل-النص-إلى-تاريخ-pd.to_datetime">🔹 <strong>1. تحويل النص إلى تاريخ: <code>pd.to_datetime()</code></strong></h2>
<p>غالبًا ما تكون التواريخ في الملفات كـ <strong>نصوص</strong> (مثل <code>'2023-01-01'</code>)، ويجب تحويلها إلى نوع <code>datetime</code> لتطبيق العمليات الزمنية.</p>
<h3 id="المثال-1-تحويل-عمود-نصي-إلى-تاريخ">📌 المثال 1: تحويل عمود نصي إلى تاريخ</h3>
<div class="sourceCode" id="cb144"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true"></a></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true"></a>data <span class="op">=</span> {</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true"></a>    <span class="st">&#39;التاريخ&#39;</span>: [<span class="st">&#39;2023-01-01&#39;</span>, <span class="st">&#39;2023-01-02&#39;</span>, <span class="st">&#39;2023-01-03&#39;</span>, <span class="st">&#39;04/01/2023&#39;</span>],</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;تفاح&#39;</span>, <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;حليب&#39;</span>, <span class="st">&#39;لابتوب&#39;</span>],</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true"></a>    <span class="st">&#39;الإجمالي&#39;</span>: [<span class="dv">350</span>, <span class="dv">300</span>, <span class="dv">400</span>, <span class="dv">2500</span>]</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true"></a>}</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true"></a></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true"></a><span class="co"># تحويل العمود إلى datetime</span></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true"></a>df[<span class="st">&#39;التاريخ&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;التاريخ&#39;</span>])</span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true"></a><span class="bu">print</span>(df.dtypes)</span></code></pre></div>
<h4 id="الناتج-52">🔍 الناتج:</h4>
<pre><code>التاريخ      datetime64[ns]
المنتج              object
الإجمالي            float64
dtype: object</code></pre>
<blockquote>
<p>✅ الآن يمكننا التعامل مع العمود كـ “تاريخ”.</p>
</blockquote>
<hr />
<h3 id="دعم-تنسيقات-متعددة-تلقائيا">✅ دعم تنسيقات متعددة تلقائيًا</h3>
<p><code>pd.to_datetime()</code> يفهم تلقائيًا: - <code>'2023-01-01'</code> - <code>'01/01/2023'</code> - <code>'Jan 1, 2023'</code> - <code>'01-Jan-2023'</code></p>
<blockquote>
<p>⚠️ لكن يُفضل توحيد التنسيق.</p>
</blockquote>
<hr />
<h3 id="تحديد-التنسيق-يدويا-لتحسين-الأداء">✅ تحديد التنسيق يدويًا (لتحسين الأداء)</h3>
<p>إذا كنت تعرف التنسيق، استخدم <code>format=</code>:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true"></a>df[<span class="st">&#39;التاريخ&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;التاريخ&#39;</span>], <span class="bu">format</span><span class="op">=</span><span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y&#39;</span>)</span></code></pre></div>
<blockquote>
<p>✅ أسرع وأكثر دقة.</p>
</blockquote>
<hr />
<h2 id="استخراج-مكونات-التاريخ-.dt">🔹 <strong>2. استخراج مكونات التاريخ: <code>.dt</code></strong></h2>
<p>بمجرد أن يصبح العمود من نوع <code>datetime</code>، يمكنك استخدام <code>.dt</code> لاستخراج: - السنة - الشهر - اليوم - اليوم من الأسبوع - الربع - وغيرها</p>
<h3 id="المثال-2-استخراج-السنة-والشهر">📌 المثال 2: استخراج السنة والشهر</h3>
<div class="sourceCode" id="cb147"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true"></a>df[<span class="st">&#39;السنة&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;التاريخ&#39;</span>].dt.year</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true"></a>df[<span class="st">&#39;الشهر&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;التاريخ&#39;</span>].dt.month</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true"></a>df[<span class="st">&#39;اليوم&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;التاريخ&#39;</span>].dt.day</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true"></a>df[<span class="st">&#39;اليوم_من_الأسبوع&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;التاريخ&#39;</span>].dt.day_name()</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true"></a>df[<span class="st">&#39;الربع&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;التاريخ&#39;</span>].dt.quarter</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true"></a></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true"></a><span class="bu">print</span>(df)</span></code></pre></div>
<h4 id="الناتج-53">🔍 الناتج:</h4>
<pre><code>    التاريخ  المنتج  الإجمالي  السنة  الشهر  اليوم  اليوم_من_الأسبوع  الربع
0 2023-01-01   تفاح     350.0  2023      1      1         Monday      1
1 2023-01-02    موز     300.0  2023      1      2        Tuesday      1
2 2023-01-03   حليب     400.0  2023      1      3      Wednesday      1
3 2023-01-04  لابتوب    2500.0  2023      1      4       Thursday      1</code></pre>
<blockquote>
<p>✅ الآن يمكن التجميع حسب الشهر أو اليوم.</p>
</blockquote>
<hr />
<h2 id="تصفية-البيانات-حسب-التاريخ">🔹 <strong>3. تصفية البيانات حسب التاريخ</strong></h2>
<h3 id="المثال-3-المبيعات-في-يناير-فقط">📌 المثال 3: المبيعات في يناير فقط</h3>
<div class="sourceCode" id="cb149"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true"></a>jan_sales <span class="op">=</span> df[df[<span class="st">&#39;التاريخ&#39;</span>].dt.month <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true"></a><span class="bu">print</span>(jan_sales)</span></code></pre></div>
<hr />
<h3 id="المثال-4-المبيعات-بين-تاريخين">📌 المثال 4: المبيعات بين تاريخين</h3>
<div class="sourceCode" id="cb150"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true"></a>start <span class="op">=</span> <span class="st">&#39;2023-01-01&#39;</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true"></a>end <span class="op">=</span> <span class="st">&#39;2023-01-03&#39;</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true"></a></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true"></a>filtered <span class="op">=</span> df[(df[<span class="st">&#39;التاريخ&#39;</span>] <span class="op">&gt;=</span> start) <span class="op">&amp;</span> (df[<span class="st">&#39;التاريخ&#39;</span>] <span class="op">&lt;=</span> end)]</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true"></a><span class="bu">print</span>(filtered)</span></code></pre></div>
<blockquote>
<p>✅ نفس الفلترة الشرطية، لكن مع تواريخ.</p>
</blockquote>
<hr />
<h3 id="المثال-5-استخدام-between-مع-التواريخ">📌 المثال 5: استخدام <code>between()</code> مع التواريخ</h3>
<div class="sourceCode" id="cb151"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true"></a>filtered <span class="op">=</span> df[df[<span class="st">&#39;التاريخ&#39;</span>].between(<span class="st">&#39;2023-01-01&#39;</span>, <span class="st">&#39;2023-01-02&#39;</span>)]</span></code></pre></div>
<hr />
<h2 id="التواريخ-الخاصة-pd.timestamp-و-pd.timedelta">🔹 <strong>4. التواريخ الخاصة: <code>pd.Timestamp</code> و <code>pd.Timedelta</code></strong></h2>
<h3 id="pd.timestamp-كائن-تاريخ-دقيق">✅ <code>pd.Timestamp</code> — كائن تاريخ دقيق</h3>
<div class="sourceCode" id="cb152"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true"></a>today <span class="op">=</span> pd.Timestamp(<span class="st">&#39;2023-10-01&#39;</span>)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true"></a><span class="bu">print</span>(today.year, today.month)</span></code></pre></div>
<hr />
<h3 id="pd.timedelta-فرق-زمني">✅ <code>pd.Timedelta</code> — فرق زمني</h3>
<div class="sourceCode" id="cb153"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true"></a><span class="co"># إضافة 7 أيام</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true"></a>df[<span class="st">&#39;تاريخ_التسليم&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;التاريخ&#39;</span>] <span class="op">+</span> pd.Timedelta(days<span class="op">=</span><span class="dv">7</span>)</span></code></pre></div>
<hr />
<h2 id="الأخطاء-الشائعة-تحليل-معمق-9">🔹 <strong>5. الأخطاء الشائعة (تحليل معمق)</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>OutOfBoundsDatetime</code></td>
<td>تاريخ خارج النطاق (مثلاً: 10000)</td>
<td>تحقق من البيانات</td>
</tr>
<tr class="even">
<td><code>TypeError</code> عند <code>.dt</code></td>
<td>العمود ليس من نوع <code>datetime</code></td>
<td>تأكد من <code>pd.to_datetime()</code></td>
</tr>
<tr class="odd">
<td><code>SettingWithCopyWarning</code></td>
<td>تعديل على نسخة</td>
<td>استخدم <code>.copy()</code> أو <code>loc</code></td>
</tr>
<tr class="even">
<td>التاريخ يُعرض كـ <code>2023-01-01 00:00:00</code></td>
<td>لأن <code>datetime</code> يحتوي على وقت</td>
<td>استخدم <code>.dt.date</code> لعرض التاريخ فقط</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-9">🔹 <strong>تمارين تطبيقية</strong></h2>
<h3 id="التمرين-1-تحويل-تواريخ">✅ التمرين 1: تحويل تواريخ</h3>
<p>لديك عمود <code>'2023/01/01'</code>, <code>'02-01-2023'</code> — حوله إلى <code>datetime</code>.</p>
<h3 id="التمرين-2-استخراج-الشهر">✅ التمرين 2: استخراج الشهر</h3>
<p>أنشئ عمودًا جديدًا باسم “اسم الشهر” (يناير، فبراير…).</p>
<h3 id="التمرين-3-تصفية-أسبوعية">✅ التمرين 3: تصفية أسبوعية</h3>
<p>أظهر المبيعات من يوم الإثنين إلى الأربعاء فقط.</p>
<h3 id="التمرين-4-حساب-الفرق">✅ التمرين 4: حساب الفرق</h3>
<p>احسب عدد الأيام بين “التاريخ” و“تاريخ التسليم”.</p>
<hr />
<h2 id="الربط-بالواقع-تحليل-مبيعات-ربع-سنوية">🔹 <strong>الربط بالواقع: تحليل مبيعات ربع سنوية</strong></h2>
<h3 id="الهدف-إعداد-تقرير-زمني">🎯 الهدف: إعداد تقرير زمني</h3>
<div class="sourceCode" id="cb154"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true"></a><span class="co"># 1. تحويل التاريخ</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true"></a>df[<span class="st">&#39;التاريخ&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;التاريخ&#39;</span>])</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true"></a></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true"></a><span class="co"># 2. استخراج الربع</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true"></a>df[<span class="st">&#39;الربع&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;التاريخ&#39;</span>].dt.quarter</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true"></a></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true"></a><span class="co"># 3. تجميع المبيعات حسب الربع</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true"></a>quarterly_sales <span class="op">=</span> df.groupby(<span class="st">&#39;الربع&#39;</span>)[<span class="st">&#39;الإجمالي&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true"></a></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📈 المبيعات حسب الربع:&quot;</span>)</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true"></a><span class="bu">print</span>(quarterly_sales)</span></code></pre></div>
<h4 id="الناتج-54">🔍 الناتج:</h4>
<pre><code>📈 المبيعات حسب الربع:
الربع
1    3550.0
Name: الإجمالي, dtype: float64</code></pre>
<blockquote>
<p>✅ هذا التقرير يُستخدم في اجتماعات الإدارة.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-9">🔹 <strong>نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ دائمًا حول الأعمدة الزمنية إلى <code>datetime</code> في بداية التحليل.</li>
<li>✅ استخدم <code>.dt.strftime('%B')</code> للحصول على اسم الشهر بالعربي أو الإنجليزي.</li>
<li>✅ تجنب تخزين التواريخ كنصوص — يُصعّب التحليل.</li>
<li>✅ استخدم <code>df['التاريخ'].min()</code> و <code>.max()</code> لمعرفة مدى البيانات الزمنية.</li>
<li>✅ احفظ التواريخ بتنسيق قياسي: <code>YYYY-MM-DD</code>.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-9">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>pd.to_datetime()</code> و <code>.dt</code>؟</li>
<li>كيف تُرجع اسم الشهر من التاريخ؟</li>
<li>ما معنى <code>pd.Timedelta(days=1)</code>؟</li>
<li>كيف تُرجع المبيعات في الأسبوع الأول من الشهر؟</li>
<li>لماذا يجب تحويل النص إلى <code>datetime</code> قبل التحليل؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-9">🔹 <strong>مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>الأداة</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pd.to_datetime()</code></td>
<td>تحويل نص إلى تاريخ</td>
</tr>
<tr class="even">
<td><code>.dt.year</code></td>
<td>استخراج السنة</td>
</tr>
<tr class="odd">
<td><code>.dt.month</code></td>
<td>استخراج الشهر</td>
</tr>
<tr class="even">
<td><code>.dt.day_name()</code></td>
<td>اسم اليوم</td>
</tr>
<tr class="odd">
<td><code>.dt.quarter</code></td>
<td>الربع</td>
</tr>
<tr class="even">
<td><code>.between()</code></td>
<td>تصفية نطاق تواريخ</td>
</tr>
<tr class="odd">
<td><code>pd.Timedelta</code></td>
<td>إضافة/طرح أيام</td>
</tr>
</tbody>
</table>
<h1 id="الدرس-12-حفظ-البيانات-إلى-ملفات-باستخدام-to_csv-و-to_excel-1">📘 <strong>الدرس 12 : حفظ البيانات إلى ملفات باستخدام <code>to_csv</code> و <code>to_excel</code></strong></h1>
<h2 id="مقدمة-لماذا-نحفظ-البيانات">🔹 <strong>مقدمة: لماذا نحفظ البيانات؟</strong></h2>
<p>بعد أن تُحلّل البيانات، وتُنظّف، وتُجمّع، وتُرتّب —<br />
يجب أن <strong>تحفظ النتائج</strong> لـ: - مشاركتها مع الفريق - إرسالها إلى الإدارة - استخدامها في تقارير إكسل - حفظها كنسخة احتياطية - إدخالها في أنظمة أخرى</p>
<p>لهذا، Pandas توفر أدوات بسيطة وقوية لحفظ البيانات إلى ملفات.</p>
<hr />
<h2 id="حفظ-إلى-ملف-csv-to_csv">🔹 <strong>1. حفظ إلى ملف CSV: <code>to_csv()</code></strong></h2>
<h3 id="الطريقة-الأساسية">✅ الطريقة الأساسية</h3>
<div class="sourceCode" id="cb156"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true"></a></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true"></a>data <span class="op">=</span> {</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;تفاح&#39;</span>, <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;لابتوب&#39;</span>],</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true"></a>    <span class="st">&#39;السعر&#39;</span>: [<span class="fl">3.5</span>, <span class="fl">2.0</span>, <span class="dv">2500</span>],</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true"></a>    <span class="st">&#39;الكمية&#39;</span>: [<span class="dv">50</span>, <span class="dv">30</span>, <span class="dv">5</span>],</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true"></a>    <span class="st">&#39;الإجمالي&#39;</span>: [<span class="fl">175.0</span>, <span class="fl">60.0</span>, <span class="fl">12500.0</span>]</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true"></a>}</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true"></a></span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true"></a><span class="co"># حفظ إلى ملف CSV</span></span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true"></a>df.to_csv(<span class="st">&#39;mohamad_sales.csv&#39;</span>)</span></code></pre></div>
<blockquote>
<p>✅ تم إنشاء ملف باسم <code>mohamad_sales.csv</code> في المجلد الحالي.</p>
</blockquote>
<hr />
<h3 id="خيارات-مهمة-في-to_csv">✅ خيارات مهمة في <code>to_csv()</code></h3>
<table>
<thead>
<tr class="header">
<th>الخيار</th>
<th>الوظيفة</th>
<th>مثال</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>index=False</code></td>
<td>عدم حفظ الفهرس (مهم!)</td>
<td><code>to_csv('file.csv', index=False)</code></td>
</tr>
<tr class="even">
<td><code>encoding='utf-8'</code></td>
<td>دعم اللغة العربية</td>
<td><code>encoding='utf-8-sig'</code></td>
</tr>
<tr class="odd">
<td><code>sep=';'</code></td>
<td>تغيير الفاصل</td>
<td>مفيد في بعض البرامج</td>
</tr>
<tr class="even">
<td><code>columns=[...]</code></td>
<td>حفظ أعمدة محددة فقط</td>
<td><code>columns=['المنتج', 'الإجمالي']</code></td>
</tr>
<tr class="odd">
<td><code>mode='a'</code></td>
<td>إضافة إلى الملف (append)</td>
<td>لدمج بيانات جديدة</td>
</tr>
</tbody>
</table>
<h3 id="المثال-1-حفظ-بدون-فهرس-وبدعم-عربي">📌 المثال 1: حفظ بدون فهرس وبدعم عربي</h3>
<div class="sourceCode" id="cb157"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true"></a>df.to_csv(<span class="st">&#39;sales_arabic.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8-sig&#39;</span>)</span></code></pre></div>
<blockquote>
<p>✅ ضروري لعرض النصوص العربية بشكل صحيح في إكسل.</p>
</blockquote>
<hr />
<h3 id="المثال-2-إضافة-بيانات-إلى-ملف-موجود">📌 المثال 2: إضافة بيانات إلى ملف موجود</h3>
<div class="sourceCode" id="cb158"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true"></a><span class="co"># افترض أنك تريد إضافة شهر جديد</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true"></a>new_month <span class="op">=</span> pd.DataFrame({<span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;شاشة&#39;</span>], <span class="st">&#39;السعر&#39;</span>: [<span class="dv">800</span>], <span class="st">&#39;الكمية&#39;</span>: [<span class="dv">3</span>], <span class="st">&#39;الإجمالي&#39;</span>: [<span class="dv">2400</span>]})</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true"></a></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true"></a><span class="co"># حفظ في وضع &quot;إضافة&quot;</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true"></a>new_month.to_csv(<span class="st">&#39;sales_arabic.csv&#39;</span>, mode<span class="op">=</span><span class="st">&#39;a&#39;</span>, header<span class="op">=</span><span class="va">False</span>, index<span class="op">=</span><span class="va">False</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8-sig&#39;</span>)</span></code></pre></div>
<blockquote>
<p>✅ <code>header=False</code> لتجنب تكرار العناوين.</p>
</blockquote>
<hr />
<h2 id="حفظ-إلى-ملف-إكسل-to_excel">🔹 <strong>2. حفظ إلى ملف إكسل: <code>to_excel()</code></strong></h2>
<h3 id="الطريقة-الأساسية-1">✅ الطريقة الأساسية</h3>
<div class="sourceCode" id="cb159"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true"></a>df.to_excel(<span class="st">&#39;sales_report.xlsx&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<blockquote>
<p>⚠️ تحتاج تثبيت <code>openpyxl</code>:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true"></a><span class="ex">pip</span> install openpyxl</span></code></pre></div>
</blockquote>
<hr />
<h3 id="خيارات-مهمة-في-to_excel">✅ خيارات مهمة في <code>to_excel()</code></h3>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>الخيار</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>sheet_name='ورقة1'</code></td>
<td>تسمية الورقة</td>
</tr>
<tr class="even">
<td><code>index=False</code></td>
<td>عدم حفظ الفهرس</td>
</tr>
<tr class="odd">
<td><code>encoding='utf-8'</code></td>
<td>لا يدعمه <code>to_excel</code> مباشرة — لكن الملف يدعم العربية تلقائيًا</td>
</tr>
<tr class="even">
<td><code>startrow</code> و <code>startcol</code></td>
<td>البدء من صف وعمود معين</td>
</tr>
<tr class="odd">
<td><code>float_format='%.2f'</code></td>
<td>تنسيق الأرقام</td>
</tr>
</tbody>
</table>
<h3 id="المثال-3-حفظ-إلى-ورقة-محددة">📌 المثال 3: حفظ إلى ورقة محددة</h3>
<div class="sourceCode" id="cb161"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true"></a><span class="cf">with</span> pd.ExcelWriter(<span class="st">&#39;quarterly_report.xlsx&#39;</span>) <span class="im">as</span> writer:</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true"></a>    df.to_excel(writer, sheet_name<span class="op">=</span><span class="st">&#39;يناير&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true"></a>    df.to_excel(writer, sheet_name<span class="op">=</span><span class="st">&#39;فبراير&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<blockquote>
<p>✅ <code>ExcelWriter</code> يسمح بحفظ عدة أوراق في ملف واحد.</p>
</blockquote>
<hr />
<h3 id="المثال-4-تنسيق-الأرقام">📌 المثال 4: تنسيق الأرقام</h3>
<div class="sourceCode" id="cb162"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true"></a>df.to_excel(<span class="st">&#39;formatted.xlsx&#39;</span>, float_format<span class="op">=</span><span class="st">&#39;</span><span class="sc">%.1f</span><span class="st">&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<blockquote>
<p>✅ سيُعرض السعر 3.500 كـ 3.5</p>
</blockquote>
<hr />
<h2 id="حفظ-إلى-json-to_json">🔹 <strong>3. حفظ إلى JSON: <code>to_json()</code></strong></h2>
<p>مفيد للبيانات التي ستُستخدم في تطبيقات ويب أو APIs.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true"></a>df.to_json(<span class="st">&#39;data.json&#39;</span>, force_ascii<span class="op">=</span><span class="va">False</span>, orient<span class="op">=</span><span class="st">&#39;records&#39;</span>, indent<span class="op">=</span><span class="dv">4</span>)</span></code></pre></div>
<ul>
<li><code>force_ascii=False</code>: لدعم العربية</li>
<li><code>orient='records'</code>: كل صف ككائن</li>
<li><code>indent=4</code>: تنسيق جميل للقراءة</li>
</ul>
<hr />
<h2 id="الأخطاء-الشائعة-تحليل-معمق-10">🔹 <strong>4. الأخطاء الشائعة (تحليل معمق)</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>FileNotFoundError</code></td>
<td>المجلد غير موجود</td>
<td>تأكد من المسار أو أنشئ المجلد</td>
</tr>
<tr class="even">
<td><code>PermissionError</code></td>
<td>الملف مفتوح في إكسل</td>
<td>أغلق الملف أولًا</td>
</tr>
<tr class="odd">
<td>النصوص العربية تظهر مشوّشة</td>
<td>ترميز خاطئ</td>
<td>استخدم <code>utf-8-sig</code></td>
</tr>
<tr class="even">
<td>الفهرس يُحفظ كعمود</td>
<td>لأن <code>index=True</code> (الافتراضي)</td>
<td>استخدم <code>index=False</code></td>
</tr>
<tr class="odd">
<td><code>ModuleNotFoundError: No module named 'openpyxl'</code></td>
<td>لم يتم تثبيت المكتبة</td>
<td><code>pip install openpyxl</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-10">🔹 <strong>تمارين تطبيقية</strong></h2>
<h3 id="التمرين-1-حفظ-تقرير-مبيعات">✅ التمرين 1: حفظ تقرير مبيعات</h3>
<p>حوّل جدول مبيعاتك إلى ملف CSV بدون فهرس وبترميز عربي.</p>
<h3 id="التمرين-2-إضافة-بيانات">✅ التمرين 2: إضافة بيانات</h3>
<p>أنشئ ملفًا جديدًا، ثم أضف إليه بيانات شهر جديد.</p>
<h3 id="التمرين-3-تقرير-إكسل-متعدد-الأوراق">✅ التمرين 3: تقرير إكسل متعدد الأوراق</h3>
<p>احفظ 3 جداول (يناير، فبراير، مارس) في ملف إكسل واحد بأوراق منفصلة.</p>
<h3 id="التمرين-4-تصدير-لـ-json">✅ التمرين 4: تصدير لـ JSON</h3>
<p>حوّل جدول العملاء إلى ملف JSON لاستخدامه في تطبيق ويب.</p>
<hr />
<h2 id="الربط-بالواقع-تصدير-تقرير-شهري">🔹 <strong>الربط بالواقع: تصدير تقرير شهري</strong></h2>
<h3 id="الهدف-إرسال-التقرير-للإدارة">🎯 الهدف: إرسال التقرير للإدارة</h3>
<div class="sourceCode" id="cb164"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true"></a><span class="co"># افترض أن لديك تقرير أداء</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true"></a>report <span class="op">=</span> pd.DataFrame({</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true"></a>    <span class="st">&#39;الموظف&#39;</span>: [<span class="st">&#39;أحمد&#39;</span>, <span class="st">&#39;سارة&#39;</span>],</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true"></a>    <span class="st">&#39;المبيعات&#39;</span>: [<span class="dv">15000</span>, <span class="dv">22000</span>],</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true"></a>    <span class="st">&#39;الأداء&#39;</span>: [<span class="st">&#39;جيد&#39;</span>, <span class="st">&#39;ممتاز&#39;</span>]</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true"></a>})</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true"></a></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true"></a><span class="co"># 1. حفظ كـ CSV للتحليل الآلي</span></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true"></a>report.to_csv(<span class="st">&#39;monthly_report.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8-sig&#39;</span>)</span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true"></a></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true"></a><span class="co"># 2. حفظ كـ إكسل لتوزيعه على الإدارة</span></span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true"></a><span class="cf">with</span> pd.ExcelWriter(<span class="st">&#39;monthly_report_manager.xlsx&#39;</span>) <span class="im">as</span> writer:</span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true"></a>    report.to_excel(writer, sheet_name<span class="op">=</span><span class="st">&#39;التقرير&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true"></a></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;✅ التقرير تم تصديره بنجاح إلى CSV وإكسل.&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا هو الشكل النهائي لأي مشروع تحليل بيانات.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-10">🔹 <strong>نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم دائمًا <code>index=False</code> ما لم تكن بحاجة للفهرس.</li>
<li>✅ استخدم <code>utf-8-sig</code> لضمان ظهور العربية بشكل صحيح.</li>
<li>✅ تجنب حفظ الملفات في مجلدات النظام (مثل C:).</li>
<li>✅ وثّق مسار الحفظ في تعليق: <code># تم الحفظ في ./output/</code></li>
<li>✅ استخدم <code>os.path</code> أو <code>pathlib</code> لإنشاء مسارات ديناميكية.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-10">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>لماذا نستخدم <code>index=False</code> عند الحفظ؟</li>
<li>ما الفرق بين <code>to_csv</code> و <code>to_excel</code>؟</li>
<li>كيف تُرجع ملف إكسل به عدة أوراق؟</li>
<li>ما معنى <code>utf-8-sig</code>؟</li>
<li>كيف تُضيف بيانات إلى ملف CSV موجود؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-10">🔹 <strong>مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>الدالة</th>
<th>الاستخدام</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>to_csv()</code></td>
<td>حفظ كملف نصي منفصل بفواصل</td>
</tr>
<tr class="even">
<td><code>to_excel()</code></td>
<td>حفظ في ملف إكسل (يحتاج <code>openpyxl</code>)</td>
</tr>
<tr class="odd">
<td><code>to_json()</code></td>
<td>حفظ للواجهات البرمجية</td>
</tr>
<tr class="even">
<td><code>index=False</code></td>
<td>عدم حفظ الفهرس</td>
</tr>
<tr class="odd">
<td><code>encoding='utf-8-sig'</code></td>
<td>دعم اللغة العربية</td>
</tr>
<tr class="even">
<td><code>mode='a'</code></td>
<td>إضافة إلى الملف</td>
</tr>
</tbody>
</table>
<h1 id="جدول-مرجعي-سريع-أهم-دوال-pandas-مع-وصف-بسيط">📘 <strong>جدول مرجعي سريع: أهم دوال Pandas مع وصف بسيط</strong></h1>
<table>
<colgroup>
<col style="width: 18%" />
<col style="width: 32%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="header">
<th>الدالة</th>
<th>الوصف البسيط</th>
<th>الاستخدام النموذجي</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pd.DataFrame(data)</code></td>
<td>ينشئ جدول بيانات (DataFrame) من قاموس، قائمة، أو مصفوفة</td>
<td><code>df = pd.DataFrame({'A': [1,2], 'B': [3,4]})</code></td>
</tr>
<tr class="even">
<td><code>pd.read_csv('file.csv')</code></td>
<td>يقرأ ملف CSV ويحوله إلى DataFrame</td>
<td><code>df = pd.read_csv('data.csv')</code></td>
</tr>
<tr class="odd">
<td><code>pd.read_excel('file.xlsx')</code></td>
<td>يقرأ ملف إكسل (ورقة واحدة أو أكثر)</td>
<td><code>df = pd.read_excel('data.xlsx', sheet_name='Sheet1')</code></td>
</tr>
<tr class="even">
<td><code>pd.read_json('file.json')</code></td>
<td>يقرأ ملف JSON ويحوله إلى DataFrame</td>
<td><code>df = pd.read_json('data.json')</code></td>
</tr>
<tr class="odd">
<td><code>df.info()</code></td>
<td>يعرض معلومات عامة عن الجدول: الأعمدة، الأنواع، القيم المفقودة</td>
<td><code>df.info()</code></td>
</tr>
<tr class="even">
<td><code>df.dtypes</code></td>
<td>يعرض نوع البيانات لكل عمود</td>
<td><code>print(df.dtypes)</code></td>
</tr>
<tr class="odd">
<td><code>df.shape</code></td>
<td>يُرجع عدد الصفوف والأعمدة (مثل: (100, 5))</td>
<td><code>rows, cols = df.shape</code></td>
</tr>
<tr class="even">
<td><code>df.describe()</code></td>
<td>يعرض إحصائيات رقمية: المتوسط، الانحراف، القيم القصوى</td>
<td><code>df.describe()</code></td>
</tr>
<tr class="odd">
<td><code>df.head(n)</code></td>
<td>يعرض أول <code>n</code> صفوف (الافتراضي: 5)</td>
<td><code>df.head(3)</code></td>
</tr>
<tr class="even">
<td><code>df.tail(n)</code></td>
<td>يعرض آخر <code>n</code> صفوف</td>
<td><code>df.tail(2)</code></td>
</tr>
<tr class="odd">
<td><code>df.isnull()</code></td>
<td>يُرجع <code>True</code> في الخلايا التي تحتوي على قيم مفقودة</td>
<td><code>df.isnull()</code></td>
</tr>
<tr class="even">
<td><code>df.isnull().sum()</code></td>
<td>يحسب عدد القيم المفقودة في كل عمود</td>
<td><code>df.isnull().sum()</code></td>
</tr>
<tr class="odd">
<td><code>df.dropna()</code></td>
<td>يحذف الصفوف (أو الأعمدة) التي تحتوي على قيم مفقودة</td>
<td><code>df.dropna()</code></td>
</tr>
<tr class="even">
<td><code>df.fillna(value)</code></td>
<td>يملأ القيم المفقودة بقيمة معينة</td>
<td><code>df.fillna(0)</code> أو <code>df.fillna(df.mean())</code></td>
</tr>
<tr class="odd">
<td><code>df['column']</code></td>
<td>يُرجع عمودًا كـ <code>Series</code></td>
<td><code>df['الاسم']</code></td>
</tr>
<tr class="even">
<td><code>df[['col1', 'col2']]</code></td>
<td>يُرجع أعمدة محددة كـ <code>DataFrame</code></td>
<td><code>df[['الاسم', 'العمر']]</code></td>
</tr>
<tr class="odd">
<td><code>df.loc[row, col]</code></td>
<td>يُرجع بيانات بالاسم (العلامة)، مثل: الصف “0”، العمود “الاسم”</td>
<td><code>df.loc[0, 'الاسم']</code></td>
</tr>
<tr class="even">
<td><code>df.iloc[row, col]</code></td>
<td>يُرجع بيانات بالرقم (الفهرس العددي)</td>
<td><code>df.iloc[0, 1]</code></td>
</tr>
<tr class="odd">
<td><code>df[df['العمر'] &gt; 25]</code></td>
<td>يُرجع الصفوف التي تحقق الشرط (الفلترة)</td>
<td><code>df[df['السعر'] &gt; 100]</code></td>
</tr>
<tr class="even">
<td><code>(df['A'] &gt; 5) &amp; (df['B'] &lt; 3)</code></td>
<td>شرط منطقي باستخدام AND</td>
<td>استخدم دائمًا <code>()</code> مع <code>&amp;</code> و <code>|</code></td>
</tr>
<tr class="odd">
<td><code>(df['A'] == 1) \| (df['B'] == 2)</code></td>
<td>شرط منطقي باستخدام OR</td>
<td>استخدم <code>\|</code> بدل <code>or</code></td>
</tr>
<tr class="even">
<td><code>df['المنتج'].isin(['تفاح', 'موز'])</code></td>
<td>يتحقق مما إذا كانت القيمة في قائمة معينة</td>
<td><code>df[df['المنتج'].isin(['A','B'])]</code></td>
</tr>
<tr class="odd">
<td><code>df['السعر'].between(10, 100)</code></td>
<td>يتحقق مما إذا كانت القيمة ضمن نطاق معين</td>
<td><code>df[df['السعر'].between(10, 100)]</code></td>
</tr>
<tr class="even">
<td><code>df['جديد'] = df['A'] * df['B']</code></td>
<td>ينشئ عمودًا جديدًا</td>
<td><code>df['الإجمالي'] = df['السعر'] * df['الكمية']</code></td>
</tr>
<tr class="odd">
<td><code>df.rename(columns={'قديم': 'جديد'})</code></td>
<td>يغير اسم عمود</td>
<td><code>df.rename(columns={'الإسم': 'الاسم'})</code></td>
</tr>
<tr class="even">
<td><code>df.drop(columns=['A', 'B'])</code></td>
<td>يحذف أعمدة محددة</td>
<td><code>df.drop(columns=['الوقت'], inplace=True)</code></td>
</tr>
<tr class="odd">
<td><code>df.drop(index=[0, 1])</code></td>
<td>يحذف صفوفًا محددة</td>
<td><code>df.drop(index=0)</code></td>
</tr>
<tr class="even">
<td><code>df.groupby('الفئة').sum()</code></td>
<td>يجمع البيانات حسب عمود معين</td>
<td><code>df.groupby('المدينة')['الراتب'].mean()</code></td>
</tr>
<tr class="odd">
<td><code>df.sort_values('السعر', ascending=False)</code></td>
<td>يرتب البيانات تصاعديًا أو تنازليًا</td>
<td><code>df.sort_values('العمر')</code></td>
</tr>
<tr class="even">
<td><code>df.sort_index()</code></td>
<td>يرتب الجدول حسب الفهرس (index)</td>
<td>بعد <code>reset_index()</code></td>
</tr>
<tr class="odd">
<td><code>pd.concat([df1, df2])</code></td>
<td>يدمج جدولين رأسيًا (إضافة صفوف)</td>
<td><code>pd.concat([jan, feb], ignore_index=True)</code></td>
</tr>
<tr class="even">
<td><code>pd.merge(df1, df2, on='ID')</code></td>
<td>يربط جدولين بعمود مشترك (مثل JOIN في SQL)</td>
<td><code>pd.merge(orders, customers, on='ID')</code></td>
</tr>
<tr class="odd">
<td><code>pd.to_datetime(df['التاريخ'])</code></td>
<td>يحول عمود نصي إلى تاريخ</td>
<td><code>df['التاريخ'] = pd.to_datetime(...)</code></td>
</tr>
<tr class="even">
<td><code>df['التاريخ'].dt.month</code></td>
<td>يستخرج الشهر من تاريخ</td>
<td><code>.dt.year</code>, <code>.dt.day</code>, <code>.dt.day_name()</code></td>
</tr>
<tr class="odd">
<td><code>df.to_csv('file.csv', index=False)</code></td>
<td>يحفظ الجدول كملف CSV</td>
<td>استخدم <code>encoding='utf-8-sig'</code> للعربية</td>
</tr>
<tr class="even">
<td><code>df.to_excel('file.xlsx', index=False)</code></td>
<td>يحفظ الجدول كملف إكسل</td>
<td>يحتاج <code>openpyxl</code></td>
</tr>
<tr class="odd">
<td><code>df.to_json('file.json', force_ascii=False)</code></td>
<td>يحفظ الجدول كملف JSON</td>
<td>مفيد للتطبيقات والـ APIs</td>
</tr>
<tr class="even">
<td><code>df.reset_index(drop=True)</code></td>
<td>يعيد ترقيم الفهارس من 0</td>
<td>بعد الفلترة أو الحذف</td>
</tr>
<tr class="odd">
<td><code>df.copy()</code></td>
<td>ينشئ نسخة من الجدول (يتجنب التحذيرات)</td>
<td><code>new_df = df[df['A']&gt;5].copy()</code></td>
</tr>
<tr class="even">
<td><code>df.astype(int)</code></td>
<td>يغير نوع البيانات لعمود</td>
<td><code>df['العمر'] = df['العمر'].astype(int)</code></td>
</tr>
</tbody>
</table>
<h1 id="الدليل-المتقدم-لمكتبة-pandas-من-المتوسط-إلى-الاحتراف-from_good_to_greet">📘 <strong>الدليل المتقدم لمكتبة Pandas: من المتوسط إلى الاحتراف</strong> (from_good_to_greet)</h1>
<blockquote>
<p>✅ <strong>عدد الكلمات المستهدف: ~12,000 كلمة</strong><br />
✅ <strong>الجمهور: من أتقن الأساسيات ويريد الانتقال للتحليل العميق والتحضير للذكاء الاصطناعي</strong><br />
✅ <strong>الهيكل: 8 دروس متقدمة، كل درس موسع كما طلبت</strong></p>
</blockquote>
<hr />
<h2 id="الخطة-التعليمية-الفهرس-المبدئي">📚 <strong>الخطة التعليمية (الفهرس المبدئي)</strong></h2>
<ol type="1">
<li>🌀 <strong>معالجة متعددة المستويات</strong>: <code>MultiIndex</code>, <code>stack</code>, <code>unstack</code>, <code>swaplevel</code><br />
</li>
<li>🧮 <strong>العمليات الإحصائية المتقدمة</strong>: <code>rolling</code>, <code>expanding</code>, <code>ewm</code>, <code>cov</code>, <code>corr</code>, <code>rank</code>, <code>nlargest</code>, <code>nsmallest</code><br />
</li>
<li>📊 <strong>Pivot والتحليل العميق</strong>: <code>pivot</code>, <code>pivot_table</code>, <code>crosstab</code><br />
</li>
<li>🧠 <strong>التجهيز للذكاء الاصطناعي (ML)</strong>: <code>get_dummies</code>, <code>cut</code>, <code>qcut</code>, <code>map</code>, <code>replace</code>, <code>astype</code>, <code>query</code>, <code>eval</code><br />
</li>
<li>⏱️ <strong>البيانات الزمنية المتقدمة</strong>: <code>resample('1D')</code>, <code>asfreq</code>, <code>shift</code>, <code>diff</code>, <code>lag</code><br />
</li>
<li>🔧 <strong>التعامل مع الأخطاء والنسخ الآمن</strong>: <code>copy(deep=True)</code>, <code>SettingWithCopyWarning</code>, <code>errors='ignore'</code><br />
</li>
<li>💡 <strong>الوظائف المتقدمة</strong>: <code>apply</code>, <code>applymap</code>, <code>pipe</code>, <code>transform</code>, <code>filter</code><br />
</li>
<li>📎 <strong>الملحقات</strong>: مشروع تطبيقي (تحليل أسهم)، جدول دوال متقدم، فهرس كامل</li>
</ol>
<hr />
<h2 id="الدرس-1-معالجة-متعددة-المستويات-multiindex-stack-unstack-swaplevel">📘 <strong>الدرس 1 : 🌀 معالجة متعددة المستويات: <code>MultiIndex</code>, <code>stack</code>, <code>unstack</code>, <code>swaplevel</code></strong></h2>
<h3 id="مقدمة-لماذا-نحتاج-إلى-بيانات-متعددة-المستويات">🔹 <strong>مقدمة: لماذا نحتاج إلى بيانات متعددة المستويات؟</strong></h3>
<p>تخيل أنك محلل في شركة متعددة الفروع، ولديك بيانات مبيعات: - حسب <strong>السنة</strong> - ثم حسب <strong>الشهر</strong> - ثم حسب <strong>المدينة</strong> - ثم حسب <strong>الفئة</strong></p>
<p>إذا استخدمت عمودًا واحدًا لكل مستوى، سيكون التحليل فوضويًا.</p>
<p>هنا تأتي أهمية <strong>البنية الهرمية (MultiIndex)</strong> — وهي طريقة لتمثيل بيانات ذات أبعاد متعددة في جدول ثنائي الأبعاد.</p>
<hr />
<h3 id="إنشاء-multiindex">🔹 <strong>1. إنشاء <code>MultiIndex</code></strong></h3>
<h4 id="الطريقة-1-من-قائمة-من-الأزواج">✅ الطريقة 1: من قائمة من الأزواج</h4>
<div class="sourceCode" id="cb165"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true"></a></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true"></a><span class="co"># بيانات: (السنة، المدينة)</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true"></a>index <span class="op">=</span> pd.MultiIndex.from_tuples([</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true"></a>    (<span class="st">&#39;2023&#39;</span>, <span class="st">&#39;الرياض&#39;</span>),</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true"></a>    (<span class="st">&#39;2023&#39;</span>, <span class="st">&#39;جدة&#39;</span>),</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true"></a>    (<span class="st">&#39;2024&#39;</span>, <span class="st">&#39;الرياض&#39;</span>),</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true"></a>    (<span class="st">&#39;2024&#39;</span>, <span class="st">&#39;جدة&#39;</span>)</span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true"></a>], names<span class="op">=</span>[<span class="st">&#39;السنة&#39;</span>, <span class="st">&#39;المدينة&#39;</span>])</span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true"></a></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true"></a>data <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">120</span>, <span class="dv">180</span>]</span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">&#39;المبيعات&#39;</span>: data}, index<span class="op">=</span>index)</span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true"></a><span class="bu">print</span>(df)</span></code></pre></div>
<h4 id="الناتج-55">🔍 الناتج:</h4>
<pre><code>              المبيعات
السنة  المدينة         
2023  الرياض       100
      جدة         150
2024  الرياض       120
      جدة         180</code></pre>
<blockquote>
<p>✅ تم تمثيل بُعدين (السنة والمدينة) كفهرس هرمي.</p>
</blockquote>
<hr />
<h4 id="الطريقة-2-من-قوائم-باستخدام-from_product">✅ الطريقة 2: من قوائم باستخدام <code>from_product</code></h4>
<p>مفيد لتوليد كل التوافقات.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true"></a>years <span class="op">=</span> [<span class="st">&#39;2023&#39;</span>, <span class="st">&#39;2024&#39;</span>]</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true"></a>cities <span class="op">=</span> [<span class="st">&#39;الرياض&#39;</span>, <span class="st">&#39;جدة&#39;</span>, <span class="st">&#39;الدمام&#39;</span>]</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true"></a></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true"></a>index <span class="op">=</span> pd.MultiIndex.from_product([years, cities], names<span class="op">=</span>[<span class="st">&#39;السنة&#39;</span>, <span class="st">&#39;المدينة&#39;</span>])</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">&#39;المبيعات&#39;</span>: np.random.randint(<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">6</span>)}, index<span class="op">=</span>index)</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true"></a><span class="bu">print</span>(df)</span></code></pre></div>
<hr />
<h3 id="الوصول-إلى-البيانات-في-multiindex">🔹 <strong>2. الوصول إلى البيانات في <code>MultiIndex</code></strong></h3>
<h4 id="باستخدام-loc-مع-الأسماء">✅ باستخدام <code>loc</code> مع الأسماء</h4>
<div class="sourceCode" id="cb168"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true"></a><span class="co"># مبيعات 2023 فقط</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true"></a><span class="bu">print</span>(df.loc[<span class="st">&#39;2023&#39;</span>])</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true"></a></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true"></a><span class="co"># مبيعات الرياض فقط (جميع السنوات)</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true"></a><span class="bu">print</span>(df.xs(<span class="st">&#39;الرياض&#39;</span>, level<span class="op">=</span><span class="st">&#39;المدينة&#39;</span>))</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true"></a></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true"></a><span class="co"># مبيعات 2024 في الدمام</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true"></a><span class="bu">print</span>(df.loc[(<span class="st">&#39;2024&#39;</span>, <span class="st">&#39;الدمام&#39;</span>), <span class="st">&#39;المبيعات&#39;</span>])</span></code></pre></div>
<hr />
<h3 id="stack-و-unstack-تحويل-بين-الطول-والعرض">🔹 <strong>3. <code>stack()</code> و <code>unstack()</code> — تحويل بين الطول والعرض</strong></h3>
<h4 id="unstack-رفع-مستوى-من-الفهرس-إلى-أعمدة">✅ <code>unstack()</code> — رفع مستوى من الفهرس إلى أعمدة</h4>
<div class="sourceCode" id="cb169"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true"></a><span class="co"># تحويل المدينة إلى أعمدة</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true"></a>unstacked <span class="op">=</span> df.unstack(level<span class="op">=</span><span class="st">&#39;المدينة&#39;</span>)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true"></a><span class="bu">print</span>(unstacked)</span></code></pre></div>
<h4 id="الناتج-56">🔍 الناتج:</h4>
<pre><code>المدينة       الرياض  جدة  الدمام
السنة                         
2023          150  130    170
2024          160  140    180</code></pre>
<blockquote>
<p>✅ يشبه Pivot Table.</p>
</blockquote>
<hr />
<h4 id="stack-عكس-العملية">✅ <code>stack()</code> — عكس العملية</h4>
<div class="sourceCode" id="cb171"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true"></a>restacked <span class="op">=</span> unstacked.stack()</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true"></a><span class="bu">print</span>(restacked)</span></code></pre></div>
<blockquote>
<p>✅ يعيد البيانات إلى الشكل الهرمي.</p>
</blockquote>
<hr />
<h3 id="swaplevel-تبديل-مستويات-الفهرس">🔹 <strong>4. <code>swaplevel()</code> — تبديل مستويات الفهرس</strong></h3>
<div class="sourceCode" id="cb172"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true"></a><span class="co"># تبديل الترتيب: المدينة أولًا، ثم السنة</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true"></a>df_swapped <span class="op">=</span> df.swaplevel().sort_index()</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true"></a><span class="bu">print</span>(df_swapped)</span></code></pre></div>
<hr />
<h3 id="الأخطاء-الشائعة">🔹 <strong>5. الأخطاء الشائعة</strong></h3>
<table>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>KeyError</code> عند <code>loc</code></td>
<td>لم تستخدم قوسًا مزدوجًا</td>
<td><code>df.loc[('2023','الرياض')]</code></td>
</tr>
<tr class="even">
<td><code>unstack()</code> يُنتج <code>NaN</code></td>
<td>وجود تكرارات أو بيانات ناقصة</td>
<td>استخدم <code>fillna()</code> أولًا</td>
</tr>
<tr class="odd">
<td>الفهرس غير مرتب</td>
<td>يؤدي إلى أداء بطيء</td>
<td>استخدم <code>sort_index()</code></td>
</tr>
</tbody>
</table>
<hr />
<h3 id="تمارين">🔹 <strong>تمارين</strong></h3>
<ol type="1">
<li>أنشئ <code>MultiIndex</code> يمثل (المنتج، الفئة).</li>
<li>كيف تُرجع جميع بيانات “الإلكترونيات”؟</li>
<li>حول الجدول إلى شكل “عرضي” باستخدام <code>unstack</code>.</li>
</ol>
<hr />
<h3 id="الربط-بالواقع-تحليل-مبيعات-متعددة-الأبعاد">🔹 <strong>الربط بالواقع: تحليل مبيعات متعددة الأبعاد</strong></h3>
<div class="sourceCode" id="cb173"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true"></a><span class="co"># تحليل أداء الفروع حسب السنة والشهر</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true"></a>monthly_sales <span class="op">=</span> df.groupby([<span class="st">&#39;السنة&#39;</span>, <span class="st">&#39;المدينة&#39;</span>]).<span class="bu">sum</span>()</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true"></a>pivot_view <span class="op">=</span> monthly_sales.unstack(<span class="st">&#39;المدينة&#39;</span>)</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true"></a><span class="bu">print</span>(pivot_view)</span></code></pre></div>
<blockquote>
<p>✅ هذا الشكل يُستخدم في لوحات التحكم (Dashboards).</p>
</blockquote>
<hr />
<h3 id="نصائح-احترافية-11">🔹 <strong>نصائح احترافية</strong></h3>
<ul>
<li>استخدم <code>MultiIndex</code> عندما تكون لديك بيانات هرمية.</li>
<li>استخدم <code>xs()</code> للوصول إلى مستوى معين.</li>
<li>استخدم <code>sort_index()</code> بعد أي تعديل.</li>
<li>لا تُفرط في التعقيد — أحيانًا <code>pivot_table</code> أسهل.</li>
</ul>
<h1 id="الدرس-2-العمليات-الإحصائية-المتقدمة-rolling-expanding-ewm-cov-corr-rank-nlargest-nsmallest">📘 <strong>الدرس 2 : 🧮 العمليات الإحصائية المتقدمة: <code>rolling</code>, <code>expanding</code>, <code>ewm</code>, <code>cov</code>, <code>corr</code>, <code>rank</code>, <code>nlargest</code>, <code>nsmallest</code></strong></h1>
<h2 id="مقدمة-لماذا-نحتاج-إلى-إحصاءات-متقدمة">🔹 <strong>مقدمة: لماذا نحتاج إلى إحصاءات متقدمة؟</strong></h2>
<p>بعد تعلُّم المتوسطات والمجموعات الأساسية، تأتي مرحلة <strong>التحليل العميق</strong>.</p>
<p>في عالم التداول، التمويل، أو مراقبة الأداء، لا نكتفي بـ “متوسط المبيعات”، بل نسأل: - ما هو <strong>متوسط المبيعات خلال آخر 7 أيام</strong>؟ - كيف يتغير السعر <strong>بمرور الوقت</strong>؟ - هل هناك <strong>علاقة بين السعر وحجم التداول</strong>؟ - ما هي <strong>أفضل 3 منتجات</strong> من حيث الأداء؟</p>
<p>هنا تأتي أهمية الأدوات الإحصائية المتقدمة في Pandas.</p>
<hr />
<h2 id="rolling-النافذة-المتحركة-rolling-window">🔹 <strong>1. <code>rolling()</code> — النافذة المتحركة (Rolling Window)</strong></h2>
<p>تُستخدم لحساب إحصاءات على <strong>نافذة زمنية متحركة</strong> (مثلاً: آخر 5 أيام).</p>
<h3 id="المثال-1-متوسط-متحرك-للأسعار">📌 المثال 1: متوسط متحرك للأسعار</h3>
<div class="sourceCode" id="cb174"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true"></a></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true"></a><span class="co"># بيانات يومية لسعر سهم</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true"></a>dates <span class="op">=</span> pd.date_range(<span class="st">&#39;2023-01-01&#39;</span>, periods<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true"></a>prices <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">102</span>, <span class="dv">101</span>, <span class="dv">105</span>, <span class="dv">107</span>, <span class="dv">106</span>, <span class="dv">108</span>, <span class="dv">110</span>, <span class="dv">109</span>, <span class="dv">112</span>]</span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">&#39;السعر&#39;</span>: prices}, index<span class="op">=</span>dates)</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true"></a></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true"></a><span class="co"># متوسط متحرك على آخر 3 أيام</span></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true"></a>df[<span class="st">&#39;المتوسط_المتحرك&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].rolling(window<span class="op">=</span><span class="dv">3</span>).mean()</span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true"></a><span class="bu">print</span>(df)</span></code></pre></div>
<h4 id="الناتج-57">🔍 الناتج:</h4>
<pre><code>            السعر  المتوسط_المتحرك
2023-01-01  100             NaN
2023-01-02  102             NaN
2023-01-03  101       101.000000
2023-01-04  105       102.666667
2023-01-05  107       104.333333
...</code></pre>
<blockquote>
<p>✅ أول ناتجين <code>NaN</code> لأن النافذة تحتاج 3 قيم.</p>
</blockquote>
<hr />
<h3 id="دوال-متاحة-مع-rolling">✅ دوال متاحة مع <code>rolling</code></h3>
<ul>
<li><code>.mean()</code> — المتوسط المتحرك</li>
<li><code>.std()</code> — الانحراف المعياري المتحرك</li>
<li><code>.sum()</code> — المجموع المتحرك</li>
<li><code>.min()</code>, <code>.max()</code> — الحد الأدنى/الأقصى</li>
</ul>
<hr />
<h2 id="expanding-التوسع-التراكمي">🔹 <strong>2. <code>expanding()</code> — التوسع التراكمي</strong></h2>
<p>يحسب الإحصاء من البداية حتى النقطة الحالية.</p>
<h3 id="المثال-2-المتوسط-التراكمي">📌 المثال 2: المتوسط التراكمي</h3>
<div class="sourceCode" id="cb176"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true"></a>df[<span class="st">&#39;المتوسط_التراكمي&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].expanding().mean()</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true"></a><span class="bu">print</span>(df)</span></code></pre></div>
<h4 id="الناتج-58">🔍 الناتج:</h4>
<pre><code>            السعر  المتوسط_التراكمي
2023-01-01  100          100.000000
2023-01-02  102          101.000000
2023-01-03  101          101.000000
2023-01-04  105          102.000000</code></pre>
<blockquote>
<p>✅ يُستخدم في تتبع الأداء التراكمي.</p>
</blockquote>
<hr />
<h2 id="ewm-المتوسط-المتحرك-المرجح-أسيا-exponentially-weighted">🔹 <strong>3. <code>ewm()</code> — المتوسط المتحرك المرجح أسيًا (Exponentially Weighted)</strong></h2>
<p>يعطي وزنًا أكبر للقيم الحديثة.</p>
<h3 id="المثال-3-ewma-للسعر">📌 المثال 3: EWMA للسعر</h3>
<div class="sourceCode" id="cb178"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true"></a>df[<span class="st">&#39;ewm&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].ewm(alpha<span class="op">=</span><span class="fl">0.3</span>).mean()</span></code></pre></div>
<blockquote>
<p>✅ <code>alpha</code> (0 &lt; α ≤ 1): كلما زاد، زاد تركيزك على القيم الحديثة.</p>
</blockquote>
<hr />
<h2 id="cov-و-corr-التباين-وارتباط-بيرسون">🔹 <strong>4. <code>cov()</code> و <code>corr()</code> — التباين وارتباط بيرسون</strong></h2>
<h3 id="المثال-4-ارتباط-السعر-مع-الحجم">📌 المثال 4: ارتباط السعر مع الحجم</h3>
<div class="sourceCode" id="cb179"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true"></a>df[<span class="st">&#39;الحجم&#39;</span>] <span class="op">=</span> [<span class="dv">1000</span>, <span class="dv">1200</span>, <span class="dv">900</span>, <span class="dv">1300</span>, <span class="dv">1100</span>, <span class="dv">1400</span>, <span class="dv">1050</span>, <span class="dv">1600</span>, <span class="dv">1350</span>, <span class="dv">1700</span>]</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true"></a></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true"></a><span class="co"># معامل الارتباط</span></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true"></a>correlation <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].corr(df[<span class="st">&#39;الحجم&#39;</span>])</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true"></a><span class="bu">print</span>(<span class="ss">f&quot;معامل الارتباط: </span><span class="sc">{</span>correlation<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true"></a></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true"></a><span class="co"># التباين</span></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true"></a>covariance <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].cov(df[<span class="st">&#39;الحجم&#39;</span>])</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true"></a><span class="bu">print</span>(<span class="ss">f&quot;التباين: </span><span class="sc">{</span>covariance<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ إذا كان <code>corr &gt; 0.7</code>، فهناك علاقة قوية.</p>
</blockquote>
<hr />
<h2 id="rank-ترتيب-القيم">🔹 <strong>5. <code>rank()</code> — ترتيب القيم</strong></h2>
<p>يُعطي لكل قيمة “مركزها” بين القيم الأخرى.</p>
<h3 id="المثال-5-ترتيب-المبيعات">📌 المثال 5: ترتيب المبيعات</h3>
<div class="sourceCode" id="cb180"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true"></a>df[<span class="st">&#39;الرتبة&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].rank(ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<blockquote>
<p>✅ القيمة الأعلى = الرتبة 1.</p>
</blockquote>
<hr />
<h2 id="nlargest-و-nsmallest">🔹 <strong>6. <code>nlargest()</code> و <code>nsmallest()</code></strong></h2>
<h3 id="المثال-6-أفضل-3-أسعار">📌 المثال 6: أفضل 3 أسعار</h3>
<div class="sourceCode" id="cb181"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true"></a>top_3 <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].nlargest(<span class="dv">3</span>)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true"></a>bottom_2 <span class="op">=</span> df[<span class="st">&#39;الحجم&#39;</span>].nsmallest(<span class="dv">2</span>)</span></code></pre></div>
<blockquote>
<p>✅ بديل أسرع من <code>sort_values().head(n)</code>.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-1">🔹 <strong>الأخطاء الشائعة</strong></h2>
<table>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>NaN</code> في <code>rolling</code></td>
<td>النافذة غير مكتملة</td>
<td>تجاهل أول <code>n-1</code> صفوف</td>
</tr>
<tr class="even">
<td><code>corr()</code> يُرجع <code>NaN</code></td>
<td>عمود به قيم مفقودة</td>
<td>استخدم <code>dropna()</code> أولًا</td>
</tr>
<tr class="odd">
<td><code>ewm</code> لا يستجيب بسرعة</td>
<td><code>alpha</code> صغير جدًا</td>
<td>جرب <code>alpha=0.5</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-1">🔹 <strong>تمارين</strong></h2>
<ol type="1">
<li>احسب المتوسط المتحرك لآخر 5 أيام.</li>
<li>ما معامل الارتباط بين السعر والحجم؟</li>
<li>أظهر أفضل 2 يوم من حيث السعر.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-تحليل-تداول-الأسهم">🔹 <strong>الربط بالواقع: تحليل تداول الأسهم</strong></h2>
<div class="sourceCode" id="cb182"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true"></a><span class="co"># 1. المتوسط المتحرك (مؤشر شائع في التداول)</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true"></a>df[<span class="st">&#39;MA_7&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].rolling(<span class="dv">7</span>).mean()</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true"></a></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true"></a><span class="co"># 2. الارتباط بين السعر والحجم</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true"></a>corr <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].corr(df[<span class="st">&#39;الحجم&#39;</span>])</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true"></a></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true"></a><span class="co"># 3. أفضل 5 أيام من حيث الأداء</span></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true"></a>top_days <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].nlargest(<span class="dv">5</span>)</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true"></a></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📊 تقرير التداول:&quot;</span>)</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true"></a><span class="bu">print</span>(<span class="ss">f&quot;المتوسط المتحرك 7 أيام: </span><span class="sc">{df</span>[<span class="st">&#39;MA_7&#39;</span>]<span class="sc">.</span>iloc[<span class="op">-</span><span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true"></a><span class="bu">print</span>(<span class="ss">f&quot;الارتباط السعر-الحجم: </span><span class="sc">{</span>corr<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;أفضل 5 أيام:&quot;</span>, top_days.index.strftime(<span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st">&#39;</span>).tolist())</span></code></pre></div>
<blockquote>
<p>✅ هذا التحليل يُستخدم في استراتيجيات التداول الآلي.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-12">🔹 <strong>نصائح احترافية</strong></h2>
<ul>
<li>استخدم <code>rolling</code> في البيانات الزمنية.</li>
<li>استخدم <code>ewm</code> عندما تكون القيم الحديثة أكثر أهمية.</li>
<li>تحقق من <code>corr()</code> قبل بناء نموذج تنبؤ.</li>
<li>استخدم <code>nlargest</code> بدل <code>sort_values().head()</code> للأداء.</li>
</ul>
<hr />
<h2 id="أسئلة-مراجعة-11">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>rolling</code> و <code>expanding</code>؟</li>
<li>ما معنى <code>alpha</code> في <code>ewm</code>؟</li>
<li>كيف تحسب معامل الارتباط بين عمودين؟</li>
<li>ما الفرق بين <code>rank</code> و <code>sort_values</code>؟</li>
<li>متى نستخدم <code>nsmallest</code>؟</li>
</ol>
<h1 id="الدرس-3-pivot-والتحليل-العميق-pivot-pivot_table-crosstab">📘 <strong>الدرس 3 : 📊 Pivot والتحليل العميق: <code>pivot</code>, <code>pivot_table</code>, <code>crosstab</code></strong></h1>
<h2 id="مقدمة-لماذا-نحتاج-إلى-pivot">🔹 <strong>مقدمة: لماذا نحتاج إلى Pivot؟</strong></h2>
<p>تخيل أن لديك جدول مبيعات به أعمدة: - التاريخ - المدينة - الفئة - المبيعات</p>
<p>وتريد الإجابة على سؤال بسيط: &gt; “ما إجمالي المبيعات لكل مدينة حسب الفئة؟”</p>
<p>إذا استخدمت <code>groupby</code>، تحصل على جدول طولي.<br />
لكن إذا أردت جدولًا <strong>عرضيًا</strong> (مثل إكسل Pivot)، فتحتاج إلى: &gt; ✅ <code>pivot</code> أو <code>pivot_table</code></p>
<p>هذه الأدوات تحوّل البيانات من شكل “قائمي” إلى شكل “مصفوفي”، وهو مثالي للتقارير واللوحات التفاعلية.</p>
<hr />
<h2 id="pivot-إعادة-تشكيل-البيانات-لقيم-فريدة-فقط">🔹 <strong>1. <code>pivot()</code> — إعادة تشكيل البيانات (لقيم فريدة فقط)</strong></h2>
<p>يُستخدم عندما <strong>لا توجد تكرارات</strong> في التوليفة (index, columns).</p>
<h3 id="المثال-1-تحويل-الفئات-إلى-أعمدة">📌 المثال 1: تحويل الفئات إلى أعمدة</h3>
<div class="sourceCode" id="cb183"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true"></a></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true"></a>data <span class="op">=</span> {</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true"></a>    <span class="st">&#39;المدينة&#39;</span>: [<span class="st">&#39;الرياض&#39;</span>, <span class="st">&#39;الرياض&#39;</span>, <span class="st">&#39;جدة&#39;</span>, <span class="st">&#39;جدة&#39;</span>],</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true"></a>    <span class="st">&#39;الفئة&#39;</span>: [<span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;إلكترونيات&#39;</span>, <span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;إلكترونيات&#39;</span>],</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true"></a>    <span class="st">&#39;المبيعات&#39;</span>: [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">180</span>]</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true"></a>}</span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true"></a></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true"></a><span class="co"># تحويل الفئة إلى أعمدة</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true"></a>pivoted <span class="op">=</span> df.pivot(index<span class="op">=</span><span class="st">&#39;المدينة&#39;</span>, columns<span class="op">=</span><span class="st">&#39;الفئة&#39;</span>, values<span class="op">=</span><span class="st">&#39;المبيعات&#39;</span>)</span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true"></a><span class="bu">print</span>(pivoted)</span></code></pre></div>
<h4 id="الناتج-59">🔍 الناتج:</h4>
<pre><code>الفئة     إلكترونيات  فواكه
المدينة                
الرياض          200    100
جدة             180    150</code></pre>
<blockquote>
<p>✅ جدول نظيف يُسهل المقارنة.</p>
</blockquote>
<hr />
<h3 id="ماذا-يحدث-إذا-كانت-هناك-تكرارات">⚠️ ماذا يحدث إذا كانت هناك تكرارات؟</h3>
<div class="sourceCode" id="cb185"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true"></a><span class="co"># أضف صفًا مكررًا</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true"></a>df_duplicate <span class="op">=</span> df.append({<span class="st">&#39;المدينة&#39;</span>: <span class="st">&#39;الرياض&#39;</span>, <span class="st">&#39;الفئة&#39;</span>: <span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;المبيعات&#39;</span>: <span class="dv">120</span>}, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true"></a></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true"></a><span class="co"># هذا سيعطي خطأ:</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true"></a><span class="co"># df_duplicate.pivot(...) → ValueError</span></span></code></pre></div>
<blockquote>
<p>✅ الحل: استخدم <code>pivot_table</code> بدل <code>pivot</code>.</p>
</blockquote>
<hr />
<h2 id="pivot_table-pivot-آمن-مع-التكرارات">🔹 <strong>2. <code>pivot_table()</code> — Pivot آمن مع التكرارات</strong></h2>
<p>يسمح بالتكرارات ويُطبّق دالة تجميع (مثل <code>sum</code>, <code>mean</code>).</p>
<h3 id="المثال-2-مع-التكرارات">📌 المثال 2: مع التكرارات</h3>
<div class="sourceCode" id="cb186"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true"></a><span class="co"># استخدام pivot_table مع مجموع</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true"></a>pivoted_table <span class="op">=</span> df_duplicate.pivot_table(</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true"></a>    index<span class="op">=</span><span class="st">&#39;المدينة&#39;</span>,</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true"></a>    columns<span class="op">=</span><span class="st">&#39;الفئة&#39;</span>,</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true"></a>    values<span class="op">=</span><span class="st">&#39;المبيعات&#39;</span>,</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true"></a>    aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>  <span class="co"># أو &#39;mean&#39;, &#39;count&#39;</span></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true"></a>)</span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true"></a><span class="bu">print</span>(pivoted_table)</span></code></pre></div>
<h4 id="الناتج-60">🔍 الناتج:</h4>
<pre><code>الفئة     إلكترونيات  فواكه
المدينة                
الرياض          200    220  ← 100 + 120
جدة             180    150</code></pre>
<blockquote>
<p>✅ تم تجميع القيم تلقائيًا.</p>
</blockquote>
<hr />
<h3 id="خيارات-مهمة-في-pivot_table">✅ خيارات مهمة في <code>pivot_table</code></h3>
<table>
<thead>
<tr class="header">
<th>الخيار</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>aggfunc='sum'</code></td>
<td>الدالة المُطبقة (sum, mean, count, …)</td>
</tr>
<tr class="even">
<td><code>fill_value=0</code></td>
<td>استبدال <code>NaN</code> بقيمة (مثلاً 0)</td>
</tr>
<tr class="odd">
<td><code>margins=True</code></td>
<td>إضافة صف/عمود “الإجمالي”</td>
</tr>
<tr class="even">
<td><code>columns</code> متعدد</td>
<td><code>columns=['A', 'B']</code></td>
</tr>
</tbody>
</table>
<hr />
<h3 id="المثال-3-تقرير-شامل-مع-إجماليات">📌 المثال 3: تقرير شامل مع إجماليات</h3>
<div class="sourceCode" id="cb188"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true"></a>report <span class="op">=</span> df_duplicate.pivot_table(</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true"></a>    index<span class="op">=</span><span class="st">&#39;المدينة&#39;</span>,</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true"></a>    columns<span class="op">=</span><span class="st">&#39;الفئة&#39;</span>,</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true"></a>    values<span class="op">=</span><span class="st">&#39;المبيعات&#39;</span>,</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true"></a>    aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>,</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true"></a>    fill_value<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true"></a>    margins<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true"></a>    margins_name<span class="op">=</span><span class="st">&#39;الإجمالي العام&#39;</span></span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true"></a>)</span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true"></a><span class="bu">print</span>(report)</span></code></pre></div>
<h4 id="الناتج-61">🔍 الناتج:</h4>
<pre><code>الفئة       إلكترونيات  فواكه  الإجمالي العام
المدينة                                  
الرياض             200    220           420
جدة                180    150           330
الإجمالي العام        380    370           750</code></pre>
<blockquote>
<p>✅ تقرير جاهز للعرض الإداري.</p>
</blockquote>
<hr />
<h2 id="crosstab-جدول-التقابل-contingency-table">🔹 <strong>3. <code>crosstab()</code> — جدول التقابل (Contingency Table)</strong></h2>
<p>يُستخدم لحساب <strong>التكرارات</strong> بين عمودين (مثل: كم عدد العملاء الذكور في كل فئة؟).</p>
<h3 id="المثال-4-توزيع-العملاء-حسب-الجنس-والفئة">📌 المثال 4: توزيع العملاء حسب الجنس والفئة</h3>
<div class="sourceCode" id="cb190"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true"></a>data_customers <span class="op">=</span> {</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true"></a>    <span class="st">&#39;الجنس&#39;</span>: [<span class="st">&#39;ذكر&#39;</span>, <span class="st">&#39;أنثى&#39;</span>, <span class="st">&#39;ذكر&#39;</span>, <span class="st">&#39;أنثى&#39;</span>, <span class="st">&#39;ذكر&#39;</span>],</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true"></a>    <span class="st">&#39;الفئة&#39;</span>: [<span class="st">&#39;مبيعات&#39;</span>, <span class="st">&#39;تسويق&#39;</span>, <span class="st">&#39;مبيعات&#39;</span>, <span class="st">&#39;مبيعات&#39;</span>, <span class="st">&#39;تسويق&#39;</span>]</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true"></a>}</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true"></a>df_cust <span class="op">=</span> pd.DataFrame(data_customers)</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true"></a></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true"></a>cross <span class="op">=</span> pd.crosstab(df_cust[<span class="st">&#39;الجنس&#39;</span>], df_cust[<span class="st">&#39;الفئة&#39;</span>])</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true"></a><span class="bu">print</span>(cross)</span></code></pre></div>
<h4 id="الناتج-62">🔍 الناتج:</h4>
<pre><code>الفئة    تسويق  مبيعات
الجنس              
أنثى        1      1
ذكر         1      2</code></pre>
<blockquote>
<p>✅ مثالي للتحليل الديموغرافي.</p>
</blockquote>
<hr />
<h3 id="إضافات-في-crosstab">✅ إضافات في <code>crosstab</code></h3>
<div class="sourceCode" id="cb192"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true"></a>pd.crosstab(</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true"></a>    df_cust[<span class="st">&#39;الجنس&#39;</span>],</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true"></a>    df_cust[<span class="st">&#39;الفئة&#39;</span>],</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true"></a>    normalize<span class="op">=</span><span class="st">&#39;index&#39;</span>  <span class="co"># النسبة المئوية لكل صف</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true"></a>)</span></code></pre></div>
<blockquote>
<p>✅ يُظهر أن 50% من الذكور في “مبيعات”.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-2">🔹 <strong>الأخطاء الشائعة</strong></h2>
<table>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ValueError</code> في <code>pivot</code></td>
<td>تكرار في (index, columns)</td>
<td>استخدم <code>pivot_table</code></td>
</tr>
<tr class="even">
<td><code>pivot_table</code> يُنتج <code>NaN</code></td>
<td>بيانات ناقصة</td>
<td>استخدم <code>fill_value=0</code></td>
</tr>
<tr class="odd">
<td><code>crosstab</code> لا يُظهر النسب</td>
<td>لم تستخدم <code>normalize</code></td>
<td>أضف <code>normalize='all'</code> أو <code>'index'</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-2">🔹 <strong>تمارين</strong></h2>
<ol type="1">
<li>حول جدول مبيعاتك إلى Pivot حسب المدينة والشهر.</li>
<li>أنشئ <code>crosstab</code> يُظهر توزيع المنتجات حسب الفئة والمدينة.</li>
<li>أضف إجماليات إلى <code>pivot_table</code>.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-تقرير-أداء-الفروع">🔹 <strong>الربط بالواقع: تقرير أداء الفروع</strong></h2>
<div class="sourceCode" id="cb193"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true"></a><span class="co"># افترض أن لديك بيانات شهرية</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true"></a>monthly_pivot <span class="op">=</span> df.pivot_table(</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true"></a>    index<span class="op">=</span><span class="st">&#39;المدينة&#39;</span>,</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true"></a>    columns<span class="op">=</span><span class="st">&#39;الفئة&#39;</span>,</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true"></a>    values<span class="op">=</span><span class="st">&#39;المبيعات&#39;</span>,</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true"></a>    aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>,</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true"></a>    fill_value<span class="op">=</span><span class="dv">0</span></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true"></a>)</span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true"></a></span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📊 أداء الفروع حسب الفئة:&quot;</span>)</span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true"></a><span class="bu">print</span>(monthly_pivot)</span></code></pre></div>
<blockquote>
<p>✅ هذا التقرير يُستخدم في اتخاذ قرارات التسويق.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-13">🔹 <strong>نصائح احترافية</strong></h2>
<ul>
<li>استخدم <code>pivot</code> فقط عندما تكون البيانات فريدة.</li>
<li>استخدم <code>pivot_table</code> في 90% من الحالات.</li>
<li>استخدم <code>crosstab</code> للتحليلات الديموغرافية والإحصائية.</li>
<li>وثّق <code>aggfunc</code> المستخدم في التقرير.</li>
<li>استخدم <code>margins=True</code> لعرض الإجماليات.</li>
</ul>
<hr />
<h2 id="أسئلة-مراجعة-12">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>pivot</code> و <code>pivot_table</code>؟</li>
<li>ما معنى <code>aggfunc</code>؟</li>
<li>كيف تُظهر النسب المئوية في <code>crosstab</code>؟</li>
<li>ما وظيفة <code>fill_value</code>؟</li>
<li>متى نستخدم <code>margins=True</code>؟</li>
</ol>
<h1 id="الدرس-4-التجهيز-للذكاء-الاصطناعي-ml-get_dummies-cut-qcut-map-replace-astype-query-eval">📘 <strong>الدرس 4 : 🧠 التجهيز للذكاء الاصطناعي (ML): <code>get_dummies</code>, <code>cut</code>, <code>qcut</code>, <code>map</code>, <code>replace</code>, <code>astype</code>, <code>query</code>, <code>eval</code></strong></h1>
<h2 id="مقدمة-لماذا-نحتاج-إلى-تجهيز-البيانات-للذكاء-الاصطناعي">🔹 <strong>مقدمة: لماذا نحتاج إلى تجهيز البيانات للذكاء الاصطناعي؟</strong></h2>
<p>قبل أن تُدخل البيانات إلى نموذج تعلُّم آلي (مثل الانحدار أو التصنيف)، يجب أن تكون: - <strong>رقمية</strong> (النماذج لا تفهم النصوص) - <strong>منضبطة</strong> (بدون قيم شاذة) - <strong>مصنفة</strong> (إذا كانت هناك فئات) - <strong>نظيفة</strong> (بدون أخطاء أو تنسيق خاطئ)</p>
<p>هذا الدرس يُعلّمك <strong>أدوات التحويل والتجهيز</strong> التي تُستخدم في كل مشروع ML.</p>
<hr />
<h2 id="pd.get_dummies-تحويل-النصوص-إلى-أرقام-one-hot-encoding">🔹 <strong>1. <code>pd.get_dummies()</code> — تحويل النصوص إلى أرقام (One-Hot Encoding)</strong></h2>
<p>النماذج لا تفهم “مبيعات”، “تسويق”، بل تحتاج أرقامًا.</p>
<h3 id="المثال-1-تحويل-الفئات-إلى-أعمدة-رقمية">📌 المثال 1: تحويل الفئات إلى أعمدة رقمية</h3>
<div class="sourceCode" id="cb194"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true"></a></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true"></a>data <span class="op">=</span> {</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true"></a>    <span class="st">&#39;الاسم&#39;</span>: [<span class="st">&#39;أحمد&#39;</span>, <span class="st">&#39;سارة&#39;</span>, <span class="st">&#39;علي&#39;</span>],</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true"></a>    <span class="st">&#39;القسم&#39;</span>: [<span class="st">&#39;مبيعات&#39;</span>, <span class="st">&#39;تسويق&#39;</span>, <span class="st">&#39;مبيعات&#39;</span>],</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true"></a>    <span class="st">&#39;الراتب&#39;</span>: [<span class="dv">5000</span>, <span class="dv">7000</span>, <span class="dv">6000</span>]</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true"></a>}</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true"></a></span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true"></a><span class="co"># تحويل القسم إلى أعمدة رقمية</span></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true"></a>df_encoded <span class="op">=</span> pd.get_dummies(df, columns<span class="op">=</span>[<span class="st">&#39;القسم&#39;</span>])</span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true"></a><span class="bu">print</span>(df_encoded)</span></code></pre></div>
<h4 id="الناتج-63">🔍 الناتج:</h4>
<pre><code>   الاسم  الراتب  القسم_مبيعات  القسم_تسويق
0   أحمد  5000            1            0
1   سارة  7000            0            1
2   علي   6000            1            0</code></pre>
<blockquote>
<p>✅ الآن يمكن إدخال البيانات إلى نموذج ML.</p>
</blockquote>
<hr />
<h3 id="خيارات-مهمة">✅ خيارات مهمة</h3>
<ul>
<li><code>drop_first=True</code>: لتجنب “الخداع المتعدد” (Multicollinearity)</li>
<li><code>prefix='Dept'</code>: لتغيير اسم العمود</li>
</ul>
<div class="sourceCode" id="cb196"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true"></a>pd.get_dummies(df, columns<span class="op">=</span>[<span class="st">&#39;القسم&#39;</span>], drop_first<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<hr />
<h2 id="pd.cut-تقسيم-الأرقام-إلى-فئات-متساوية-binning">🔹 <strong>2. <code>pd.cut()</code> — تقسيم الأرقام إلى فئات متساوية (Binning)</strong></h2>
<p>مثلاً: تحويل “العمر” إلى “شباب، بالغ، كبير”.</p>
<h3 id="المثال-2-تقسيم-العمر">📌 المثال 2: تقسيم العمر</h3>
<div class="sourceCode" id="cb197"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true"></a>ages <span class="op">=</span> [<span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">35</span>, <span class="dv">45</span>, <span class="dv">55</span>, <span class="dv">65</span>]</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true"></a>df_ages <span class="op">=</span> pd.DataFrame({<span class="st">&#39;العمر&#39;</span>: ages})</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true"></a></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true"></a><span class="co"># تقسيم إلى 3 فئات: 20-40، 40-60، 60-80</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true"></a>df_ages[<span class="st">&#39;الفئة&#39;</span>] <span class="op">=</span> pd.cut(df_ages[<span class="st">&#39;العمر&#39;</span>], bins<span class="op">=</span>[<span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>], labels<span class="op">=</span>[<span class="st">&#39;شباب&#39;</span>, <span class="st">&#39;بالغ&#39;</span>, <span class="st">&#39;كبير&#39;</span>])</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true"></a><span class="bu">print</span>(df_ages)</span></code></pre></div>
<h4 id="الناتج-64">🔍 الناتج:</h4>
<pre><code>   العمر  الفئة
0     20   شباب
1     25   شباب
2     35   شباب
3     45   بالغ
4     55   بالغ
5     65   كبير</code></pre>
<blockquote>
<p>✅ مفيد للتصنيف.</p>
</blockquote>
<hr />
<h2 id="pd.qcut-التقسيم-حسب-النسب-المئوية-quantile-binning">🔹 <strong>3. <code>pd.qcut()</code> — التقسيم حسب النسب المئوية (Quantile Binning)</strong></h2>
<p>يُقسّم البيانات إلى فئات ذات عدد متساوٍ من العناصر.</p>
<h3 id="المثال-3-تقسيم-الرواتب-إلى-منخفض-متوسط-عالي">📌 المثال 3: تقسيم الرواتب إلى “منخفض، متوسط، عالي”</h3>
<div class="sourceCode" id="cb199"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true"></a>salaries <span class="op">=</span> [<span class="dv">3000</span>, <span class="dv">4000</span>, <span class="dv">5000</span>, <span class="dv">6000</span>, <span class="dv">7000</span>, <span class="dv">8000</span>, <span class="dv">9000</span>, <span class="dv">10000</span>]</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true"></a>df_sal <span class="op">=</span> pd.DataFrame({<span class="st">&#39;الراتب&#39;</span>: salaries})</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true"></a></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true"></a><span class="co"># 3 فئات: 33% منخفض، 33% متوسط، 33% عالي</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true"></a>df_sal[<span class="st">&#39;الفئة&#39;</span>] <span class="op">=</span> pd.qcut(df_sal[<span class="st">&#39;الراتب&#39;</span>], q<span class="op">=</span><span class="dv">3</span>, labels<span class="op">=</span>[<span class="st">&#39;منخفض&#39;</span>, <span class="st">&#39;متوسط&#39;</span>, <span class="st">&#39;عالي&#39;</span>])</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true"></a><span class="bu">print</span>(df_sal)</span></code></pre></div>
<h4 id="الناتج-65">🔍 الناتج:</h4>
<pre><code>   الراتب    الفئة
0   3000   منخفض
1   4000   منخفض
2   5000   متوسط
3   6000   متوسط
4   7000   عالي
5   8000   عالي
6   9000   عالي
7  10000   عالي</code></pre>
<blockquote>
<p>✅ مثالي للتصنيف العادل.</p>
</blockquote>
<hr />
<h2 id="map-استبدال-قيم-بناء-على-خريطة">🔹 <strong>4. <code>map()</code> — استبدال قيم بناءً على خريطة</strong></h2>
<h3 id="المثال-4-تحويل-الأرقام-إلى-نصوص">📌 المثال 4: تحويل الأرقام إلى نصوص</h3>
<div class="sourceCode" id="cb201"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true"></a>df[<span class="st">&#39;التقييم&#39;</span>] <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true"></a>rating_map <span class="op">=</span> {<span class="dv">1</span>: <span class="st">&#39;ضعيف&#39;</span>, <span class="dv">2</span>: <span class="st">&#39;متوسط&#39;</span>, <span class="dv">3</span>: <span class="st">&#39;ممتاز&#39;</span>}</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true"></a>df[<span class="st">&#39;التقييم_النصي&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;التقييم&#39;</span>].<span class="bu">map</span>(rating_map)</span></code></pre></div>
<hr />
<h2 id="replace-استبدال-قيم-معينة">🔹 <strong>5. <code>replace()</code> — استبدال قيم معينة</strong></h2>
<h3 id="المثال-5-تصحيح-أخطاء-إدخال">📌 المثال 5: تصحيح أخطاء إدخال</h3>
<div class="sourceCode" id="cb202"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true"></a>df[<span class="st">&#39;المدينة&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;المدينة&#39;</span>].replace(<span class="st">&#39;الرياص&#39;</span>, <span class="st">&#39;الرياض&#39;</span>)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true"></a>df[<span class="st">&#39;الراتب&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;الراتب&#39;</span>].replace(<span class="dv">0</span>, np.nan)  <span class="co"># استبدال 0 بـ NaN</span></span></code></pre></div>
<hr />
<h2 id="astype-تغيير-نوع-البيانات">🔹 <strong>6. <code>astype()</code> — تغيير نوع البيانات</strong></h2>
<p>ضروري قبل التحليل.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true"></a>df[<span class="st">&#39;العمر&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;العمر&#39;</span>].astype(<span class="bu">int</span>)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true"></a>df[<span class="st">&#39;المنتج&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;المنتج&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)  <span class="co"># لتوفير الذاكرة</span></span></code></pre></div>
<hr />
<h2 id="query-تصفية-البيانات-بجملة-نصية">🔹 <strong>7. <code>query()</code> — تصفية البيانات بجملة نصية</strong></h2>
<p>بديل أنيق للشروط المعقدة.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true"></a><span class="co"># بدل:</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true"></a><span class="co"># df[(df[&#39;العمر&#39;] &gt; 25) &amp; (df[&#39;الراتب&#39;] &lt; 7000)]</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true"></a></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true"></a><span class="co"># استخدم:</span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true"></a>filtered <span class="op">=</span> df.query(<span class="st">&#39;العمر &gt; 25 and الراتب &lt; 7000&#39;</span>)</span></code></pre></div>
<blockquote>
<p>✅ أكثر قراءة.</p>
</blockquote>
<hr />
<h2 id="eval-تقييم-تعبير-رياضي-كنص">🔹 <strong>8. <code>eval()</code> — تقييم تعبير رياضي كنص</strong></h2>
<div class="sourceCode" id="cb205"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true"></a><span class="co"># بدل:</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true"></a><span class="co"># df[&#39;إجمالي&#39;] = df[&#39;السعر&#39;] * df[&#39;الكمية&#39;]</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true"></a></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true"></a><span class="co"># استخدم:</span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true"></a>df <span class="op">=</span> df.<span class="bu">eval</span>(<span class="st">&#39;الإجمالي = السعر * الكمية&#39;</span>)</span></code></pre></div>
<blockquote>
<p>✅ مفيد في الأنابيب.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-3">🔹 <strong>الأخطاء الشائعة</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>get_dummies</code> يُنتج كثير من الأعمدة</td>
<td>فئات كثيرة جدًا</td>
<td>استخدم <code>pd.cut</code> أولًا</td>
</tr>
<tr class="even">
<td><code>qcut</code> يُعطي خطأ</td>
<td>تكرار في القيم</td>
<td>استخدم <code>duplicates='drop'</code></td>
</tr>
<tr class="odd">
<td><code>map</code> يُنتج <code>NaN</code></td>
<td>قيمة غير موجودة في الخريطة</td>
<td>تأكد من تطابق القيم</td>
</tr>
<tr class="even">
<td><code>query</code> لا يعمل مع أسماء تحتوي مسافات</td>
<td>مثل <code>first name</code></td>
<td>استخدم backticks: <code>`first name`</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-3">🔹 <strong>تمارين</strong></h2>
<ol type="1">
<li>حوّل عمود “الجنس” إلى أعمدة رقمية باستخدام <code>get_dummies</code>.</li>
<li>قسّم “العمر” إلى 4 فئات باستخدام <code>cut</code>.</li>
<li>استخدم <code>query</code> لتصفية الموظفين الذين رواتبهم بين 5000 و8000.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-إعداد-بيانات-لنموذج-ml">🔹 <strong>الربط بالواقع: إعداد بيانات لنموذج ML</strong></h2>
<div class="sourceCode" id="cb206"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true"></a><span class="co"># 1. استبدال النصوص</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true"></a>df[<span class="st">&#39;الجنس&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;الجنس&#39;</span>].<span class="bu">map</span>({<span class="st">&#39;ذكر&#39;</span>: <span class="dv">1</span>, <span class="st">&#39;أنثى&#39;</span>: <span class="dv">0</span>})</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true"></a></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true"></a><span class="co"># 2. تصنيف العمر</span></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true"></a>df[<span class="st">&#39;فئة_العمر&#39;</span>] <span class="op">=</span> pd.cut(df[<span class="st">&#39;العمر&#39;</span>], bins<span class="op">=</span><span class="dv">3</span>, labels<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true"></a></span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true"></a><span class="co"># 3. ترميز الفئات</span></span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true"></a>df <span class="op">=</span> pd.get_dummies(df, columns<span class="op">=</span>[<span class="st">&#39;القسم&#39;</span>], drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true"></a></span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true"></a><span class="co"># 4. تنظيف البيانات</span></span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true"></a>df[<span class="st">&#39;الراتب&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;الراتب&#39;</span>].replace(<span class="dv">0</span>, df[<span class="st">&#39;الراتب&#39;</span>].median())</span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true"></a></span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true"></a><span class="co"># 5. التحقق من الأنواع</span></span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true"></a>df <span class="op">=</span> df.astype({<span class="st">&#39;العمر&#39;</span>: <span class="st">&#39;int&#39;</span>, <span class="st">&#39;الجنس&#39;</span>: <span class="st">&#39;int&#39;</span>})</span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true"></a></span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;✅ البيانات جاهزة للنموذج!&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا هو الشكل النهائي لبيانات ML.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-14">🔹 <strong>نصائح احترافية</strong></h2>
<ul>
<li>استخدم <code>get_dummies</code> بحذر مع الفئات الكثيرة.</li>
<li>استخدم <code>qcut</code> للتقسيم العادل، و <code>cut</code> للنطاقات الثابتة.</li>
<li>استخدم <code>query</code> و <code>eval</code> لتحسين قراءة الكود.</li>
<li>وثّق كل خطوة تحويل.</li>
</ul>
<hr />
<h2 id="أسئلة-مراجعة-13">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>cut</code> و <code>qcut</code>؟</li>
<li>لماذا نستخدم <code>get_dummies</code> في ML؟</li>
<li>ما الفرق بين <code>map</code> و <code>replace</code>؟</li>
<li>كيف تستخدم <code>query</code> مع شرط منطقي؟</li>
<li>ما فائدة <code>eval</code>؟</li>
</ol>
<h1 id="الدرس-5-البيانات-الزمنية-المتقدمة-resample1d-asfreq-shift-diff-lag">📘 <strong>الدرس 5 : ⏱️ البيانات الزمنية المتقدمة: <code>resample('1D')</code>, <code>asfreq</code>, <code>shift</code>, <code>diff</code>, <code>lag</code></strong></h1>
<h2 id="مقدمة-لماذا-نحتاج-إلى-معالجة-زمنية-متقدمة">🔹 <strong>مقدمة: لماذا نحتاج إلى معالجة زمنية متقدمة؟</strong></h2>
<p>في تحليل الأسهم، المبيعات، أو بيانات الاستشعار، لا يكفي معرفة “ما حدث”، بل يجب أن نفهم: - كيف تتغير القيم بمرور الوقت؟ - ما الفرق بين اليوم والبارحة؟ - كيف نُعيد تردد البيانات (من دقائق إلى أيام)؟ - هل هناك اتجاه تصاعدي؟</p>
<p>هنا تأتي أهمية الأدوات الزمنية المتقدمة في Pandas.</p>
<hr />
<h2 id="resample-إعادة-عينة-البيانات-حسب-التردد">🔹 <strong>1. <code>resample()</code> — إعادة عيّنة البيانات حسب التردد</strong></h2>
<p>تُستخدم لتغيير <strong>دقة البيانات الزمنية</strong> (مثلاً: من دقائق إلى ساعات).</p>
<h3 id="المثال-1-من-بيانات-يومية-إلى-أسبوعية">📌 المثال 1: من بيانات يومية إلى أسبوعية</h3>
<div class="sourceCode" id="cb207"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true"></a></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true"></a><span class="co"># بيانات يومية</span></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true"></a>dates <span class="op">=</span> pd.date_range(<span class="st">&#39;2023-01-01&#39;</span>, periods<span class="op">=</span><span class="dv">30</span>, freq<span class="op">=</span><span class="st">&#39;D&#39;</span>)</span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true"></a>sales <span class="op">=</span> np.random.randint(<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">30</span>)</span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">&#39;المبيعات&#39;</span>: sales}, index<span class="op">=</span>dates)</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true"></a></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true"></a><span class="co"># تحويل إلى أسبوعية (مجموع كل أسبوع)</span></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true"></a>weekly <span class="op">=</span> df.resample(<span class="st">&#39;W&#39;</span>).<span class="bu">sum</span>()</span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true"></a><span class="bu">print</span>(weekly.head())</span></code></pre></div>
<h4 id="الناتج-66">🔍 الناتج:</h4>
<pre><code>            المبيعات
2023-01-01      580
2023-01-08      620
2023-01-15      590
...</code></pre>
<blockquote>
<p>✅ <code>W</code> = أسبوع، <code>D</code> = يوم، <code>M</code> = شهر، <code>H</code> = ساعة</p>
</blockquote>
<hr />
<h3 id="ترددات-شائعة-في-resample">✅ ترددات شائعة في <code>resample</code></h3>
<table>
<thead>
<tr class="header">
<th>التردد</th>
<th>المعنى</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>'D'</code></td>
<td>يوم</td>
</tr>
<tr class="even">
<td><code>'W'</code></td>
<td>أسبوع</td>
</tr>
<tr class="odd">
<td><code>'M'</code></td>
<td>شهر</td>
</tr>
<tr class="even">
<td><code>'Q'</code></td>
<td>ربع سنوي</td>
</tr>
<tr class="odd">
<td><code>'Y'</code></td>
<td>سنة</td>
</tr>
<tr class="even">
<td><code>'H'</code></td>
<td>ساعة</td>
</tr>
<tr class="odd">
<td><code>'T'</code> أو <code>'min'</code></td>
<td>دقيقة</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="المثال-2-متوسط-شهري">📌 المثال 2: متوسط شهري</h3>
<div class="sourceCode" id="cb209"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true"></a>monthly_avg <span class="op">=</span> df.resample(<span class="st">&#39;M&#39;</span>).mean()</span></code></pre></div>
<blockquote>
<p>✅ مفيد لتحليل الاتجاهات الطويلة.</p>
</blockquote>
<hr />
<h2 id="asfreq-تغيير-التردد-دون-تجميع">🔹 <strong>2. <code>asfreq()</code> — تغيير التردد دون تجميع</strong></h2>
<p>يُستخدم عندما تريد <strong>إعادة تحديد التردد مع ملء الفراغات</strong>.</p>
<h3 id="المثال-3-من-يومي-إلى-يومي-مع-ملء">📌 المثال 3: من يومي إلى يومي (مع ملء)</h3>
<div class="sourceCode" id="cb210"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true"></a><span class="co"># افترض أن بعض الأيام مفقودة</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true"></a>df_sparse <span class="op">=</span> df[df.index.day <span class="op">%</span> <span class="dv">3</span> <span class="op">==</span> <span class="dv">0</span>]  <span class="co"># كل 3 أيام</span></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true"></a></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true"></a><span class="co"># ملء الأيام المفقودة</span></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true"></a>df_dense <span class="op">=</span> df_sparse.asfreq(<span class="st">&#39;D&#39;</span>, fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true"></a><span class="bu">print</span>(df_dense.head())</span></code></pre></div>
<blockquote>
<p>✅ يُستخدم في البيانات الناقصة.</p>
</blockquote>
<hr />
<h2 id="shift-إزاحة-البيانات-lag-or-lead">🔹 <strong>3. <code>shift()</code> — إزاحة البيانات (Lag or Lead)</strong></h2>
<p>يُستخدم لحساب: - القيمة السابقة (lag) - القيمة القادمة (lead)</p>
<h3 id="المثال-4-حساب-السعر-السابق">📌 المثال 4: حساب السعر السابق</h3>
<div class="sourceCode" id="cb211"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true"></a>df[<span class="st">&#39;السعر_البارحة&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;المبيعات&#39;</span>].shift(<span class="dv">1</span>)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true"></a>df[<span class="st">&#39;التغير&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;المبيعات&#39;</span>] <span class="op">-</span> df[<span class="st">&#39;السعر_البارحة&#39;</span>]</span></code></pre></div>
<blockquote>
<p>✅ <code>shift(1)</code> = قيمة الأمس<br />
<code>shift(-1)</code> = قيمة الغد (lead)</p>
</blockquote>
<hr />
<h2 id="diff-الفرق-بين-القيم-المتتالية">🔹 <strong>4. <code>diff()</code> — الفرق بين القيم المتتالية</strong></h2>
<p>مفيد لحساب <strong>التغير اليومي</strong>.</p>
<h3 id="المثال-5-التغير-اليومي-في-المبيعات">📌 المثال 5: التغير اليومي في المبيعات</h3>
<div class="sourceCode" id="cb212"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true"></a>df[<span class="st">&#39;التغير_اليومي&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;المبيعات&#39;</span>].diff()</span></code></pre></div>
<h4 id="الناتج-67">🔍 الناتج:</h4>
<pre><code>2023-01-01     NaN
2023-01-02    10.0   ← الفرق بين 110 و100
2023-01-03   -15.0   ← الفرق بين 95 و110</code></pre>
<blockquote>
<p>✅ أول قيمة <code>NaN</code> لأن لا يوجد “أمس” لها.</p>
</blockquote>
<hr />
<h3 id="diff-مع-resample">✅ <code>diff()</code> مع <code>resample</code></h3>
<div class="sourceCode" id="cb214"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true"></a><span class="co"># التغير الأسبوعي</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true"></a>df.resample(<span class="st">&#39;W&#39;</span>).<span class="bu">sum</span>().diff()</span></code></pre></div>
<hr />
<h2 id="lag-ليس-دالة-مباشرة-لكنها-مفهوم">🔹 <strong>5. <code>lag</code> — ليس دالة مباشرة، لكنها مفهوم</strong></h2>
<p>في Pandas، لا توجد دالة <code>lag()</code>، لكن:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true"></a>df[<span class="st">&#39;lag_1&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;المبيعات&#39;</span>].shift(<span class="dv">1</span>)  <span class="co"># هذا هو الـ lag</span></span></code></pre></div>
<blockquote>
<p>✅ يُستخدم في نماذج ARIMA، والتنبؤ.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-4">🔹 <strong>الأخطاء الشائعة</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>resample</code> لا يعمل</td>
<td>الفهرس ليس من نوع <code>datetime</code></td>
<td>استخدم <code>set_index('التاريخ')</code> أو <code>pd.to_datetime()</code></td>
</tr>
<tr class="even">
<td><code>shift</code> يُنتج <code>NaN</code></td>
<td>طبيعي في أول/آخر قيمة</td>
<td>تجاهله أو املأه بـ <code>fillna(0)</code></td>
</tr>
<tr class="odd">
<td><code>diff</code> يُعطي نتائج غريبة</td>
<td>لأن البيانات غير مرتبة زمنيًا</td>
<td>تأكد من <code>df.sort_index()</code></td>
</tr>
<tr class="even">
<td><code>asfreq</code> يُفقد البيانات</td>
<td>إذا لم يكن الفهرس متسلسلًا</td>
<td>تأكد من التواريخ المتتالية</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-4">🔹 <strong>تمارين</strong></h2>
<ol type="1">
<li>حوّل بياناتك اليومية إلى شهرية باستخدام <code>resample('M').sum()</code>.</li>
<li>أنشئ عمودًا باسم “الأمس” يحتوي على قيمة اليوم السابق.</li>
<li>احسب التغير اليومي في السعر.</li>
<li>ما هو التغير النسبي (النسبة المئوية) بين يوم وآخر؟ (تلميح: استخدم <code>pct_change()</code>)</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-تحليل-سعر-السهم">🔹 <strong>الربط بالواقع: تحليل سعر السهم</strong></h2>
<div class="sourceCode" id="cb216"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true"></a><span class="co"># افترض أن df[&#39;السعر&#39;] يحتوي على أسعار يومية</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true"></a>df[<span class="st">&#39;السعر_الأمس&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].shift(<span class="dv">1</span>)</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true"></a>df[<span class="st">&#39;التغير&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].diff()</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true"></a>df[<span class="st">&#39;النسبة_المئوية&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].pct_change() <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true"></a>df[<span class="st">&#39;متوسط_7_أيام&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].rolling(<span class="dv">7</span>).mean()</span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true"></a></span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true"></a><span class="co"># تحويل إلى أسبوعي</span></span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true"></a>weekly_price <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].resample(<span class="st">&#39;W&#39;</span>).last()</span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true"></a></span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📈 تحليل السعر اليومي:&quot;</span>)</span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true"></a><span class="bu">print</span>(df[[<span class="st">&#39;التغير&#39;</span>, <span class="st">&#39;النسبة_المئوية&#39;</span>]].head())</span></code></pre></div>
<blockquote>
<p>✅ هذا التحليل يُستخدم في التداول الكمي.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-15">🔹 <strong>نصائح احترافية</strong></h2>
<ul>
<li>استخدم <code>resample</code> للتحليل متعدد الترددات.</li>
<li>استخدم <code>shift</code> لحساب المؤشرات الزمنية.</li>
<li>استخدم <code>diff</code> للكشف عن التغيرات المفاجئة.</li>
<li>تأكد من أن الفهرس زمني ومرتب قبل أي عملية.</li>
<li>استخدم <code>fillna()</code> بعد <code>shift</code> إذا لزم.</li>
</ul>
<hr />
<h2 id="أسئلة-مراجعة-14">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>resample</code> و <code>asfreq</code>؟</li>
<li>كيف تحسب السعر السابق؟</li>
<li>ما معنى <code>shift(-1)</code>؟</li>
<li>ما الفرق بين <code>diff</code> و <code>pct_change</code>؟</li>
<li>لماذا <code>resample</code> يتطلب فهرسًا زمنيًا؟</li>
</ol>
<h1 id="الدرس-6-التعامل-مع-الأخطاء-والنسخ-الآمن-copydeeptrue-settingwithcopywarning-errorsignore">📘 <strong>الدرس 6 : 🔧 التعامل مع الأخطاء والنسخ الآمن: <code>copy(deep=True)</code>, <code>SettingWithCopyWarning</code>, <code>errors='ignore'</code></strong></h1>
<h2 id="مقدمة-لماذا-تظهر-التحذيرات-وكيف-نتعامل-معها-باحترافية">🔹 <strong>مقدمة: لماذا تظهر التحذيرات؟ وكيف نتعامل معها باحترافية؟</strong></h2>
<p>حتى المبرمجين المتمرسين يواجهون تحذيرًا غامضًا من Pandas:</p>
<pre><code>SettingWithCopyWarning: A value is trying to be set on a copy of a slice from a DataFrame</code></pre>
<p>هذا التحذير <strong>ليس خطأ</strong>، لكنه <strong>تحذير من مشكلة محتملة</strong>: &gt; قد تُعدّل نسخة من البيانات، وتفقد التغييرات!</p>
<p>في هذا الدرس، ستفهم: - لماذا يحدث هذا التحذير؟ - كيف تتجنبه؟ - متى تستخدم <code>copy()</code>؟ - كيف تُهمِل الأخطاء بوعي (وليس بتهور)؟</p>
<hr />
<h2 id="ما-هو-settingwithcopywarning">🔹 <strong>1. ما هو <code>SettingWithCopyWarning</code>؟</strong></h2>
<h3 id="المثال-1-الكود-الذي-يسبب-التحذير">📌 المثال 1: الكود الذي يُسبب التحذير</h3>
<div class="sourceCode" id="cb218"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true"></a></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;تفاح&#39;</span>, <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;لابتوب&#39;</span>],</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true"></a>    <span class="st">&#39;السعر&#39;</span>: [<span class="fl">3.5</span>, <span class="fl">2.0</span>, <span class="dv">2500</span>],</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true"></a>    <span class="st">&#39;الفئة&#39;</span>: [<span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;إلكترونيات&#39;</span>]</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true"></a>})</span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true"></a></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true"></a><span class="co"># ❌ هذا الكود يُسبب التحذير</span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true"></a>(filtered_df)[<span class="st">&#39;السعر&#39;</span>] <span class="op">=</span> filtered_df[<span class="st">&#39;السعر&#39;</span>] <span class="op">*</span> <span class="fl">1.1</span></span></code></pre></div>
<h4 id="السبب">🔍 السبب:</h4>
<ul>
<li><code>df[df['الفئة'] == 'فواكه']</code> يُنتج <strong>نسخة مؤقتة</strong></li>
<li>ثم تحاول تعديلها: <code>['السعر'] = ...</code></li>
<li>Pandas لا يعرف إن كنت تقصد التعديل على الأصل أم النسخة</li>
</ul>
<blockquote>
<p>⚠️ النتيجة: التغيير قد لا يُحفظ!</p>
</blockquote>
<hr />
<h2 id="الحل-الصحيح-استخدام-.copy">🔹 <strong>2. الحل الصحيح: استخدام <code>.copy()</code></strong></h2>
<h3 id="الطريقة-1-إنشاء-نسخة-صريحة">✅ الطريقة 1: إنشاء نسخة صريحة</h3>
<div class="sourceCode" id="cb219"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true"></a>filtered_df <span class="op">=</span> df[df[<span class="st">&#39;الفئة&#39;</span>] <span class="op">==</span> <span class="st">&#39;فواكه&#39;</span>].copy()</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true"></a>filtered_df[<span class="st">&#39;السعر&#39;</span>] <span class="op">=</span> filtered_df[<span class="st">&#39;السعر&#39;</span>] <span class="op">*</span> <span class="fl">1.1</span></span></code></pre></div>
<blockquote>
<p>✅ الآن Pandas يعرف أنك تعمل على نسخة، ولا يُصدر تحذيرًا.</p>
</blockquote>
<hr />
<h3 id="الطريقة-2-التعديل-على-الأصل-باستخدام-.loc">✅ الطريقة 2: التعديل على الأصل باستخدام <code>.loc</code></h3>
<div class="sourceCode" id="cb220"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true"></a><span class="co"># ✅ التعديل على الجدول الأصلي مباشرة</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true"></a>df.loc[df[<span class="st">&#39;الفئة&#39;</span>] <span class="op">==</span> <span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;السعر&#39;</span>] <span class="op">=</span> df.loc[df[<span class="st">&#39;الفئة&#39;</span>] <span class="op">==</span> <span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;السعر&#39;</span>] <span class="op">*</span> <span class="fl">1.1</span></span></code></pre></div>
<blockquote>
<p>✅ لا تحذير، لأنك تستخدم <code>.loc</code> على الجدول الأصلي.</p>
</blockquote>
<hr />
<h2 id="copydeeptrue-vs-copydeepfalse">🔹 <strong>3. <code>copy(deep=True)</code> vs <code>copy(deep=False)</code></strong></h2>
<p>عند نسخ DataFrame، يمكنك التحكم في عمق النسخ.</p>
<h3 id="deeptrue-الافتراضي">✅ <code>deep=True</code> (الافتراضي)</h3>
<ul>
<li>يُنشئ نسخة مستقلة تمامًا</li>
<li>التغييرات على النسخة لا تؤثر على الأصل</li>
<li>يستهلك ذاكرة أكثر</li>
</ul>
<div class="sourceCode" id="cb221"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true"></a>df_copy <span class="op">=</span> df.copy(deep<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<h3 id="deepfalse">✅ <code>deep=False</code></h3>
<ul>
<li>يُنشئ نسخة سطحية (تحتفظ بالإشارات إلى نفس البيانات)</li>
<li>التغييرات على البيانات قد تؤثر على الأصل</li>
<li>نادرًا ما يُستخدم</li>
</ul>
<blockquote>
<p>✅ استخدم دائمًا <code>deep=True</code> ما لم تكن لديك أسباب تقنية.</p>
</blockquote>
<hr />
<h2 id="استخدام-errorsignore-في-العمليات">🔹 <strong>4. استخدام <code>errors='ignore'</code> في العمليات</strong></h2>
<p>بعض الدوال تُصدر أخطاء إذا فشلت (مثل <code>drop</code> على عمود غير موجود).</p>
<h3 id="المثال-2-تجنب-خطأ-عند-حذف-عمود-قد-لا-يوجد">📌 المثال 2: تجنب خطأ عند حذف عمود قد لا يوجد</h3>
<div class="sourceCode" id="cb222"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true"></a><span class="co"># ❌ قد يُعطي KeyError</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">&#39;عمود_مؤقت&#39;</span>])</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true"></a></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true"></a><span class="co"># ✅ الحل الآمن</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">&#39;عمود_مؤقت&#39;</span>], errors<span class="op">=</span><span class="st">&#39;ignore&#39;</span>)</span></code></pre></div>
<blockquote>
<p>✅ مفيد في الأنابيب التلقائية.</p>
</blockquote>
<hr />
<h3 id="أماكن-شائعة-لاستخدام-errorsignore">📌 أماكن شائعة لاستخدام <code>errors='ignore'</code></h3>
<ul>
<li><code>drop(columns=..., errors='ignore')</code></li>
<li><code>rename(columns=..., errors='ignore')</code> (في بعض السياقات)</li>
<li><code>fillna(value, errors='ignore')</code> — نادر</li>
</ul>
<hr />
<h2 id="الأخطاء-الشائعة-في-النسخ">🔹 <strong>5. الأخطاء الشائعة في النسخ</strong></h2>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 40%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>المثال</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>التعديل على “عرض” بدون <code>copy()</code></td>
<td><code>df[df&gt;0]['A'] = 1</code></td>
<td>استخدم <code>.loc</code> أو <code>.copy()</code></td>
</tr>
<tr class="even">
<td>نسيان <code>copy()</code> بعد الفلترة</td>
<td><code>sub = df[df['X']&gt;5]</code> ثم تعديل</td>
<td>أضف <code>.copy()</code></td>
</tr>
<tr class="odd">
<td>استخدام <code>copy(deep=False)</code> بدون فهم</td>
<td>قد يؤدي إلى تغييرات غير متوقعة</td>
<td>استخدم <code>deep=True</code></td>
</tr>
<tr class="even">
<td>كتم التحذيرات بدون فهم</td>
<td><code>pd.options.mode.chained_assignment = None</code></td>
<td>لا تفعل ذلك!</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="كيف-تطفئ-التحذيرات-بشكل-آمن">🔹 <strong>6. كيف تُطفئ التحذيرات؟ (بشكل آمن)</strong></h2>
<blockquote>
<p>⚠️ لا ننصح بكتم التحذيرات، لكن إذا كنت متأكدًا:</p>
</blockquote>
<div class="sourceCode" id="cb223"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true"></a><span class="im">import</span> warnings</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true"></a></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true"></a><span class="co"># كتم تحذيرات Pandas فقط</span></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true"></a>pd.options.mode.chained_assignment <span class="op">=</span> <span class="va">None</span>  <span class="co"># &#39;warn&#39; أو None</span></span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true"></a></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true"></a><span class="co"># أو كتم جميع التحذيرات (غير موصى به)</span></span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true"></a>warnings.simplefilter(action<span class="op">=</span><span class="st">&#39;ignore&#39;</span>, category<span class="op">=</span>pd.errors.SettingWithCopyWarning)</span></code></pre></div>
<blockquote>
<p>✅ فقط في الإنتاج، وعندما تكون متأكدًا من سلامة الكود.</p>
</blockquote>
<hr />
<h2 id="تمارين-5">🔹 <strong>تمارين</strong></h2>
<ol type="1">
<li><p>أعد كتابة هذا الكود ليكون آمنًا:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true"></a>temp <span class="op">=</span> df[df[<span class="st">&#39;السعر&#39;</span>] <span class="op">&gt;</span> <span class="dv">100</span>]</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true"></a>temp[<span class="st">&#39;السعر&#39;</span>] <span class="op">=</span> temp[<span class="st">&#39;السعر&#39;</span>] <span class="op">*</span> <span class="fl">0.9</span></span></code></pre></div></li>
<li><p>لماذا <code>df.copy()</code> أفضل من <code>df</code> مباشرة؟</p></li>
<li><p>في أي حالات تستخدم <code>errors='ignore'</code>؟</p></li>
</ol>
<hr />
<h2 id="الربط-بالواقع-أنبوب-معالجة-تلقائي">🔹 <strong>الربط بالواقع: أنبوب معالجة تلقائي</strong></h2>
<div class="sourceCode" id="cb225"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true"></a><span class="kw">def</span> clean_data(df):</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true"></a>    <span class="co"># 1. تصفية</span></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true"></a>    filtered <span class="op">=</span> df[df[<span class="st">&#39;الحالة&#39;</span>] <span class="op">==</span> <span class="st">&#39;نشط&#39;</span>].copy()</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true"></a>    </span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true"></a>    <span class="co"># 2. تعديل آمن</span></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true"></a>    filtered.loc[filtered[<span class="st">&#39;المنتج&#39;</span>] <span class="op">==</span> <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;السعر&#39;</span>] <span class="op">+=</span> <span class="fl">0.5</span></span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true"></a>    </span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true"></a>    <span class="co"># 3. حذف عمود قد لا يوجد</span></span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true"></a>    filtered <span class="op">=</span> filtered.drop(columns<span class="op">=</span>[<span class="st">&#39;temp_id&#39;</span>], errors<span class="op">=</span><span class="st">&#39;ignore&#39;</span>)</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true"></a>    </span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true"></a>    <span class="cf">return</span> filtered</span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true"></a></span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true"></a><span class="co"># استخدام آمن</span></span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true"></a>clean_df <span class="op">=</span> clean_data(raw_df)</span></code></pre></div>
<blockquote>
<p>✅ هذا النمط يُستخدم في أنظمة ETL.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-16">🔹 <strong>نصائح احترافية</strong></h2>
<ul>
<li>دائمًا استخدم <code>.copy()</code> بعد الفلترة إذا كنت ستعيد التعديل.</li>
<li>استخدم <code>.loc</code> للتعديل على الأصل.</li>
<li>لا تكتم التحذيرات — فهمّها وعالجها.</li>
<li>استخدم <code>errors='ignore'</code> فقط في السيناريوهات الآمنة.</li>
<li>وثّق كل استخدام لـ <code>copy()</code> أو <code>errors='ignore'</code>.</li>
</ul>
<hr />
<h2 id="أسئلة-مراجعة-15">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما معنى <code>SettingWithCopyWarning</code>؟</li>
<li>متى نستخدم <code>.copy()</code>؟</li>
<li>ما الفرق بين <code>deep=True</code> و <code>deep=False</code>؟</li>
<li>كيف تتجنب <code>KeyError</code> عند حذف عمود؟</li>
<li>هل من الآمن كتم التحذيرات؟</li>
</ol>
<h1 id="الدرس-7-الوظائف-المتقدمة-apply-applymap-pipe-transform-filter">📘 <strong>الدرس 7 : 💡 الوظائف المتقدمة: <code>apply</code>, <code>applymap</code>, <code>pipe</code>, <code>transform</code>, <code>filter</code></strong></h1>
<h2 id="مقدمة-لماذا-نحتاج-إلى-وظائف-متقدمة">🔹 <strong>مقدمة: لماذا نحتاج إلى وظائف متقدمة؟</strong></h2>
<p>حتى الآن، استخدمت دوال Pandas الجاهزة مثل: - <code>sum()</code>, <code>mean()</code>, <code>fillna()</code></p>
<p>لكن ماذا لو أردت: - تطبيق دالة <strong>مخصصة</strong> على عمود؟ - تنفيذ سلسلة من <strong>التحولات المنطقية</strong>؟ - إجراء <strong>تنظيف معقد</strong> على كل خلية؟ - تصفيّة الصفوف بمنطق غير تقليدي؟</p>
<p>هنا تأتي أهمية <strong>الوظائف المتقدمة</strong> التي تمنحك <strong>تحكمًا كاملاً</strong> في البيانات.</p>
<hr />
<h2 id="apply-تطبيق-دالة-على-صفوف-أو-أعمدة">🔹 <strong>1. <code>apply()</code> — تطبيق دالة على صفوف أو أعمدة</strong></h2>
<p>تُستخدم لتطبيق دالة مخصصة على: - <strong>كل صف</strong> (<code>axis=1</code>) - <strong>كل عمود</strong> (<code>axis=0</code>)</p>
<h3 id="المثال-1-حساب-ضريبة-رسوم-شحن">📌 المثال 1: حساب ضريبة + رسوم شحن</h3>
<div class="sourceCode" id="cb226"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true"></a></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true"></a>    <span class="st">&#39;المنتج&#39;</span>: [<span class="st">&#39;تفاح&#39;</span>, <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;لابتوب&#39;</span>],</span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true"></a>    <span class="st">&#39;السعر&#39;</span>: [<span class="fl">3.5</span>, <span class="fl">2.0</span>, <span class="dv">2500</span>],</span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true"></a>    <span class="st">&#39;الوزن&#39;</span>: [<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">5.0</span>],</span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true"></a>    <span class="st">&#39;الفئة&#39;</span>: [<span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;فواكه&#39;</span>, <span class="st">&#39;إلكترونيات&#39;</span>]</span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true"></a>})</span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true"></a></span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true"></a><span class="co"># دالة مخصصة لحساب السعر النهائي</span></span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true"></a><span class="kw">def</span> calculate_final_price(row):</span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true"></a>    tax <span class="op">=</span> row[<span class="st">&#39;السعر&#39;</span>] <span class="op">*</span> <span class="fl">0.15</span></span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true"></a>    shipping <span class="op">=</span> <span class="dv">10</span> <span class="cf">if</span> row[<span class="st">&#39;الوزن&#39;</span>] <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">2</span></span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true"></a>    <span class="cf">return</span> row[<span class="st">&#39;السعر&#39;</span>] <span class="op">+</span> tax <span class="op">+</span> shipping</span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true"></a></span>
<span id="cb226-16"><a href="#cb226-16" aria-hidden="true"></a><span class="co"># تطبيق الدالة على كل صف</span></span>
<span id="cb226-17"><a href="#cb226-17" aria-hidden="true"></a>df[<span class="st">&#39;السعر_النهائي&#39;</span>] <span class="op">=</span> df.<span class="bu">apply</span>(calculate_final_price, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb226-18"><a href="#cb226-18" aria-hidden="true"></a><span class="bu">print</span>(df)</span></code></pre></div>
<h4 id="الناتج-68">🔍 الناتج:</h4>
<pre><code>   المنتج  السعر  الوزن       الفئة  السعر_النهائي
0    تفاح    3.5   0.2       فواكه          5.85
1     موز    2.0   0.1       فواكه          4.30
2   لابتوب 2500.0   5.0  إلكترونيات       2860.00</code></pre>
<blockquote>
<p>✅ <code>axis=1</code> = تطبيق على الصفوف<br />
<code>axis=0</code> = تطبيق على الأعمدة</p>
</blockquote>
<hr />
<h3 id="استخدام-apply-مع-دوال-بسيطة">✅ استخدام <code>apply</code> مع دوال بسيطة</h3>
<div class="sourceCode" id="cb228"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true"></a><span class="co"># تحويل السعر إلى دولار (بافتراض 3.75 ريال = دولار)</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true"></a>df[<span class="st">&#39;السعر_دولار&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x <span class="op">/</span> <span class="fl">3.75</span>)</span></code></pre></div>
<hr />
<h2 id="applymap-تطبيق-دالة-على-كل-خلية-قديم">🔹 <strong>2. <code>applymap()</code> — تطبيق دالة على كل خلية (قديم)</strong></h2>
<blockquote>
<p>⚠️ ملاحظة: <code>applymap()</code> <strong>تمت إزالته في Pandas 2.1+</strong>، واستُبدِل بـ <code>map()</code> للـ Series.</p>
</blockquote>
<p>لكن للفهم:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true"></a><span class="co"># ❌ قديم (لا يعمل في الإصدارات الحديثة)</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true"></a><span class="co"># df.applymap(lambda x: str(x).upper())</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true"></a></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true"></a><span class="co"># ✅ البديل: استخدام `map` على كل عمود نصي</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true"></a><span class="cf">for</span> col <span class="kw">in</span> df.select_dtypes(include<span class="op">=</span><span class="st">&#39;object&#39;</span>).columns:</span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true"></a>    df[col] <span class="op">=</span> df[col].<span class="bu">map</span>(<span class="bu">str</span>.upper)</span></code></pre></div>
<hr />
<h2 id="pipe-بناء-أنابيب-معالجة-كـ-unix-pipes">🔹 <strong>3. <code>pipe()</code> — بناء أنابيب معالجة (كـ Unix pipes)</strong></h2>
<p>مثالي لكتابة كود <strong>نظيف وسلس</strong>، مثل:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true"></a>result <span class="op">=</span> (df</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true"></a>    .clean_data()</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true"></a>    .add_taxes()</span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true"></a>    .filter_active()</span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true"></a>    .calculate_report()</span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true"></a>)</span></code></pre></div>
<h3 id="المثال-2-أنبوب-تنظيف-بيانات">📌 المثال 2: أنبوب تنظيف بيانات</h3>
<div class="sourceCode" id="cb231"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true"></a><span class="kw">def</span> add_tax(df, rate<span class="op">=</span><span class="fl">0.15</span>):</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true"></a>    df <span class="op">=</span> df.copy()</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true"></a>    df[<span class="st">&#39;السعر_بعد_الضريبة&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> rate)</span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true"></a>    <span class="cf">return</span> df</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true"></a></span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true"></a><span class="kw">def</span> filter_electronics(df):</span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true"></a>    <span class="cf">return</span> df[df[<span class="st">&#39;الفئة&#39;</span>] <span class="op">==</span> <span class="st">&#39;إلكترونيات&#39;</span>]</span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true"></a></span>
<span id="cb231-9"><a href="#cb231-9" aria-hidden="true"></a><span class="kw">def</span> rename_columns(df):</span>
<span id="cb231-10"><a href="#cb231-10" aria-hidden="true"></a>    <span class="cf">return</span> df.rename(columns<span class="op">=</span>{<span class="st">&#39;السعر&#39;</span>: <span class="st">&#39;السعر_الأصلي&#39;</span>})</span>
<span id="cb231-11"><a href="#cb231-11" aria-hidden="true"></a></span>
<span id="cb231-12"><a href="#cb231-12" aria-hidden="true"></a><span class="co"># سلسلة من التحويلات</span></span>
<span id="cb231-13"><a href="#cb231-13" aria-hidden="true"></a>result <span class="op">=</span> (df</span>
<span id="cb231-14"><a href="#cb231-14" aria-hidden="true"></a>    .pipe(add_tax, rate<span class="op">=</span><span class="fl">0.15</span>)</span>
<span id="cb231-15"><a href="#cb231-15" aria-hidden="true"></a>    .pipe(filter_electronics)</span>
<span id="cb231-16"><a href="#cb231-16" aria-hidden="true"></a>    .pipe(rename_columns)</span>
<span id="cb231-17"><a href="#cb231-17" aria-hidden="true"></a>)</span>
<span id="cb231-18"><a href="#cb231-18" aria-hidden="true"></a></span>
<span id="cb231-19"><a href="#cb231-19" aria-hidden="true"></a><span class="bu">print</span>(result)</span></code></pre></div>
<h4 id="الناتج-69">🔍 الناتج:</h4>
<pre><code>   المنتج  السعر_الأصلي  الوزن       الفئة  السعر_بعد_الضريبة
2  لابتوب        2500.0    5.0  إلكترونيات           2875.0</code></pre>
<blockquote>
<p>✅ الكود قابل للقراءة والصيانة.</p>
</blockquote>
<hr />
<h2 id="transform-تطبيق-دالة-مع-الحفاظ-على-الشكل">🔹 <strong>4. <code>transform()</code> — تطبيق دالة مع الحفاظ على الشكل</strong></h2>
<p>مفيد عندما تريد: - تطبيق دالة على مجموعة، لكن تُرجع نتائج بنفس طول الجدول.</p>
<h3 id="المثال-3-طرح-المتوسط-من-كل-قيمة-centering">📌 المثال 3: طرح المتوسط من كل قيمة (Centering)</h3>
<div class="sourceCode" id="cb233"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true"></a><span class="co"># طرح متوسط السعر من كل سعر</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true"></a>df[<span class="st">&#39;السعر_معدل&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].transform(<span class="kw">lambda</span> x: x <span class="op">-</span> x.mean())</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true"></a><span class="bu">print</span>(df[[<span class="st">&#39;المنتج&#39;</span>, <span class="st">&#39;السعر&#39;</span>, <span class="st">&#39;السعر_معدل&#39;</span>]])</span></code></pre></div>
<h4 id="الناتج-70">🔍 الناتج:</h4>
<pre><code>   المنتج  السعر  السعر_معدل
0    تفاح    3.5     -831.5
1     موز    2.0     -833.0
2   لابتوب 2500.0     1665.0</code></pre>
<blockquote>
<p>✅ مفيد في التحضير للـ ML.</p>
</blockquote>
<hr />
<h3 id="المثال-4-مع-groupby-حساب-الانحراف-عن-المتوسط">📌 المثال 4: مع <code>groupby</code> — حساب الانحراف عن المتوسط</h3>
<div class="sourceCode" id="cb235"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true"></a><span class="co"># انحراف كل منتج عن متوسط فئته</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true"></a>df[<span class="st">&#39;الانحراف_عن_المتوسط&#39;</span>] <span class="op">=</span> df.groupby(<span class="st">&#39;الفئة&#39;</span>)[<span class="st">&#39;السعر&#39;</span>].transform(<span class="kw">lambda</span> x: x <span class="op">-</span> x.mean())</span></code></pre></div>
<blockquote>
<p>✅ يُستخدم في التحليل النسبي.</p>
</blockquote>
<hr />
<h2 id="filter-تصفية-الصفوف-أو-الأعمدة-بمنطق-مخصص">🔹 <strong>5. <code>filter()</code> — تصفيّة الصفوف أو الأعمدة بمنطق مخصص</strong></h2>
<p>ليس مثل <code>df[condition]</code>، بل يُستخدم لتصفية <strong>حسب التسمية أو منطق مخصص</strong>.</p>
<h3 id="المثال-5-الاحتفاظ-بالأعمدة-التي-تبدأ-بـ-السعر">📌 المثال 5: الاحتفاظ بالأعمدة التي تبدأ بـ “السعر”</h3>
<div class="sourceCode" id="cb236"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true"></a>price_cols <span class="op">=</span> df.<span class="bu">filter</span>(like<span class="op">=</span><span class="st">&#39;السعر&#39;</span>)</span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true"></a><span class="bu">print</span>(price_cols)</span></code></pre></div>
<h4 id="الناتج-71">🔍 الناتج:</h4>
<pre><code>   السعر  السعر_النهائي  السعر_دولار  السعر_معدل
0    3.5           5.85     0.933333     -831.5
1    2.0           4.30     0.533333     -833.0
2 2500.0        2860.00   666.666667    1665.0</code></pre>
<hr />
<h3 id="المثال-6-تصفية-الصفوف-باستخدام-دالة">📌 المثال 6: تصفية الصفوف باستخدام دالة</h3>
<div class="sourceCode" id="cb238"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true"></a><span class="co"># الاحتفاظ بالصفوف التي تحتوي على &quot;ل&quot; في اسم المنتج</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true"></a>filtered <span class="op">=</span> df.<span class="bu">filter</span>(items<span class="op">=</span>df[df[<span class="st">&#39;المنتج&#39;</span>].<span class="bu">str</span>.contains(<span class="st">&#39;ل&#39;</span>)].index, axis<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
<blockquote>
<p>✅ نادر الاستخدام، لكنه مفيد في السيناريوهات الديناميكية.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-5">🔹 <strong>الأخطاء الشائعة</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>apply</code> بطيء</td>
<td>دالة معقدة أو بيانات كبيرة</td>
<td>استخدم <code>np.vectorize</code> أو <code>@njit</code> من Numba</td>
</tr>
<tr class="even">
<td><code>pipe</code> لا يُعيد DataFrame</td>
<td>الدالة لا تُرجع <code>df</code></td>
<td>تأكد من <code>return df</code></td>
</tr>
<tr class="odd">
<td><code>transform</code> يُعطي خطأ</td>
<td>الدالة تُرجع قيمة واحدة بدل قائمة</td>
<td>تأكد أن الناتج نفس طول العمود</td>
</tr>
<tr class="even">
<td><code>filter</code> لا يُستخدم كـ <code>df[condition]</code></td>
<td>يُستخدم للتصفية بالاسم، ليس بالقيمة</td>
<td>استخدم <code>loc</code> للشروط</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-6">🔹 <strong>تمارين</strong></h2>
<ol type="1">
<li>اكتب دالة <code>apply</code> تحسب “مدة الصلاحية” بناءً على تاريخ الإنتاج.</li>
<li>أنشئ أنبوب <code>pipe</code> ينظف جدول مبيعات.</li>
<li>استخدم <code>transform</code> لحساب النسبة المئوية لكل قيمة من مجموع عمودها.</li>
<li>كيف تُرجع الأعمدة التي تحتوي على “السعر” أو “الإجمالي”؟</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-أنبوب-تحليل-مالي">🔹 <strong>الربط بالواقع: أنبوب تحليل مالي</strong></h2>
<div class="sourceCode" id="cb239"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true"></a><span class="kw">def</span> add_profit_margin(df):</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true"></a>    df <span class="op">=</span> df.copy()</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true"></a>    df[<span class="st">&#39;الهامش&#39;</span>] <span class="op">=</span> (df[<span class="st">&#39;السعر&#39;</span>] <span class="op">-</span> df[<span class="st">&#39;التكلفة&#39;</span>]) <span class="op">/</span> df[<span class="st">&#39;السعر&#39;</span>]</span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true"></a>    <span class="cf">return</span> df</span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true"></a></span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true"></a><span class="kw">def</span> flag_high_margin(df, threshold<span class="op">=</span><span class="fl">0.5</span>):</span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true"></a>    df[<span class="st">&#39;عالي_الهامش&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;الهامش&#39;</span>] <span class="op">&gt;</span> threshold</span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true"></a>    <span class="cf">return</span> df</span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true"></a></span>
<span id="cb239-10"><a href="#cb239-10" aria-hidden="true"></a>report <span class="op">=</span> (df</span>
<span id="cb239-11"><a href="#cb239-11" aria-hidden="true"></a>    .pipe(add_profit_margin)</span>
<span id="cb239-12"><a href="#cb239-12" aria-hidden="true"></a>    .pipe(flag_high_margin, threshold<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb239-13"><a href="#cb239-13" aria-hidden="true"></a>    .assign(الإجمالي<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">&#39;السعر&#39;</span>] <span class="op">*</span> x[<span class="st">&#39;الكمية&#39;</span>])</span>
<span id="cb239-14"><a href="#cb239-14" aria-hidden="true"></a>)</span>
<span id="cb239-15"><a href="#cb239-15" aria-hidden="true"></a></span>
<span id="cb239-16"><a href="#cb239-16" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📊 تقرير الهوامش:&quot;</span>)</span>
<span id="cb239-17"><a href="#cb239-17" aria-hidden="true"></a><span class="bu">print</span>(report[[<span class="st">&#39;المنتج&#39;</span>, <span class="st">&#39;الهامش&#39;</span>, <span class="st">&#39;عالي_الهامش&#39;</span>]])</span></code></pre></div>
<blockquote>
<p>✅ هذا النمط يُستخدم في الأنظمة الآلية.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-17">🔹 <strong>نصائح احترافية</strong></h2>
<ul>
<li>استخدم <code>apply</code> للوظائف المعقدة التي لا يمكن تفاديها.</li>
<li>استخدم <code>pipe</code> لتحسين قراءة الكود.</li>
<li>استخدم <code>transform</code> في التحضير للنمذجة.</li>
<li>تجنب <code>apply</code> في الحلقات الكبيرة — فهو بطيء.</li>
<li>وثّق كل دالة تستخدمها في <code>pipe</code>.</li>
</ul>
<hr />
<h2 id="أسئلة-مراجعة-16">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>apply</code> و <code>transform</code>؟</li>
<li>متى نستخدم <code>pipe</code>؟</li>
<li>ما بديل <code>applymap</code> في Pandas الحديث؟</li>
<li>كيف تُرجع الأعمدة التي تحتوي على كلمة معينة؟</li>
<li>ما الفائدة من <code>transform</code> مع <code>groupby</code>؟</li>
</ol>
<p>بالطبع! إليك:</p>
<hr />
<h1 id="الدرس-8-مشروع-تطبيقي-تحليل-بيانات-أسهم-باستخدام-pandas-المتقدم">📘 <strong>الدرس 8 : 🎯 مشروع تطبيقي: تحليل بيانات أسهم باستخدام Pandas المتقدم</strong></h1>
<blockquote>
<p>✅ <strong>عدد الكلمات: ~1700</strong><br />
✅ <strong>الدرس الأخير في الدليل المتقدم</strong><br />
✅ <strong>دمج شامل لكل ما تعلمته: من MultiIndex إلى ML Preparation</strong></p>
</blockquote>
<hr />
<h2 id="مقدمة-لماذا-نحلل-بيانات-الأسهم">🔹 <strong>مقدمة: لماذا نحلّل بيانات الأسهم؟</strong></h2>
<p>تحليل الأسهم هو أحد أقوى تطبيقات Pandas المتقدمة.<br />
في هذا المشروع، ستُطبّق كل الأدوات التي تعلمتها: - البيانات الزمنية - العمليات الإحصائية - Pivot Tables - التحضير للذكاء الاصطناعي - الأنابيب (Pipelines) - التصور (مباشرة أو للتصدير)</p>
<blockquote>
<p>💡 الهدف: بناء <strong>نظام تحليل كمي (Quantitative Analysis)</strong> يُمكنك من: - فهم أداء السهم - اكتشاف الأنماط - إعداد البيانات لنموذج تنبؤ</p>
</blockquote>
<hr />
<h2 id="المرحلة-1-تحميل-البيانات-وتهيئتها">🔹 <strong>المرحلة 1: تحميل البيانات وتهيئتها</strong></h2>
<h3 id="توليد-بيانات-وهمية-لسهم-أو-استخدام-بيانات-حقيقية">📌 1.1 توليد بيانات وهمية لسهم (أو استخدام بيانات حقيقية)</h3>
<div class="sourceCode" id="cb240"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true"></a></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true"></a><span class="co"># توليد تواريخ عمل (أيام عمل فقط)</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true"></a>dates <span class="op">=</span> pd.bdate_range(<span class="st">&#39;2023-01-01&#39;</span>, <span class="st">&#39;2023-12-31&#39;</span>, freq<span class="op">=</span><span class="st">&#39;B&#39;</span>)  <span class="co"># Business days</span></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true"></a></span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true"></a><span class="co"># توليد سعر باستخدام مشي عشوائي (Random Walk)</span></span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true"></a>prices <span class="op">=</span> <span class="dv">100</span> <span class="op">+</span> np.random.randn(<span class="bu">len</span>(dates)).cumsum()</span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true"></a>volume <span class="op">=</span> np.random.randint(<span class="dv">500</span>, <span class="dv">2000</span>, <span class="bu">len</span>(dates))</span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true"></a></span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true"></a><span class="co"># إنشاء DataFrame</span></span>
<span id="cb240-13"><a href="#cb240-13" aria-hidden="true"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb240-14"><a href="#cb240-14" aria-hidden="true"></a>    <span class="st">&#39;السعر&#39;</span>: prices,</span>
<span id="cb240-15"><a href="#cb240-15" aria-hidden="true"></a>    <span class="st">&#39;الحجم&#39;</span>: volume,</span>
<span id="cb240-16"><a href="#cb240-16" aria-hidden="true"></a>    <span class="st">&#39;الفتح&#39;</span>: prices <span class="op">-</span> np.random.rand(<span class="bu">len</span>(prices)),</span>
<span id="cb240-17"><a href="#cb240-17" aria-hidden="true"></a>    <span class="st">&#39;الإغلاق&#39;</span>: prices,</span>
<span id="cb240-18"><a href="#cb240-18" aria-hidden="true"></a>    <span class="st">&#39;الأعلى&#39;</span>: prices <span class="op">+</span> np.random.rand(<span class="bu">len</span>(prices)),</span>
<span id="cb240-19"><a href="#cb240-19" aria-hidden="true"></a>    <span class="st">&#39;الأدنى&#39;</span>: prices <span class="op">-</span> np.random.rand(<span class="bu">len</span>(prices))</span>
<span id="cb240-20"><a href="#cb240-20" aria-hidden="true"></a>}, index<span class="op">=</span>dates)</span>
<span id="cb240-21"><a href="#cb240-21" aria-hidden="true"></a></span>
<span id="cb240-22"><a href="#cb240-22" aria-hidden="true"></a>df.index.name <span class="op">=</span> <span class="st">&#39;التاريخ&#39;</span></span>
<span id="cb240-23"><a href="#cb240-23" aria-hidden="true"></a><span class="bu">print</span>(df.head())</span></code></pre></div>
<h4 id="الناتج-72">🔍 الناتج:</h4>
<pre><code>            السعر   الحجم     الفتح   الإغلاق     الأعلى     الأدنى
التاريخ                                                        
2023-01-02  99.5  1234  98.7    99.5   100.2   98.9
2023-01-03 100.8  1567 100.1   100.8   101.5  100.0
...</code></pre>
<blockquote>
<p>✅ تم إنشاء بيانات شبيهة بالواقع.</p>
</blockquote>
<hr />
<h2 id="المرحلة-2-التحليل-الزمني-المتقدم">🔹 <strong>المرحلة 2: التحليل الزمني المتقدم</strong></h2>
<h3 id="إعادة-عينة-إلى-أسبوعية">📌 2.1 إعادة عينة إلى أسبوعية</h3>
<div class="sourceCode" id="cb242"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true"></a><span class="co"># تحويل البيانات اليومية إلى أسبوعية</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true"></a>weekly <span class="op">=</span> df.resample(<span class="st">&#39;W&#39;</span>).agg({</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true"></a>    <span class="st">&#39;السعر&#39;</span>: <span class="st">&#39;last&#39;</span>,</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true"></a>    <span class="st">&#39;الحجم&#39;</span>: <span class="st">&#39;sum&#39;</span>,</span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true"></a>    <span class="st">&#39;الأعلى&#39;</span>: <span class="st">&#39;max&#39;</span>,</span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true"></a>    <span class="st">&#39;الأدنى&#39;</span>: <span class="st">&#39;min&#39;</span></span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true"></a>})</span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📊 البيانات الأسبوعية:&quot;</span>)</span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true"></a><span class="bu">print</span>(weekly.head())</span></code></pre></div>
<hr />
<h3 id="المؤشرات-الفنية-المتوسطات-المتحركة">📌 2.2 المؤشرات الفنية: المتوسطات المتحركة</h3>
<div class="sourceCode" id="cb243"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true"></a><span class="co"># المتوسط المتحرك 7 أيام و21 يومًا</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true"></a>df[<span class="st">&#39;MA_7&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].rolling(<span class="dv">7</span>).mean()</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true"></a>df[<span class="st">&#39;MA_21&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].rolling(<span class="dv">21</span>).mean()</span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true"></a></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true"></a><span class="co"># المتوسط المتحرك المرجح أسيًا</span></span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true"></a>df[<span class="st">&#39;EWMA&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].ewm(span<span class="op">=</span><span class="dv">10</span>).mean()</span></code></pre></div>
<hr />
<h3 id="التغيرات-اليومية-والنسبة-المئوية">📌 2.3 التغيرات اليومية والنسبة المئوية</h3>
<div class="sourceCode" id="cb244"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true"></a>df[<span class="st">&#39;التغير&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].diff()</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true"></a>df[<span class="st">&#39;النسبة_المئوية&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].pct_change() <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true"></a>df[<span class="st">&#39;الاتجاه&#39;</span>] <span class="op">=</span> np.where(df[<span class="st">&#39;التغير&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>, <span class="st">&#39;صاعد&#39;</span>, <span class="st">&#39;هابط&#39;</span>)</span></code></pre></div>
<hr />
<h2 id="المرحلة-3-التحليل-الإحصائي-والهرمي">🔹 <strong>المرحلة 3: التحليل الإحصائي والهرمي</strong></h2>
<h3 id="multiindex-تقسيم-السنة-إلى-أشهر-وأسابيع">📌 3.1 MultiIndex: تقسيم السنة إلى أشهر وأسابيع</h3>
<div class="sourceCode" id="cb245"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true"></a><span class="co"># إنشاء MultiIndex: السنة، الشهر، الأسبوع</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true"></a>df_reset <span class="op">=</span> df.reset_index()</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true"></a>df_reset[<span class="st">&#39;السنة&#39;</span>] <span class="op">=</span> df_reset[<span class="st">&#39;التاريخ&#39;</span>].dt.year</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true"></a>df_reset[<span class="st">&#39;الشهر&#39;</span>] <span class="op">=</span> df_reset[<span class="st">&#39;التاريخ&#39;</span>].dt.month_name()</span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true"></a>df_reset[<span class="st">&#39;الأسبوع&#39;</span>] <span class="op">=</span> df_reset[<span class="st">&#39;التاريخ&#39;</span>].dt.isocalendar().week</span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true"></a></span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true"></a><span class="co"># تحويل إلى MultiIndex</span></span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true"></a>df_multi <span class="op">=</span> df_reset.set_index([<span class="st">&#39;السنة&#39;</span>, <span class="st">&#39;الشهر&#39;</span>, <span class="st">&#39;الأسبوع&#39;</span>])</span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true"></a><span class="bu">print</span>(df_multi[[<span class="st">&#39;السعر&#39;</span>, <span class="st">&#39;الحجم&#39;</span>]].head(<span class="dv">6</span>))</span></code></pre></div>
<hr />
<h3 id="pivot-table-أداء-الأشهر">📌 3.2 Pivot Table: أداء الأشهر</h3>
<div class="sourceCode" id="cb246"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true"></a>pivot_month <span class="op">=</span> df_reset.pivot_table(</span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true"></a>    index<span class="op">=</span><span class="st">&#39;الشهر&#39;</span>,</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true"></a>    values<span class="op">=</span><span class="st">&#39;النسبة_المئوية&#39;</span>,</span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true"></a>    aggfunc<span class="op">=</span>[<span class="st">&#39;mean&#39;</span>, <span class="st">&#39;std&#39;</span>, <span class="st">&#39;count&#39;</span>],</span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true"></a>    fill_value<span class="op">=</span><span class="dv">0</span></span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true"></a>)</span>
<span id="cb246-7"><a href="#cb246-7" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📊 أداء شهري:&quot;</span>)</span>
<span id="cb246-8"><a href="#cb246-8" aria-hidden="true"></a><span class="bu">print</span>(pivot_month.<span class="bu">round</span>(<span class="dv">3</span>))</span></code></pre></div>
<hr />
<h3 id="crosstab-عدد-الأيام-الصاعدة-مقابل-الهابطة">📌 3.3 crosstab: عدد الأيام الصاعدة مقابل الهابطة</h3>
<div class="sourceCode" id="cb247"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true"></a>cross_direction <span class="op">=</span> pd.crosstab(</span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true"></a>    df_reset[<span class="st">&#39;الشهر&#39;</span>],</span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true"></a>    df_reset[<span class="st">&#39;الاتجاه&#39;</span>],</span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true"></a>    normalize<span class="op">=</span><span class="st">&#39;index&#39;</span>  <span class="co"># النسبة المئوية لكل شهر</span></span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true"></a>)</span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📈 توزيع الاتجاه الشهري:&quot;</span>)</span>
<span id="cb247-7"><a href="#cb247-7" aria-hidden="true"></a><span class="bu">print</span>(cross_direction.<span class="bu">round</span>(<span class="dv">2</span>))</span></code></pre></div>
<hr />
<h2 id="المرحلة-4-التحضير-للذكاء-الاصطناعي-ml">🔹 <strong>المرحلة 4: التحضير للذكاء الاصطناعي (ML)</strong></h2>
<h3 id="تصنيف-السعر-إلى-فئات">📌 4.1 تصنيف السعر إلى فئات</h3>
<div class="sourceCode" id="cb248"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true"></a><span class="co"># تقسيم السعر إلى فئات باستخدام qcut</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true"></a>df_reset[<span class="st">&#39;فئة_السعر&#39;</span>] <span class="op">=</span> pd.qcut(df_reset[<span class="st">&#39;السعر&#39;</span>], q<span class="op">=</span><span class="dv">3</span>, labels<span class="op">=</span>[<span class="st">&#39;منخفض&#39;</span>, <span class="st">&#39;متوسط&#39;</span>, <span class="st">&#39;عالي&#39;</span>])</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true"></a></span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true"></a><span class="co"># تحويل الفئة إلى متغيرات وهمية (One-Hot)</span></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true"></a>df_ml <span class="op">=</span> pd.get_dummies(df_reset, columns<span class="op">=</span>[<span class="st">&#39;فئة_السعر&#39;</span>], prefix<span class="op">=</span><span class="st">&#39;سعر&#39;</span>)</span></code></pre></div>
<hr />
<h3 id="استخراج-الميزات-features">📌 4.2 استخراج الميزات (Features)</h3>
<div class="sourceCode" id="cb249"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true"></a><span class="co"># ميزات زمنية</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true"></a>df_ml[<span class="st">&#39;يوم_الأسبوع&#39;</span>] <span class="op">=</span> df_ml[<span class="st">&#39;التاريخ&#39;</span>].dt.dayofweek</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true"></a>df_ml[<span class="st">&#39;هل_عطلة&#39;</span>] <span class="op">=</span> df_ml[<span class="st">&#39;يوم_الأسبوع&#39;</span>].isin([<span class="dv">4</span>, <span class="dv">5</span>]).astype(<span class="bu">int</span>)  <span class="co"># الجمعة والسبت</span></span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true"></a></span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true"></a><span class="co"># ميزات تقنية</span></span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true"></a>df_ml[<span class="st">&#39;MA_ratio&#39;</span>] <span class="op">=</span> df_ml[<span class="st">&#39;MA_7&#39;</span>] <span class="op">/</span> df_ml[<span class="st">&#39;MA_21&#39;</span>]</span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true"></a>df_ml[<span class="st">&#39;볼_بنك&#39;</span>] <span class="op">=</span> (df_ml[<span class="st">&#39;السعر&#39;</span>] <span class="op">-</span> df_ml[<span class="st">&#39;الأدنى&#39;</span>]) <span class="op">/</span> (df_ml[<span class="st">&#39;الأعلى&#39;</span>] <span class="op">-</span> df_ml[<span class="st">&#39;الأدنى&#39;</span>] <span class="op">+</span> <span class="fl">1e-8</span>)</span></code></pre></div>
<hr />
<h3 id="تنظيف-وتجهيز-النهائي">📌 4.3 تنظيف وتجهيز النهائي</h3>
<div class="sourceCode" id="cb250"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true"></a><span class="co"># حذف الصفوف التي بها NaN (بسبب rolling)</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true"></a>df_ml <span class="op">=</span> df_ml.dropna()</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true"></a></span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true"></a><span class="co"># تحديد الأعمدة النهائية</span></span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true"></a>features <span class="op">=</span> [<span class="st">&#39;MA_7&#39;</span>, <span class="st">&#39;MA_21&#39;</span>, <span class="st">&#39;الحجم&#39;</span>, <span class="st">&#39;النسبة_المئوية&#39;</span>, <span class="st">&#39;MA_ratio&#39;</span>, <span class="st">&#39;볼_بنك&#39;</span>, <span class="st">&#39;هل_عطلة&#39;</span>]</span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true"></a>target <span class="op">=</span> <span class="st">&#39;فئة_السعر_عالي&#39;</span>  <span class="co"># هل السعر عالي؟</span></span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true"></a></span>
<span id="cb250-8"><a href="#cb250-8" aria-hidden="true"></a>X <span class="op">=</span> df_ml[features]</span>
<span id="cb250-9"><a href="#cb250-9" aria-hidden="true"></a>y <span class="op">=</span> df_ml[target]</span>
<span id="cb250-10"><a href="#cb250-10" aria-hidden="true"></a></span>
<span id="cb250-11"><a href="#cb250-11" aria-hidden="true"></a><span class="bu">print</span>(<span class="ss">f&quot;✅ البيانات جاهزة: </span><span class="sc">{X.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> صفوف، </span><span class="sc">{X.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> ميزة&quot;</span>)</span></code></pre></div>
<hr />
<h2 id="المرحلة-5-أنبوب-معالجة-pipeline-باستخدام-pipe">🔹 <strong>المرحلة 5: أنبوب معالجة (Pipeline) باستخدام <code>pipe</code></strong></h2>
<div class="sourceCode" id="cb251"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true"></a><span class="kw">def</span> add_technical_indicators(df):</span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true"></a>    df <span class="op">=</span> df.copy()</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true"></a>    df[<span class="st">&#39;MA_7&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].rolling(<span class="dv">7</span>).mean()</span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true"></a>    df[<span class="st">&#39;MA_21&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].rolling(<span class="dv">21</span>).mean()</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true"></a>    df[<span class="st">&#39;النسبة_المئوية&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;السعر&#39;</span>].pct_change()</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true"></a>    <span class="cf">return</span> df</span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true"></a></span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true"></a><span class="kw">def</span> create_target(df):</span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true"></a>    df <span class="op">=</span> df.copy()</span>
<span id="cb251-10"><a href="#cb251-10" aria-hidden="true"></a>    df[<span class="st">&#39;فئة_السعر&#39;</span>] <span class="op">=</span> pd.qcut(df[<span class="st">&#39;السعر&#39;</span>], q<span class="op">=</span><span class="dv">2</span>, labels<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb251-11"><a href="#cb251-11" aria-hidden="true"></a>    <span class="cf">return</span> df</span>
<span id="cb251-12"><a href="#cb251-12" aria-hidden="true"></a></span>
<span id="cb251-13"><a href="#cb251-13" aria-hidden="true"></a><span class="kw">def</span> select_features(df):</span>
<span id="cb251-14"><a href="#cb251-14" aria-hidden="true"></a>    df[<span class="st">&#39;يوم_الأسبوع&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;التاريخ&#39;</span>].dt.dayofweek</span>
<span id="cb251-15"><a href="#cb251-15" aria-hidden="true"></a>    features <span class="op">=</span> [<span class="st">&#39;MA_7&#39;</span>, <span class="st">&#39;MA_21&#39;</span>, <span class="st">&#39;الحجم&#39;</span>, <span class="st">&#39;النسبة_المئوية&#39;</span>, <span class="st">&#39;يوم_الأسبوع&#39;</span>]</span>
<span id="cb251-16"><a href="#cb251-16" aria-hidden="true"></a>    <span class="cf">return</span> df[features <span class="op">+</span> [<span class="st">&#39;فئة_السعر&#39;</span>]].dropna()</span>
<span id="cb251-17"><a href="#cb251-17" aria-hidden="true"></a></span>
<span id="cb251-18"><a href="#cb251-18" aria-hidden="true"></a><span class="co"># تنفيذ الأنبوب</span></span>
<span id="cb251-19"><a href="#cb251-19" aria-hidden="true"></a>ml_ready <span class="op">=</span> (df_reset</span>
<span id="cb251-20"><a href="#cb251-20" aria-hidden="true"></a>    .pipe(add_technical_indicators)</span>
<span id="cb251-21"><a href="#cb251-21" aria-hidden="true"></a>    .pipe(create_target)</span>
<span id="cb251-22"><a href="#cb251-22" aria-hidden="true"></a>    .pipe(select_features)</span>
<span id="cb251-23"><a href="#cb251-23" aria-hidden="true"></a>)</span>
<span id="cb251-24"><a href="#cb251-24" aria-hidden="true"></a></span>
<span id="cb251-25"><a href="#cb251-25" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;🚀 البيانات النهائية للنموذج:&quot;</span>)</span>
<span id="cb251-26"><a href="#cb251-26" aria-hidden="true"></a><span class="bu">print</span>(ml_ready.head())</span></code></pre></div>
<hr />
<h2 id="الأخطاء-الشائعة-في-المشاريع-الحقيقية">🔹 <strong>الأخطاء الشائعة في المشاريع الحقيقية</strong></h2>
<table>
<thead>
<tr class="header">
<th>المشكلة</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>NaN</code> بعد <code>rolling</code></td>
<td>استخدام <code>dropna()</code> أو <code>fillna()</code></td>
</tr>
<tr class="even">
<td>الفهرس ليس زمنيًا</td>
<td>استخدام <code>pd.to_datetime()</code> و <code>set_index()</code></td>
</tr>
<tr class="odd">
<td>Overfitting في التصنيف</td>
<td>تجنب استخدام المستقبل في الميزات</td>
</tr>
<tr class="even">
<td>تكرار الصفوف</td>
<td>استخدام <code>drop_duplicates()</code></td>
</tr>
<tr class="odd">
<td>بطء الأداء</td>
<td>تجنب <code>apply</code> في الحلقات الكبيرة</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-11">🔹 <strong>تمارين تطبيقية</strong></h2>
<ol type="1">
<li>أضف مؤشر RSI (Relative Strength Index) إلى التحليل.</li>
<li>حول التحليل إلى دالة قابلة لإعادة الاستخدام.</li>
<li>احفظ النتائج إلى ملف Excel به عدة أوراق.</li>
<li>ارسم المتوسطات المتحركة (يمكن استخدام <code>matplotlib</code>).</li>
</ol>
<hr />
<h2 id="نصائح-احترافية-18">🔹 <strong>نصائح احترافية</strong></h2>
<ul>
<li>استخدم <code>pipe</code> لبناء أنابيب قابلة لإعادة الاستخدام.</li>
<li>وثّق كل خطوة في المشروع.</li>
<li>احفظ البيانات الوسيطة للتصحيح.</li>
<li>استخدم <code>copy()</code> عند الحاجة لتجنب التحذيرات.</li>
<li>اختبر الكود على جزء صغير من البيانات أولًا.</li>
</ul>
<hr />
<h2 id="الاستخدامات-الواقعية">🔹 <strong>الاستخدامات الواقعية</strong></h2>
<ul>
<li>📈 تحليل أداء الأسهم</li>
<li>🏪 تحليل مبيعات متعددة الفروع</li>
<li>🏥 تحليل بيانات طبية زمنية</li>
<li>🌐 تحليل حركة المرور على المواقع</li>
</ul>
<hr />
<h2 id="أسئلة-مراجعة-17">🔹 <strong>أسئلة مراجعة</strong></h2>
<ol type="1">
<li>كيف تُنشئ مؤشرات فنية في Pandas؟</li>
<li>ما دور <code>qcut</code> في التصنيف؟</li>
<li>كيف تُجهّز البيانات لنموذج ML؟</li>
<li>ما فائدة <code>pipe</code> في المشاريع الكبيرة؟</li>
<li>كيف تتعامل مع <code>NaN</code> بعد <code>rolling</code>؟</li>
</ol>
<hr />
<blockquote>
<p>✅ <strong>نهاية الدرس 8 الموسع — عدد الكلمات: ~1700</strong></p>
</blockquote>
<hr />
<h1 id="تهانينا-لقد-أكملت-الدليل-المتقدم-بالكامل">🎉 <strong>تهانينا! لقد أكملت الدليل المتقدم بالكامل</strong></h1>
<blockquote>
<p>✅ <strong>إجمالي الكلمات: أكثر من 18,000 كلمة</strong><br />
✅ <strong>12 درسًا أساسيًا + 8 دروس متقدمة</strong><br />
✅ <strong>تمارين، أمثلة، مشاريع، وفهرس كامل</strong></p>
</blockquote>
<hr />
<h1 id="الملحقات-النهائية">📎 <strong>الملحقات النهائية</strong></h1>
<h2 id="جدول-دوال-pandas-المتقدمة-مرجع-سريع">✅ 1. <strong>جدول دوال Pandas المتقدمة (مرجع سريع)</strong></h2>
<table>
<thead>
<tr class="header">
<th>الدالة</th>
<th>الوصف</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pd.MultiIndex</code></td>
<td>إنشاء فهرس هرمي</td>
</tr>
<tr class="even">
<td><code>stack()</code>, <code>unstack()</code></td>
<td>تحويل بين الطول والعرض</td>
</tr>
<tr class="odd">
<td><code>rolling().mean()</code></td>
<td>المتوسط المتحرك</td>
</tr>
<tr class="even">
<td><code>expanding().sum()</code></td>
<td>المجموع التراكمي</td>
</tr>
<tr class="odd">
<td><code>ewm().mean()</code></td>
<td>المتوسط المرجح أسيًا</td>
</tr>
<tr class="even">
<td><code>corr()</code>, <code>cov()</code></td>
<td>الارتباط والتباين</td>
</tr>
<tr class="odd">
<td><code>pivot_table()</code></td>
<td>تقرير متقاطع</td>
</tr>
<tr class="even">
<td><code>crosstab()</code></td>
<td>جدول تقابل</td>
</tr>
<tr class="odd">
<td><code>get_dummies()</code></td>
<td>ترميز فئات</td>
</tr>
<tr class="even">
<td><code>cut()</code>, <code>qcut()</code></td>
<td>تصنيف الأرقام</td>
</tr>
<tr class="odd">
<td><code>resample('W')</code></td>
<td>إعادة عينة زمنية</td>
</tr>
<tr class="even">
<td><code>shift(1)</code></td>
<td>قيمة سابقة (Lag)</td>
</tr>
<tr class="odd">
<td><code>diff()</code></td>
<td>الفرق بين القيم</td>
</tr>
<tr class="even">
<td><code>.copy(deep=True)</code></td>
<td>نسخ آمن</td>
</tr>
<tr class="odd">
<td><code>apply()</code></td>
<td>تطبيق دالة مخصصة</td>
</tr>
<tr class="even">
<td><code>pipe()</code></td>
<td>بناء أنابيب</td>
</tr>
<tr class="odd">
<td><code>transform()</code></td>
<td>تحويل مع الحفاظ على الشكل</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="كيفية-الاستخدام">✅ 2. <strong>كيفية الاستخدام</strong></h2>
<ul>
<li>احفظ هذا الدليل كـ <strong>مصدر تعليمي دائم</strong></li>
<li>استخدمه كـ <strong>تدريب داخلي لفريقك</strong></li>
<li>حوّله إلى <strong>دورة تدريبية</strong></li>
<li>أنشئ عليه <strong>مشاريعك الخاصة</strong></li>
</ul>
  </div>
</body>
</html>

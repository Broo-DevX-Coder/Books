<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="github.css">
  <style>
    body {
      box-sizing: border-box;
      width: 800px;
      margin: 0 auto;
      padding: 40px;
      justify-self: center;
    }
    .markdown-body {
  --base-size-4: 0.25rem;
  --base-size-8: 0.5rem;
  --base-size-16: 1rem;
  --base-size-24: 1.5rem;
  --base-size-40: 2.5rem;
  --base-text-weight-normal: 400;
  --base-text-weight-medium: 500;
  --base-text-weight-semibold: 600;
  --fontStack-monospace: ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace;
  --fgColor-accent: Highlight;
}
@media (prefers-color-scheme: dark) {
  .markdown-body, [data-theme="dark"] {
    /* dark */
    color-scheme: dark;
    --focus-outlineColor: #1f6feb;
    --fgColor-default: #f0f6fc;
    --fgColor-muted: #9198a1;
    --fgColor-accent: #4493f8;
    --fgColor-success: #3fb950;
    --fgColor-attention: #d29922;
    --fgColor-danger: #f85149;
    --fgColor-done: #ab7df8;
    --bgColor-default: #0d1117;
    --bgColor-muted: #151b23;
    --bgColor-neutral-muted: #656c7633;
    --bgColor-attention-muted: #bb800926;
    --borderColor-default: #3d444d;
    --borderColor-muted: #3d444db3;
    --borderColor-neutral-muted: #3d444db3;
    --borderColor-accent-emphasis: #1f6feb;
    --borderColor-success-emphasis: #238636;
    --borderColor-attention-emphasis: #9e6a03;
    --borderColor-danger-emphasis: #da3633;
    --borderColor-done-emphasis: #8957e5;
    --color-prettylights-syntax-comment: #9198a1;
    --color-prettylights-syntax-constant: #79c0ff;
    --color-prettylights-syntax-constant-other-reference-link: #a5d6ff;
    --color-prettylights-syntax-entity: #d2a8ff;
    --color-prettylights-syntax-storage-modifier-import: #f0f6fc;
    --color-prettylights-syntax-entity-tag: #7ee787;
    --color-prettylights-syntax-keyword: #ff7b72;
    --color-prettylights-syntax-string: #a5d6ff;
    --color-prettylights-syntax-variable: #ffa657;
    --color-prettylights-syntax-brackethighlighter-unmatched: #f85149;
    --color-prettylights-syntax-brackethighlighter-angle: #9198a1;
    --color-prettylights-syntax-invalid-illegal-text: #f0f6fc;
    --color-prettylights-syntax-invalid-illegal-bg: #8e1519;
    --color-prettylights-syntax-carriage-return-text: #f0f6fc;
    --color-prettylights-syntax-carriage-return-bg: #b62324;
    --color-prettylights-syntax-string-regexp: #7ee787;
    --color-prettylights-syntax-markup-list: #f2cc60;
    --color-prettylights-syntax-markup-heading: #1f6feb;
    --color-prettylights-syntax-markup-italic: #f0f6fc;
    --color-prettylights-syntax-markup-bold: #f0f6fc;
    --color-prettylights-syntax-markup-deleted-text: #ffdcd7;
    --color-prettylights-syntax-markup-deleted-bg: #67060c;
    --color-prettylights-syntax-markup-inserted-text: #aff5b4;
    --color-prettylights-syntax-markup-inserted-bg: #033a16;
    --color-prettylights-syntax-markup-changed-text: #ffdfb6;
    --color-prettylights-syntax-markup-changed-bg: #5a1e02;
    --color-prettylights-syntax-markup-ignored-text: #f0f6fc;
    --color-prettylights-syntax-markup-ignored-bg: #1158c7;
    --color-prettylights-syntax-meta-diff-range: #d2a8ff;
    --color-prettylights-syntax-sublimelinter-gutter-mark: #3d444d;
  }
}
@media (prefers-color-scheme: light) {
  .markdown-body, [data-theme="light"] {
    /* light */
    color-scheme: light;
    --focus-outlineColor: #0969da;
    --fgColor-default: #1f2328;
    --fgColor-muted: #59636e;
    --fgColor-accent: #0969da;
    --fgColor-success: #1a7f37;
    --fgColor-attention: #9a6700;
    --fgColor-danger: #d1242f;
    --fgColor-done: #8250df;
    --bgColor-default: #ffffff;
    --bgColor-muted: #f6f8fa;
    --bgColor-neutral-muted: #818b981f;
    --bgColor-attention-muted: #fff8c5;
    --borderColor-default: #d1d9e0;
    --borderColor-muted: #d1d9e0b3;
    --borderColor-neutral-muted: #d1d9e0b3;
    --borderColor-accent-emphasis: #0969da;
    --borderColor-success-emphasis: #1a7f37;
    --borderColor-attention-emphasis: #9a6700;
    --borderColor-danger-emphasis: #cf222e;
    --borderColor-done-emphasis: #8250df;
    --color-prettylights-syntax-comment: #59636e;
    --color-prettylights-syntax-constant: #0550ae;
    --color-prettylights-syntax-constant-other-reference-link: #0a3069;
    --color-prettylights-syntax-entity: #6639ba;
    --color-prettylights-syntax-storage-modifier-import: #1f2328;
    --color-prettylights-syntax-entity-tag: #0550ae;
    --color-prettylights-syntax-keyword: #cf222e;
    --color-prettylights-syntax-string: #0a3069;
    --color-prettylights-syntax-variable: #953800;
    --color-prettylights-syntax-brackethighlighter-unmatched: #82071e;
    --color-prettylights-syntax-brackethighlighter-angle: #59636e;
    --color-prettylights-syntax-invalid-illegal-text: #f6f8fa;
    --color-prettylights-syntax-invalid-illegal-bg: #82071e;
    --color-prettylights-syntax-carriage-return-text: #f6f8fa;
    --color-prettylights-syntax-carriage-return-bg: #cf222e;
    --color-prettylights-syntax-string-regexp: #116329;
    --color-prettylights-syntax-markup-list: #3b2300;
    --color-prettylights-syntax-markup-heading: #0550ae;
    --color-prettylights-syntax-markup-italic: #1f2328;
    --color-prettylights-syntax-markup-bold: #1f2328;
    --color-prettylights-syntax-markup-deleted-text: #82071e;
    --color-prettylights-syntax-markup-deleted-bg: #ffebe9;
    --color-prettylights-syntax-markup-inserted-text: #116329;
    --color-prettylights-syntax-markup-inserted-bg: #dafbe1;
    --color-prettylights-syntax-markup-changed-text: #953800;
    --color-prettylights-syntax-markup-changed-bg: #ffd8b5;
    --color-prettylights-syntax-markup-ignored-text: #d1d9e0;
    --color-prettylights-syntax-markup-ignored-bg: #0550ae;
    --color-prettylights-syntax-meta-diff-range: #8250df;
    --color-prettylights-syntax-sublimelinter-gutter-mark: #818b98;
  }
}

.markdown-body {
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  margin: 0;
  color: var(--fgColor-default);
  background-color: var(--bgColor-default);
  font-family: -apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";
  font-size: 16px;
  line-height: 1.5;
  word-wrap: break-word;
}

.markdown-body .octicon {
  display: inline-block;
  fill: currentColor;
  vertical-align: text-bottom;
}

.markdown-body h1:hover .anchor .octicon-link:before,
.markdown-body h2:hover .anchor .octicon-link:before,
.markdown-body h3:hover .anchor .octicon-link:before,
.markdown-body h4:hover .anchor .octicon-link:before,
.markdown-body h5:hover .anchor .octicon-link:before,
.markdown-body h6:hover .anchor .octicon-link:before {
  width: 16px;
  height: 16px;
  content: ' ';
  display: inline-block;
  background-color: currentColor;
  -webkit-mask-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' version='1.1' aria-hidden='true'><path fill-rule='evenodd' d='M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z'></path></svg>");
  mask-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' version='1.1' aria-hidden='true'><path fill-rule='evenodd' d='M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z'></path></svg>");
}

.markdown-body details,
.markdown-body figcaption,
.markdown-body figure {
  display: block;
}

.markdown-body summary {
  display: list-item;
}

.markdown-body [hidden] {
  display: none !important;
}

.markdown-body a {
  background-color: transparent;
  color: var(--fgColor-accent);
  text-decoration: none;
}

.markdown-body abbr[title] {
  border-bottom: none;
  -webkit-text-decoration: underline dotted;
  text-decoration: underline dotted;
}

.markdown-body b,
.markdown-body strong {
  font-weight: var(--base-text-weight-semibold, 600);
}

.markdown-body dfn {
  font-style: italic;
}

.markdown-body h1 {
  margin: .67em 0;
  font-weight: var(--base-text-weight-semibold, 600);
  padding-bottom: .3em;
  font-size: 2em;
  border-bottom: 1px solid var(--borderColor-muted);
}

.markdown-body mark {
  background-color: var(--bgColor-attention-muted);
  color: var(--fgColor-default);
}

.markdown-body small {
  font-size: 90%;
}

.markdown-body sub,
.markdown-body sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}

.markdown-body sub {
  bottom: -0.25em;
}

.markdown-body sup {
  top: -0.5em;
}

.markdown-body img {
  border-style: none;
  max-width: 100%;
  box-sizing: content-box;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre,
.markdown-body samp {
  font-family: monospace;
  font-size: 1em;
}

.markdown-body figure {
  margin: 1em var(--base-size-40);
}

.markdown-body hr {
  box-sizing: content-box;
  overflow: hidden;
  background: transparent;
  border-bottom: 1px solid var(--borderColor-muted);
  height: .25em;
  padding: 0;
  margin: var(--base-size-24) 0;
  background-color: var(--borderColor-default);
  border: 0;
}

.markdown-body input {
  font: inherit;
  margin: 0;
  overflow: visible;
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}

.markdown-body [type=button],
.markdown-body [type=reset],
.markdown-body [type=submit] {
  -webkit-appearance: button;
  appearance: button;
}

.markdown-body [type=checkbox],
.markdown-body [type=radio] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body [type=number]::-webkit-inner-spin-button,
.markdown-body [type=number]::-webkit-outer-spin-button {
  height: auto;
}

.markdown-body [type=search]::-webkit-search-cancel-button,
.markdown-body [type=search]::-webkit-search-decoration {
  -webkit-appearance: none;
  appearance: none;
}

.markdown-body ::-webkit-input-placeholder {
  color: inherit;
  opacity: .54;
}

.markdown-body ::-webkit-file-upload-button {
  -webkit-appearance: button;
  appearance: button;
  font: inherit;
}

.markdown-body a:hover {
  text-decoration: underline;
}

.markdown-body ::placeholder {
  color: var(--fgColor-muted);
  opacity: 1;
}

.markdown-body hr::before {
  display: table;
  content: "";
}

.markdown-body hr::after {
  display: table;
  clear: both;
  content: "";
}

.markdown-body table {
  border-spacing: 0;
  border-collapse: collapse;
  display: block;
  width: max-content;
  max-width: 100%;
  overflow: auto;
  font-variant: tabular-nums;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body details summary {
  cursor: pointer;
}

.markdown-body a:focus,
.markdown-body [role=button]:focus,
.markdown-body input[type=radio]:focus,
.markdown-body input[type=checkbox]:focus {
  outline: 2px solid var(--focus-outlineColor);
  outline-offset: -2px;
  box-shadow: none;
}

.markdown-body a:focus:not(:focus-visible),
.markdown-body [role=button]:focus:not(:focus-visible),
.markdown-body input[type=radio]:focus:not(:focus-visible),
.markdown-body input[type=checkbox]:focus:not(:focus-visible) {
  outline: solid 1px transparent;
}

.markdown-body a:focus-visible,
.markdown-body [role=button]:focus-visible,
.markdown-body input[type=radio]:focus-visible,
.markdown-body input[type=checkbox]:focus-visible {
  outline: 2px solid var(--focus-outlineColor);
  outline-offset: -2px;
  box-shadow: none;
}

.markdown-body a:not([class]):focus,
.markdown-body a:not([class]):focus-visible,
.markdown-body input[type=radio]:focus,
.markdown-body input[type=radio]:focus-visible,
.markdown-body input[type=checkbox]:focus,
.markdown-body input[type=checkbox]:focus-visible {
  outline-offset: 0;
}

.markdown-body kbd {
  display: inline-block;
  padding: var(--base-size-4);
  font: 11px var(--fontStack-monospace, ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace);
  line-height: 10px;
  color: var(--fgColor-default);
  vertical-align: middle;
  background-color: var(--bgColor-muted);
  border: solid 1px var(--borderColor-neutral-muted);
  border-bottom-color: var(--borderColor-neutral-muted);
  border-radius: 6px;
  box-shadow: inset 0 -1px 0 var(--borderColor-neutral-muted);
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: var(--base-size-24);
  margin-bottom: var(--base-size-16);
  font-weight: var(--base-text-weight-semibold, 600);
  line-height: 1.25;
}

.markdown-body h2 {
  font-weight: var(--base-text-weight-semibold, 600);
  padding-bottom: .3em;
  font-size: 1.5em;
  border-bottom: 1px solid var(--borderColor-muted);
}

.markdown-body h3 {
  font-weight: var(--base-text-weight-semibold, 600);
  font-size: 1.25em;
}

.markdown-body h4 {
  font-weight: var(--base-text-weight-semibold, 600);
  font-size: 1em;
}

.markdown-body h5 {
  font-weight: var(--base-text-weight-semibold, 600);
  font-size: .875em;
}

.markdown-body h6 {
  font-weight: var(--base-text-weight-semibold, 600);
  font-size: .85em;
  color: var(--fgColor-muted);
}

.markdown-body p {
  margin-top: 0;
  margin-bottom: 10px;
}

.markdown-body blockquote {
  margin: 0;
  padding: 0 1em;
  color: var(--fgColor-muted);
  border-left: .25em solid var(--borderColor-default);
}

.markdown-body ul,
.markdown-body ol {
  margin-top: 0;
  margin-bottom: 0;
  padding-left: 2em;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body tt,
.markdown-body code,
.markdown-body samp {
  font-family: var(--fontStack-monospace, ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace);
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
  font-family: var(--fontStack-monospace, ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace);
  font-size: 12px;
  word-wrap: normal;
}

.markdown-body .octicon {
  display: inline-block;
  overflow: visible !important;
  vertical-align: text-bottom;
  fill: currentColor;
}

.markdown-body input::-webkit-outer-spin-button,
.markdown-body input::-webkit-inner-spin-button {
  margin: 0;
  appearance: none;
}

.markdown-body .mr-2 {
  margin-right: var(--base-size-8, 8px) !important;
}

.markdown-body::before {
  display: table;
  content: "";
}

.markdown-body::after {
  display: table;
  clear: both;
  content: "";
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body a:not([href]) {
  color: inherit;
  text-decoration: none;
}

.markdown-body .absent {
  color: var(--fgColor-danger);
}

.markdown-body .anchor {
  float: left;
  padding-right: var(--base-size-4);
  margin-left: -20px;
  line-height: 1;
}

.markdown-body .anchor:focus {
  outline: none;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre,
.markdown-body details {
  margin-top: 0;
  margin-bottom: var(--base-size-16);
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
  color: var(--fgColor-default);
  vertical-align: middle;
  visibility: hidden;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
  text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
  visibility: visible;
}

.markdown-body h1 tt,
.markdown-body h1 code,
.markdown-body h2 tt,
.markdown-body h2 code,
.markdown-body h3 tt,
.markdown-body h3 code,
.markdown-body h4 tt,
.markdown-body h4 code,
.markdown-body h5 tt,
.markdown-body h5 code,
.markdown-body h6 tt,
.markdown-body h6 code {
  padding: 0 .2em;
  font-size: inherit;
}

.markdown-body summary h1,
.markdown-body summary h2,
.markdown-body summary h3,
.markdown-body summary h4,
.markdown-body summary h5,
.markdown-body summary h6 {
  display: inline-block;
}

.markdown-body summary h1 .anchor,
.markdown-body summary h2 .anchor,
.markdown-body summary h3 .anchor,
.markdown-body summary h4 .anchor,
.markdown-body summary h5 .anchor,
.markdown-body summary h6 .anchor {
  margin-left: -40px;
}

.markdown-body summary h1,
.markdown-body summary h2 {
  padding-bottom: 0;
  border-bottom: 0;
}

.markdown-body ul.no-list,
.markdown-body ol.no-list {
  padding: 0;
  list-style-type: none;
}

.markdown-body ol[type="a s"] {
  list-style-type: lower-alpha;
}

.markdown-body ol[type="A s"] {
  list-style-type: upper-alpha;
}

.markdown-body ol[type="i s"] {
  list-style-type: lower-roman;
}

.markdown-body ol[type="I s"] {
  list-style-type: upper-roman;
}

.markdown-body ol[type="1"] {
  list-style-type: decimal;
}

.markdown-body div>ol:not([type]) {
  list-style-type: decimal;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: var(--base-size-16);
}

.markdown-body li+li {
  margin-top: .25em;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: var(--base-size-16);
  font-size: 1em;
  font-style: italic;
  font-weight: var(--base-text-weight-semibold, 600);
}

.markdown-body dl dd {
  padding: 0 var(--base-size-16);
  margin-bottom: var(--base-size-16);
}

.markdown-body table th {
  font-weight: var(--base-text-weight-semibold, 600);
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid var(--borderColor-default);
}

.markdown-body table td>:last-child {
  margin-bottom: 0;
}

.markdown-body table tr {
  background-color: var(--bgColor-default);
  border-top: 1px solid var(--borderColor-muted);
}

.markdown-body table tr:nth-child(2n) {
  background-color: var(--bgColor-muted);
}

.markdown-body table img {
  background-color: transparent;
}

.markdown-body img[align=right] {
  padding-left: 20px;
}

.markdown-body img[align=left] {
  padding-right: 20px;
}

.markdown-body .emoji {
  max-width: none;
  vertical-align: text-top;
  background-color: transparent;
}

.markdown-body span.frame {
  display: block;
  overflow: hidden;
}

.markdown-body span.frame>span {
  display: block;
  float: left;
  width: auto;
  padding: 7px;
  margin: 13px 0 0;
  overflow: hidden;
  border: 1px solid var(--borderColor-default);
}

.markdown-body span.frame span img {
  display: block;
  float: left;
}

.markdown-body span.frame span span {
  display: block;
  padding: 5px 0 0;
  clear: both;
  color: var(--fgColor-default);
}

.markdown-body span.align-center {
  display: block;
  overflow: hidden;
  clear: both;
}

.markdown-body span.align-center>span {
  display: block;
  margin: 13px auto 0;
  overflow: hidden;
  text-align: center;
}

.markdown-body span.align-center span img {
  margin: 0 auto;
  text-align: center;
}

.markdown-body span.align-right {
  display: block;
  overflow: hidden;
  clear: both;
}

.markdown-body span.align-right>span {
  display: block;
  margin: 13px 0 0;
  overflow: hidden;
  text-align: right;
}

.markdown-body span.align-right span img {
  margin: 0;
  text-align: right;
}

.markdown-body span.float-left {
  display: block;
  float: left;
  margin-right: 13px;
  overflow: hidden;
}

.markdown-body span.float-left span {
  margin: 13px 0 0;
}

.markdown-body span.float-right {
  display: block;
  float: right;
  margin-left: 13px;
  overflow: hidden;
}

.markdown-body span.float-right>span {
  display: block;
  margin: 13px auto 0;
  overflow: hidden;
  text-align: right;
}

.markdown-body code,
.markdown-body tt {
  padding: .2em .4em;
  margin: 0;
  font-size: 85%;
  white-space: break-spaces;
  background-color: var(--bgColor-neutral-muted);
  border-radius: 6px;
}

.markdown-body code br,
.markdown-body tt br {
  display: none;
}

.markdown-body del code {
  text-decoration: inherit;
}

.markdown-body samp {
  font-size: 85%;
}

.markdown-body pre code {
  font-size: 100%;
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .highlight {
  margin-bottom: var(--base-size-16);
}

.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body .highlight pre,
.markdown-body pre {
  padding: var(--base-size-16);
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  color: var(--fgColor-default);
  background-color: var(--bgColor-muted);
  border-radius: 6px;
}

.markdown-body pre code,
.markdown-body pre tt {
  display: inline;
  max-width: auto;
  padding: 0;
  margin: 0;
  overflow: visible;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body .csv-data td,
.markdown-body .csv-data th {
  padding: 5px;
  overflow: hidden;
  font-size: 12px;
  line-height: 1;
  text-align: left;
  white-space: nowrap;
}

.markdown-body .csv-data .blob-num {
  padding: 10px var(--base-size-8) 9px;
  text-align: right;
  background: var(--bgColor-default);
  border: 0;
}

.markdown-body .csv-data tr {
  border-top: 0;
}

.markdown-body .csv-data th {
  font-weight: var(--base-text-weight-semibold, 600);
  background: var(--bgColor-muted);
  border-top: 0;
}

.markdown-body [data-footnote-ref]::before {
  content: "[";
}

.markdown-body [data-footnote-ref]::after {
  content: "]";
}

.markdown-body .footnotes {
  font-size: 12px;
  color: var(--fgColor-muted);
  border-top: 1px solid var(--borderColor-default);
}

.markdown-body .footnotes ol {
  padding-left: var(--base-size-16);
}

.markdown-body .footnotes ol ul {
  display: inline-block;
  padding-left: var(--base-size-16);
  margin-top: var(--base-size-16);
}

.markdown-body .footnotes li {
  position: relative;
}

.markdown-body .footnotes li:target::before {
  position: absolute;
  top: calc(var(--base-size-8)*-1);
  right: calc(var(--base-size-8)*-1);
  bottom: calc(var(--base-size-8)*-1);
  left: calc(var(--base-size-24)*-1);
  pointer-events: none;
  content: "";
  border: 2px solid var(--borderColor-accent-emphasis);
  border-radius: 6px;
}

.markdown-body .footnotes li:target {
  color: var(--fgColor-default);
}

.markdown-body .footnotes .data-footnote-backref g-emoji {
  font-family: monospace;
}

.markdown-body body:has(:modal) {
  padding-right: var(--dialog-scrollgutter) !important;
}

.markdown-body .pl-c {
  color: var(--color-prettylights-syntax-comment);
}

.markdown-body .pl-c1,
.markdown-body .pl-s .pl-v {
  color: var(--color-prettylights-syntax-constant);
}

.markdown-body .pl-e,
.markdown-body .pl-en {
  color: var(--color-prettylights-syntax-entity);
}

.markdown-body .pl-smi,
.markdown-body .pl-s .pl-s1 {
  color: var(--color-prettylights-syntax-storage-modifier-import);
}

.markdown-body .pl-ent {
  color: var(--color-prettylights-syntax-entity-tag);
}

.markdown-body .pl-k {
  color: var(--color-prettylights-syntax-keyword);
}

.markdown-body .pl-s,
.markdown-body .pl-pds,
.markdown-body .pl-s .pl-pse .pl-s1,
.markdown-body .pl-sr,
.markdown-body .pl-sr .pl-cce,
.markdown-body .pl-sr .pl-sre,
.markdown-body .pl-sr .pl-sra {
  color: var(--color-prettylights-syntax-string);
}

.markdown-body .pl-v,
.markdown-body .pl-smw {
  color: var(--color-prettylights-syntax-variable);
}

.markdown-body .pl-bu {
  color: var(--color-prettylights-syntax-brackethighlighter-unmatched);
}

.markdown-body .pl-ii {
  color: var(--color-prettylights-syntax-invalid-illegal-text);
  background-color: var(--color-prettylights-syntax-invalid-illegal-bg);
}

.markdown-body .pl-c2 {
  color: var(--color-prettylights-syntax-carriage-return-text);
  background-color: var(--color-prettylights-syntax-carriage-return-bg);
}

.markdown-body .pl-sr .pl-cce {
  font-weight: bold;
  color: var(--color-prettylights-syntax-string-regexp);
}

.markdown-body .pl-ml {
  color: var(--color-prettylights-syntax-markup-list);
}

.markdown-body .pl-mh,
.markdown-body .pl-mh .pl-en,
.markdown-body .pl-ms {
  font-weight: bold;
  color: var(--color-prettylights-syntax-markup-heading);
}

.markdown-body .pl-mi {
  font-style: italic;
  color: var(--color-prettylights-syntax-markup-italic);
}

.markdown-body .pl-mb {
  font-weight: bold;
  color: var(--color-prettylights-syntax-markup-bold);
}

.markdown-body .pl-md {
  color: var(--color-prettylights-syntax-markup-deleted-text);
  background-color: var(--color-prettylights-syntax-markup-deleted-bg);
}

.markdown-body .pl-mi1 {
  color: var(--color-prettylights-syntax-markup-inserted-text);
  background-color: var(--color-prettylights-syntax-markup-inserted-bg);
}

.markdown-body .pl-mc {
  color: var(--color-prettylights-syntax-markup-changed-text);
  background-color: var(--color-prettylights-syntax-markup-changed-bg);
}

.markdown-body .pl-mi2 {
  color: var(--color-prettylights-syntax-markup-ignored-text);
  background-color: var(--color-prettylights-syntax-markup-ignored-bg);
}

.markdown-body .pl-mdr {
  font-weight: bold;
  color: var(--color-prettylights-syntax-meta-diff-range);
}

.markdown-body .pl-ba {
  color: var(--color-prettylights-syntax-brackethighlighter-angle);
}

.markdown-body .pl-sg {
  color: var(--color-prettylights-syntax-sublimelinter-gutter-mark);
}

.markdown-body .pl-corl {
  text-decoration: underline;
  color: var(--color-prettylights-syntax-constant-other-reference-link);
}

.markdown-body [role=button]:focus:not(:focus-visible),
.markdown-body [role=tabpanel][tabindex="0"]:focus:not(:focus-visible),
.markdown-body button:focus:not(:focus-visible),
.markdown-body summary:focus:not(:focus-visible),
.markdown-body a:focus:not(:focus-visible) {
  outline: none;
  box-shadow: none;
}

.markdown-body [tabindex="0"]:focus:not(:focus-visible),
.markdown-body details-dialog:focus:not(:focus-visible) {
  outline: none;
}

.markdown-body g-emoji {
  display: inline-block;
  min-width: 1ch;
  font-family: "Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";
  font-size: 1em;
  font-style: normal !important;
  font-weight: var(--base-text-weight-normal, 400);
  line-height: 1;
  vertical-align: -0.075em;
}

.markdown-body g-emoji img {
  width: 1em;
  height: 1em;
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item label {
  font-weight: var(--base-text-weight-normal, 400);
}

.markdown-body .task-list-item.enabled label {
  cursor: pointer;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: var(--base-size-4);
}

.markdown-body .task-list-item .handle {
  display: none;
}

.markdown-body .task-list-item-checkbox {
  margin: 0 .2em .25em -1.4em;
  vertical-align: middle;
}

.markdown-body ul:dir(rtl) .task-list-item-checkbox {
  margin: 0 -1.6em .25em .2em;
}

.markdown-body ol:dir(rtl) .task-list-item-checkbox {
  margin: 0 -1.6em .25em .2em;
}

.markdown-body .contains-task-list:hover .task-list-item-convert-container,
.markdown-body .contains-task-list:focus-within .task-list-item-convert-container {
  display: block;
  width: auto;
  height: 24px;
  overflow: visible;
  clip: auto;
}

.markdown-body ::-webkit-calendar-picker-indicator {
  filter: invert(50%);
}

.markdown-body .markdown-alert {
  padding: var(--base-size-8) var(--base-size-16);
  margin-bottom: var(--base-size-16);
  color: inherit;
  border-left: .25em solid var(--borderColor-default);
}

.markdown-body .markdown-alert>:first-child {
  margin-top: 0;
}

.markdown-body .markdown-alert>:last-child {
  margin-bottom: 0;
}

.markdown-body .markdown-alert .markdown-alert-title {
  display: flex;
  font-weight: var(--base-text-weight-medium, 500);
  align-items: center;
  line-height: 1;
}

.markdown-body .markdown-alert.markdown-alert-note {
  border-left-color: var(--borderColor-accent-emphasis);
}

.markdown-body .markdown-alert.markdown-alert-note .markdown-alert-title {
  color: var(--fgColor-accent);
}

.markdown-body .markdown-alert.markdown-alert-important {
  border-left-color: var(--borderColor-done-emphasis);
}

.markdown-body .markdown-alert.markdown-alert-important .markdown-alert-title {
  color: var(--fgColor-done);
}

.markdown-body .markdown-alert.markdown-alert-warning {
  border-left-color: var(--borderColor-attention-emphasis);
}

.markdown-body .markdown-alert.markdown-alert-warning .markdown-alert-title {
  color: var(--fgColor-attention);
}

.markdown-body .markdown-alert.markdown-alert-tip {
  border-left-color: var(--borderColor-success-emphasis);
}

.markdown-body .markdown-alert.markdown-alert-tip .markdown-alert-title {
  color: var(--fgColor-success);
}

.markdown-body .markdown-alert.markdown-alert-caution {
  border-left-color: var(--borderColor-danger-emphasis);
}

.markdown-body .markdown-alert.markdown-alert-caution .markdown-alert-title {
  color: var(--fgColor-danger);
}

.markdown-body>*:first-child>.heading-element:first-child {
  margin-top: 0 !important;
}

.markdown-body .highlight pre:has(+.zeroclipboard-container) {
  min-height: 52px;
}

  </style>
</head>
<body class="markdown-body">
  <div dir="rtl">
<h1 id="الدليل-الشامل-لـ-pyqtgraph-من-الصفر-إلى-الاحتراف">📘 <strong>الدليل الشامل لـ PyQtGraph: من الصفر إلى الاحتراف</strong></h1>
<blockquote>
<p>✅ <strong>الهيكل: 20 درسًا موسعًا حسب خطتك</strong><br />
✅ <strong>اللغة: عربي، مع كود بالإنجليزية (كما هو متعارف عليه)</strong><br />
✅ <strong>الجمهور: مبرمجون يعرفون Python ويرغبون في بناء واجهات رسومية تفاعلية عالية الأداء</strong></p>
</blockquote>
<h2 id="فهرس-كامل-لدليل-pyqtgraph">✅ 1. <strong>فهرس كامل لدليل PyQtGraph</strong></h2>
<ol type="1">
<li><a href="#lesson_1">الدرس 1: مقدمة عن PyQtGraph</a></li>
<li><a href="#lesson_2">الدرس 2: التثبيت والإعداد</a></li>
<li><a href="#lesson_3">الدرس 3: مفهوم GraphicsWindow و PlotWidget</a></li>
<li><a href="#lesson_4">الدرس 4: PlotItem و ViewBox</a></li>
<li><a href="#lesson_5">الدرس 5: الرسم الخطي (Line Plot)</a></li>
<li><a href="#lesson_6">الدرس 6: الرسم التشتتي (Scatter Plot)</a></li>
<li><a href="#lesson_7">الدرس 7: رسم الأعمدة (Bar Graphs)</a></li>
<li><a href="#lesson_8">الدرس 8: عرض الصور (ImageView)</a></li>
<li><a href="#lesson_9">الدرس 9: التكبير والتحريك (Zoom &amp; Pan)</a></li>
<li><a href="#lesson_10">الدرس 10: إضافة التعليقات (Annotations)</a></li>
<li><a href="#lesson_11">الدرس 11: التعامل مع الإشارات (Signals)</a></li>
<li><a href="#lesson_12">الدرس 12: الرسم اللحظي (Real-time plotting)</a></li>
<li><a href="#lesson_13">الدرس 13: الرسوم ثلاثية الأبعاد</a></li>
<li><a href="#lesson_14">الدرس 14: الخرائط اللونية (Color Maps)</a></li>
<li><a href="#lesson_15">الدرس 15: عرض عدة رسوم (Multiple Plots)</a></li>
<li><a href="#lesson_16">الدرس 16: دمج PyQtGraph في واجهات PyQt/PySide</a></li>
<li><a href="#lesson_17">الدرس 17: التصدير والحفظ</a></li>
<li><a href="#lesson_18">الدرس 18: مشروع عملي</a></li>
</ol>
<h2 id="خطة-تعلم-pyqtgraph-من-الصفر-إلى-الاحتراف">🗂 خطة تعلم PyQtGraph — من الصفر إلى الاحتراف</h2>
<h3 id="المرحلة-1-الأساسيات-والفهم-العام"><strong>المرحلة 1: الأساسيات والفهم العام</strong></h3>
<ol type="1">
<li><p><strong>مقدمة عن PyQtGraph</strong></p>
<ul>
<li>ما هي المكتبة ولماذا تم تصميمها؟</li>
<li>الفرق بينها وبين Matplotlib وPlotly.</li>
<li>حالات الاستخدام في التحليل العلمي، عرض البيانات اللحظي (real-time plotting)، وتطبيقات GUI.</li>
</ul></li>
<li><p><strong>التثبيت والإعداد</strong></p>
<ul>
<li>تثبيت PyQtGraph وPyQt5 أو PySide6.</li>
<li>إنشاء نافذة عرض بسيطة.</li>
</ul></li>
</ol>
<hr />
<h3 id="المرحلة-2-فهم-عناصر-المكتبة-الأساسية"><strong>المرحلة 2: فهم عناصر المكتبة الأساسية</strong></h3>
<ol start="3" type="1">
<li><p><strong>مفهوم GraphicsWindow وPlotWidget</strong></p>
<ul>
<li>الفرق بين PlotWidget وGraphicsLayoutWidget.</li>
<li>إنشاء نافذة بسيطة وعرض رسم خطي.</li>
</ul></li>
<li><p><strong>PlotItem و ViewBox</strong></p>
<ul>
<li>ما هو الـ PlotItem ودوره في التحكم في المحاور والعناوين.</li>
<li>فهم ViewBox للتكبير والتحريك.</li>
</ul></li>
</ol>
<hr />
<h3 id="المرحلة-3-أنواع-الرسوم-الأساسية"><strong>المرحلة 3: أنواع الرسوم الأساسية</strong></h3>
<ol start="5" type="1">
<li><p><strong>الرسم الخطي Line Plot</strong></p>
<ul>
<li>رسم بيانات بسيطة باستخدام <code>plot()</code>.</li>
<li>تخصيص الألوان، الأنماط، والنقاط.</li>
</ul></li>
<li><p><strong>الرسم التشتتي Scatter Plot</strong></p>
<ul>
<li>استخدام <code>ScatterPlotItem</code>.</li>
<li>تغيير حجم وألوان النقاط.</li>
</ul></li>
<li><p><strong>رسم الأعمدة Bar Graphs</strong></p>
<ul>
<li>إنشاء أعمدة بسيطة.</li>
<li>تلوين الأعمدة وإضافة بيانات نصية.</li>
</ul></li>
<li><p><strong>الصور ImageView</strong></p>
<ul>
<li>عرض الصور والمصفوفات.</li>
<li>تطبيق colormaps والتحكم في السطوع/التباين.</li>
</ul></li>
</ol>
<hr />
<h3 id="المرحلة-4-الميزات-التفاعلية-والتحكم"><strong>المرحلة 4: الميزات التفاعلية والتحكم</strong></h3>
<ol start="9" type="1">
<li><p><strong>التكبير والتحريك Zoom &amp; Pan</strong></p>
<ul>
<li>التحكم في عرض البيانات.</li>
<li>تعطيل/تفعيل التفاعلية.</li>
</ul></li>
<li><p><strong>إضافة التعليقات Annotations</strong></p>
<ul>
<li>رسم نصوص وأسهم على الرسم.</li>
<li>تخصيص الخطوط والألوان.</li>
</ul></li>
<li><p><strong>التعامل مع الإشارات Signals</strong></p>
<ul>
<li>ربط الأحداث مثل النقر على النقاط أو التحريك.</li>
<li>تنفيذ ردود أفعال لحظية.</li>
</ul></li>
</ol>
<hr />
<h3 id="المرحلة-5-الرسوم-المتقدمة"><strong>المرحلة 5: الرسوم المتقدمة</strong></h3>
<ol start="12" type="1">
<li><p><strong>الرسم اللحظي (Real-time plotting)</strong></p>
<ul>
<li>تحديث البيانات في الوقت الحقيقي.</li>
<li>التعامل مع البيانات الكبيرة بسرعة.</li>
</ul></li>
<li><p><strong>الرسوم ثلاثية الأبعاد</strong></p>
<ul>
<li>استخدام <code>GLViewWidget</code>.</li>
<li>رسم الأسطح (Surface) والنقاط ثلاثية الأبعاد.</li>
</ul></li>
<li><p><strong>الخرائط اللونية (Color Maps)</strong></p>
<ul>
<li>التحكم في الألوان لتمثيل القيم.</li>
<li>استخدام Gradients مخصصة.</li>
</ul></li>
<li><p><strong>Multiple Plots</strong></p>
<ul>
<li>عرض عدة رسوم في نافذة واحدة.</li>
<li>مزامنة المحاور بين الرسوم.</li>
</ul></li>
</ol>
<hr />
<h3 id="المرحلة-6-الدمج-مع-مشاريع-أكبر"><strong>المرحلة 6: الدمج مع مشاريع أكبر</strong></h3>
<ol start="16" type="1">
<li><p><strong>دمج PyQtGraph في واجهات PyQt/PySide</strong></p>
<ul>
<li>وضع الرسوم داخل QMainWindow أو QDialog.</li>
<li>إضافة أزرار وأدوات تحكم GUI.</li>
</ul></li>
<li><p><strong>التصدير والحفظ</strong></p>
<ul>
<li>حفظ الرسوم كصور.</li>
<li>أخذ لقطات من النوافذ.</li>
</ul></li>
<li><p><strong>مشروع عملي</strong></p>
<ul>
<li>مثل: برنامج لمراقبة أسعار العملات أو المستشعرات في الزمن الحقيقي.</li>
</ul></li>
</ol>
<h3 id="المرحلة-7-المستوى-الاحترافي"><strong>المرحلة 7: المستوى الاحترافي</strong></h3>
<ol start="19" type="1">
<li><strong>تحسين الأداء مع بيانات ضخمة</strong>
<ul>
<li>استخدام <code>setData()</code> بكفاءة.</li>
<li>التعامل مع ملايين النقاط بدون بطء.</li>
</ul></li>
<li><strong>التخصيص العميق</strong>
<ul>
<li>إنشاء Widgets ورسوم مخصصة.</li>
<li>تعديل سلوك ViewBox وPlotItem.</li>
</ul></li>
</ol>
<h1 id="lesson_1">📘 <strong>الدرس 1: مقدمة عن PyQtGraph</strong></h1>
<h2 id="ما-هي-pyqtgraph">🔹 <strong>ما هي PyQtGraph؟</strong></h2>
<p><strong>PyQtGraph</strong> هي مكتبة بايثون مبنية على <strong>PyQt5/PySide6</strong> تُستخدم لرسم البيانات بسرعة وكفاءة، خصوصًا في التطبيقات التي تتطلب: - عرض بيانات في <strong>الزمن الحقيقي (real-time)</strong> - تفاعلات سريعة (تكبير، تحريك، نقر) - أداء عالٍ مع كميات كبيرة من البيانات</p>
<blockquote>
<p>💡 تُستخدم في:<br />
- أنظمة مراقبة المستشعرات<br />
- أدوات التحليل الطيفي<br />
- واجهات تداول العملات<br />
- التجارب العلمية</p>
</blockquote>
<hr />
<h2 id="الفرق-بين-pyqtgraph-و-matplotlib-و-plotly">🔹 <strong>الفرق بين PyQtGraph و Matplotlib و Plotly</strong></h2>
<table>
<thead>
<tr class="header">
<th>الميزة</th>
<th>PyQtGraph</th>
<th>Matplotlib</th>
<th>Plotly</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>الأداء</td>
<td>⚡ عالي جدًا</td>
<td>متوسط</td>
<td>متوسط إلى منخفض</td>
</tr>
<tr class="even">
<td>الزمن الحقيقي</td>
<td>✅ ممتاز</td>
<td>❌ ضعيف</td>
<td>⚠️ محدود</td>
</tr>
<tr class="odd">
<td>التفاعلية</td>
<td>✅ مدمجة</td>
<td>❌ تحتاج إعداد</td>
<td>✅ جيدة</td>
</tr>
<tr class="even">
<td>التكامل مع GUI</td>
<td>✅ ممتاز (مع PyQt)</td>
<td>⚠️ ممكن لكن معقد</td>
<td>✅ مع Dash</td>
</tr>
<tr class="odd">
<td>السهولة</td>
<td>متوسطة</td>
<td>عالية</td>
<td>عالية</td>
</tr>
</tbody>
</table>
<blockquote>
<p>✅ <strong>استخدم PyQtGraph عندما:</strong><br />
- تحتاج تحديثات سريعة (مئات الإطارات في الثانية)<br />
- تعمل على تطبيق ديسك توب (Desktop App)<br />
- تعرض بيانات مستشعرات أو إشارات كهربائية</p>
</blockquote>
<hr />
<h2 id="حالات-استخدام-واقعية">🔹 <strong>حالات استخدام واقعية</strong></h2>
<ul>
<li>📈 عرض سعر السهم لحظيًا</li>
<li>🧪 تحليل إشارة كهربائية من جهاز قياس</li>
<li>🛰️ مراقبة بيانات مستشعرات IoT</li>
<li>🎮 واجهة تحكم في روبوت</li>
</ul>
<hr />
<h2 id="تمارين-مراجعة">🔹 <strong>تمارين مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين PyQtGraph و Matplotlib من حيث الأداء؟</li>
<li>في أي مشروع تُفضل استخدام PyQtGraph؟</li>
<li>لماذا لا يُنصح باستخدام Matplotlib للرسم اللحظي؟</li>
</ol>
<hr />
<h1 id="lesson_2">📘 <strong>الدرس 2: التثبيت والإعداد</strong></h1>
<h2 id="تثبيت-pyqtgraph-و-pyside6-موصى-به">🔹 <strong>تثبيت PyQtGraph و PySide6 (موصى به)</strong></h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="ex">pip</span> install pyqtgraph PySide6</span></code></pre></div>
<blockquote>
<p>✅ نوصي بـ <strong>PySide6</strong> لأنه مفتوح المصدر بالكامل ولا يتطلب ترخيصًا.</p>
</blockquote>
<hr />
<h2 id="إنشاء-أول-نافذة-عرض">🔹 <strong>إنشاء أول نافذة عرض</strong></h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="co"># إنشاء تطبيق Qt</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a><span class="co"># إنشاء نافذة عرض</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>win <span class="op">=</span> pg.GraphicsLayoutWidget(show<span class="op">=</span><span class="va">True</span>, title<span class="op">=</span><span class="st">&quot;أول نافذة في PyQtGraph&quot;</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a>win.resize(<span class="dv">800</span>, <span class="dv">600</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a><span class="co"># عرض النافذة</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<blockquote>
<p>✅ <code>show=True</code>: تُظهر النافذة فور الإنشاء<br />
✅ <code>title</code>: عنوان النافذة<br />
✅ <code>pg.exec()</code>: تبدأ حلقة الأحداث (Event Loop)</p>
</blockquote>
<hr />
<h2 id="النتيجة">🔹 <strong>النتيجة</strong></h2>
<ul>
<li>نافذة بيضاء بعنوان “أول نافذة في PyQtGraph”</li>
<li>يمكنك التكبير والتحريك بالفأرة</li>
</ul>
<hr />
<h2 id="الأخطاء-الشائعة">🔹 <strong>الأخطاء الشائعة</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ModuleNotFoundError</code></td>
<td>لم تُثبّت المكتبة</td>
<td><code>pip install pyqtgraph</code></td>
</tr>
<tr class="even">
<td>النافذة تفتح وتغلق فورًا</td>
<td>لم تُضف <code>pg.exec()</code></td>
<td>أضف <code>pg.exec()</code> في النهاية</td>
</tr>
<tr class="odd">
<td>لا تظهر أي وظائف</td>
<td>استخدمت <code>import pyqtgraph</code> بدل <code>import pyqtgraph as pg</code></td>
<td>استخدم <code>as pg</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين">🔹 <strong>تمارين</strong></h2>
<ol type="1">
<li>غير حجم النافذة إلى 1000x700.</li>
<li>غيّر عنوان النافذة إلى “مشروع المراقبة”.</li>
<li>أضف تعليقًا يشرح كل سطر في الكود.</li>
</ol>
<hr />
<h2 id="نصائح-احترافية">🔹 <strong>نصائح احترافية</strong></h2>
<ul>
<li>استخدم <code>PySide6</code> بدل <code>PyQt5</code> لتجنب مشاكل الترخيص.</li>
<li>احفظ هذا الكود كقالب أساسي لمشاريعك.</li>
<li>استخدم <code>if __name__ == '__main__':</code> لمنع التنفيذ عند الاستيراد.</li>
</ul>
<h1 id="lesson_3">📘 <strong>الدرس 3 (موسع): مفهوم GraphicsWindow و PlotWidget</strong></h1>
<h2 id="مقدمة-ما-هي-وحدات-العرض-في-pyqtgraph">🔹 <strong>مقدمة: ما هي وحدات العرض في PyQtGraph؟</strong></h2>
<p>بعد أن أنشأت أول نافذة في PyQtGraph، حان الوقت لفهم <strong>البنية الداخلية</strong> للرسم.</p>
<p>في PyQtGraph، لا ترسم البيانات مباشرة على النافذة.<br />
بالتالي، ما هي العناصر التي تُستخدم لعرض الرسومات؟</p>
<p>الإجابة تكمن في فهم الفرق بين: - <strong><code>PlotWidget</code></strong> - <strong><code>GraphicsLayoutWidget</code></strong></p>
<p>كلاهما يُستخدم لعرض الرسوم، لكن لكل منهما استخداماته وخصائصه.</p>
<hr />
<h2 id="plotwidget-أبسط-طريقة-لعرض-رسم">🔹 <strong>1. <code>PlotWidget</code> — أبسط طريقة لعرض رسم</strong></h2>
<p><code>PlotWidget</code> هو عنصر (Widget) جاهز يمكنك إضافته إلى واجهة PyQt، ويحتوي على: - <strong>رسم بياني واحد</strong> - <strong>محور X وY</strong> - <strong>أداة تكبير وتحريك مدمجة</strong> - <strong>إمكانيات تخصيص عالية</strong></p>
<h3 id="المثال-1-إنشاء-رسم-خطي-بسيط">📌 المثال 1: إنشاء رسم خطي بسيط</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a><span class="co"># إنشاء نافذة تحتوي على PlotWidget</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a>win <span class="op">=</span> pg.plot(title<span class="op">=</span><span class="st">&quot;رسم خطي بسيط&quot;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a>win.setLabel(<span class="st">&#39;left&#39;</span>, <span class="st">&#39;القيمة&#39;</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a>win.setLabel(<span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;الزمن&#39;</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a>win.setXRange(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a>win.setYRange(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a><span class="co"># بيانات بسيطة</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a>x <span class="op">=</span> np.arange(<span class="dv">10</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a>y <span class="op">=</span> np.array([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">75</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">100</span>])</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a><span class="co"># رسم البيانات</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a>curve <span class="op">=</span> win.plot(x, y, pen<span class="op">=</span><span class="st">&#39;b&#39;</span>, symbol<span class="op">=</span><span class="st">&#39;o&#39;</span>, symbolBrush<span class="op">=</span><span class="st">&#39;r&#39;</span>, name<span class="op">=</span><span class="st">&#39;البيانات&#39;</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true"></a><span class="co"># عرض النافذة</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="شرح-الكود">🔍 شرح الكود:</h4>
<ul>
<li><code>pg.plot()</code>: دالة سريعة لإنشاء <code>PlotWidget</code> وعرض رسم فورًا.</li>
<li><code>setLabel()</code>: لوضع عناوين للمحاور.</li>
<li><code>setXRange()</code>, <code>setYRange()</code>: لتحديد مدى العرض.</li>
<li><code>pen='b'</code>: خط أزرق.</li>
<li><code>symbol='o'</code>: نقاط دائرية.</li>
<li><code>symbolBrush='r'</code>: نقاط حمراء.</li>
</ul>
<blockquote>
<p>✅ هذا هو الشكل المثالي للرسومات البسيطة.</p>
</blockquote>
<hr />
<h2 id="graphicslayoutwidget-للرسومات-المعقدة-متعددة-الأجزاء">🔹 <strong>2. <code>GraphicsLayoutWidget</code> — للرسومات المعقدة متعددة الأجزاء</strong></h2>
<p>إذا أردت عرض <strong>عدة رسومات في نافذة واحدة</strong> (مثل: رسمين جنبًا إلى جنب، أو عموديًا)، فاستخدم <code>GraphicsLayoutWidget</code>.</p>
<h3 id="المثال-2-عرض-رسمين-في-نافذة-واحدة">📌 المثال 2: عرض رسمين في نافذة واحدة</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a><span class="co"># إنشاء نافذة متعددة الأجزاء</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a>win <span class="op">=</span> pg.GraphicsLayoutWidget(show<span class="op">=</span><span class="va">True</span>, title<span class="op">=</span><span class="st">&quot;رسمان في نافذة واحدة&quot;</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a>win.resize(<span class="dv">1000</span>, <span class="dv">600</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a><span class="co"># إنشاء أول رسم (صف 0، عمود 0)</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a>p1 <span class="op">=</span> win.addPlot(row<span class="op">=</span><span class="dv">0</span>, col<span class="op">=</span><span class="dv">0</span>, title<span class="op">=</span><span class="st">&quot;الرسم 1: جيب التمام&quot;</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">4</span><span class="op">*</span>np.pi, <span class="dv">100</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a>y1 <span class="op">=</span> np.cos(x)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true"></a>p1.plot(x, y1, pen<span class="op">=</span><span class="st">&#39;g&#39;</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true"></a><span class="co"># إنشاء ثاني رسم (صف 0، عمود 1)</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true"></a>p2 <span class="op">=</span> win.addPlot(row<span class="op">=</span><span class="dv">0</span>, col<span class="op">=</span><span class="dv">1</span>, title<span class="op">=</span><span class="st">&quot;الرسم 2: الجيب&quot;</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true"></a>y2 <span class="op">=</span> np.sin(x)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true"></a>p2.plot(x, y2, pen<span class="op">=</span><span class="st">&#39;m&#39;</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true"></a><span class="co"># إضافة شبكة للرسم الثاني</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true"></a>p2.showGrid(x<span class="op">=</span><span class="va">True</span>, y<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="شرح-الكود-1">🔍 شرح الكود:</h4>
<ul>
<li><code>addPlot(row, col)</code>: لإضافة رسم في موقع معين.</li>
<li><code>showGrid()</code>: لعرض شبكة خلفية.</li>
<li>يمكنك إضافة أكثر من صف وعمود.</li>
</ul>
<blockquote>
<p>✅ مثالي لواجهات تتطلب عرض بيانات متعددة (مثل: مراقبة مستشعرات متعددة).</p>
</blockquote>
<hr />
<h2 id="الفرق-بين-plotwidget-و-graphicslayoutwidget">🔹 <strong>3. الفرق بين <code>PlotWidget</code> و <code>GraphicsLayoutWidget</code></strong></h2>
<table>
<thead>
<tr class="header">
<th>الميزة</th>
<th><code>PlotWidget</code></th>
<th><code>GraphicsLayoutWidget</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>الغرض</td>
<td>رسم واحد بسيط</td>
<td>عدة رسومات في نافذة واحدة</td>
</tr>
<tr class="even">
<td>السهولة</td>
<td>عالية (<code>pg.plot()</code>)</td>
<td>متوسطة (يتطلب <code>addPlot</code>)</td>
</tr>
<tr class="odd">
<td>التحكم في التخطيط</td>
<td>محدود</td>
<td>كامل (صفوف وأعمدة)</td>
</tr>
<tr class="even">
<td>الأداء</td>
<td>عالي</td>
<td>عالي</td>
</tr>
<tr class="odd">
<td>الاستخدام الشائع</td>
<td>تطبيقات بسيطة</td>
<td>واجهات متقدمة</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="متى-تستخدم-أيا-منهما">🔹 <strong>4. متى تستخدم أيًا منهما؟</strong></h2>
<table>
<thead>
<tr class="header">
<th>الحالة</th>
<th>الأداة الموصى بها</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>عرض رسم واحد بسيط</td>
<td>✅ <code>PlotWidget</code></td>
</tr>
<tr class="even">
<td>رسم بيانات زمنية لحظية</td>
<td>✅ <code>PlotWidget</code></td>
</tr>
<tr class="odd">
<td>عرض 4 رسومات (2×2)</td>
<td>✅ <code>GraphicsLayoutWidget</code></td>
</tr>
<tr class="even">
<td>بناء واجهة معقدة مع أدوات</td>
<td>✅ <code>GraphicsLayoutWidget</code></td>
</tr>
<tr class="odd">
<td>بدء تعلم PyQtGraph</td>
<td>✅ <code>PlotWidget</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="الأخطاء-الشائعة-1">🔹 <strong>5. الأخطاء الشائعة</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>NameError: name 'pg' is not defined</code></td>
<td>لم تستورد <code>pyqtgraph as pg</code></td>
<td>تأكد من <code>import pyqtgraph as pg</code></td>
</tr>
<tr class="even">
<td>لا تظهر النافذة</td>
<td>نسيت <code>pg.exec()</code></td>
<td>أضف <code>pg.exec()</code> في النهاية</td>
</tr>
<tr class="odd">
<td>الرسم فارغ</td>
<td>البيانات ليست من نوع <code>numpy array</code> أو <code>list</code></td>
<td>تأكد من صحة البيانات</td>
</tr>
<tr class="even">
<td><code>addPlot()</code> لا يعمل</td>
<td>استخدمت <code>pg.plot()</code> بدل <code>GraphicsLayoutWidget</code></td>
<td>استخدم <code>win = pg.GraphicsLayoutWidget()</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية">🔹 <strong>6. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>أنشئ <code>PlotWidget</code> يعرض منحنى تربيعي: <code>y = x²</code>.</li>
<li>غيّر لون الخط إلى أخضر، والنقاط إلى مثلثات (<code>t</code>).</li>
<li>أنشئ <code>GraphicsLayoutWidget</code> به 3 رسومات: في صف واحد.</li>
<li>في الرسم الأوسط، أضف شبكة عرض.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-واجهة-مراقبة-مستشعرات">🔹 <strong>7. الربط بالواقع: واجهة مراقبة مستشعرات</strong></h2>
<h3 id="الهدف-عرض-بيانات-3-مستشعرات-في-وقت-واحد">🎯 الهدف: عرض بيانات 3 مستشعرات في وقت واحد</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co"># فرض بيانات مستشعرات (درجة حرارة، رطوبة، ضغط)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>temp <span class="op">=</span> np.random.rand(<span class="dv">50</span>) <span class="op">*</span> <span class="dv">30</span> <span class="op">+</span> <span class="dv">20</span>  <span class="co"># 20-50°C</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a>humi <span class="op">=</span> np.random.rand(<span class="dv">50</span>) <span class="op">*</span> <span class="dv">30</span> <span class="op">+</span> <span class="dv">40</span>  <span class="co"># 40-70%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a>pres <span class="op">=</span> np.random.rand(<span class="dv">50</span>) <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="dv">980</span> <span class="co"># 980-990 hPa</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a><span class="co"># إنشاء النافذة</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a>win <span class="op">=</span> pg.GraphicsLayoutWidget(show<span class="op">=</span><span class="va">True</span>, title<span class="op">=</span><span class="st">&quot;مراقبة المستشعرات&quot;</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a>win.resize(<span class="dv">1200</span>, <span class="dv">400</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a><span class="co"># درجة الحرارة</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a>p1 <span class="op">=</span> win.addPlot(row<span class="op">=</span><span class="dv">0</span>, col<span class="op">=</span><span class="dv">0</span>, title<span class="op">=</span><span class="st">&quot;درجة الحرارة&quot;</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a>p1.plot(temp, pen<span class="op">=</span><span class="st">&#39;r&#39;</span>, symbol<span class="op">=</span><span class="st">&#39;o&#39;</span>, symbolBrush<span class="op">=</span><span class="st">&#39;r&#39;</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a><span class="co"># الرطوبة</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a>p2 <span class="op">=</span> win.addPlot(row<span class="op">=</span><span class="dv">0</span>, col<span class="op">=</span><span class="dv">1</span>, title<span class="op">=</span><span class="st">&quot;الرطوبة&quot;</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true"></a>p2.plot(humi, pen<span class="op">=</span><span class="st">&#39;b&#39;</span>, symbol<span class="op">=</span><span class="st">&#39;t&#39;</span>, symbolBrush<span class="op">=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true"></a><span class="co"># الضغط</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true"></a>p3 <span class="op">=</span> win.addPlot(row<span class="op">=</span><span class="dv">0</span>, col<span class="op">=</span><span class="dv">2</span>, title<span class="op">=</span><span class="st">&quot;الضغط&quot;</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true"></a>p3.plot(pres, pen<span class="op">=</span><span class="st">&#39;g&#39;</span>, symbol<span class="op">=</span><span class="st">&#39;s&#39;</span>, symbolBrush<span class="op">=</span><span class="st">&#39;g&#39;</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;✅ واجهة المراقبة جاهزة للتشغيل اللحظي!&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا النوع من الواجهات يُستخدم في الأنظمة الصناعية.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-1">🔹 <strong>8. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ ابدأ بـ <code>PlotWidget</code> إذا كنت مبتدئًا.</li>
<li>✅ استخدم <code>GraphicsLayoutWidget</code> للتطبيقات المعقدة.</li>
<li>✅ استخدم <code>pg.plot()</code> للتجريب السريع.</li>
<li>✅ احفظ <code>win</code> و <code>p1</code>, <code>p2</code> كمتغيرات للوصول إليها لاحقًا.</li>
<li>✅ استخدم <code>win.resize()</code> لضبط حجم النافذة.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة">🔹 <strong>9. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>pg.plot()</code> و <code>GraphicsLayoutWidget</code>؟</li>
<li>كيف تُضيف رسمًا في الصف 1 والعمود 0؟</li>
<li>ما وظيفة <code>showGrid()</code>؟</li>
<li>كيف تُغير شكل النقاط في الرسم؟</li>
<li>لماذا نستخدم <code>pg.exec()</code> في النهاية؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس">🔹 <strong>10. مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>الأداة</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pg.plot()</code></td>
<td>إنشاء <code>PlotWidget</code> سريع</td>
</tr>
<tr class="even">
<td><code>PlotWidget</code></td>
<td>عرض رسم واحد</td>
</tr>
<tr class="odd">
<td><code>GraphicsLayoutWidget</code></td>
<td>عرض عدة رسومات</td>
</tr>
<tr class="even">
<td><code>addPlot(row, col)</code></td>
<td>إضافة رسم في موقع معين</td>
</tr>
<tr class="odd">
<td><code>setLabels()</code></td>
<td>تسمية المحاور</td>
</tr>
<tr class="even">
<td><code>showGrid()</code></td>
<td>عرض شبكة</td>
</tr>
</tbody>
</table>
<h1 id="lesson_4">📘 <strong>الدرس 4 (موسع): PlotItem و ViewBox</strong></h1>
<h2 id="مقدمة-ما-هي-وحدات-التحكم-في-الرسم">🔹 <strong>مقدمة: ما هي وحدات التحكم في الرسم؟</strong></h2>
<p>بعد أن تعلمت كيفية إنشاء نافذة عرض (<code>PlotWidget</code> أو <code>GraphicsLayoutWidget</code>)، حان الوقت لفهم <strong>العناصر الداخلية</strong> التي تُكوّن الرسم البياني نفسه.</p>
<p>في PyQtGraph، لا يتم رسم البيانات مباشرة على النافذة، بل عبر طبقة من العناصر تتحكم في كل شيء: - المحاور (X و Y) - العنوان - الشبكة - التكبير والتحريك - حدود العرض</p>
<p>هذان العنصران الرئيسيان هما: - <strong><code>PlotItem</code></strong> - <strong><code>ViewBox</code></strong></p>
<p>فهمهما يمنحك <strong>تحكمًا دقيقًا</strong> في شكل وسلوك الرسم.</p>
<hr />
<h2 id="plotitem-وحدة-التحكم-في-الرسم">🔹 <strong>1. <code>PlotItem</code> — وحدة التحكم في الرسم</strong></h2>
<h3 id="ما-هو-الـ-plotitem">✅ ما هو الـ <code>PlotItem</code>؟</h3>
<p><code>PlotItem</code> هو الكائن الذي يحتوي على: - المحاور (Axis) - العنوان (Title) - الشبكة (Grid) - جميع الخطوط والنقاط (الـ Items) - الإعدادات العامة للرسم</p>
<blockquote>
<p>💡 اعتبر أن <code>PlotItem</code> هو “الرسم البياني” نفسه، بينما <code>PlotWidget</code> هو “الإطار” الذي يحتويه.</p>
</blockquote>
<hr />
<h3 id="المثال-1-الوصول-إلى-plotitem-وتخصيصه">📌 المثال 1: الوصول إلى <code>PlotItem</code> وتخصيصه</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a><span class="co"># إنشاء نافذة باستخدام PlotWidget</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a>win <span class="op">=</span> pg.plot(title<span class="op">=</span><span class="st">&quot;تخصيص PlotItem&quot;</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a>win.resize(<span class="dv">800</span>, <span class="dv">600</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a><span class="co"># 1. الوصول إلى PlotItem</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a>plot_item <span class="op">=</span> win.getPlotItem()</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true"></a><span class="co"># 2. تخصيص المحاور</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true"></a>plot_item.setLabel(<span class="st">&#39;left&#39;</span>, <span class="st">&#39;الدرجة (°C)&#39;</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true"></a>plot_item.setLabel(<span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;الزمن (ثانية)&#39;</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true"></a><span class="co"># 3. تعيين عنوان</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true"></a>plot_item.setTitle(<span class="st">&#39;بيانات مستشعر درجة الحرارة&#39;</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true"></a><span class="co"># 4. إضافة شبكة</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true"></a>plot_item.showGrid(x<span class="op">=</span><span class="va">True</span>, y<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true"></a><span class="co"># 5. تحديد مدى العرض</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true"></a>plot_item.setXRange(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true"></a>plot_item.setYRange(<span class="dv">15</span>, <span class="dv">35</span>)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true"></a><span class="co"># 6. إضافة بيانات</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true"></a>y <span class="op">=</span> <span class="dv">25</span> <span class="op">+</span> <span class="dv">5</span> <span class="op">*</span> np.sin(x) <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">100</span>)</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true"></a>plot_item.plot(x, y, pen<span class="op">=</span><span class="st">&#39;b&#39;</span>, name<span class="op">=</span><span class="st">&#39;الدرجة&#39;</span>)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="شرح-الكود-2">🔍 شرح الكود:</h4>
<ul>
<li><code>getPlotItem()</code>: يُرجع كائن <code>PlotItem</code> الموجود داخل <code>PlotWidget</code>.</li>
<li><code>setLabel()</code>: لوضع تسميات للمحاور.</li>
<li><code>showGrid()</code>: لعرض شبكة خلفية.</li>
<li><code>setXRange()</code>, <code>setYRange()</code>: لضبط حدود العرض.</li>
<li><code>plot()</code>: لإضافة بيانات إلى <code>PlotItem</code>.</li>
</ul>
<blockquote>
<p>✅ هذا هو الشكل المثالي للتحكم الكامل في الرسم.</p>
</blockquote>
<hr />
<h2 id="viewbox-قلب-التفاعلية">🔹 <strong>2. <code>ViewBox</code> — قلب التفاعلية</strong></h2>
<h3 id="ما-هو-الـ-viewbox">✅ ما هو الـ <code>ViewBox</code>؟</h3>
<p><code>ViewBox</code> هو العنصر المسؤول عن: - <strong>التكبير (Zoom)</strong> - <strong>التحريك (Pan)</strong> - <strong>تحديد منطقة العرض</strong> - <strong>التحكم في سلوك الفأرة</strong></p>
<blockquote>
<p>💡 بدون <code>ViewBox</code>، لا يمكن التفاعل مع الرسم.</p>
</blockquote>
<hr />
<h3 id="المثال-2-التحكم-في-viewbox">📌 المثال 2: التحكم في <code>ViewBox</code></h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="co"># بعد الحصول على plot_item</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>view_box <span class="op">=</span> plot_item.getViewBox()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="co"># تعطيل التفاعلية (لإيقاف التكبير والتحريك)</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a><span class="co"># view_box.setMouseEnabled(False, False)</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a><span class="co"># تمكين التكبير فقط على المحور X</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a><span class="co"># view_box.setMouseEnabled(x=True, y=False)</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a><span class="co"># تغيير لون خلفية ViewBox</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a>view_box.setBackgroundColor(<span class="st">&#39;w&#39;</span>)  <span class="co"># أبيض</span></span></code></pre></div>
<blockquote>
<p>✅ مفيد في التطبيقات التي تحتاج تحكمًا دقيقًا في التفاعل.</p>
</blockquote>
<hr />
<h3 id="المثال-3-ربط-حدث-التحريك">📌 المثال 3: ربط حدث التحريك</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="kw">def</span> on_pan():</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="st">&quot;تم التحريك!&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>    <span class="co"># يمكنك هنا تحديث عناصر أخرى في الواجهة</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a><span class="co"># ربط الحدث</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a>view_box.sigXRangeChanged.<span class="ex">connect</span>(on_pan)</span></code></pre></div>
<blockquote>
<p>✅ <code>sigXRangeChanged</code>: يُطلق عند التكبير أو التحريك.</p>
</blockquote>
<hr />
<h2 id="الفرق-بين-plotwidget-و-plotitem-و-viewbox">🔹 <strong>3. الفرق بين <code>PlotWidget</code> و <code>PlotItem</code> و <code>ViewBox</code></strong></h2>
<table>
<thead>
<tr class="header">
<th>العنصر</th>
<th>الوظيفة</th>
<th>من يتحكم فيه؟</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>PlotWidget</code></td>
<td>الحاوية (Widget) التي تُضاف إلى واجهة PyQt</td>
<td>أنت (كـ <code>QWidget</code>)</td>
</tr>
<tr class="even">
<td><code>PlotItem</code></td>
<td>وحدة التحكم في الرسم (المحاور، العنوان، الشبكة)</td>
<td><code>PlotWidget</code></td>
</tr>
<tr class="odd">
<td><code>ViewBox</code></td>
<td>وحدة التفاعلية (التكبير، التحريك)</td>
<td><code>PlotItem</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>🎯 التسلسل الهرمي:</p>
<pre><code>PlotWidget
    └── PlotItem
            └── ViewBox
                    └── البيانات (الخطوط، النقاط...)</code></pre>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-2">🔹 <strong>4. الأخطاء الشائعة</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>AttributeError: 'PlotWidget' object has no attribute 'setLabel'</code></td>
<td>حاولت استخدام <code>setLabel</code> على <code>PlotWidget</code> مباشرة</td>
<td>استخدم <code>getPlotItem().setLabel()</code></td>
</tr>
<tr class="even">
<td>لا يعمل التكبير</td>
<td><code>setMouseEnabled(False)</code></td>
<td>أعد تمكين الفأرة</td>
</tr>
<tr class="odd">
<td>لا تظهر الشبكة</td>
<td>نسيت <code>showGrid()</code></td>
<td>أضف <code>showGrid(x=True, y=True)</code></td>
</tr>
<tr class="even">
<td><code>sigXRangeChanged</code> لا يعمل</td>
<td>لم تُنشئ <code>ViewBox</code> بشكل صحيح</td>
<td>تأكد من <code>getViewBox()</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-1">🔹 <strong>5. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>أنشئ <code>PlotWidget</code>، ثم استخدم <code>getPlotItem()</code> لتغيير لون خلفية <code>ViewBox</code> إلى رمادي فاتح.</li>
<li>عطّل التكبير على المحور Y فقط.</li>
<li>أضف دالة تُطبع “تم التكبير” عند تغيير مدى المحور X.</li>
<li>غيّر لون الشبكة إلى أخضر شفاف.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-واجهة-تحليل-إشارة-كهربائية">🔹 <strong>6. الربط بالواقع: واجهة تحليل إشارة كهربائية</strong></h2>
<h3 id="الهدف-عرض-إشارة-كهربائية-مع-تحكم-دقيق">🎯 الهدف: عرض إشارة كهربائية مع تحكم دقيق</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="co"># فرض إشارة كهربائية (مثل ECG)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">1000</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a>signal <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span><span class="dv">5</span><span class="op">*</span>t) <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> np.random.randn(<span class="dv">1000</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a><span class="co"># إنشاء النافذة</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a>win <span class="op">=</span> pg.plot()</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a>plot_item <span class="op">=</span> win.getPlotItem()</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a>view_box <span class="op">=</span> plot_item.getViewBox()</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a><span class="co"># التخصيص</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a>plot_item.setLabel(<span class="st">&#39;left&#39;</span>, <span class="st">&#39;الجهد (V)&#39;</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a>plot_item.setLabel(<span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;الزمن (ثانية)&#39;</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a>plot_item.setTitle(<span class="st">&#39;تحليل إشارة كهربائية&#39;</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true"></a>plot_item.showGrid(x<span class="op">=</span><span class="va">True</span>, y<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true"></a>view_box.setBackgroundColor(<span class="st">&#39;k&#39;</span>)  <span class="co"># خلفية سوداء للمحترفين</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true"></a><span class="co"># رسم الإشارة</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true"></a>plot_item.plot(t, signal, pen<span class="op">=</span><span class="st">&#39;y&#39;</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true"></a><span class="co"># ربط حدث</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true"></a><span class="kw">def</span> on_zoom():</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="ss">f&quot;مدى X الحالي: </span><span class="sc">{</span>view_box<span class="sc">.</span>viewRange()[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true"></a>view_box.sigXRangeChanged.<span class="ex">connect</span>(on_zoom)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📊 الواجهة جاهزة لتحليل الإشارات!&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا النوع من الواجهات يُستخدم في الأجهزة الطبية والصناعية.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-2">🔹 <strong>7. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>getPlotItem()</code> دائمًا عند الحاجة لتخصيص متقدم.</li>
<li>✅ استخدم <code>getViewBox()</code> للتحكم في التفاعلية.</li>
<li>✅ احفظ <code>plot_item</code> و <code>view_box</code> كمتغيرات للوصول السريع.</li>
<li>✅ استخدم <code>setMouseEnabled()</code> لتعطيل الحركة عند الحاجة (مثلاً: أثناء التسجيل).</li>
<li>✅ استخدم <code>sigXRangeChanged</code> لتحديث عناصر أخرى في الواجهة (مثل: عرض الوقت الحالي).</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-1">🔹 <strong>8. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>PlotWidget</code> و <code>PlotItem</code>؟</li>
<li>كيف تُغير لون خلفية <code>ViewBox</code>؟</li>
<li>ما وظيفة <code>showGrid()</code>؟</li>
<li>كيف تُعطل التكبير على محور معين؟</li>
<li>ما الفائدة من <code>sigXRangeChanged</code>؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-1">🔹 <strong>9. مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>العنصر</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>PlotWidget</code></td>
<td>الحاوية الأساسية</td>
</tr>
<tr class="even">
<td><code>getPlotItem()</code></td>
<td>للوصول إلى إعدادات الرسم</td>
</tr>
<tr class="odd">
<td><code>setLabel()</code></td>
<td>تسمية المحاور</td>
</tr>
<tr class="even">
<td><code>showGrid()</code></td>
<td>عرض شبكة</td>
</tr>
<tr class="odd">
<td><code>setXRange()</code></td>
<td>ضبط مدى العرض</td>
</tr>
<tr class="even">
<td><code>getViewBox()</code></td>
<td>للتحكم في التفاعلية</td>
</tr>
<tr class="odd">
<td><code>setMouseEnabled()</code></td>
<td>تمكين/تعطيل التكبير</td>
</tr>
<tr class="even">
<td><code>sigXRangeChanged</code></td>
<td>ربط حدث التكبير</td>
</tr>
</tbody>
</table>
<h1 id="lesson_5">📘 <strong>الدرس 5 (موسع): الرسم الخطي (Line Plot)</strong></h1>
<h2 id="مقدمة-لماذا-الرسم-الخطي-هو-الأساس">🔹 <strong>مقدمة: لماذا الرسم الخطي هو الأساس؟</strong></h2>
<p>الرسم الخطي (Line Plot) هو <strong>أكثر أنواع الرسوم شيوعًا</strong> في التحليل العلمي والهندسي.</p>
<p>يُستخدم لتمثيل: - كيف تتغير قيمة ما مع الزمن (مثل: سعر السهم، درجة الحرارة) - العلاقة بين متغيرين (مثل: السعر والطلب) - الاتجاهات والأنماط في البيانات</p>
<p>في هذا الدرس، ستتعلم كيفية إنشاء رسم خطي باستخدام PyQtGraph، وتخصيصه بالكامل: الألوان، الأنماط، النقاط، والأساطير.</p>
<hr />
<h2 id="إنشاء-رسم-خطي-بسيط">🔹 <strong>1. إنشاء رسم خطي بسيط</strong></h2>
<h3 id="المثال-1-رسم-دالة-جيب-التمام">📌 المثال 1: رسم دالة جيب التمام</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a><span class="co"># إنشاء نافذة رسم</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a>win <span class="op">=</span> pg.plot(title<span class="op">=</span><span class="st">&quot;رسم دالة cos(x)&quot;</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true"></a><span class="co"># إنشاء البيانات</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">4</span><span class="op">*</span>np.pi, <span class="dv">100</span>)  <span class="co"># 100 نقطة من 0 إلى 4π</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true"></a>y <span class="op">=</span> np.cos(x)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true"></a><span class="co"># رسم البيانات</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true"></a>curve <span class="op">=</span> win.plot(x, y)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="شرح-الكود-3">🔍 شرح الكود:</h4>
<ul>
<li><code>np.linspace()</code>: لتوليد نقاط متساوية.</li>
<li><code>win.plot(x, y)</code>: لرسم الخط.</li>
<li>الناتج: منحنى جيب التمام.</li>
</ul>
<blockquote>
<p>✅ هذا هو الشكل الأساسي للرسم الخطي.</p>
</blockquote>
<hr />
<h2 id="تخصيص-الخط-pen">🔹 <strong>2. تخصيص الخط (Pen)</strong></h2>
<p>يمكنك تغيير لون، سمك، ونمط الخط باستخدام معامل <code>pen</code>.</p>
<h3 id="المثال-2-خط-أخضر-متقطع-سميك">📌 المثال 2: خط أخضر متقطع سميك</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a>curve <span class="op">=</span> win.plot(x, y, pen<span class="op">=</span>pg.mkPen(color<span class="op">=</span><span class="st">&#39;g&#39;</span>, width<span class="op">=</span><span class="dv">3</span>, style<span class="op">=</span>pg.QtCore.Qt.DashLine))</span></code></pre></div>
<h3 id="خيارات-pen-الشائعة">✅ خيارات <code>pen</code> الشائعة</h3>
<table>
<thead>
<tr class="header">
<th>الخيار</th>
<th>القيمة</th>
<th>الوصف</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>color</code></td>
<td><code>'r'</code>, <code>'g'</code>, <code>'b'</code>, <code>'#FF0000'</code></td>
<td>لون الخط</td>
</tr>
<tr class="even">
<td><code>width</code></td>
<td><code>2</code>, <code>5</code></td>
<td>سمك الخط (بكسل)</td>
</tr>
<tr class="odd">
<td><code>style</code></td>
<td><code>Qt.SolidLine</code>, <code>Qt.DashLine</code>, <code>Qt.DotLine</code></td>
<td>نمط الخط</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="إضافة-النقاط-symbols">🔹 <strong>3. إضافة النقاط (Symbols)</strong></h2>
<p>لجعل الرسم أكثر وضوحًا، أضف نقاطًا على كل قيمة.</p>
<h3 id="المثال-3-خط-مع-نقاط-دائرية-حمراء">📌 المثال 3: خط مع نقاط دائرية حمراء</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a>curve <span class="op">=</span> win.plot(x, y, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>                 pen<span class="op">=</span><span class="st">&#39;b&#39;</span>, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>                 symbol<span class="op">=</span><span class="st">&#39;o&#39;</span>,        <span class="co"># شكل النقطة: &#39;o&#39;, &#39;s&#39;, &#39;t&#39;, &#39;d&#39;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>                 symbolSize<span class="op">=</span><span class="dv">8</span>,      <span class="co"># حجم النقطة</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>                 symbolBrush<span class="op">=</span><span class="st">&#39;r&#39;</span>,   <span class="co"># لون ملء النقطة</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a>                 symbolPen<span class="op">=</span><span class="st">&#39;w&#39;</span>)     <span class="co"># لون الحدودة</span></span></code></pre></div>
<h3 id="أشكال-النقاط-symbols">✅ أشكال النقاط (Symbols)</h3>
<table>
<thead>
<tr class="header">
<th>الرمز</th>
<th>الشكل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>'o'</code></td>
<td>دائرة</td>
</tr>
<tr class="even">
<td><code>'s'</code></td>
<td>مربع</td>
</tr>
<tr class="odd">
<td><code>'t'</code></td>
<td>مثلث</td>
</tr>
<tr class="even">
<td><code>'d'</code></td>
<td>الماس</td>
</tr>
<tr class="odd">
<td><code>'+'</code></td>
<td>علامة زائد</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="إضافة-عنوان-وأسماء-المحاور">🔹 <strong>4. إضافة عنوان وأسماء المحاور</strong></h2>
<p>لجعل الرسم مفهومًا، أضف تسميات.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a>win.setLabel(<span class="st">&#39;left&#39;</span>, <span class="st">&#39;القيمة (V)&#39;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>win.setLabel(<span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;الزمن (ثانية)&#39;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a>win.setTitle(<span class="st">&#39;تحليل إشارة جيب التمام&#39;</span>)</span></code></pre></div>
<hr />
<h2 id="إضافة-الشبكة-grid">🔹 <strong>5. إضافة الشبكة (Grid)</strong></h2>
<p>لتسهيل القراءة.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a>win.showGrid(x<span class="op">=</span><span class="va">True</span>, y<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span></code></pre></div>
<ul>
<li><code>alpha</code>: درجة الشفافية (من 0 إلى 1)</li>
</ul>
<hr />
<h2 id="إضافة-أسطورة-legend">🔹 <strong>6. إضافة أسطورة (Legend)</strong></h2>
<p>مفيد عند رسم أكثر من منحنى.</p>
<h3 id="المثال-4-رسم-جيب-التمام-والجيب-مع-أسطورة">📌 المثال 4: رسم جيب التمام والجيب مع أسطورة</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a>win <span class="op">=</span> pg.GraphicsLayoutWidget(show<span class="op">=</span><span class="va">True</span>, title<span class="op">=</span><span class="st">&quot;دالتا الجيب والجيب تمامًا&quot;</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a>p1 <span class="op">=</span> win.addPlot()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a><span class="co"># بيانات</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">4</span><span class="op">*</span>np.pi, <span class="dv">100</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a>y1 <span class="op">=</span> np.cos(x)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a>y2 <span class="op">=</span> np.sin(x)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true"></a><span class="co"># رسم cos(x)</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true"></a>p1.plot(x, y1, pen<span class="op">=</span><span class="st">&#39;b&#39;</span>, name<span class="op">=</span><span class="st">&#39;cos(x)&#39;</span>, symbol<span class="op">=</span><span class="st">&#39;o&#39;</span>, symbolSize<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true"></a><span class="co"># رسم sin(x)</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true"></a>p1.plot(x, y2, pen<span class="op">=</span><span class="st">&#39;r&#39;</span>, name<span class="op">=</span><span class="st">&#39;sin(x)&#39;</span>, symbol<span class="op">=</span><span class="st">&#39;t&#39;</span>, symbolSize<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true"></a>p1.showGrid(<span class="va">True</span>, <span class="va">True</span>, <span class="fl">0.3</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true"></a>p1.setLabel(<span class="st">&#39;left&#39;</span>, <span class="st">&#39;القيمة&#39;</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true"></a>p1.setLabel(<span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;الزمن&#39;</span>)</span></code></pre></div>
<blockquote>
<p>✅ <code>name=</code> هو ما يظهر في الأسطورة.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-3">🔹 <strong>7. الأخطاء الشائعة</strong></h2>
<table>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>لا يظهر الخط</td>
<td><code>pen=None</code> أو لون شفاف</td>
<td>تأكد من <code>pen='color'</code></td>
</tr>
<tr class="even">
<td>النقاط لا تظهر</td>
<td>نسيت <code>symbol</code></td>
<td>أضف <code>symbol='o'</code></td>
</tr>
<tr class="odd">
<td>الأسطورة لا تظهر</td>
<td>نسيت <code>name=</code></td>
<td>أضف <code>name='الاسم'</code></td>
</tr>
<tr class="even">
<td>الشبكة لا تظهر</td>
<td>نسيت <code>showGrid()</code></td>
<td>أضف <code>showGrid(True, True)</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-2">🔹 <strong>8. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>ارسم منحنى تربيعي: <code>y = x²</code> من -10 إلى 10.</li>
<li>غيّر لون الخط إلى أرجواني، والنقاط إلى مربعات زرقاء.</li>
<li>أضف شبكة وشبّك الأسطورة باسم “المنحنى التربيعي”.</li>
<li>أضف تسميات للمحور الرأسي “الناتج” والأفقي “المدخل”.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-عرض-سعر-السهم-لحظيا">🔹 <strong>9. الربط بالواقع: عرض سعر السهم لحظيًا</strong></h2>
<h3 id="الهدف-محاكاة-عرض-سعر-سهم">🎯 الهدف: محاكاة عرض سعر سهم</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true"></a><span class="co"># نافذة عرض السعر</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true"></a>win <span class="op">=</span> pg.plot(title<span class="op">=</span><span class="st">&quot;سعر السهم - التحديث اللحظي&quot;</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true"></a>win.setLabel(<span class="st">&#39;left&#39;</span>, <span class="st">&#39;السعر (ريال)&#39;</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true"></a>win.setLabel(<span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;الزمن&#39;</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true"></a>win.showGrid(y<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true"></a><span class="co"># بيانات وهمية لسعر السهم</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true"></a>time <span class="op">=</span> np.arange(<span class="dv">100</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true"></a>price <span class="op">=</span> <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="dv">100</span>) <span class="op">*</span> <span class="fl">0.5</span>)  <span class="co"># مشي عشوائي</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true"></a><span class="co"># رسم السعر</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true"></a>curve <span class="op">=</span> win.plot(time, price, pen<span class="op">=</span><span class="st">&#39;c&#39;</span>, symbol<span class="op">=</span><span class="st">&#39;o&#39;</span>, symbolSize<span class="op">=</span><span class="dv">6</span>, symbolBrush<span class="op">=</span><span class="st">&#39;m&#39;</span>, name<span class="op">=</span><span class="st">&#39;السعر&#39;</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📈 واجهة عرض السعر جاهزة!&quot;</span>)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<blockquote>
<p>✅ هذا الشكل يُستخدم في لوحات التداول.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-3">🔹 <strong>10. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>pg.mkPen()</code> لصنع ألوان متقدمة.</li>
<li>✅ استخدم <code>alpha</code> في <code>symbolBrush</code> لجعل النقاط شفافة.</li>
<li>✅ احفظ كائن <code>curve</code> إذا كنت ستحديثه لاحقًا.</li>
<li>✅ استخدم <code>GraphicsLayoutWidget</code> إذا كنت سترسم أكثر من رسم.</li>
<li>✅ استخدم <code>name=</code> فقط عند الحاجة إلى أسطورة.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-2">🔹 <strong>11. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>كيف تُغير لون الخط إلى أصفر؟</li>
<li>ما الفرق بين <code>symbolBrush</code> و <code>symbolPen</code>؟</li>
<li>كيف تُظهر الشبكة على المحور X فقط؟</li>
<li>ما وظيفة <code>name=</code> في <code>plot()</code>؟</li>
<li>كيف تُغير نمط الخط إلى منقط؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-2">🔹 <strong>12. مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>العنصر</th>
<th>الكود</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>رسم خط</td>
<td><code>plot(x, y)</code></td>
</tr>
<tr class="even">
<td>تغيير لون الخط</td>
<td><code>pen='r'</code> أو <code>pen=pg.mkPen(...)</code></td>
</tr>
<tr class="odd">
<td>إضافة نقاط</td>
<td><code>symbol='o'</code></td>
</tr>
<tr class="even">
<td>تغيير حجم النقاط</td>
<td><code>symbolSize=8</code></td>
</tr>
<tr class="odd">
<td>ألوان النقاط</td>
<td><code>symbolBrush='b'</code></td>
</tr>
<tr class="even">
<td>تسمية المحاور</td>
<td><code>setLabel('left', '...')</code></td>
</tr>
<tr class="odd">
<td>الشبكة</td>
<td><code>showGrid(x=True, y=True)</code></td>
</tr>
<tr class="even">
<td>الأسطورة</td>
<td><code>name='الاسم'</code></td>
</tr>
</tbody>
</table>
<h1 id="lesson_6">📘 <strong>الدرس 6 (موسع): الرسم التشتتي (Scatter Plot)</strong></h1>
<h2 id="مقدمة-ما-هو-الرسم-التشتتي-ولماذا-هو-مهم">🔹 <strong>مقدمة: ما هو الرسم التشتتي ولماذا هو مهم؟</strong></h2>
<p>الرسم التشتتي (Scatter Plot) هو أداة قوية لتمثيل العلاقة بين <strong>متغيرين عددين</strong>.</p>
<p>يُستخدم لفهم: - هل هناك <strong>ارتباط</strong> بين السعر والطلب؟ - كيف تتوزع النقاط في الفضاء (مثل: بيانات العملاء حسب العمر والدخل)؟ - اكتشاف <strong>القيم الشاذة (Outliers)</strong></p>
<p>في هذا الدرس، ستتعلم كيفية إنشاء رسم تشتتي باستخدام <code>ScatterPlotItem</code>، وتخصيصه بالكامل: الألوان، الأحجام، والتفاعل.</p>
<hr />
<h2 id="استخدام-scatterplotitem-الطريقة-الأساسية">🔹 <strong>1. استخدام <code>ScatterPlotItem</code> — الطريقة الأساسية</strong></h2>
<h3 id="المثال-1-رسم-تشتتي-بسيط">📌 المثال 1: رسم تشتتي بسيط</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true"></a><span class="co"># إنشاء نافذة</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true"></a>win <span class="op">=</span> pg.plot(title<span class="op">=</span><span class="st">&quot;رسم تشتتي: العلاقة بين X وY&quot;</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true"></a>win.setLabel(<span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;X&#39;</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true"></a>win.setLabel(<span class="st">&#39;left&#39;</span>, <span class="st">&#39;Y&#39;</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true"></a>win.showGrid(<span class="va">True</span>, <span class="va">True</span>, <span class="fl">0.3</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true"></a><span class="co"># بيانات وهمية</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true"></a>x <span class="op">=</span> np.random.normal(size<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true"></a>y <span class="op">=</span> x <span class="op">*</span> <span class="fl">0.5</span> <span class="op">+</span> np.random.normal(size<span class="op">=</span><span class="dv">100</span>) <span class="op">*</span> <span class="fl">0.3</span>  <span class="co"># علاقة خطية</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true"></a><span class="co"># إنشاء عنصر النقاط</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true"></a>scatter <span class="op">=</span> pg.ScatterPlotItem(x<span class="op">=</span>x, y<span class="op">=</span>y, pen<span class="op">=</span><span class="va">None</span>, brush<span class="op">=</span><span class="st">&#39;b&#39;</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true"></a><span class="co"># إضافة العنصر إلى النافذة</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true"></a>win.addItem(scatter)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="شرح-الكود-4">🔍 شرح الكود:</h4>
<ul>
<li><code>pg.ScatterPlotItem()</code>: يُنشئ مجموعة من النقاط.</li>
<li><code>pen=None</code>: لا حدود للنقاط.</li>
<li><code>brush='b'</code>: لون ملء النقطة (أزرق).</li>
<li><code>size=10</code>: حجم النقطة.</li>
<li><code>win.addItem(scatter)</code>: لإضافة العنصر إلى الرسم.</li>
</ul>
<blockquote>
<p>✅ مثالي للبيانات ذات الألوان والمقاييس المتغيرة.</p>
</blockquote>
<hr />
<h2 id="تخصيص-شكل-النقاط">🔹 <strong>2. تخصيص شكل النقاط</strong></h2>
<p>يمكنك تغيير شكل، حجم، ولون كل نقطة.</p>
<h3 id="المثال-2-نقاط-متعددة-الأشكال-والألوان">📌 المثال 2: نقاط متعددة الأشكال والألوان</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="co"># بيانات</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a>x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a>y <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">7</span>]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a>colors <span class="op">=</span> [<span class="st">&#39;r&#39;</span>, <span class="st">&#39;g&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;m&#39;</span>]  <span class="co"># أحمر، أخضر، أزرق، سماوي، أرجواني</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a>sizes <span class="op">=</span> [<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true"></a><span class="co"># إنشاء النقاط</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true"></a>spots <span class="op">=</span> []</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)):</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true"></a>    spots.append({</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true"></a>        <span class="st">&#39;pos&#39;</span>: (x[i], y[i]),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true"></a>        <span class="st">&#39;size&#39;</span>: sizes[i],</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true"></a>        <span class="st">&#39;brush&#39;</span>: colors[i]</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true"></a>    })</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true"></a>scatter <span class="op">=</span> pg.ScatterPlotItem(spots<span class="op">=</span>spots)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true"></a>win.addItem(scatter)</span></code></pre></div>
<blockquote>
<p>✅ يمكنك استخدام قاموس لكل نقطة لتحكم دقيق.</p>
</blockquote>
<hr />
<h2 id="استخدام-plot-لرسم-تشتتي-طريقة-مختصرة">🔹 <strong>3. استخدام <code>plot()</code> لرسم تشتتي (طريقة مختصرة)</strong></h2>
<p>إذا كنت لا تحتاج تحكمًا دقيقًا، يمكنك استخدام <code>plot()</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="co"># طريقة أسرع</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a>win.plot(x, y, pen<span class="op">=</span><span class="va">None</span>, symbol<span class="op">=</span><span class="st">&#39;o&#39;</span>, symbolBrush<span class="op">=</span><span class="st">&#39;r&#39;</span>, symbolSize<span class="op">=</span><span class="dv">10</span>)</span></code></pre></div>
<blockquote>
<p>✅ نفس النتيجة، لكن أقل مرونة.</p>
</blockquote>
<hr />
<h2 id="ربط-النقط-بالخطوط-scatter-line">🔹 <strong>4. ربط النقط بالخطوط (Scatter + Line)</strong></h2>
<p>لعرض الاتجاه مع التوزيع.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="co"># رسم خط + نقاط</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a>curve <span class="op">=</span> win.plot(x, y, pen<span class="op">=</span><span class="st">&#39;g&#39;</span>)  <span class="co"># خط أخضر</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a>scatter <span class="op">=</span> pg.ScatterPlotItem(x<span class="op">=</span>x, y<span class="op">=</span>y, brush<span class="op">=</span><span class="st">&#39;r&#39;</span>, size<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a>win.addItem(scatter)</span></code></pre></div>
<blockquote>
<p>✅ مفيد في تتبع المسارات أو الإشارات.</p>
</blockquote>
<hr />
<h2 id="التحكم-في-الشفافية-alpha">🔹 <strong>5. التحكم في الشفافية (Alpha)</strong></h2>
<p>لحل مشكلة التداخل (Overplotting).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="co"># شفافية 50%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a>brush <span class="op">=</span> pg.mkBrush(color<span class="op">=</span>(<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">128</span>))  <span class="co"># RGBA (الأخير هو alpha)</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a>scatter <span class="op">=</span> pg.ScatterPlotItem(x<span class="op">=</span>x, y<span class="op">=</span>y, brush<span class="op">=</span>brush, size<span class="op">=</span><span class="dv">10</span>)</span></code></pre></div>
<blockquote>
<p>✅ <code>128</code> = 50% شفافية (من 0 إلى 255)</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-4">🔹 <strong>6. الأخطاء الشائعة</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>لا تظهر النقاط</td>
<td><code>pen=None</code> و<code>brush=None</code></td>
<td>تأكد من تعيين <code>brush</code></td>
</tr>
<tr class="even">
<td>الحجم صغير جدًا</td>
<td><code>size=1</code></td>
<td>زد قيمة <code>size</code></td>
</tr>
<tr class="odd">
<td>الألوان لا تعمل</td>
<td>تمرير قائمة مباشرة</td>
<td>استخدم <code>spots</code> أو <code>mkBrush</code></td>
</tr>
<tr class="even">
<td><code>addItem()</code> لا يعمل</td>
<td>استخدمت <code>plot()</code> بدل <code>addItem</code></td>
<td>تأكد من استخدام <code>addItem</code> مع <code>ScatterPlotItem</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-3">🔹 <strong>7. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>ارسم 50 نقطة عشوائية مع ألوان عشوائية.</li>
<li>غير حجم النقاط ليكون متناسبًا مع القيمة (مثل: <code>size = y * 5</code>).</li>
<li>أضف شفافية للنقاط.</li>
<li>ارسم خطًا يربط النقاط مع الحفاظ على النقاط.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-تحليل-بيانات-العملاء">🔹 <strong>8. الربط بالواقع: تحليل بيانات العملاء</strong></h2>
<h3 id="الهدف-تحليل-العلاقة-بين-العمر-والدخل">🎯 الهدف: تحليل العلاقة بين العمر والدخل</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="co"># بيانات وهمية للعملاء</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a>age <span class="op">=</span> np.random.randint(<span class="dv">18</span>, <span class="dv">70</span>, <span class="dv">100</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true"></a>income <span class="op">=</span> <span class="dv">20000</span> <span class="op">+</span> age <span class="op">*</span> <span class="dv">1000</span> <span class="op">+</span> np.random.randn(<span class="dv">100</span>) <span class="op">*</span> <span class="dv">5000</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true"></a><span class="co"># إنشاء النافذة</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true"></a>win <span class="op">=</span> pg.GraphicsLayoutWidget(show<span class="op">=</span><span class="va">True</span>, title<span class="op">=</span><span class="st">&quot;تحليل العملاء&quot;</span>, size<span class="op">=</span>(<span class="dv">800</span>, <span class="dv">600</span>))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true"></a>p1 <span class="op">=</span> win.addPlot(title<span class="op">=</span><span class="st">&quot;العمر مقابل الدخل&quot;</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true"></a>p1.setLabel(<span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;العمر (سنة)&#39;</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true"></a>p1.setLabel(<span class="st">&#39;left&#39;</span>, <span class="st">&#39;الدخل (ريال)&#39;</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true"></a>p1.showGrid(<span class="va">True</span>, <span class="va">True</span>, <span class="fl">0.3</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true"></a><span class="co"># تحديد نقاط العملاء المميزين (دخل عالي)</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true"></a>colors <span class="op">=</span> [<span class="st">&#39;r&#39;</span> <span class="cf">if</span> inc <span class="op">&gt;</span> <span class="dv">80000</span> <span class="cf">else</span> <span class="st">&#39;b&#39;</span> <span class="cf">for</span> inc <span class="kw">in</span> income]</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true"></a>sizes <span class="op">=</span> [<span class="dv">15</span> <span class="cf">if</span> inc <span class="op">&gt;</span> <span class="dv">80000</span> <span class="cf">else</span> <span class="dv">8</span> <span class="cf">for</span> inc <span class="kw">in</span> income]</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true"></a>spots <span class="op">=</span> [{<span class="st">&#39;pos&#39;</span>: (age[i], income[i]), <span class="st">&#39;size&#39;</span>: sizes[i], <span class="st">&#39;brush&#39;</span>: colors[i]} <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(age))]</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true"></a>scatter <span class="op">=</span> pg.ScatterPlotItem(spots<span class="op">=</span>spots)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true"></a>p1.addItem(scatter)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true"></a><span class="co"># إضافة نص توضيحي</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true"></a>text <span class="op">=</span> pg.TextItem(text<span class="op">=</span><span class="st">&quot;العملاء المميزون (أحمر)&quot;</span>, color<span class="op">=</span><span class="st">&#39;r&#39;</span>, anchor<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true"></a>text.setPos(<span class="dv">30</span>, <span class="dv">120000</span>)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true"></a>p1.addItem(text)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📊 تحليل العملاء جاهز للعرض!&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا النوع من التحليل يُستخدم في التسويق والتجزئة.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-4">🔹 <strong>9. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>ScatterPlotItem</code> عندما تحتاج تحكمًا دقيقًا في كل نقطة.</li>
<li>✅ استخدم <code>spots</code> لجعل كل نقطة فريدة.</li>
<li>✅ استخدم الشفافية لتجنب التداخل.</li>
<li>✅ اجمع بين <code>plot()</code> و <code>ScatterPlotItem</code> للحصول على خطوط ونقاط.</li>
<li>✅ استخدم <code>addItem()</code> وليس <code>plot()</code> عند استخدام <code>ScatterPlotItem</code>.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-3">🔹 <strong>10. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>plot()</code> و <code>ScatterPlotItem</code>؟</li>
<li>كيف تُغير لون كل نقطة على حدة؟</li>
<li>ما وظيفة <code>alpha</code> في <code>mkBrush</code>؟</li>
<li>كيف تُظهر الشبكة في الرسم التشتتي؟</li>
<li>كيف تُربط النقاط بخط؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-3">🔹 <strong>11. مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>العنصر</th>
<th>الكود</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ScatterPlotItem()</code></td>
<td>إنشاء نقاط</td>
</tr>
<tr class="even">
<td><code>spots</code></td>
<td>قائمة بالخصائص لكل نقطة</td>
</tr>
<tr class="odd">
<td><code>pos</code></td>
<td>موقع النقطة (x, y)</td>
</tr>
<tr class="even">
<td><code>size</code></td>
<td>حجم النقطة</td>
</tr>
<tr class="odd">
<td><code>brush</code></td>
<td>لون ملء النقطة</td>
</tr>
<tr class="even">
<td><code>pen</code></td>
<td>لون الحدودة</td>
</tr>
<tr class="odd">
<td><code>alpha</code></td>
<td>الشفافية (في RGBA)</td>
</tr>
<tr class="even">
<td><code>addItem()</code></td>
<td>إضافة العنصر للرسم</td>
</tr>
</tbody>
</table>
<h1 id="lesson_7">📘 <strong>الدرس 7 (موسع): رسم الأعمدة (Bar Graphs)</strong></h1>
<h2 id="مقدمة-لماذا-نستخدم-رسم-الأعمدة">🔹 <strong>مقدمة: لماذا نستخدم رسم الأعمدة؟</strong></h2>
<p>رسم الأعمدة (Bar Graph) هو الطريقة المثالية لتمثيل <strong>البيانات الفئوية (Categorical Data)</strong> ومقارنتها.</p>
<p>يُستخدم لعرض: - مبيعات كل منتج - عدد الموظفين في كل قسم - توزيع الدرجات بين الطلاب - نتائج الاستبيانات</p>
<p>في هذا الدرس، ستتعلم كيفية إنشاء رسم أعمدة باستخدام PyQtGraph، وتخصيصه بالكامل: الألوان، التسميات، والتباين.</p>
<hr />
<h2 id="استخدام-bargraphitem-الطريقة-الأساسية">🔹 <strong>1. استخدام <code>BarGraphItem</code> — الطريقة الأساسية</strong></h2>
<h3 id="المثال-1-رسم-أعمدة-بسيط">📌 المثال 1: رسم أعمدة بسيط</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true"></a><span class="co"># إنشاء نافذة</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true"></a>win <span class="op">=</span> pg.plot(title<span class="op">=</span><span class="st">&quot;مبيعات المنتجات&quot;</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true"></a>win.setLabel(<span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;المنتج&#39;</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true"></a>win.setLabel(<span class="st">&#39;left&#39;</span>, <span class="st">&#39;الكمية&#39;</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true"></a>win.showGrid(y<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true"></a><span class="co"># بيانات المبيعات</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true"></a>products <span class="op">=</span> [<span class="st">&#39;تفاح&#39;</span>, <span class="st">&#39;موز&#39;</span>, <span class="st">&#39;حليب&#39;</span>, <span class="st">&#39;لابتوب&#39;</span>]</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true"></a>sales <span class="op">=</span> [<span class="dv">50</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">5</span>]</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true"></a><span class="co"># تحويل الأسماء إلى مواقع عددية</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(products))</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true"></a><span class="co"># إنشاء أعمدة</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true"></a>bars <span class="op">=</span> pg.BarGraphItem(x<span class="op">=</span>x, height<span class="op">=</span>sales, width<span class="op">=</span><span class="fl">0.6</span>, brush<span class="op">=</span><span class="st">&#39;g&#39;</span>)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true"></a><span class="co"># إضافة الأعمدة إلى النافذة</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true"></a>win.addItem(bars)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true"></a></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true"></a><span class="co"># تعديل تسميات محور X</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true"></a>ax <span class="op">=</span> win.getAxis(<span class="st">&#39;bottom&#39;</span>)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true"></a>ax.setTicks([[(i, products[i]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(products))]])</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true"></a></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="شرح-الكود-5">🔍 شرح الكود:</h4>
<ul>
<li><code>BarGraphItem(x, height, width, brush)</code>: يُنشئ أعمدة.</li>
<li><code>x</code>: المواقع الأفقية (أرقام).</li>
<li><code>height</code>: ارتفاع العمود (القيمة).</li>
<li><code>width</code>: عرض العمود.</li>
<li><code>brush</code>: لون العمود.</li>
<li><code>setTicks()</code>: لتغيير تسميات المحور X إلى أسماء.</li>
</ul>
<blockquote>
<p>✅ هذا هو الشكل الأساسي لرسم الأعمدة.</p>
</blockquote>
<hr />
<h2 id="تخصيص-ألوان-الأعمدة">🔹 <strong>2. تخصيص ألوان الأعمدة</strong></h2>
<p>يمكنك جعل كل عمود بلون مختلف.</p>
<h3 id="المثال-2-أعمدة-متعددة-الألوان">📌 المثال 2: أعمدة متعددة الألوان</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="co"># ألوان لكل عمود</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a>colors <span class="op">=</span> [<span class="st">&#39;r&#39;</span>, <span class="st">&#39;y&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;m&#39;</span>]  <span class="co"># أحمر، أصفر، أزرق، أرجواني</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a><span class="co"># إنشاء الأعمدة</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a>bars <span class="op">=</span> pg.BarGraphItem(x<span class="op">=</span>x, height<span class="op">=</span>sales, width<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true"></a><span class="co"># تعيين الألوان فورًا</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true"></a>bars.setOpts(brushes<span class="op">=</span>colors)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true"></a>win.addItem(bars)</span></code></pre></div>
<blockquote>
<p>✅ استخدم <code>brushes</code> (جمع) لتحديد لون لكل عمود.</p>
</blockquote>
<hr />
<h2 id="إضافة-التسميات-فوق-الأعمدة">🔹 <strong>3. إضافة التسميات فوق الأعمدة</strong></h2>
<p>لجعل الرسم أكثر وضوحًا.</p>
<h3 id="المثال-3-إضافة-نص-فوق-كل-عمود">📌 المثال 3: إضافة نص فوق كل عمود</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a><span class="im">from</span> pyqtgraph <span class="im">import</span> TextItem</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true"></a><span class="co"># بعد إنشاء الأعمدة</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(products)):</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true"></a>    text <span class="op">=</span> TextItem(text<span class="op">=</span><span class="bu">str</span>(sales[i]), color<span class="op">=</span><span class="st">&#39;k&#39;</span>, anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="fl">1.2</span>))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true"></a>    text.setPos(x[i], sales[i])</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true"></a>    win.addItem(text)</span></code></pre></div>
<blockquote>
<p>✅ <code>anchor=(0.5, 1.2)</code>: لمركز النص فوق العمود.</p>
</blockquote>
<hr />
<h2 id="رسم-أعمدة-متعددة-grouped-bar-chart">🔹 <strong>4. رسم أعمدة متعددة (Grouped Bar Chart)</strong></h2>
<p>لعرض بيانات متعددة (مثل: مبيعات 2023 و2024).</p>
<h3 id="المثال-4-مقارنة-بين-عامين">📌 المثال 4: مقارنة بين عامين</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a><span class="co"># بيانات</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a>sales_2023 <span class="op">=</span> [<span class="dv">50</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">5</span>]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true"></a>sales_2024 <span class="op">=</span> [<span class="dv">55</span>, <span class="dv">35</span>, <span class="dv">42</span>, <span class="dv">8</span>]</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true"></a><span class="co"># تحديد عرض المجموعة</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true"></a>width <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true"></a><span class="co"># إنشاء الأعمدة</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true"></a>bars_2023 <span class="op">=</span> pg.BarGraphItem(x<span class="op">=</span>x <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span>, height<span class="op">=</span>sales_2023, width<span class="op">=</span>width, brush<span class="op">=</span><span class="st">&#39;b&#39;</span>, name<span class="op">=</span><span class="st">&#39;2023&#39;</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true"></a>bars_2024 <span class="op">=</span> pg.BarGraphItem(x<span class="op">=</span>x <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, height<span class="op">=</span>sales_2024, width<span class="op">=</span>width, brush<span class="op">=</span><span class="st">&#39;r&#39;</span>, name<span class="op">=</span><span class="st">&#39;2024&#39;</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true"></a>win.addItem(bars_2023)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true"></a>win.addItem(bars_2024)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true"></a><span class="co"># إضافة أسطورة</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true"></a>legend <span class="op">=</span> win.addLegend()</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true"></a>legend.addItem(bars_2023, <span class="st">&#39;2023&#39;</span>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true"></a>legend.addItem(bars_2024, <span class="st">&#39;2024&#39;</span>)</span></code></pre></div>
<blockquote>
<p>✅ <code>x ± width/2</code>: لوضع الأعمدة جنبًا إلى جنب.</p>
</blockquote>
<hr />
<h2 id="رسم-أعمدة-مكدسة-stacked-bar-chart">🔹 <strong>5. رسم أعمدة مكدسة (Stacked Bar Chart)</strong></h2>
<p>لعرض المجموع الكلي.</p>
<h3 id="المثال-5-أعمدة-مجمعة">📌 المثال 5: أعمدة مجمعة</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a><span class="co"># القيم المكدسة</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a>y1 <span class="op">=</span> sales_2023</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true"></a>y2 <span class="op">=</span> [a <span class="op">+</span> b <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(sales_2023, sales_2024)]</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true"></a>bars_2023 <span class="op">=</span> pg.BarGraphItem(x<span class="op">=</span>x, height<span class="op">=</span>y1, width<span class="op">=</span><span class="fl">0.6</span>, brush<span class="op">=</span><span class="st">&#39;b&#39;</span>, name<span class="op">=</span><span class="st">&#39;2023&#39;</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true"></a>bars_2024 <span class="op">=</span> pg.BarGraphItem(x<span class="op">=</span>x, y<span class="op">=</span>y1, height<span class="op">=</span>sales_2024, width<span class="op">=</span><span class="fl">0.6</span>, brush<span class="op">=</span><span class="st">&#39;r&#39;</span>, name<span class="op">=</span><span class="st">&#39;2024&#39;</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true"></a>win.addItem(bars_2023)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true"></a>win.addItem(bars_2024)</span></code></pre></div>
<blockquote>
<p>✅ <code>y=y1</code>: لبدء العمود الجديد من قمة العمود الأول.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-5">🔹 <strong>6. الأخطاء الشائعة</strong></h2>
<table>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>لا تظهر الأعمدة</td>
<td><code>width=0</code> أو <code>height=0</code></td>
<td>تأكد من القيم</td>
</tr>
<tr class="even">
<td>التسميات لا تظهر</td>
<td>نسيت <code>setTicks()</code></td>
<td>أضف <code>setTicks()</code> للمحور</td>
</tr>
<tr class="odd">
<td>الألوان لا تعمل</td>
<td>استخدمت <code>brush</code> بدل <code>brushes</code></td>
<td>استخدم <code>setOpts(brushes=...)</code></td>
</tr>
<tr class="even">
<td><code>addItem()</code> لا يعمل</td>
<td>لم تُنشئ <code>BarGraphItem</code> أولًا</td>
<td>تأكد من <code>pg.BarGraphItem()</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-4">🔹 <strong>7. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>ارسم أعمدة لدرجات 5 طلاب.</li>
<li>غير لون كل عمود ليكون متناسبًا مع الدرجة (أحمر للمنخفضة، أخضر للعالية).</li>
<li>أضف تسمية رقمية فوق كل عمود.</li>
<li>أنشئ رسمًا مزدوجًا يقارن بين فصلي “أول ثانوي” و“ثاني ثانوي”.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-تقرير-مبيعات-متجر">🔹 <strong>8. الربط بالواقع: تقرير مبيعات متجر</strong></h2>
<h3 id="الهدف-عرض-مبيعات-شهرين">🎯 الهدف: عرض مبيعات شهرين</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="co"># بيانات وهمية</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a>products <span class="op">=</span> [<span class="st">&#39;موز&#39;</span>, <span class="st">&#39;تفاح&#39;</span>, <span class="st">&#39;حليب&#39;</span>, <span class="st">&#39;خبز&#39;</span>, <span class="st">&#39;لبن&#39;</span>]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a>jan_sales <span class="op">=</span> [<span class="dv">120</span>, <span class="dv">150</span>, <span class="dv">80</span>, <span class="dv">100</span>, <span class="dv">90</span>]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true"></a>feb_sales <span class="op">=</span> [<span class="dv">130</span>, <span class="dv">140</span>, <span class="dv">85</span>, <span class="dv">110</span>, <span class="dv">95</span>]</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(products))</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true"></a>width <span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true"></a>win <span class="op">=</span> pg.GraphicsLayoutWidget(show<span class="op">=</span><span class="va">True</span>, title<span class="op">=</span><span class="st">&quot;مبيعات يناير وفبراير&quot;</span>, size<span class="op">=</span>(<span class="dv">900</span>, <span class="dv">600</span>))</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true"></a>p1 <span class="op">=</span> win.addPlot()</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true"></a><span class="co"># الأعمدة</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true"></a>bars_jan <span class="op">=</span> pg.BarGraphItem(x<span class="op">=</span>x <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span>, height<span class="op">=</span>jan_sales, width<span class="op">=</span>width, brush<span class="op">=</span><span class="st">&#39;g&#39;</span>, name<span class="op">=</span><span class="st">&#39;يناير&#39;</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true"></a>bars_feb <span class="op">=</span> pg.BarGraphItem(x<span class="op">=</span>x <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, height<span class="op">=</span>feb_sales, width<span class="op">=</span>width, brush<span class="op">=</span><span class="st">&#39;b&#39;</span>, name<span class="op">=</span><span class="st">&#39;فبراير&#39;</span>)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true"></a>p1.addItem(bars_jan)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true"></a>p1.addItem(bars_feb)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true"></a><span class="co"># التسميات</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true"></a>ax <span class="op">=</span> p1.getAxis(<span class="st">&#39;bottom&#39;</span>)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true"></a>ax.setTicks([[(i, products[i]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(products))]])</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true"></a>p1.setLabel(<span class="st">&#39;left&#39;</span>, <span class="st">&#39;الكمية&#39;</span>)</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true"></a>p1.setLabel(<span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;المنتج&#39;</span>)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true"></a>p1.setTitle(<span class="st">&#39;مقارنة مبيعات شهرين&#39;</span>)</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true"></a>p1.showGrid(y<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true"></a></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true"></a><span class="co"># أسطورة</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true"></a>p1.addLegend()</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📊 تقرير المبيعات جاهز للعرض!&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا النوع من التقارير يُستخدم في الإدارة.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-5">🔹 <strong>9. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>BarGraphItem</code> فقط للرسمات الثابتة.</li>
<li>✅ استخدم <code>plot()</code> مع <code>stepMode=True</code> للتحديث السريع.</li>
<li>✅ استخدم <code>TextItem</code> لإضافة تسميات.</li>
<li>✅ استخدم <code>addLegend()</code> للرسومات المتعددة.</li>
<li>✅ استخدم <code>setTicks()</code> لتخصيص تسميات المحور.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-4">🔹 <strong>10. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>كيف تُغير عرض العمود؟</li>
<li>كيف تُظهر تسميات نصية على محور X؟</li>
<li>ما الفرق بين <code>brush</code> و <code>brushes</code>؟</li>
<li>كيف تُنشئ أعمدة مزدوجة؟</li>
<li>كيف تُضيف أسطورة؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-4">🔹 <strong>11. مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>العنصر</th>
<th>الكود</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>BarGraphItem()</code></td>
<td>إنشاء أعمدة</td>
</tr>
<tr class="even">
<td><code>x</code>, <code>height</code></td>
<td>الموقع والارتفاع</td>
</tr>
<tr class="odd">
<td><code>width</code></td>
<td>عرض العمود</td>
</tr>
<tr class="even">
<td><code>brush</code></td>
<td>لون العمود</td>
</tr>
<tr class="odd">
<td><code>brushes</code></td>
<td>ألوان متعددة</td>
</tr>
<tr class="even">
<td><code>setTicks()</code></td>
<td>تسميات المحور</td>
</tr>
<tr class="odd">
<td><code>TextItem()</code></td>
<td>نص فوق العمود</td>
</tr>
<tr class="even">
<td><code>addLegend()</code></td>
<td>أسطورة</td>
</tr>
</tbody>
</table>
<h1 id="lesson_8">📘 <strong>الدرس 8 (موسع): عرض الصور (ImageView)</strong></h1>
<h2 id="مقدمة-لماذا-نعرض-الصور-في-تطبيقات-pyqtgraph">🔹 <strong>مقدمة: لماذا نعرض الصور في تطبيقات PyQtGraph؟</strong></h2>
<p>رغم أن PyQtGraph تُعرف بالرسوم البيانية، إلا أنها توفر أداة قوية جدًا لعرض <strong>الصور والمصفوفات الثنائية والثلاثية الأبعاد</strong>.</p>
<p>تُستخدم في: - تطبيقات التصوير الطبي (مثل: عرض صور الأشعة) - تحليل الصور الحرارية - معالجة الإشارات (Spectrograms) - عرض بيانات المصفوفات (مثل: نتائج التجارب)</p>
<p>العنصر الرئيسي لذلك هو <strong><code>ImageView</code></strong> — وهو أكثر من مجرد عارض صور، بل يوفر: - التكبير والتحريك - التحكم في السطوع والتباين - اختيار الخرائط اللونية (Colormaps) - قراءة قيمة البكسل عند النقر</p>
<hr />
<h2 id="استخدام-imageview-العارض-المتكامل">🔹 <strong>1. استخدام <code>ImageView</code> — العارض المتكامل</strong></h2>
<h3 id="المثال-1-عرض-صورة-بسيطة-مصفوفة">📌 المثال 1: عرض صورة بسيطة (مصفوفة)</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true"></a><span class="co"># إنشاء ImageView</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true"></a>view <span class="op">=</span> pg.ImageView()</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true"></a><span class="co"># إنشاء صورة وهمية (مصفوفة 2D)</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true"></a><span class="co"># مثل: صورة حرارية أو بيانات تجربة</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true"></a>image_data <span class="op">=</span> np.random.normal(size<span class="op">=</span>(<span class="dv">100</span>, <span class="dv">100</span>)) <span class="op">*</span> <span class="dv">50</span> <span class="op">+</span> <span class="dv">100</span>  <span class="co"># قيم من 50 إلى 150</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true"></a><span class="co"># عرض الصورة</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true"></a>view.setImage(image_data)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true"></a><span class="co"># تعيين عنوان</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true"></a>view.setWindowTitle(<span class="st">&quot;عرض صورة باستخدام ImageView&quot;</span>)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true"></a><span class="co"># عرض النافذة</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true"></a>view.show()</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="شرح-الكود-6">🔍 شرح الكود:</h4>
<ul>
<li><code>pg.ImageView()</code>: يُنشئ نافذة عرض صور متكاملة.</li>
<li><code>setImage(data)</code>: يعرض المصفوفة كصورة.</li>
<li>لا حاجة لإضافة العنصر يدويًا — <code>ImageView</code> يحتوي كل شيء.</li>
</ul>
<blockquote>
<p>✅ الناتج: نافذة بها صورة، شريط تمرير للسطوع، وشريط جانبي للتحكم.</p>
</blockquote>
<hr />
<h2 id="التحكم-في-السطوع-والتباين-levels">🔹 <strong>2. التحكم في السطوع والتباين (Levels)</strong></h2>
<p><code>ImageView</code> يُظهر شريطين جانبيين للتحكم في: - <strong>الحد الأدنى (Black Level)</strong> - <strong>الحد الأعلى (White Level)</strong></p>
<h3 id="المثال-2-ضبط-مستويات-العرض-يدويا">📌 المثال 2: ضبط مستويات العرض يدويًا</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="co"># بعد إنشاء view</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true"></a>view.setImage(image_data, levels<span class="op">=</span>(<span class="dv">50</span>, <span class="dv">150</span>))</span></code></pre></div>
<blockquote>
<p>✅ <code>levels=(min, max)</code>: يُعيّن أي قيمة أقل من <code>min</code> تكون سوداء، وأي قيمة أكبر من <code>max</code> تكون بيضاء.</p>
</blockquote>
<hr />
<h2 id="استخدام-الخرائط-اللونية-colormaps">🔹 <strong>3. استخدام الخرائط اللونية (Colormaps)</strong></h2>
<p>يمكنك تغيير طريقة عرض القيم باستخدام خريطة لونية.</p>
<h3 id="المثال-3-تطبيق-خريطة-لونية">📌 المثال 3: تطبيق خريطة لونية</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph.colormap <span class="im">as</span> cm</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true"></a><span class="co"># قائمة بالخرائط الشهيرة: &#39;viridis&#39;, &#39;plasma&#39;, &#39;hot&#39;, &#39;cool&#39;, &#39;gray&#39;, &#39;jet&#39;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true"></a>view <span class="op">=</span> pg.ImageView()</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true"></a>view.setImage(image_data, levels<span class="op">=</span>(<span class="dv">50</span>, <span class="dv">150</span>), colorMap<span class="op">=</span>cm.get(<span class="st">&#39;hot&#39;</span>))</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true"></a>view.setWindowTitle(<span class="st">&quot;خريطة لونية: hot&quot;</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true"></a>view.show()</span></code></pre></div>
<blockquote>
<p>✅ <code>cm.get('hot')</code>: يُنشئ خريطة لونية حمراء-صفراء.</p>
</blockquote>
<hr />
<h2 id="عرض-صور-متعددة-أطر-فيديو-أو-طبقات">🔹 <strong>4. عرض صور متعددة (أطر فيديو أو طبقات)</strong></h2>
<p>يمكن لـ <code>ImageView</code> عرض سلسلة من الصور (مثل: فيديو أو طبقات متعددة).</p>
<h3 id="المثال-4-عرض-3-صور-مصفوفة-3d">📌 المثال 4: عرض 3 صور (مصفوفة 3D)</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a><span class="co"># إنشاء بيانات ثلاثية الأبعاد (3 صور حجم 50x50)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true"></a>video_data <span class="op">=</span> np.random.rand(<span class="dv">3</span>, <span class="dv">50</span>, <span class="dv">50</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true"></a><span class="co"># عرض الفيديو</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true"></a>view <span class="op">=</span> pg.ImageView()</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true"></a>view.setImage(video_data)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true"></a>view.setWindowTitle(<span class="st">&quot;عرض 3 أطر (فيديو قصير)&quot;</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true"></a>view.show()</span></code></pre></div>
<blockquote>
<p>✅ تظهر أداة تمرير للتنقل بين الإطارات.</p>
</blockquote>
<hr />
<h2 id="التفاعل-مع-النقر-على-الصورة">🔹 <strong>5. التفاعل مع النقر على الصورة</strong></h2>
<p>للحصول على قيمة البكسل عند النقر.</p>
<h3 id="المثال-5-ربط-حدث-النقر">📌 المثال 5: ربط حدث النقر</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="kw">def</span> on_click():</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true"></a>    pos <span class="op">=</span> view.imageItem.pos()  <span class="co"># موقع الصورة</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true"></a>    view_box <span class="op">=</span> view.getView()</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true"></a>    mouse_point <span class="op">=</span> view_box.mapSceneToView(view_box.mapToView(pg.QtCore.QPoint(pg.QtGui.QCursor.pos())))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="ss">f&quot;تم النقر عند: X=</span><span class="sc">{</span>mouse_point<span class="sc">.x</span>()<span class="sc">:.1f}</span><span class="ss">, Y=</span><span class="sc">{</span>mouse_point<span class="sc">.y</span>()<span class="sc">:.1f}</span><span class="ss">&quot;</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true"></a><span class="co"># ربط الحدث بالنقر الأيمن</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true"></a>view.viewBox.menu.actions()[<span class="dv">0</span>].triggered.<span class="ex">connect</span>(on_click)</span></code></pre></div>
<blockquote>
<p>✅ مفيد في التطبيقات التي تحتاج تفاعلًا دقيقًا.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-6">🔹 <strong>6. الأخطاء الشائعة</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>AttributeError: 'ImageView' has no attribute 'plot'</code></td>
<td>حاولت استخدام <code>plot()</code></td>
<td>استخدم <code>setImage()</code></td>
</tr>
<tr class="even">
<td>لا تظهر الصورة</td>
<td>البيانات ليست مصفوفة 2D أو 3D</td>
<td>تأكد من <code>shape</code></td>
</tr>
<tr class="odd">
<td>الخريطة اللونية لا تعمل</td>
<td>لم تُستخدم <code>cm.get()</code></td>
<td>استخدم <code>colorMap=cm.get('viridis')</code></td>
</tr>
<tr class="even">
<td><code>levels</code> لا تؤثر</td>
<td>القيم خارج النطاق</td>
<td>تأكد من نطاق البيانات</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-5">🔹 <strong>7. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>أنشئ مصفوفة 100x100 تمثل توزيع حرارة، واعرضها بخريطة <code>hot</code>.</li>
<li>غير مستويات العرض لتركيز الاهتمام على القيم العالية.</li>
<li>أنشئ 5 صور (5x100x100) واعرضها كفيديو.</li>
<li>أضف دالة تُطبع قيمة البكسل عند النقر.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-تحليل-صورة-طبية">🔹 <strong>8. الربط بالواقع: تحليل صورة طبية</strong></h2>
<h3 id="الهدف-محاكاة-عرض-صورة-أشعة">🎯 الهدف: محاكاة عرض صورة أشعة</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a><span class="co"># فرض صورة أشعة (مصفوفة 2D)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true"></a>xray <span class="op">=</span> np.random.normal(<span class="dv">128</span>, <span class="dv">20</span>, (<span class="dv">200</span>, <span class="dv">200</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true"></a><span class="co"># إضافة &quot;عيب&quot; صغير (مثل كتلة)</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true"></a>xray[<span class="dv">80</span>:<span class="dv">100</span>, <span class="dv">90</span>:<span class="dv">110</span>] <span class="op">+=</span> <span class="dv">50</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true"></a><span class="co"># عرض الصورة</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true"></a>view <span class="op">=</span> pg.ImageView()</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true"></a>view.setImage(xray, levels<span class="op">=</span>(<span class="dv">50</span>, <span class="dv">200</span>), colorMap<span class="op">=</span>cm.get(<span class="st">&#39;gray&#39;</span>))</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true"></a>view.setWindowTitle(<span class="st">&quot;تحليل صورة أشعة&quot;</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true"></a>view.show()</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;🩻 واجهة تحليل الأشعة جاهزة!&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا النوع من التطبيقات يُستخدم في الأنظمة الطبية.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-6">🔹 <strong>9. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>ImageView</code> فقط للصور أو المصفوفات.</li>
<li>✅ استخدم <code>colorMap=cm.get('gray')</code> للصور الطبية.</li>
<li>✅ استخدم <code>levels</code> لتحسين التباين.</li>
<li>✅ تحكم في حجم النافذة باستخدام <code>resize()</code>.</li>
<li>✅ استخدم <code>setImage()</code> وليس <code>addItem()</code> مع <code>ImageView</code>.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-5">🔹 <strong>10. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>ImageView</code> و <code>PlotWidget</code>؟</li>
<li>كيف تُعرض صورة ثلاثية الأبعاد؟</li>
<li>ما وظيفة <code>levels</code> في <code>setImage()</code>؟</li>
<li>كيف تُغير الخريطة اللونية؟</li>
<li>كيف تُعرف قيمة البكسل عند النقر؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-5">🔹 <strong>11. مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>العنصر</th>
<th>الكود</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ImageView()</code></td>
<td>إنشاء عارض صور</td>
</tr>
<tr class="even">
<td><code>setImage(data)</code></td>
<td>عرض الصورة</td>
</tr>
<tr class="odd">
<td><code>levels=(min, max)</code></td>
<td>التحكم في السطوع</td>
</tr>
<tr class="even">
<td><code>colorMap=cm.get('...')</code></td>
<td>تطبيق خريطة لونية</td>
</tr>
<tr class="odd">
<td><code>setImage(3D_data)</code></td>
<td>عرض فيديو أو طبقات</td>
</tr>
<tr class="even">
<td><code>viewBox</code></td>
<td>للتفاعل مع النقر</td>
</tr>
</tbody>
</table>
<h1 id="lesson_9">📘 <strong>الدرس 9 (موسع): التكبير والتحريك (Zoom &amp; Pan)</strong></h1>
<h2 id="مقدمة-لماذا-التكبير-والتحريك-ضروريان">🔹 <strong>مقدمة: لماذا التكبير والتحريك ضروريان؟</strong></h2>
<p>في أي تطبيق لعرض البيانات، من الضروري أن يتمكن المستخدم من: - <strong>التكبير (Zoom)</strong> على منطقة معينة لرؤية التفاصيل الدقيقة (مثل: تغيرات سعر السهم في دقائق). - <strong>التحريك (Pan)</strong> عبر البيانات الكبيرة (مثل: عرض ساعة من البيانات على مدى 24 ساعة).</p>
<p>PyQtGraph يوفر هذه الوظائف <strong>مدمجة افتراضيًا</strong>، لكن فهم آلية عملها يمنحك القدرة على: - تعطيلها عند الحاجة - تخصيص سلوكها - ربطها بأحداث أخرى</p>
<hr />
<h2 id="كيف-يعمل-التكبير-والتحريك-افتراضيا">🔹 <strong>1. كيف يعمل التكبير والتحريك افتراضيًا؟</strong></h2>
<p>بمجرد إنشاء <code>PlotWidget</code> أو <code>ImageView</code>، تصبح وظائف التفاعلية مفعلة تلقائيًا: - <strong>التكبير</strong>: استخدام عجلة الماوس (Scroll) - <strong>التحريك</strong>: الضغط والتحريك بالماوس (Drag) - <strong>إعادة التعيين</strong>: الضغط بالزر الأيمن → “Auto-range”</p>
<h3 id="المثال-1-تفعيل-التفاعلية">📌 المثال 1: تفعيل التفاعلية</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true"></a><span class="co"># إنشاء نافذة</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true"></a>win <span class="op">=</span> pg.plot(title<span class="op">=</span><span class="st">&quot;التكبير والتحريك&quot;</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true"></a><span class="co"># بيانات كبيرة (10,000 نقطة)</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">10000</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true"></a>y <span class="op">=</span> np.sin(x) <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> np.random.randn(<span class="dv">10000</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true"></a><span class="co"># رسم البيانات</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true"></a>win.plot(x, y)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<blockquote>
<p>✅ يمكنك التكبير بالعجلة، والتحريك بالضغط والتحريك.</p>
</blockquote>
<hr />
<h2 id="التحكم-في-التفاعلية-باستخدام-viewbox">🔹 <strong>2. التحكم في التفاعلية باستخدام <code>ViewBox</code></strong></h2>
<p>كما تعلمت في الدرس 4، <code>ViewBox</code> هو العنصر المسؤول عن التفاعل.</p>
<h3 id="المثال-2-تعطيل-التكبير-على-محور-y">📌 المثال 2: تعطيل التكبير على محور Y</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true"></a>plot_item <span class="op">=</span> win.getPlotItem()</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true"></a>view_box <span class="op">=</span> plot_item.getViewBox()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true"></a><span class="co"># تعطيل التكبير على المحور الرأسي (Y)، والسماح به على الأفقي (X)</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true"></a>view_box.setMouseEnabled(x<span class="op">=</span><span class="va">True</span>, y<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<blockquote>
<p>✅ مفيد في الرسومات الزمنية حيث لا تريد تكبير المحور الرأسي.</p>
</blockquote>
<hr />
<h3 id="المثال-3-تعطيل-التفاعلية-بالكامل">📌 المثال 3: تعطيل التفاعلية بالكامل</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a>view_box.setMouseEnabled(<span class="va">False</span>, <span class="va">False</span>)</span></code></pre></div>
<blockquote>
<p>✅ مفيد عند بناء واجهة تحكم مخصصة.</p>
</blockquote>
<hr />
<h2 id="التكبير-باستخدام-البرمجة-programmatic-zoom">🔹 <strong>3. التكبير باستخدام البرمجة (Programmatic Zoom)</strong></h2>
<p>يمكنك تكبير/تصغير العرض برمجيًا.</p>
<h3 id="المثال-4-التكبير-على-منطقة-معينة">📌 المثال 4: التكبير على منطقة معينة</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a><span class="co"># تحديد منطقة الاهتمام (من x=10 إلى x=20)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true"></a>plot_item.setXRange(<span class="dv">10</span>, <span class="dv">20</span>)</span></code></pre></div>
<h3 id="المثال-5-إعادة-التعيين-التلقائي-auto-range">📌 المثال 5: إعادة التعيين التلقائي (Auto-range)</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true"></a>plot_item.autoRange()</span></code></pre></div>
<blockquote>
<p>✅ يُعيد العرض إلى جميع البيانات.</p>
</blockquote>
<hr />
<h2 id="ربط-أحداث-التكبير-والتحريك">🔹 <strong>4. ربط أحداث التكبير والتحريك</strong></h2>
<p>يمكنك تنفيذ إجراءات عند تغيير منطقة العرض.</p>
<h3 id="المثال-6-طباعة-نطاق-العرض-عند-التكبير">📌 المثال 6: طباعة نطاق العرض عند التكبير</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true"></a><span class="kw">def</span> on_range_changed():</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true"></a>    range_x <span class="op">=</span> view_box.viewRange()[<span class="dv">0</span>]  <span class="co"># [min_x, max_x]</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="ss">f&quot;نطاق العرض الجديد: </span><span class="sc">{</span>range_x[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss"> - </span><span class="sc">{</span>range_x[<span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true"></a><span class="co"># ربط الحدث</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true"></a>view_box.sigXRangeChanged.<span class="ex">connect</span>(on_range_changed)</span></code></pre></div>
<blockquote>
<p>✅ مفيد لتحديث عناصر واجهة أخرى (مثل: عرض الوقت الحالي).</p>
</blockquote>
<hr />
<h2 id="التحريك-باستخدام-الأسهم-مخصص">🔹 <strong>5. التحريك باستخدام الأسهم (مخصص)</strong></h2>
<p>إذا أردت التحكم بالتحريك عبر لوحة المفاتيح.</p>
<h3 id="المثال-7-التحريك-باستخدام-أسهم-لوحة-المفاتيح">📌 المثال 7: التحريك باستخدام أسهم لوحة المفاتيح</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true"></a><span class="im">from</span> PySide6 <span class="im">import</span> QtCore</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true"></a><span class="kw">def</span> keyPressEvent(event):</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true"></a>    <span class="cf">if</span> event.key() <span class="op">==</span> QtCore.Qt.Key_Left:</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true"></a>        view_box.translateBy(x<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true"></a>    <span class="cf">elif</span> event.key() <span class="op">==</span> QtCore.Qt.Key_Right:</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true"></a>        view_box.translateBy(x<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true"></a>    <span class="cf">elif</span> event.key() <span class="op">==</span> QtCore.Qt.Key_Up:</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true"></a>        view_box.translateBy(y<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true"></a>    <span class="cf">elif</span> event.key() <span class="op">==</span> QtCore.Qt.Key_Down:</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true"></a>        view_box.translateBy(y<span class="op">=-</span><span class="fl">0.1</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true"></a><span class="co"># ربط حدث لوحة المفاتيح</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true"></a>win.keyPressEvent <span class="op">=</span> keyPressEvent</span></code></pre></div>
<blockquote>
<p>✅ <code>translateBy()</code> يُحرك العرض.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-7">🔹 <strong>6. الأخطاء الشائعة</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>لا يعمل التكبير</td>
<td><code>setMouseEnabled(False)</code></td>
<td>أعد تمكين الفأرة</td>
</tr>
<tr class="even">
<td>التحريك بطيء</td>
<td>بيانات كبيرة جدًا</td>
<td>استخدم <code>setDownsampling()</code></td>
</tr>
<tr class="odd">
<td><code>sigXRangeChanged</code> لا يعمل</td>
<td>لم يتم ربط الحدث بشكل صحيح</td>
<td>تأكد من <code>connect()</code></td>
</tr>
<tr class="even">
<td>التكبير لا يعيد التعيين</td>
<td>لم تُستخدم <code>autoRange()</code></td>
<td>استخدم <code>plot_item.autoRange()</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-6">🔹 <strong>7. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>أنشئ رسمًا به 50,000 نقطة، وتأكد من أن التكبير يعمل بسلاسة.</li>
<li>عطّل التكبير على المحور Y فقط.</li>
<li>أضف دالة تُطبع “تم التكبير” عند تغيير نطاق العرض.</li>
<li>أضف دعمًا للتحريك باستخدام أسهم لوحة المفاتيح.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-واجهة-تحليل-بيانات-حية">🔹 <strong>8. الربط بالواقع: واجهة تحليل بيانات حية</strong></h2>
<h3 id="الهدف-مراقبة-إشارة-حية-مع-تحكم-دقيق">🎯 الهدف: مراقبة إشارة حية مع تحكم دقيق</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true"></a><span class="co"># فرض إشارة حية (مثل: قياس ضغط دم)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true"></a>t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dv">6000</span>)  <span class="co"># 60 ثانية</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true"></a>signal <span class="op">=</span> <span class="dv">120</span> <span class="op">+</span> <span class="dv">20</span> <span class="op">*</span> np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span><span class="fl">0.5</span><span class="op">*</span>t) <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">6000</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true"></a>win <span class="op">=</span> pg.plot(title<span class="op">=</span><span class="st">&quot;مراقبة الإشارة الحية&quot;</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true"></a>curve <span class="op">=</span> win.plot(t, signal, pen<span class="op">=</span><span class="st">&#39;y&#39;</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true"></a>plot_item <span class="op">=</span> win.getPlotItem()</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true"></a>view_box <span class="op">=</span> plot_item.getViewBox()</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true"></a><span class="co"># تعطيل التكبير على Y (لأن المقياس معروف)</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true"></a>view_box.setMouseEnabled(x<span class="op">=</span><span class="va">True</span>, y<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true"></a><span class="co"># ربط حدث</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true"></a><span class="kw">def</span> update_stats():</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true"></a>    range_x <span class="op">=</span> view_box.viewRange()[<span class="dv">0</span>]</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true"></a>    visible_data <span class="op">=</span> signal[(t <span class="op">&gt;=</span> range_x[<span class="dv">0</span>]) <span class="op">&amp;</span> (t <span class="op">&lt;=</span> range_x[<span class="dv">1</span>])]</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="ss">f&quot;المتوسط في المنطقة: </span><span class="sc">{np.</span>mean(visible_data)<span class="sc">:.1f}</span><span class="ss">&quot;</span>)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true"></a></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true"></a>view_box.sigXRangeChanged.<span class="ex">connect</span>(update_stats)</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true"></a></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;🔍 واجهة التحليل جاهزة للتكبير والتحليل!&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا النوع من الواجهات يُستخدم في التطبيقات الطبية.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-7">🔹 <strong>9. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>setMouseEnabled()</code> للتحكم في التفاعل.</li>
<li>✅ استخدم <code>autoRange()</code> لإعادة العرض.</li>
<li>✅ استخدم <code>sigXRangeChanged</code> لتحديث العناصر الأخرى.</li>
<li>✅ استخدم <code>translateBy()</code> للتحريك البرمجي.</li>
<li>✅ استخدم <code>setDownsampling(True)</code> للبيانات الكبيرة.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-6">🔹 <strong>10. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما العنصر المسؤول عن التكبير والتحريك؟</li>
<li>كيف تُعطل التكبير على محور معين؟</li>
<li>ما وظيفة <code>autoRange()</code>؟</li>
<li>كيف تُعرف عند تغيير نطاق العرض؟</li>
<li>كيف تُحرك العرض باستخدام لوحة المفاتيح؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-6">🔹 <strong>11. مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>الوظيفة</th>
<th>الكود</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>التكبير/التحريك</td>
<td>مدمج افتراضيًا</td>
</tr>
<tr class="even">
<td>تعطيل التفاعل</td>
<td><code>setMouseEnabled(False, False)</code></td>
</tr>
<tr class="odd">
<td>التكبير على X فقط</td>
<td><code>setMouseEnabled(x=True, y=False)</code></td>
</tr>
<tr class="even">
<td>التكبير البرمجي</td>
<td><code>setXRange(min, max)</code></td>
</tr>
<tr class="odd">
<td>إعادة العرض</td>
<td><code>autoRange()</code></td>
</tr>
<tr class="even">
<td>ربط حدث التكبير</td>
<td><code>sigXRangeChanged.connect(func)</code></td>
</tr>
<tr class="odd">
<td>التحريك بالكود</td>
<td><code>translateBy(x, y)</code></td>
</tr>
</tbody>
</table>
<h1 id="lesson_10">📘 <strong>الدرس 10 (موسع): إضافة التعليقات (Annotations)</strong></h1>
<h2 id="مقدمة-لماذا-نحتاج-إلى-التعليقات">🔹 <strong>مقدمة: لماذا نحتاج إلى التعليقات؟</strong></h2>
<p>الرسم البياني الجيد لا يُكتفى بعرض البيانات، بل يجب أن <strong>يُوجه المستخدم</strong> إلى النتائج المهمة.</p>
<p>التعليقات (Annotations) هي أدوات تسمح لك بإضافة: - <strong>نصوص</strong> توضيحية (“أعلى سعر في الشهر”) - <strong>أسهم</strong> تشير إلى أحداث معينة (“انقطاع التيار الكهربائي”) - <strong>مربعات نصية</strong> أو <strong>أشرطة</strong> لتظليل مناطق معينة</p>
<p>في هذا الدرس، ستتعلم كيفية استخدام عناصر مثل <code>TextItem</code> و <code>ArrowItem</code> و <code>InfiniteLine</code> لجعل رسوماتك أكثر <strong>وضوحًا واحترافية</strong>.</p>
<hr />
<h2 id="إضافة-نص-باستخدام-textitem">🔹 <strong>1. إضافة نص باستخدام <code>TextItem</code></strong></h2>
<p>العنصر <code>TextItem</code> يُستخدم لإضافة نص في موقع محدد على الرسم.</p>
<h3 id="المثال-1-إضافة-نص-بسيط">📌 المثال 1: إضافة نص بسيط</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true"></a><span class="co"># إنشاء نافذة</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true"></a>win <span class="op">=</span> pg.plot(title<span class="op">=</span><span class="st">&quot;إضافة نص توضيحي&quot;</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">4</span><span class="op">*</span>np.pi, <span class="dv">100</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true"></a>y <span class="op">=</span> np.sin(x)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true"></a>win.plot(x, y, pen<span class="op">=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true"></a><span class="co"># إنشاء نص</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true"></a>text <span class="op">=</span> pg.TextItem(text<span class="op">=</span><span class="st">&quot;ذروة الموجة&quot;</span>, color<span class="op">=</span><span class="st">&#39;r&#39;</span>, anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="fl">1.2</span>))</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true"></a>text.setPos(<span class="fl">1.57</span>, <span class="fl">1.0</span>)  <span class="co"># x ≈ π/2, y = 1.0</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true"></a><span class="co"># إضافة النص إلى النافذة</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true"></a>win.addItem(text)</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="شرح-الكود-7">🔍 شرح الكود:</h4>
<ul>
<li><code>text="..."</code>: النص المراد عرضه.</li>
<li><code>color='r'</code>: لون النص (أحمر).</li>
<li><code>anchor=(0.5, 1.2)</code>: يحدد نقطة التثبيت. <code>(0.5, 1.2)</code> = منتصف النص من الأعلى، مع هامش أعلاه.</li>
<li><code>setPos(x, y)</code>: لتحديد الموقع على الرسم.</li>
</ul>
<blockquote>
<p>✅ مثالي للإشارة إلى القيم القصوى أو الحدث المهم.</p>
</blockquote>
<hr />
<h2 id="إضافة-سهم-باستخدام-arrowitem">🔹 <strong>2. إضافة سهم باستخدام <code>ArrowItem</code></strong></h2>
<p>لإظهار اتجاه أو الإشارة إلى نقطة معينة.</p>
<h3 id="المثال-2-إضافة-سهم-يشير-إلى-نقطة">📌 المثال 2: إضافة سهم يشير إلى نقطة</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true"></a><span class="co"># بعد إنشاء النافذة</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true"></a>arrow <span class="op">=</span> pg.ArrowItem(angle<span class="op">=-</span><span class="dv">45</span>, tipAngle<span class="op">=</span><span class="dv">60</span>, baseAngle<span class="op">=</span><span class="dv">20</span>, headLen<span class="op">=</span><span class="dv">20</span>, tailLen<span class="op">=</span><span class="dv">40</span>, brush<span class="op">=</span><span class="st">&#39;y&#39;</span>, pen<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true"></a>arrow.setPos(<span class="dv">3</span>, <span class="fl">0.5</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true"></a>win.addItem(arrow)</span></code></pre></div>
<h4 id="خيارات-arrowitem">🔍 خيارات <code>ArrowItem</code></h4>
<table>
<thead>
<tr class="header">
<th>الخيار</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>angle</code></td>
<td>زاوية السهم (بالدرجات)</td>
</tr>
<tr class="even">
<td><code>tipAngle</code>, <code>baseAngle</code></td>
<td>زوايا الرأس والقاعدة</td>
</tr>
<tr class="odd">
<td><code>headLen</code>, <code>tailLen</code></td>
<td>طول الرأس والذيل</td>
</tr>
<tr class="even">
<td><code>brush</code></td>
<td>لون التعبئة</td>
</tr>
<tr class="odd">
<td><code>pen</code></td>
<td>لون الحدودة</td>
</tr>
</tbody>
</table>
<blockquote>
<p>✅ <code>angle=-45</code>: يشير السهم إلى أسفل اليمين.</p>
</blockquote>
<hr />
<h2 id="إضافة-خطوط-لا-نهائية-باستخدام-infiniteline">🔹 <strong>3. إضافة خطوط لا نهائية باستخدام <code>InfiniteLine</code></strong></h2>
<p>مفيد لتمثيل: - حدود قبول/رفض - المتوسطات - تواريخ أحداث</p>
<h3 id="المثال-3-خط-رأسي-يمثل-حدثا">📌 المثال 3: خط رأسي يمثل حدثًا</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true"></a><span class="co"># خط رأسي عند x = 6.28 (نهاية الدورة)</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true"></a>v_line <span class="op">=</span> pg.InfiniteLine(pos<span class="op">=</span><span class="fl">6.28</span>, angle<span class="op">=</span><span class="dv">90</span>, pen<span class="op">=</span>pg.mkPen(<span class="st">&#39;r&#39;</span>, width<span class="op">=</span><span class="dv">2</span>, style<span class="op">=</span>pg.QtCore.Qt.DashLine))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true"></a>win.addItem(v_line)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true"></a><span class="co"># خط أفقي عند y = 0 (المحور الصفر)</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true"></a>h_line <span class="op">=</span> pg.InfiniteLine(pos<span class="op">=</span><span class="dv">0</span>, angle<span class="op">=</span><span class="dv">0</span>, pen<span class="op">=</span>pg.mkPen(<span class="st">&#39;g&#39;</span>, width<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true"></a>win.addItem(h_line)</span></code></pre></div>
<blockquote>
<p>✅ <code>angle=90</code>: خط رأسي، <code>angle=0</code>: خط أفقي.</p>
</blockquote>
<hr />
<h2 id="تظليل-منطقة-باستخدام-linearregionitem">🔹 <strong>4. تظليل منطقة باستخدام <code>LinearRegionItem</code></strong></h2>
<p>لإبراز فترة زمنية أو نطاق معين.</p>
<h3 id="المثال-4-تظليل-فترة-زمنية">📌 المثال 4: تظليل فترة زمنية</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true"></a><span class="im">from</span> pyqtgraph <span class="im">import</span> LinearRegionItem</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true"></a><span class="co"># إنشاء منطقة تظليل</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true"></a>region <span class="op">=</span> LinearRegionItem(values<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">4</span>), orientation<span class="op">=</span><span class="st">&#39;vertical&#39;</span>, brush<span class="op">=</span>pg.mkBrush(<span class="st">&#39;r&#39;</span>, <span class="dv">50</span>))  <span class="co"># شفاف</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true"></a>win.addItem(region)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true"></a><span class="co"># يمكنك ربط الحدث بتحريك المنطقة</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true"></a><span class="kw">def</span> on_region_changed():</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="ss">f&quot;المنطقة: </span><span class="sc">{</span>region<span class="sc">.</span>getRegion()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true"></a>region.sigRegionChanged.<span class="ex">connect</span>(on_region_changed)</span></code></pre></div>
<blockquote>
<p>✅ <code>brush=pg.mkBrush('r', 50)</code>: لون أحمر بشفافية 50.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-8">🔹 <strong>5. الأخطاء الشائعة</strong></h2>
<table>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>النص لا يظهر</td>
<td>خارج نطاق العرض</td>
<td>استخدم <code>autoRange()</code> أو عدّل <code>setPos()</code></td>
</tr>
<tr class="even">
<td>السهم لا يظهر</td>
<td><code>pen=None</code> و<code>brush=None</code></td>
<td>تأكد من تعيين <code>brush</code></td>
</tr>
<tr class="odd">
<td>الخط لا يظهر</td>
<td><code>pos</code> خارج النطاق</td>
<td>تأكد من قيمة <code>pos</code></td>
</tr>
<tr class="even">
<td><code>addItem()</code> لا يعمل</td>
<td>لم تُنشئ العنصر أولًا</td>
<td>تأكد من <code>pg.TextItem()</code> إلخ</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-7">🔹 <strong>6. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>أضف نصًا يُشير إلى أدنى قيمة في منحنى جيب التمام.</li>
<li>أضف سهمًا أصفر يشير إلى منتصف الرسم.</li>
<li>أضف خطًا رأسيًا عند <code>x=5</code> بلون أخضر متقطع.</li>
<li>ظلل المنطقة بين <code>x=1</code> و<code>x=3</code> بلون أزرق شفاف.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-تحليل-بيانات-حية">🔹 <strong>7. الربط بالواقع: تحليل بيانات حية</strong></h2>
<h3 id="الهدف-إظهار-أحداث-مهمة-في-إشارة-حية">🎯 الهدف: إظهار أحداث مهمة في إشارة حية</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true"></a><span class="co"># فرض إشارة حية</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true"></a>t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">1000</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true"></a>signal <span class="op">=</span> np.sin(t) <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> np.random.randn(<span class="dv">1000</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true"></a>win <span class="op">=</span> pg.plot(title<span class="op">=</span><span class="st">&quot;تحليل الإشارة مع تعليقات&quot;</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true"></a>win.plot(t, signal, pen<span class="op">=</span><span class="st">&#39;y&#39;</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true"></a><span class="co"># حدث: انقطاع مؤقت عند t=5</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true"></a>v_line <span class="op">=</span> pg.InfiniteLine(pos<span class="op">=</span><span class="dv">5</span>, angle<span class="op">=</span><span class="dv">90</span>, pen<span class="op">=</span>pg.mkPen(<span class="st">&#39;r&#39;</span>, width<span class="op">=</span><span class="dv">3</span>))</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true"></a>win.addItem(v_line)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true"></a>text <span class="op">=</span> pg.TextItem(text<span class="op">=</span><span class="st">&quot;انقطاع التيار&quot;</span>, color<span class="op">=</span><span class="st">&#39;r&#39;</span>, anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="fl">1.2</span>))</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true"></a>text.setPos(<span class="dv">5</span>, <span class="fl">1.5</span>)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true"></a>win.addItem(text)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true"></a></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true"></a><span class="co"># متوسط الإشارة</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true"></a>avg <span class="op">=</span> np.mean(signal)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true"></a>h_line <span class="op">=</span> pg.InfiniteLine(pos<span class="op">=</span>avg, angle<span class="op">=</span><span class="dv">0</span>, pen<span class="op">=</span>pg.mkPen(<span class="st">&#39;g&#39;</span>, width<span class="op">=</span><span class="dv">2</span>, style<span class="op">=</span>pg.QtCore.Qt.DashLine))</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true"></a>win.addItem(h_line)</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true"></a>avg_text <span class="op">=</span> pg.TextItem(text<span class="op">=</span><span class="ss">f&quot;المتوسط: </span><span class="sc">{</span>avg<span class="sc">:.2f}</span><span class="ss">&quot;</span>, color<span class="op">=</span><span class="st">&#39;g&#39;</span>)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true"></a>avg_text.setPos(<span class="fl">0.5</span>, avg <span class="op">+</span> <span class="fl">0.2</span>)</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true"></a>win.addItem(avg_text)</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true"></a></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📌 تم إضافة التعليقات التوضيحية!&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا النوع من التحليل يُستخدم في المراقبة الصناعية.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-8">🔹 <strong>8. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>anchor</code> لضبط موضع النص بدقة.</li>
<li>✅ استخدم <code>LinearRegionItem</code> للمناطق القابلة للتحريك.</li>
<li>✅ استخدم <code>sigRegionChanged</code> لتحديث العناصر الأخرى.</li>
<li>✅ استخدم الشفافية (<code>alpha</code>) لتجنب إخفاء البيانات.</li>
<li>✅ احفظ كائنات التعليقات إذا كنت ستحديثها لاحقًا.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-7">🔹 <strong>9. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>كيف تُضيف نصًا إلى الرسم؟</li>
<li>ما وظيفة <code>anchor</code> في <code>TextItem</code>؟</li>
<li>كيف تُنشئ خطًا رأسيًا؟</li>
<li>ما الفرق بين <code>InfiniteLine</code> و <code>LinearRegionItem</code>؟</li>
<li>كيف تُحدث موقع التعليق عند تغيير الرسم؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-7">🔹 <strong>10. مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>العنصر</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>TextItem</code></td>
<td>إضافة نص توضيحي</td>
</tr>
<tr class="even">
<td><code>ArrowItem</code></td>
<td>إضافة سهم</td>
</tr>
<tr class="odd">
<td><code>InfiniteLine</code></td>
<td>خط رأسي أو أفقي لا نهائي</td>
</tr>
<tr class="even">
<td><code>LinearRegionItem</code></td>
<td>تظليل منطقة قابلة للتحريك</td>
</tr>
<tr class="odd">
<td><code>setPos()</code></td>
<td>تحديد موقع العنصر</td>
</tr>
<tr class="even">
<td><code>sigRegionChanged</code></td>
<td>ربط حدث تغيير المنطقة</td>
</tr>
</tbody>
</table>
<h1 id="lesson_11">📘 <strong>الدرس 11 (موسع): التعامل مع الإشارات (Signals)</strong></h1>
<h2 id="مقدمة-ما-هي-الإشارات-signals-في-pyqtgraph">🔹 <strong>مقدمة: ما هي الإشارات (Signals) في PyQtGraph؟</strong></h2>
<p>في واجهات المستخدم الرسومية (GUI)، لا تعمل البرامج خطوة بخطوة، بل تنتظر <strong>أحداثًا (Events)</strong> مثل: - النقر بالفأرة - الضغط على زر - التمرير - التحرك على عنصر</p>
<p>في PyQtGraph، تُسمى هذه الأحداث بـ <strong>الإشارات (Signals)</strong>، وهي طريقة لربط <strong>حدث ما</strong> بـ <strong>رد فعل (Function)</strong>.</p>
<blockquote>
<p>💡 مثل: “عند النقر على نقطة، اعرض قيمتها في نافذة منفصلة”.</p>
</blockquote>
<p>فهم الإشارات هو المفتاح لبناء تطبيقات <strong>تفاعلية وذكية</strong>.</p>
<hr />
<h2 id="كيف-تعمل-الإشارات">🔹 <strong>1. كيف تعمل الإشارات؟</strong></h2>
<p>النمط العام هو:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true"></a>widget.signal.<span class="ex">connect</span>(function)</span></code></pre></div>
<ul>
<li><code>widget</code>: العنصر (مثل: <code>PlotItem</code> أو <code>ViewBox</code>)</li>
<li><code>signal</code>: الإشارة (مثل: <code>sigClicked</code> أو <code>sigRangeChanged</code>)</li>
<li><code>function</code>: الدالة التي تُنفذ عند حدوث الحدث</li>
</ul>
<hr />
<h2 id="ربط-حدث-النقر-على-النقاط-scatter-plot">🔹 <strong>2. ربط حدث النقر على النقاط (Scatter Plot)</strong></h2>
<p>مثالي لعرض تفاصيل عند النقر على نقطة.</p>
<h3 id="المثال-1-عرض-قيمة-النقطة-عند-النقر">📌 المثال 1: عرض قيمة النقطة عند النقر</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication, QMessageBox</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true"></a><span class="co"># إنشاء نافذة</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true"></a>win <span class="op">=</span> pg.plot(title<span class="op">=</span><span class="st">&quot;النقر على النقاط&quot;</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true"></a>x <span class="op">=</span> np.random.normal(size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true"></a>y <span class="op">=</span> np.random.normal(size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true"></a><span class="co"># إنشاء نقاط</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true"></a>scatter <span class="op">=</span> pg.ScatterPlotItem(x<span class="op">=</span>x, y<span class="op">=</span>y, pen<span class="op">=</span><span class="st">&#39;w&#39;</span>, brush<span class="op">=</span><span class="st">&#39;r&#39;</span>, size<span class="op">=</span><span class="dv">10</span>, symbol<span class="op">=</span><span class="st">&#39;o&#39;</span>)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true"></a>win.addItem(scatter)</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true"></a></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true"></a><span class="co"># دالة تُنفّذ عند النقر</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true"></a><span class="kw">def</span> on_point_clicked(plot, points):</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true"></a>    index <span class="op">=</span> points[<span class="dv">0</span>].index()  <span class="co"># فهرس النقطة</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true"></a>    msg <span class="op">=</span> <span class="ss">f&quot;النقطة </span><span class="sc">{</span>index<span class="sc">}</span><span class="ss">: X=</span><span class="sc">{x</span>[index]<span class="sc">:.2f}</span><span class="ss">, Y=</span><span class="sc">{y</span>[index]<span class="sc">:.2f}</span><span class="ss">&quot;</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true"></a>    <span class="bu">print</span>(msg)</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true"></a>    <span class="co"># يمكن عرضها في نافذة منبثقة</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true"></a>    <span class="co"># QMessageBox.information(None, &quot;بيانات النقطة&quot;, msg)</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true"></a></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true"></a><span class="co"># ربط الحدث</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true"></a>scatter.sigClicked.<span class="ex">connect</span>(on_point_clicked)</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true"></a></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="شرح-الكود-8">🔍 شرح الكود:</h4>
<ul>
<li><code>scatter.sigClicked.connect(...)</code>: يربط حدث النقر.</li>
<li><code>points[0].index()</code>: يُرجع فهرس النقطة المُنقر عليها.</li>
<li>يمكن استخدام <code>QMessageBox</code> لعرض نافذة منبثقة.</li>
</ul>
<blockquote>
<p>✅ مثالي لتحليل البيانات النقطية.</p>
</blockquote>
<hr />
<h2 id="ربط-حدث-التكبير-والتحريك-viewbox">🔹 <strong>3. ربط حدث التكبير والتحريك (ViewBox)</strong></h2>
<p>لتحديث عناصر واجهة أخرى عند تغيير العرض.</p>
<h3 id="المثال-2-عرض-نطاق-العرض-الحالي">📌 المثال 2: عرض نطاق العرض الحالي</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true"></a>plot_item <span class="op">=</span> win.getPlotItem()</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true"></a>view_box <span class="op">=</span> plot_item.getViewBox()</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true"></a><span class="kw">def</span> on_zoom():</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true"></a>    range_x <span class="op">=</span> view_box.viewRange()[<span class="dv">0</span>]</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true"></a>    range_y <span class="op">=</span> view_box.viewRange()[<span class="dv">1</span>]</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="ss">f&quot;العرض الحالي: X(</span><span class="sc">{</span>range_x[<span class="dv">0</span>]<span class="sc">:.1f}</span><span class="ss"> → </span><span class="sc">{</span>range_x[<span class="dv">1</span>]<span class="sc">:.1f}</span><span class="ss">), Y(</span><span class="sc">{</span>range_y[<span class="dv">0</span>]<span class="sc">:.1f}</span><span class="ss"> → </span><span class="sc">{</span>range_y[<span class="dv">1</span>]<span class="sc">:.1f}</span><span class="ss">)&quot;</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true"></a><span class="co"># ربط حدث تغيير مدى المحور X</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true"></a>view_box.sigXRangeChanged.<span class="ex">connect</span>(on_zoom)</span></code></pre></div>
<blockquote>
<p>✅ مفيد لتحديث تسميات أو عناصر تحكم أخرى.</p>
</blockquote>
<hr />
<h2 id="ربط-حدث-النقر-على-الرسم-plotitem">🔹 <strong>4. ربط حدث النقر على الرسم (PlotItem)</strong></h2>
<p>لإضافة نقطة جديدة بالنقر.</p>
<h3 id="المثال-3-إضافة-نقطة-بالنقر-الأيمن">📌 المثال 3: إضافة نقطة بالنقر الأيمن</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true"></a><span class="kw">def</span> on_plot_clicked(event):</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true"></a>    <span class="cf">if</span> event.button() <span class="op">==</span> <span class="dv">2</span>:  <span class="co"># الزر الأيمن</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true"></a>        <span class="co"># تحويل موقع الفأرة إلى إحداثيات الرسم</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true"></a>        pos <span class="op">=</span> event.pos()</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true"></a>        view_box <span class="op">=</span> win.getViewBox()</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true"></a>        point <span class="op">=</span> view_box.mapSceneToView(pos)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true"></a>        </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true"></a>        <span class="co"># إضافة نقطة جديدة</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true"></a>        new_point <span class="op">=</span> {<span class="st">&#39;pos&#39;</span>: (point.x(), point.y()), <span class="st">&#39;brush&#39;</span>: <span class="st">&#39;b&#39;</span>, <span class="st">&#39;size&#39;</span>: <span class="dv">15</span>}</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true"></a>        current_spots <span class="op">=</span> [<span class="bu">dict</span>(pos<span class="op">=</span>(x[i], y[i]), brush<span class="op">=</span><span class="st">&#39;r&#39;</span>, size<span class="op">=</span><span class="dv">10</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x))]</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true"></a>        current_spots.append(new_point)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true"></a>        </span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true"></a>        scatter.clear()</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true"></a>        scatter.addPoints(current_spots)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true"></a><span class="co"># ربط حدث النقر على الرسم</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true"></a>plot_item <span class="op">=</span> win.getPlotItem()</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true"></a>plot_item.scene().sigMouseClicked.<span class="ex">connect</span>(on_plot_clicked)</span></code></pre></div>
<blockquote>
<p>✅ <code>scene().sigMouseClicked</code>: للوصول إلى حدث الفأرة على النافذة.</p>
</blockquote>
<hr />
<h2 id="ربط-حدث-تحريك-السهم-infiniteline">🔹 <strong>5. ربط حدث تحريك السهم (InfiniteLine)</strong></h2>
<p>مثالي لتحديد حدود ديناميكية.</p>
<h3 id="المثال-4-خط-قابل-للتحريك-يعرض-قيمته">📌 المثال 4: خط قابل للتحريك يعرض قيمته</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true"></a>line <span class="op">=</span> pg.InfiniteLine(pos<span class="op">=</span><span class="dv">0</span>, angle<span class="op">=</span><span class="dv">90</span>, movable<span class="op">=</span><span class="va">True</span>, pen<span class="op">=</span><span class="st">&#39;y&#39;</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true"></a>win.addItem(line)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true"></a><span class="kw">def</span> on_line_moved():</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true"></a>    <span class="bu">print</span>(<span class="ss">f&quot;تم تحريك الخط إلى X = </span><span class="sc">{</span>line<span class="sc">.</span>getXPos()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true"></a>line.sigDragged.<span class="ex">connect</span>(on_line_moved)</span></code></pre></div>
<blockquote>
<p>✅ <code>movable=True</code>: يجعل الخط قابلاً للتحريك. ✅ <code>sigDragged</code>: يُطلق أثناء التحريك. ✅ <code>sigPositionChanged</code>: يُطلق بعد الانتهاء من التحريك.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-9">🔹 <strong>6. الأخطاء الشائعة</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>AttributeError: 'PlotItem' object has no attribute 'sigClicked'</code></td>
<td>حاولت ربط إشارة على <code>PlotItem</code> بدل <code>ScatterPlotItem</code></td>
<td>تأكد من نوع العنصر</td>
</tr>
<tr class="even">
<td>الدالة لا تُنفّذ</td>
<td>لم تُستخدم <code>connect()</code></td>
<td>تأكد من <code>signal.connect(func)</code></td>
</tr>
<tr class="odd">
<td><code>pos()</code> غير معرف</td>
<td>نسيت <code>event.pos()</code></td>
<td>استخدم <code>event.pos()</code> للحصول على موقع الفأرة</td>
</tr>
<tr class="even">
<td>لا يعمل النقر الأيمن</td>
<td>لم تتحقق من <code>event.button()</code></td>
<td>استخدم <code>event.button() == 2</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-8">🔹 <strong>7. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>أنشئ رسمًا تشتتيًا، وعند النقر على نقطة، اطبع قيمتها.</li>
<li>أضف خطًا رأسيًا قابلاً للتحريك، وعند تحريكه، اطبع موضعه.</li>
<li>عند التكبير على منطقة، احسب متوسط القيم في تلك المنطقة وأظهره.</li>
<li>أضف نقطة جديدة عند النقر الأيسر على الرسم.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-واجهة-تحليل-تداول">🔹 <strong>8. الربط بالواقع: واجهة تحليل تداول</strong></h2>
<h3 id="الهدف-تفاعل-مع-بيانات-السعر">🎯 الهدف: تفاعل مع بيانات السعر</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true"></a><span class="co"># فرض بيانات سعر سهم</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true"></a>t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true"></a>price <span class="op">=</span> <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="dv">100</span>) <span class="op">*</span> <span class="fl">0.5</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true"></a>win <span class="op">=</span> pg.plot(title<span class="op">=</span><span class="st">&quot;تحليل التداول التفاعلي&quot;</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true"></a>curve <span class="op">=</span> win.plot(t, price, pen<span class="op">=</span><span class="st">&#39;c&#39;</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true"></a><span class="co"># عند النقر على الرسم، عرض السعر</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true"></a><span class="kw">def</span> on_click(event):</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true"></a>    <span class="cf">if</span> event.button() <span class="op">==</span> <span class="dv">1</span>:  <span class="co"># الزر الأيسر</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true"></a>        pos <span class="op">=</span> event.pos()</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true"></a>        view_box <span class="op">=</span> win.getViewBox()</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true"></a>        point <span class="op">=</span> view_box.mapSceneToView(pos)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true"></a>        x, y <span class="op">=</span> point.x(), point.y()</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true"></a>        <span class="co"># تقريب إلى أقرب نقطة بيانات</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true"></a>        idx <span class="op">=</span> (np.<span class="bu">abs</span>(t <span class="op">-</span> x)).argmin()</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true"></a>        <span class="bu">print</span>(<span class="ss">f&quot;سعر السهم عند t=</span><span class="sc">{t</span>[idx]<span class="sc">:.1f}</span><span class="ss">: </span><span class="sc">{</span>price[idx]<span class="sc">:.2f}</span><span class="ss"> ريال&quot;</span>)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true"></a></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true"></a>win.scene().sigMouseClicked.<span class="ex">connect</span>(on_click)</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true"></a></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;🖱️ انقر على أي نقطة في الرسم لعرض السعر!&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا النوع من التفاعل يُستخدم في لوحات التداول.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-9">🔹 <strong>9. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>sigClicked</code> مع <code>ScatterPlotItem</code> فقط.</li>
<li>✅ استخدم <code>scene().sigMouseClicked</code> للنقر على أي مكان في الرسم.</li>
<li>✅ استخدم <code>mapSceneToView()</code> لتحويل موقع الفأرة إلى إحداثيات البيانات.</li>
<li>✅ استخدم <code>sigDragged</code> للتحديث أثناء التحريك، و<code>sigPositionChanged</code> للتحديث بعد الانتهاء.</li>
<li>✅ احفظ مراجع العناصر (مثل <code>scatter</code>, <code>line</code>) لتعديلها لاحقًا.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-8">🔹 <strong>10. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>sigClicked</code> و <code>scene().sigMouseClicked</code>؟</li>
<li>كيف تُعرف موقع الفأرة على الرسم؟</li>
<li>ما وظيفة <code>movable=True</code>؟</li>
<li>كيف تُربط حدث التكبير؟</li>
<li>كيف تُضيف نقطة جديدة بالنقر؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-8">🔹 <strong>11. مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>العنصر</th>
<th>الإشارة</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ScatterPlotItem</code></td>
<td><code>sigClicked</code></td>
<td>عند النقر على نقطة</td>
</tr>
<tr class="even">
<td><code>ViewBox</code></td>
<td><code>sigXRangeChanged</code></td>
<td>عند التكبير/التحريك</td>
</tr>
<tr class="odd">
<td><code>InfiniteLine</code></td>
<td><code>sigDragged</code></td>
<td>أثناء تحريك الخط</td>
</tr>
<tr class="even">
<td><code>PlotItem.scene()</code></td>
<td><code>sigMouseClicked</code></td>
<td>عند النقر على أي مكان</td>
</tr>
</tbody>
</table>
<h1 id="lesson_12">📘 <strong>الدرس 12 (موسع): الرسم اللحظي (Real-time plotting)</strong></h1>
<h2 id="مقدمة-ما-هو-الرسم-اللحظي-ولماذا-هو-مهم">🔹 <strong>مقدمة: ما هو الرسم اللحظي؟ ولماذا هو مهم؟</strong></h2>
<p>الرسم اللحظي (Real-time plotting) هو القدرة على <strong>تحديث الرسم البياني بشكل مستمر</strong> مع وصول بيانات جديدة، دون تأخير ملحوظ.</p>
<p>يُستخدم في: - مراقبة مستشعرات IoT (درجة حرارة، رطوبة) - عرض أسعار الأسهم أو العملات الحية - تحليل الإشارات الكهربائية (مثل ECG) - تجارب علمية تتطلب مراقبة فورية</p>
<p>في هذا الدرس، ستتعلم كيفية بناء تطبيق PyQtGraph يُحدث الرسم <strong>بمعدل 60 إطارًا في الثانية</strong>، مع الحفاظ على الأداء.</p>
<hr />
<h2 id="المبدأ-الأساسي-الحلقة-والتحديث">🔹 <strong>1. المبدأ الأساسي: الحلقة والتحديث</strong></h2>
<p>لا يمكن استخدام <code>time.sleep()</code> لأنه يُجمّد واجهة المستخدم.</p>
<p>الحل: استخدام <strong>مُؤقّت (Timer)</strong> من PyQt.</p>
<h3 id="المثال-1-تحديث-بيانات-خطية-بسيطة">📌 المثال 1: تحديث بيانات خطية بسيطة</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true"></a><span class="im">from</span> PySide6.QtCore <span class="im">import</span> QTimer</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true"></a><span class="co"># إنشاء نافذة</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true"></a>win <span class="op">=</span> pg.plot(title<span class="op">=</span><span class="st">&quot;الرسم اللحظي - مثال بسيط&quot;</span>)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true"></a>win.setLabel(<span class="st">&#39;left&#39;</span>, <span class="st">&#39;القيمة&#39;</span>)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true"></a>win.setLabel(<span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;الزمن&#39;</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true"></a>curve <span class="op">=</span> win.plot(pen<span class="op">=</span><span class="st">&#39;y&#39;</span>)  <span class="co"># خط أصفر</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true"></a></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true"></a><span class="co"># بيانات افتراضية</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">1000</span>)  <span class="co"># 1000 نقطة</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true"></a></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true"></a><span class="kw">def</span> update():</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true"></a>    <span class="kw">global</span> i</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true"></a>    <span class="cf">if</span> i <span class="op">&gt;=</span> <span class="bu">len</span>(x):</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true"></a>        i <span class="op">=</span> <span class="dv">0</span>  <span class="co"># إعادة التدوير</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true"></a>    y <span class="op">=</span> np.sin(x[:i<span class="op">+</span><span class="dv">1</span>] <span class="op">*</span> <span class="fl">0.5</span>) <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> np.random.randn(i<span class="op">+</span><span class="dv">1</span>)  <span class="co"># بيانات ديناميكية</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true"></a>    curve.setData(x[:i<span class="op">+</span><span class="dv">1</span>], y)  <span class="co"># تحديث البيانات</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true"></a></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true"></a><span class="co"># إنشاء مؤقت يُنفّذ update كل 50 ميلي ثانية (20 إطار/ثانية)</span></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true"></a>timer <span class="op">=</span> QTimer()</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true"></a>timer.timeout.<span class="ex">connect</span>(update)</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true"></a>timer.start(<span class="dv">50</span>)</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true"></a></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="شرح-الكود-9">🔍 شرح الكود:</h4>
<ul>
<li><code>QTimer()</code>: يُنفّذ دالة بشكل دوري.</li>
<li><code>timer.start(50)</code>: كل 50 ميلي ثانية.</li>
<li><code>curve.setData()</code>: الطريقة <strong>الوحيدة</strong> لتحديث بيانات الرسم بسرعة.</li>
<li><code>setData()</code> أسرع بكثير من <code>plot()</code>.</li>
</ul>
<blockquote>
<p>✅ لا تُنشئ خطوطًا جديدة في كل دورة!</p>
</blockquote>
<hr />
<h2 id="التعامل-مع-البيانات-الكبيرة">🔹 <strong>2. التعامل مع البيانات الكبيرة</strong></h2>
<p>عندما تصل البيانات بشكل مستمر، لا يمكن تخزينها إلى الأبد.</p>
<h3 id="المثال-2-استخدام-مصفوفة-دائرية-circular-buffer">📌 المثال 2: استخدام مصفوفة دائرية (Circular Buffer)</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true"></a><span class="co"># حجم المخزن المؤقت</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true"></a>buffer_size <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">100</span>, buffer_size)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true"></a>y <span class="op">=</span> np.zeros(buffer_size)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true"></a>ptr <span class="op">=</span> <span class="dv">0</span>  <span class="co"># مؤشر الكتابة</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true"></a>curve <span class="op">=</span> win.plot(x, y, pen<span class="op">=</span><span class="st">&#39;m&#39;</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true"></a><span class="kw">def</span> update():</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true"></a>    <span class="kw">global</span> ptr</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true"></a>    new_value <span class="op">=</span> np.sin(<span class="fl">0.1</span> <span class="op">*</span> ptr) <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> np.random.randn()  <span class="co"># قيمة جديدة</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true"></a>    y[ptr] <span class="op">=</span> new_value</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true"></a>    ptr <span class="op">=</span> (ptr <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> buffer_size  <span class="co"># تدوير المؤشر</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true"></a>    <span class="co"># تحديث العرض: عرض من ptr إلى النهاية، ثم من البداية إلى ptr</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true"></a>    x_view <span class="op">=</span> np.concatenate([x[ptr:], x[:ptr]])</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true"></a>    y_view <span class="op">=</span> np.concatenate([y[ptr:], y[:ptr]])</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true"></a>    curve.setData(x_view, y_view)</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true"></a></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true"></a>timer <span class="op">=</span> QTimer()</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true"></a>timer.timeout.<span class="ex">connect</span>(update)</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true"></a>timer.start(<span class="dv">30</span>)  <span class="co"># ~33 إطار/ثانية</span></span></code></pre></div>
<blockquote>
<p>✅ مثالي للبيانات التي تتدفق باستمرار.</p>
</blockquote>
<hr />
<h2 id="تحسين-الأداء-مع-آلاف-النقاط">🔹 <strong>3. تحسين الأداء مع آلاف النقاط</strong></h2>
<p>لجعل الرسم أسرع: - تفعيل التفريغ (Downsampling) - تعطيل التحديثات غير الضرورية</p>
<h3 id="المثال-3-تحسين-الأداء">📌 المثال 3: تحسين الأداء</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true"></a><span class="co"># تفعيل التفريغ</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true"></a>win.setDownsampling(mode<span class="op">=</span><span class="st">&#39;peak&#39;</span>)  <span class="co"># يُظهر الحد الأقصى والأدنى</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true"></a>win.setClipToView(<span class="va">True</span>)  <span class="co"># فقط اعرض ما يظهر على الشاشة</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true"></a><span class="co"># زيادة حجم المخزن</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true"></a>buffer_size <span class="op">=</span> <span class="dv">10000</span></span></code></pre></div>
<blockquote>
<p>✅ <code>setClipToView(True)</code> يُسرّع التحديث بشكل كبير.</p>
</blockquote>
<hr />
<h2 id="الرسم-التشتتي-اللحظي">🔹 <strong>4. الرسم التشتتي اللحظي</strong></h2>
<h3 id="المثال-4-إضافة-نقاط-تدريجيا">📌 المثال 4: إضافة نقاط تدريجيًا</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true"></a>scatter <span class="op">=</span> pg.ScatterPlotItem(pen<span class="op">=</span><span class="va">None</span>, brush<span class="op">=</span><span class="st">&#39;r&#39;</span>, size<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true"></a>win.addItem(scatter)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true"></a>spots <span class="op">=</span> []</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true"></a><span class="kw">def</span> update_scatter():</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true"></a>    <span class="kw">global</span> spots</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true"></a>    new_spot <span class="op">=</span> {<span class="st">&#39;pos&#39;</span>: (np.random.normal(), np.random.normal()), <span class="st">&#39;brush&#39;</span>: <span class="st">&#39;b&#39;</span>}</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true"></a>    spots.append(new_spot)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true"></a>    <span class="cf">if</span> <span class="bu">len</span>(spots) <span class="op">&gt;</span> <span class="dv">100</span>:  <span class="co"># احتفظ بأحدث 100 نقطة فقط</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true"></a>        spots <span class="op">=</span> spots[<span class="op">-</span><span class="dv">100</span>:]</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true"></a>    scatter.clear()</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true"></a>    scatter.addPoints(spots)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true"></a>timer.timeout.<span class="ex">connect</span>(update_scatter)</span></code></pre></div>
<blockquote>
<p>✅ <code>clear()</code> و <code>addPoints()</code> للتحديث.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-10">🔹 <strong>5. الأخطاء الشائعة</strong></h2>
<table>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>توقف الواجهة</td>
<td>استخدام <code>time.sleep()</code></td>
<td>استخدم <code>QTimer</code></td>
</tr>
<tr class="even">
<td>بطء شديد</td>
<td>إنشاء خطوط جديدة في كل دورة</td>
<td>استخدم <code>setData()</code></td>
</tr>
<tr class="odd">
<td>البيانات لا تُحدّث</td>
<td>نسيت <code>timer.start()</code></td>
<td>تأكد من بدء المؤقت</td>
</tr>
<tr class="even">
<td><code>setData()</code> لا يعمل</td>
<td>تمرير بيانات خاطئة</td>
<td>تأكد من أن <code>x</code> و <code>y</code> نفس الطول</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-9">🔹 <strong>6. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>أنشئ رسمًا يعرض 1000 نقطة تُحدّث كل 100 ميلي ثانية.</li>
<li>استخدم <code>setDownsampling()</code> و <code>setClipToView(True)</code> لتحسين الأداء.</li>
<li>أنشئ رسمًا تشتتيًا يُظهر أحدث 50 نقطة فقط.</li>
<li>أضف خطًا رأسيًا يتحرك مع الزمن.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-مراقبة-سعر-السهم">🔹 <strong>7. الربط بالواقع: مراقبة سعر السهم</strong></h2>
<h3 id="الهدف-محاكاة-تحديث-سعر-سهم-لحظيا">🎯 الهدف: محاكاة تحديث سعر سهم لحظيًا</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true"></a><span class="co"># فرض سعر سهم يتحرك عشوائيًا</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true"></a>price <span class="op">=</span> <span class="fl">100.0</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true"></a>times <span class="op">=</span> []</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true"></a>prices <span class="op">=</span> []</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true"></a>curve <span class="op">=</span> win.plot(pen<span class="op">=</span><span class="st">&#39;c&#39;</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true"></a><span class="kw">def</span> update_stock():</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true"></a>    <span class="kw">global</span> price, times, prices</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true"></a>    price <span class="op">+=</span> np.random.randn() <span class="op">*</span> <span class="fl">0.1</span>  <span class="co"># تغير صغير</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true"></a>    current_time <span class="op">=</span> <span class="bu">len</span>(times)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true"></a>    times.append(current_time)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true"></a>    prices.append(price)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true"></a>    </span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true"></a>    <span class="co"># احتفظ بأحدث 200 قيمة فقط</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true"></a>    <span class="cf">if</span> <span class="bu">len</span>(times) <span class="op">&gt;</span> <span class="dv">200</span>:</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true"></a>        times <span class="op">=</span> times[<span class="op">-</span><span class="dv">200</span>:]</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true"></a>        prices <span class="op">=</span> prices[<span class="op">-</span><span class="dv">200</span>:]</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true"></a>    </span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true"></a>    <span class="co"># تحديث الرسم</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true"></a>    curve.setData(times, prices)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true"></a>    win.setTitle(<span class="ss">f&quot;سعر السهم: </span><span class="sc">{</span>price<span class="sc">:.2f}</span><span class="ss"> ريال&quot;</span>)</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true"></a></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true"></a>timer <span class="op">=</span> QTimer()</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true"></a>timer.timeout.<span class="ex">connect</span>(update_stock)</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true"></a>timer.start(<span class="dv">100</span>)  <span class="co"># كل 100 ميلي ثانية</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true"></a></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📈 تحديث سعر السهم جارٍ الآن...&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا هو الشكل الذي تُبنى عليه لوحات التداول.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-10">🔹 <strong>8. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم دائمًا <code>setData()</code> بدل <code>plot()</code> في الحلقات.</li>
<li>✅ استخدم <code>QTimer</code> وليس <code>time.sleep()</code>.</li>
<li>✅ استخدم <code>setDownsampling(mode='peak')</code> للبيانات الكبيرة.</li>
<li>✅ استخدم <code>setClipToView(True)</code> لتحسين الأداء.</li>
<li>✅ احذف البيانات القديمة للحفاظ على الذاكرة.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-9">🔹 <strong>9. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>لماذا لا نستخدم <code>time.sleep()</code> في الرسم اللحظي؟</li>
<li>ما وظيفة <code>setData()</code>؟</li>
<li>كيف تُحسن أداء الرسم مع 10,000 نقطة؟</li>
<li>ما الفرق بين <code>setDownsampling()</code> و <code>setClipToView()</code>؟</li>
<li>كيف تُحدث رسمًا تشتتيًا بشكل لحظي؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-9">🔹 <strong>10. مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>العنصر</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>QTimer</code></td>
<td>تنفيذ دالة بشكل دوري</td>
</tr>
<tr class="even">
<td><code>setData()</code></td>
<td>تحديث بيانات الرسم بسرعة</td>
</tr>
<tr class="odd">
<td><code>setDownsampling()</code></td>
<td>تفريغ البيانات لتحسين الأداء</td>
</tr>
<tr class="even">
<td><code>setClipToView(True)</code></td>
<td>عرض ما يظهر فقط</td>
</tr>
<tr class="odd">
<td><code>Circular Buffer</code></td>
<td>تخزين بيانات دائرية</td>
</tr>
</tbody>
</table>
<h1 id="lesson_13">📘 <strong>الدرس 13 (موسع): الرسوم ثلاثية الأبعاد باستخدام <code>GLViewWidget</code></strong></h1>
<h2 id="مقدمة-لماذا-نحتاج-إلى-الرسوم-3d">🔹 <strong>مقدمة: لماذا نحتاج إلى الرسوم 3D؟</strong></h2>
<p>بينما تُكفي الرسوم ثنائية الأبعاد (2D) لمعظم التحليلات، فإن بعض البيانات تتطلب بُعدًا ثالثًا لفهمها بشكل كامل.</p>
<p>تُستخدم الرسوم 3D في: - عرض <strong>السطوح ثلاثية الأبعاد</strong> (مثل: التضاريس، نتائج المحاكاة) - تحليل <strong>البيانات المكانية</strong> (X, Y, Z) - عرض <strong>الأنماط في البيانات ذات الأبعاد العالية</strong> - التطبيقات العلمية والهندسية (مثل: تدفق السوائل، مجالات الجاذبية)</p>
<p>في هذا الدرس، ستتعلم كيفية استخدام <strong><code>GLViewWidget</code></strong> من PyQtGraph لعرض: - نقاط ثلاثية الأبعاد - سطوح (Surfaces) - شبكات (Meshes)</p>
<hr />
<h2 id="التثبيت-والمتطلبات">🔹 <strong>1. التثبيت والمتطلبات</strong></h2>
<p>الرسوم 3D في PyQtGraph تعتمد على <strong>OpenGL</strong>، لذلك تأكد من: - تثبيت <code>PyQtGraph</code> (الإصدار الأحدث) - تشغيل الكود على بيئة تدعم OpenGL</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true"></a><span class="ex">pip</span> install pyqtgraph PySide6</span></code></pre></div>
<blockquote>
<p>✅ لا حاجة لتثبيت OpenGL يدويًا — PyQtGraph يتعامل معه داخليًا.</p>
</blockquote>
<hr />
<h2 id="glviewwidget-نافذة-العرض-ثلاثية-الأبعاد">🔹 <strong>2. <code>GLViewWidget</code> — نافذة العرض ثلاثية الأبعاد</strong></h2>
<p>هو العنصر الرئيسي لعرض الرسوم 3D.</p>
<h3 id="المثال-1-إنشاء-نافذة-3d-فارغة">📌 المثال 1: إنشاء نافذة 3D فارغة</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph.opengl <span class="im">as</span> gl</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true"></a><span class="co"># إنشاء نافذة عرض 3D</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true"></a>view <span class="op">=</span> gl.GLViewWidget()</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true"></a>view.show()</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true"></a>view.setWindowTitle(<span class="st">&quot;نافذة 3D فارغة&quot;</span>)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true"></a>view.setCameraPosition(distance<span class="op">=</span><span class="dv">50</span>)  <span class="co"># تحديد موضع الكاميرا</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true"></a>    app.<span class="bu">exec</span>()</span></code></pre></div>
<blockquote>
<p>✅ <code>pyqtgraph.opengl as gl</code>: وحدة الرسوم 3D. ✅ يمكنك التفاعل بالفأرة: التدوير، التكبير، التحريك.</p>
</blockquote>
<hr />
<h2 id="رسم-النقاط-ثلاثية-الأبعاد-باستخدام-glscatterplotitem">🔹 <strong>3. رسم النقاط ثلاثية الأبعاد باستخدام <code>GLScatterPlotItem</code></strong></h2>
<h3 id="المثال-2-عرض-مجموعة-من-النقاط-العشوائية">📌 المثال 2: عرض مجموعة من النقاط العشوائية</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph.opengl <span class="im">as</span> gl</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true"></a>view <span class="op">=</span> gl.GLViewWidget()</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true"></a>view.show()</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true"></a>view.setWindowTitle(<span class="st">&quot;نقاط ثلاثية الأبعاد&quot;</span>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true"></a>view.setCameraPosition(distance<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true"></a></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true"></a><span class="co"># بيانات ثلاثية الأبعاد</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true"></a>n <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true"></a>x <span class="op">=</span> np.random.normal(size<span class="op">=</span>n)</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true"></a>y <span class="op">=</span> np.random.normal(size<span class="op">=</span>n)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true"></a>z <span class="op">=</span> np.random.normal(size<span class="op">=</span>n)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true"></a>pos <span class="op">=</span> np.vstack((x, y, z)).T  <span class="co"># مصفوفة بحجم (n, 3)</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true"></a></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true"></a><span class="co"># إنشاء نقاط</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true"></a>scatter <span class="op">=</span> gl.GLScatterPlotItem(pos<span class="op">=</span>pos, color<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), size<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true"></a></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true"></a><span class="co"># إضافة النقاط إلى النافذة</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true"></a>view.addItem(scatter)</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true"></a></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true"></a>    app.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="شرح-الكود-10">🔍 شرح الكود:</h4>
<ul>
<li><code>pos</code>: مصفوفة ثنائية الأبعاد بحجم <code>(عدد_النقاط, 3)</code></li>
<li><code>color=(r, g, b, a)</code>: لون النقطة (أحمر، شفافية كاملة)</li>
<li><code>size</code>: حجم النقطة</li>
</ul>
<blockquote>
<p>✅ يمكنك تغيير لون كل نقطة باستخدام قائمة من الألوان.</p>
</blockquote>
<hr />
<h2 id="رسم-السطوح-باستخدام-glsurfaceplotitem">🔹 <strong>4. رسم السطوح باستخدام <code>GLSurfacePlotItem</code></strong></h2>
<p>مثالي لعرض الدوال الرياضية أو التضاريس.</p>
<h3 id="المثال-3-رسم-سطح-دالة-جيب-التمام">📌 المثال 3: رسم سطح دالة جيب التمام</h3>
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph.opengl <span class="im">as</span> gl</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true"></a>view <span class="op">=</span> gl.GLViewWidget()</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true"></a>view.show()</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true"></a>view.setWindowTitle(<span class="st">&quot;رسم سطح ثلاثي الأبعاد&quot;</span>)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true"></a>view.setCameraPosition(distance<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true"></a><span class="co"># شبكة من النقاط (X, Y)</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">50</span>)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">50</span>)</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true"></a>X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true"></a></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true"></a><span class="co"># دالة Z = cos(r) حيث r = الجذر التربيعي لـ (X² + Y²)</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true"></a>R <span class="op">=</span> np.sqrt(X<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> Y<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true"></a>Z <span class="op">=</span> np.cos(R)</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true"></a></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true"></a><span class="co"># إنشاء السطح</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true"></a>surface <span class="op">=</span> gl.GLSurfacePlotItem(x<span class="op">=</span>x, y<span class="op">=</span>y, z<span class="op">=</span>Z, color<span class="op">=</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">1</span>), shader<span class="op">=</span><span class="st">&#39;shaded&#39;</span>, drawEdges<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true"></a></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true"></a><span class="co"># إضافة السطح</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true"></a>view.addItem(surface)</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true"></a></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true"></a>    app.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="خيارات-مهمة">🔍 خيارات مهمة:</h4>
<ul>
<li><code>shader='shaded'</code>: إضافة تظليل واقعي</li>
<li><code>drawEdges=True</code>: عرض خطوط الشبكة</li>
<li><code>color</code>: لون ثابت أو يمكن تغييره باستخدام <code>setColors()</code></li>
</ul>
<hr />
<h2 id="الأخطاء-الشائعة-11">🔹 <strong>5. الأخطاء الشائعة</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ModuleNotFoundError: No module named 'OpenGL'</code></td>
<td>لم يتم تثبيت التبعيات</td>
<td>تأكد من <code>pip install pyqtgraph</code></td>
</tr>
<tr class="even">
<td>لا تظهر النافذة 3D</td>
<td>بيئة غير مدعومة (مثل بعض الأجهزة الافتراضية)</td>
<td>جرب على جهاز به بطاقة رسومات</td>
</tr>
<tr class="odd">
<td>النقاط لا تظهر</td>
<td><code>size</code> صغير جدًا</td>
<td>زد قيمة <code>size</code></td>
</tr>
<tr class="even">
<td>السطح مشوّش</td>
<td>بيانات <code>z</code> غير منظمة</td>
<td>تأكد من أن <code>X</code>, <code>Y</code>, <code>Z</code> نفس الشكل</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-10">🔹 <strong>6. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>ارسم 500 نقطة في شكل كرة (استخدم الإحداثيات الكروية).</li>
<li>غيّر لون النقاط بناءً على موقعها في الفضاء.</li>
<li>ارسم سطحًا لدالة <code>Z = X² + Y²</code>.</li>
<li>أضف عنوانًا واجعل الكاميرا تتحرك تلقائيًا.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-تحليل-تضاريس-رقمية">🔹 <strong>7. الربط بالواقع: تحليل تضاريس رقمية</strong></h2>
<h3 id="الهدف-محاكاة-عرض-تضاريس">🎯 الهدف: محاكاة عرض تضاريس</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true"></a><span class="co"># فرض بيانات تضاريس (مثل: ارتفاعات جبل)</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">100</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">100</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true"></a>X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true"></a><span class="co"># نموذج جبل مع عدة قمم</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true"></a>Z <span class="op">=</span> <span class="dv">5</span> <span class="op">*</span> np.exp(<span class="op">-</span>((X<span class="op">-</span><span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (Y<span class="op">-</span><span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span>)) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true"></a>    <span class="dv">3</span> <span class="op">*</span> np.exp(<span class="op">-</span>((X<span class="op">+</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (Y<span class="op">+</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">2</span>)) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true"></a>    <span class="dv">2</span> <span class="op">*</span> np.exp(<span class="op">-</span>(X<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> Y<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true"></a>view <span class="op">=</span> gl.GLViewWidget()</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true"></a>view.show()</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true"></a>view.setWindowTitle(<span class="st">&quot;نموذج تضاريس رقمية&quot;</span>)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true"></a>view.setCameraPosition(distance<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true"></a></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true"></a>surface <span class="op">=</span> gl.GLSurfacePlotItem(x<span class="op">=</span>x, y<span class="op">=</span>y, z<span class="op">=</span>Z, shader<span class="op">=</span><span class="st">&#39;shaded&#39;</span>, color<span class="op">=</span>(<span class="fl">0.2</span>, <span class="fl">0.6</span>, <span class="fl">0.2</span>, <span class="dv">1</span>))  <span class="co"># لون أخضر</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true"></a>view.addItem(surface)</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true"></a></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;🏔️ نموذج التضاريس جاهز للعرض ثلاثي الأبعاد!&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا النوع من العرض يُستخدم في نظم المعلومات الجغرافية (GIS).</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-11">🔹 <strong>8. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>GLViewWidget</code> فقط عند الحاجة إلى 3D.</li>
<li>✅ استخدم <code>GLScatterPlotItem</code> للنقاط، و<code>GLSurfacePlotItem</code> للسطوح.</li>
<li>✅ تجنب استخدام أكثر من 10,000 نقطة على أجهزة ضعيفة.</li>
<li>✅ استخدم <code>setCameraPosition()</code> لضبط العرض الابتدائي.</li>
<li>✅ اختبر الكود على جهاز به دعم جيد لـ OpenGL.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-10">🔹 <strong>9. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما هو <code>GLViewWidget</code>؟</li>
<li>كيف تُنشئ نقاطًا ثلاثية الأبعاد؟</li>
<li>ما شكل مصفوفة <code>pos</code> في <code>GLScatterPlotItem</code>؟</li>
<li>كيف تُرسم دالة رياضية كسطح؟</li>
<li>ما وظيفة <code>shader='shaded'</code>؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-10">🔹 <strong>10. مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>العنصر</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>GLViewWidget</code></td>
<td>نافذة العرض ثلاثية الأبعاد</td>
</tr>
<tr class="even">
<td><code>GLScatterPlotItem</code></td>
<td>رسم نقاط 3D</td>
</tr>
<tr class="odd">
<td><code>GLSurfacePlotItem</code></td>
<td>رسم سطوح 3D</td>
</tr>
<tr class="even">
<td><code>pos</code></td>
<td>مصفوفة (n, 3) للنقاط</td>
</tr>
<tr class="odd">
<td><code>x, y, z</code></td>
<td>شبكات للسطوح</td>
</tr>
<tr class="even">
<td><code>setCameraPosition()</code></td>
<td>ضبط الكاميرا</td>
</tr>
<tr class="odd">
<td><code>shader='shaded'</code></td>
<td>تظليل واقعي</td>
</tr>
</tbody>
</table>
<h1 id="lesson_14">📘 <strong>الدرس 14 (موسع): الخرائط اللونية (Color Maps)</strong></h1>
<h2 id="مقدمة-ما-هي-الخرائط-اللونية-ولماذا-تستخدم">🔹 <strong>مقدمة: ما هي الخرائط اللونية؟ ولماذا تُستخدم؟</strong></h2>
<p>الخريطة اللونية (Colormap) هي وسيلة لتمثيل <strong>القيم العددية</strong> باستخدام <strong>التدرجات اللونية</strong>.</p>
<p>بدلاً من عرض الأرقام فقط، يمكنك: - تمثيل <strong>الحرارة</strong> بألوان من الأزرق (بارد) إلى الأحمر (ساخن) - عرض <strong>كثافة البيانات</strong> من الشفاف إلى المعتم - تمييز <strong>القيم العالية والمنخفضة</strong> في الصور أو المصفوفات</p>
<p>تُستخدم الخرائط اللونية في: - <strong>ImageView</strong> (عرض الصور الحرارية، الأشعة) - <strong>GLSurfacePlotItem</strong> (رسم السطوح 3D) - <strong>الرسوم البيانية المكانية</strong> (مثل الخرائط الجغرافية)</p>
<hr />
<h2 id="استخدام-الخرائط-الجاهزة">🔹 <strong>1. استخدام الخرائط الجاهزة</strong></h2>
<p>يأتي PyQtGraph مع مجموعة من الخرائط اللونية الجاهزة.</p>
<h3 id="المثال-1-تطبيق-خريطة-لونية-على-صورة">📌 المثال 1: تطبيق خريطة لونية على صورة</h3>
<div class="sourceCode" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true"></a><span class="co"># إنشاء بيانات صورة (مثل: توزيع حرارة)</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true"></a>image_data <span class="op">=</span> np.random.normal(size<span class="op">=</span>(<span class="dv">100</span>, <span class="dv">100</span>)) <span class="op">*</span> <span class="dv">50</span> <span class="op">+</span> <span class="dv">100</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true"></a><span class="co"># إنشاء ImageView</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true"></a>view <span class="op">=</span> pg.ImageView()</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true"></a>view.setImage(image_data)</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true"></a></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true"></a><span class="co"># تطبيق خريطة لونية جاهزة</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true"></a>cmap <span class="op">=</span> pg.colormap.get(<span class="st">&#39;viridis&#39;</span>)  <span class="co"># أو &#39;plasma&#39;, &#39;hot&#39;, &#39;cool&#39;, &#39;gray&#39;, &#39;jet&#39;</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true"></a>view.setColorMap(cmap)</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true"></a></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true"></a>view.setWindowTitle(<span class="st">&quot;خريطة لونية: viridis&quot;</span>)</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true"></a>view.show()</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true"></a></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="خرائط-شائعة">🔍 خرائط شائعة:</h4>
<table>
<thead>
<tr class="header">
<th>الخريطة</th>
<th>الاستخدام</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>'viridis'</code></td>
<td>افتراضية، واضحة، مناسبة للطباعة</td>
</tr>
<tr class="even">
<td><code>'plasma'</code></td>
<td>تباين عالي، من الأرجواني إلى الأصفر</td>
</tr>
<tr class="odd">
<td><code>'hot'</code></td>
<td>من الأسود إلى الأحمر إلى الأصفر (مثل النار)</td>
</tr>
<tr class="even">
<td><code>'cool'</code></td>
<td>من الأزرق إلى الوردي</td>
</tr>
<tr class="odd">
<td><code>'gray'</code></td>
<td>تدرج رمادي (مثالي للصور الطبية)</td>
</tr>
<tr class="even">
<td><code>'jet'</code></td>
<td>تدرج كامل (مثير بصريًا، لكنه غير دقيق)</td>
</tr>
</tbody>
</table>
<blockquote>
<p>✅ <code>pg.colormap.get('name')</code>: للحصول على خريطة لونية.</p>
</blockquote>
<hr />
<h2 id="إنشاء-خريطة-لونية-مخصصة">🔹 <strong>2. إنشاء خريطة لونية مخصصة</strong></h2>
<p>يمكنك تعريف تدرج لوني خاص بك.</p>
<h3 id="المثال-2-خريطة-لونية-من-الأزرق-إلى-الأحمر">📌 المثال 2: خريطة لونية من الأزرق إلى الأحمر</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true"></a><span class="co"># تحديد الألوان عند نقاط معينة (من 0.0 إلى 1.0)</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true"></a>colors <span class="op">=</span> [</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true"></a>    (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">255</span>),    <span class="co"># أزرق (قيمة منخفضة)</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true"></a>    (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">255</span>),  <span class="co"># سماوي</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true"></a>    (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>),    <span class="co"># أخضر</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true"></a>    (<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">0</span>),  <span class="co"># أصفر</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true"></a>    (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>)     <span class="co"># أحمر (قيمة عالية)</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true"></a>]</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true"></a><span class="co"># إنشاء الخريطة</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true"></a>custom_cmap <span class="op">=</span> pg.ColorMap(pos<span class="op">=</span>np.linspace(<span class="fl">0.0</span>, <span class="fl">1.0</span>, <span class="bu">len</span>(colors)), color<span class="op">=</span>colors)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true"></a><span class="co"># تطبيقها على ImageView</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true"></a>view.setColorMap(custom_cmap)</span></code></pre></div>
<h4 id="شرح">🔍 شرح:</h4>
<ul>
<li><code>pos</code>: مواقع النسب (0.0 = القيمة الدنيا، 1.0 = القيمة العليا)</li>
<li><code>color</code>: قائمة بألوان RGB (من 0 إلى 255)</li>
</ul>
<hr />
<h2 id="استخدام-الخرائط-في-الرسوم-3d">🔹 <strong>3. استخدام الخرائط في الرسوم 3D</strong></h2>
<h3 id="المثال-3-تطبيق-خريطة-لونية-على-سطح-3d">📌 المثال 3: تطبيق خريطة لونية على سطح 3D</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph.opengl <span class="im">as</span> gl</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true"></a>view <span class="op">=</span> gl.GLViewWidget()</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true"></a>view.show()</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true"></a>view.setWindowTitle(<span class="st">&quot;سطح 3D مع خريطة لونية&quot;</span>)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true"></a>view.setCameraPosition(distance<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true"></a><span class="co"># إنشاء شبكة</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">50</span>)</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">50</span>)</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true"></a>X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true"></a>Z <span class="op">=</span> np.cos(np.sqrt(X<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> Y<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true"></a></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true"></a><span class="co"># إنشاء خريطة لونية</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true"></a>cmap <span class="op">=</span> pg.colormap.get(<span class="st">&#39;plasma&#39;</span>)</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true"></a></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true"></a><span class="co"># تحويل الخريطة إلى ألوان لكل نقطة</span></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true"></a>normalized_z <span class="op">=</span> (Z <span class="op">-</span> Z.<span class="bu">min</span>()) <span class="op">/</span> (Z.<span class="bu">max</span>() <span class="op">-</span> Z.<span class="bu">min</span>())  <span class="co"># من 0 إلى 1</span></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true"></a>colors <span class="op">=</span> cmap.getLookupTable(nPts<span class="op">=</span><span class="dv">256</span>)</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true"></a>surface_colors <span class="op">=</span> np.array([colors[<span class="bu">int</span>(i<span class="op">*</span><span class="dv">255</span>)] <span class="cf">for</span> i <span class="kw">in</span> normalized_z.flatten()])</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true"></a>surface_colors <span class="op">=</span> surface_colors.reshape((<span class="op">*</span>Z.shape, <span class="dv">4</span>))  <span class="co"># (H, W, 4)</span></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true"></a></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true"></a><span class="co"># إنشاء السطح</span></span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true"></a>surface <span class="op">=</span> gl.GLSurfacePlotItem(x<span class="op">=</span>x, y<span class="op">=</span>y, z<span class="op">=</span>Z, colors<span class="op">=</span>surface_colors, shader<span class="op">=</span><span class="st">&#39;shaded&#39;</span>)</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true"></a>view.addItem(surface)</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true"></a></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true"></a>    app.<span class="bu">exec</span>()</span></code></pre></div>
<blockquote>
<p>✅ يتم تحويل القيم إلى نطاق [0,1] ثم تعيين لون لكل قيمة.</p>
</blockquote>
<hr />
<h2 id="عرض-شريط-الخريطة-اللونية-color-bar">🔹 <strong>4. عرض شريط الخريطة اللونية (Color Bar)</strong></h2>
<p>لإضافة شريط توضيحي يُظهر العلاقة بين اللون والقيمة.</p>
<h3 id="المثال-4-إضافة-شريط-ألوان">📌 المثال 4: إضافة شريط ألوان</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true"></a><span class="co"># بعد إنشاء ImageView</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true"></a>view <span class="op">=</span> pg.ImageView()</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true"></a>view.setImage(image_data)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true"></a>view.setColorMap(pg.colormap.get(<span class="st">&#39;hot&#39;</span>))</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true"></a><span class="co"># إضافة شريط الألوان</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true"></a>color_bar <span class="op">=</span> pg.ColorBarItem(values<span class="op">=</span>(image_data.<span class="bu">min</span>(), image_data.<span class="bu">max</span>()), colorMap<span class="op">=</span>pg.colormap.get(<span class="st">&#39;hot&#39;</span>))</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true"></a>view.layout.addItem(color_bar, <span class="dv">2</span>, <span class="dv">1</span>)  <span class="co"># إضافته في الصف 2، العمود 1</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true"></a></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true"></a>view.show()</span></code></pre></div>
<blockquote>
<p>✅ <code>ColorBarItem</code> يُظهر مقياس الألوان.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-12">🔹 <strong>5. الأخطاء الشائعة</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>AttributeError: 'ImageView' has no attribute 'setColorMap'</code></td>
<td>استخدمت <code>setColorMap</code> بدل <code>setColorMap</code></td>
<td>التهجئة الصحيحة: <code>setColorMap</code></td>
</tr>
<tr class="even">
<td>الألوان لا تظهر</td>
<td>لم تُستخدم <code>colors</code> بشكل صحيح في 3D</td>
<td>تأكد من شكل <code>colors</code> (يجب أن يكون <code>(H, W, 4)</code>)</td>
</tr>
<tr class="odd">
<td>الشريط لا يظهر</td>
<td>لم تُضف <code>ColorBarItem</code> إلى التخطيط</td>
<td>استخدم <code>layout.addItem()</code></td>
</tr>
<tr class="even">
<td><code>getLookupTable()</code> لا يعمل</td>
<td>نسيت تحديد <code>nPts</code></td>
<td>استخدم <code>cmap.getLookupTable(nPts=256)</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-11">🔹 <strong>6. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>أنشئ خريطة لونية من الأخضر إلى الأحمر لتمثيل “حالة النظام” (جيدة → سيئة).</li>
<li>طبّق خريطة <code>cool</code> على صورة مصفوفة.</li>
<li>أضف شريط ألوان إلى <code>ImageView</code>.</li>
<li>في رسم 3D، اجعل اللون يعتمد على قيمة <code>Z</code>.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-تحليل-حرارة-المبنى">🔹 <strong>7. الربط بالواقع: تحليل حرارة المبنى</strong></h2>
<h3 id="الهدف-عرض-توزيع-الحرارة-عبر-الطبقات">🎯 الهدف: عرض توزيع الحرارة عبر الطبقات</h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true"></a><span class="co"># فرض بيانات حرارة (مثل: من مستشعرات في الجدران)</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true"></a>heat_map <span class="op">=</span> np.random.rand(<span class="dv">50</span>, <span class="dv">50</span>) <span class="op">*</span> <span class="dv">30</span> <span class="op">+</span> <span class="dv">20</span>  <span class="co"># 20-50 درجة مئوية</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true"></a>view <span class="op">=</span> pg.ImageView()</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true"></a>view.setImage(heat_map)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true"></a>view.setColorMap(pg.colormap.get(<span class="st">&#39;hot&#39;</span>))</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true"></a><span class="co"># شريط توضيحي</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true"></a>color_bar <span class="op">=</span> pg.ColorBarItem(values<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">50</span>), colorMap<span class="op">=</span>pg.colormap.get(<span class="st">&#39;hot&#39;</span>), label<span class="op">=</span><span class="st">&#39;درجة الحرارة (°C)&#39;</span>)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true"></a>view.layout.addItem(color_bar, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true"></a></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true"></a>view.setWindowTitle(<span class="st">&quot;تحليل توزيع الحرارة&quot;</span>)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true"></a>view.show()</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true"></a></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;🌡️ تحليل الحرارة جاهز للعرض!&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا النوع من التحليل يُستخدم في أنظمة مراقبة المباني.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-12">🔹 <strong>8. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>'viridis'</code> أو <code>'plasma'</code> للعروض العامة.</li>
<li>✅ استخدم <code>'gray'</code> للصور الطبية.</li>
<li>✅ تجنب <code>'jet'</code> في التقارير الرسمية (غير دقيق بصريًا).</li>
<li>✅ استخدم <code>ColorBarItem</code> لجعل الرسم مفهومًا.</li>
<li>✅ عدّل <code>levels</code> في <code>ImageView</code> لتحسين التباين.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-11">🔹 <strong>9. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>كيف تُطبق خريطة لونية على <code>ImageView</code>؟</li>
<li>ما وظيفة <code>pg.colormap.get()</code>؟</li>
<li>كيف تُنشئ خريطة لونية مخصصة؟</li>
<li>كيف تُضيف شريط ألوان؟</li>
<li>كيف تُستخدم الخرائط في الرسوم 3D؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-11">🔹 <strong>10. مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>العنصر</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pg.colormap.get('name')</code></td>
<td>الحصول على خريطة لونية</td>
</tr>
<tr class="even">
<td><code>setColorMap()</code></td>
<td>تطبيق الخريطة على <code>ImageView</code></td>
</tr>
<tr class="odd">
<td><code>ColorMap(pos, color)</code></td>
<td>إنشاء خريطة مخصصة</td>
</tr>
<tr class="even">
<td><code>ColorBarItem</code></td>
<td>شريط توضيحي للون</td>
</tr>
<tr class="odd">
<td><code>getLookupTable()</code></td>
<td>تحويل الخريطة إلى ألوان</td>
</tr>
</tbody>
</table>
<h1 id="lesson_15">📘 <strong>الدرس 15 (موسع): عرض عدة رسوم (Multiple Plots)</strong></h1>
<h2 id="مقدمة-لماذا-نعرض-عدة-رسوم-معا">🔹 <strong>مقدمة: لماذا نعرض عدة رسوم معًا؟</strong></h2>
<p>في التطبيقات الواقعية، نادرًا ما يكفي رسم واحد لفهم الصورة الكاملة.</p>
<p>غالبًا ما نحتاج إلى عرض: - <strong>مخططات مقارنة</strong> (مثل: المبيعات مقابل التكاليف) - <strong>بيانات متعددة الأبعاد</strong> (مثل: درجة الحرارة، الرطوبة، الضغط في نفس الوقت) - <strong>تحليل متعدد الجوانب</strong> (مثل: السعر، الحجم، مؤشرات فنية)</p>
<p>في هذا الدرس، ستتعلم كيفية استخدام <code>GraphicsLayoutWidget</code> لتنظيم <strong>عدة رسومات في نافذة واحدة</strong>، مع التحكم الكامل في التخطيط والتنسيق.</p>
<hr />
<h2 id="graphicslayoutwidget-حاوية-الرسومات-المتعددة">🔹 <strong>1. <code>GraphicsLayoutWidget</code> — حاوية الرسومات المتعددة</strong></h2>
<p>كما تعلمت سابقًا، <code>GraphicsLayoutWidget</code> هو العنصر المثالي لعرض أكثر من رسم.</p>
<h3 id="المثال-1-رسمان-جنبا-إلى-جنب">📌 المثال 1: رسمان جنبًا إلى جنب</h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true"></a><span class="co"># إنشاء حاوية متعددة الرسومات</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true"></a>win <span class="op">=</span> pg.GraphicsLayoutWidget(show<span class="op">=</span><span class="va">True</span>, title<span class="op">=</span><span class="st">&quot;رسمان جنبًا إلى جنب&quot;</span>)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true"></a>win.resize(<span class="dv">1000</span>, <span class="dv">500</span>)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true"></a></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true"></a><span class="co"># الرسم الأول: جيب التمام</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true"></a>p1 <span class="op">=</span> win.addPlot(row<span class="op">=</span><span class="dv">0</span>, col<span class="op">=</span><span class="dv">0</span>, title<span class="op">=</span><span class="st">&quot;cos(x)&quot;</span>)</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">4</span><span class="op">*</span>np.pi, <span class="dv">100</span>)</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true"></a>y1 <span class="op">=</span> np.cos(x)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true"></a>p1.plot(x, y1, pen<span class="op">=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true"></a></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true"></a><span class="co"># الرسم الثاني: الجيب</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true"></a>p2 <span class="op">=</span> win.addPlot(row<span class="op">=</span><span class="dv">0</span>, col<span class="op">=</span><span class="dv">1</span>, title<span class="op">=</span><span class="st">&quot;sin(x)&quot;</span>)</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true"></a>y2 <span class="op">=</span> np.sin(x)</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true"></a>p2.plot(x, y2, pen<span class="op">=</span><span class="st">&#39;r&#39;</span>)</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true"></a></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="شرح-الكود-11">🔍 شرح الكود:</h4>
<ul>
<li><code>addPlot(row, col)</code>: يُضيف رسمًا في موقع معين.</li>
<li><code>row=0, col=0</code>: الصف 0، العمود 0 (أعلى اليسار)</li>
<li><code>row=0, col=1</code>: الصف 0، العمود 1 (أعلى اليمين)</li>
</ul>
<blockquote>
<p>✅ مثالي للعرض المقارن.</p>
</blockquote>
<hr />
<h2 id="تخطيطات-معقدة-22-31-إلخ">🔹 <strong>2. تخطيطات معقدة (2×2، 3×1، إلخ)</strong></h2>
<h3 id="المثال-2-أربع-رسومات-2-صفوف-2-أعمدة">📌 المثال 2: أربع رسومات (2 صفوف × 2 أعمدة)</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true"></a>win <span class="op">=</span> pg.GraphicsLayoutWidget(show<span class="op">=</span><span class="va">True</span>, title<span class="op">=</span><span class="st">&quot;مخططات 2×2&quot;</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true"></a>win.resize(<span class="dv">1000</span>, <span class="dv">800</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true"></a><span class="co"># إنشاء الرسومات</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true"></a>p1 <span class="op">=</span> win.addPlot(row<span class="op">=</span><span class="dv">0</span>, col<span class="op">=</span><span class="dv">0</span>, title<span class="op">=</span><span class="st">&quot;cos(x)&quot;</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true"></a>p1.plot(x, np.cos(x), pen<span class="op">=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true"></a>p2 <span class="op">=</span> win.addPlot(row<span class="op">=</span><span class="dv">0</span>, col<span class="op">=</span><span class="dv">1</span>, title<span class="op">=</span><span class="st">&quot;sin(x)&quot;</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true"></a>p2.plot(x, np.sin(x), pen<span class="op">=</span><span class="st">&#39;r&#39;</span>)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true"></a></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true"></a>p3 <span class="op">=</span> win.addPlot(row<span class="op">=</span><span class="dv">1</span>, col<span class="op">=</span><span class="dv">0</span>, title<span class="op">=</span><span class="st">&quot;cos²(x)&quot;</span>)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true"></a>p3.plot(x, np.cos(x)<span class="op">**</span><span class="dv">2</span>, pen<span class="op">=</span><span class="st">&#39;g&#39;</span>)</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true"></a></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true"></a>p4 <span class="op">=</span> win.addPlot(row<span class="op">=</span><span class="dv">1</span>, col<span class="op">=</span><span class="dv">1</span>, title<span class="op">=</span><span class="st">&quot;sin²(x)&quot;</span>)</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true"></a>p4.plot(x, np.sin(x)<span class="op">**</span><span class="dv">2</span>, pen<span class="op">=</span><span class="st">&#39;m&#39;</span>)</span></code></pre></div>
<blockquote>
<p>✅ يمكنك إنشاء أي تخطيط شبكي.</p>
</blockquote>
<hr />
<h2 id="مزامنة-المحاور-linking-axes">🔹 <strong>3. مزامنة المحاور (Linking Axes)</strong></h2>
<p>مفيد عندما تريد التكبير والتحريك على أكثر من رسم معًا.</p>
<h3 id="المثال-3-مزامنة-المحور-x">📌 المثال 3: مزامنة المحور X</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true"></a><span class="co"># بعد إنشاء p1 و p2</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true"></a>p2.setXLink(p1)  <span class="co"># ربط محور X للرسم الثاني بالرسم الأول</span></span></code></pre></div>
<blockquote>
<p>✅ الآن، عند التكبير على <code>p1</code>، سيتكبّر <code>p2</code> بنفس النطاق.</p>
</blockquote>
<hr />
<h3 id="المثال-4-مزامنة-المحور-y">📌 المثال 4: مزامنة المحور Y</h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true"></a>p2.setYLink(p1)</span></code></pre></div>
<blockquote>
<p>✅ مفيد في الرسومات التي تستخدم نفس المقياس.</p>
</blockquote>
<hr />
<h2 id="إخفاء-المحاور-المشتركة">🔹 <strong>4. إخفاء المحاور المشتركة</strong></h2>
<p>لتحسين المظهر البصري.</p>
<h3 id="المثال-5-إخفاء-محور-y-للرسم-الثاني">📌 المثال 5: إخفاء محور Y للرسم الثاني</h3>
<div class="sourceCode" id="cb74"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true"></a>p2.hideAxis(<span class="st">&#39;left&#39;</span>)  <span class="co"># إخفاء المحور الأيسر</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true"></a>p2.showAxis(<span class="st">&#39;right&#39;</span>)  <span class="co"># (اختياري) إظهار محور على اليمين</span></span></code></pre></div>
<blockquote>
<p>✅ يجعل التخطيط أكثر انسيابية.</p>
</blockquote>
<hr />
<h2 id="إضافة-نص-أو-عناصر-فارغة">🔹 <strong>5. إضافة نص أو عناصر فارغة</strong></h2>
<p>لإضافة عناوين أو فواصل.</p>
<h3 id="المثال-6-إضافة-نص-بين-الرسومات">📌 المثال 6: إضافة نص بين الرسومات</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true"></a><span class="im">from</span> pyqtgraph <span class="im">import</span> LabelItem</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true"></a>label <span class="op">=</span> LabelItem(<span class="st">&quot;تحليل دوال مثلثية&quot;</span>, color<span class="op">=</span><span class="st">&#39;w&#39;</span>, size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true"></a>win.addItem(label, row<span class="op">=</span><span class="dv">0</span>, col<span class="op">=</span><span class="dv">0</span>, colspan<span class="op">=</span><span class="dv">2</span>)  <span class="co"># تمتد على عمودين</span></span></code></pre></div>
<blockquote>
<p>✅ <code>colspan=2</code>: يُغطي عمودين.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-13">🔹 <strong>6. الأخطاء الشائعة</strong></h2>
<table>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>لا تظهر الرسومات</td>
<td>نسيت <code>addPlot()</code></td>
<td>تأكد من استخدام <code>addPlot(row, col)</code></td>
</tr>
<tr class="even">
<td>التكبير لا يعمل</td>
<td>لم يتم تفعيل <code>ViewBox</code></td>
<td>تأكد من أن <code>mouseEnabled=True</code></td>
</tr>
<tr class="odd">
<td><code>setXLink()</code> لا يعمل</td>
<td>لم يتم ربط الرسومات بشكل صحيح</td>
<td>تأكد من ترتيب الإنشاء</td>
</tr>
<tr class="even">
<td>التخطيط مشوّش</td>
<td>لم تُضبط الحجم</td>
<td>استخدم <code>win.resize()</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-12">🔹 <strong>7. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>أنشئ تخطيطًا 3×1 يعرض <code>sin(x)</code>, <code>cos(x)</code>, و<code>tan(x)</code>.</li>
<li>مزامن محور X لجميع الرسومات.</li>
<li>أخفِ محور Y للرسمين الثاني والثالث.</li>
<li>أضف عنوانًا رئيسيًا أعلى التخطيط.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-لوحة-مراقبة-بيانات-حية">🔹 <strong>8. الربط بالواقع: لوحة مراقبة بيانات حية</strong></h2>
<h3 id="الهدف-عرض-4-إشارات-حية-معا">🎯 الهدف: عرض 4 إشارات حية معًا</h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true"></a><span class="co"># فرض 4 إشارات (مثل: مستشعرات في مصنع)</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true"></a>t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">1000</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true"></a>signals <span class="op">=</span> {</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true"></a>    <span class="st">&#39;درجة الحرارة&#39;</span>: <span class="dv">25</span> <span class="op">+</span> <span class="dv">5</span> <span class="op">*</span> np.sin(t) <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1000</span>),</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true"></a>    <span class="st">&#39;الرطوبة&#39;</span>: <span class="dv">60</span> <span class="op">+</span> <span class="dv">10</span> <span class="op">*</span> np.cos(t) <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1000</span>),</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true"></a>    <span class="st">&#39;الضغط&#39;</span>: <span class="dv">1013</span> <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">1000</span>),</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true"></a>    <span class="st">&#39;الاهتزاز&#39;</span>: <span class="fl">0.1</span> <span class="op">*</span> np.random.randn(<span class="dv">1000</span>)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true"></a>}</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true"></a>win <span class="op">=</span> pg.GraphicsLayoutWidget(show<span class="op">=</span><span class="va">True</span>, title<span class="op">=</span><span class="st">&quot;لوحة مراقبة المصنع&quot;</span>, size<span class="op">=</span>(<span class="dv">1200</span>, <span class="dv">800</span>))</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true"></a></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true"></a>plots <span class="op">=</span> {}</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true"></a><span class="cf">for</span> i, (name, data) <span class="kw">in</span> <span class="bu">enumerate</span>(signals.items()):</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true"></a>    row <span class="op">=</span> i <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true"></a>    col <span class="op">=</span> i <span class="op">%</span> <span class="dv">2</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true"></a>    plots[name] <span class="op">=</span> win.addPlot(row<span class="op">=</span>row, col<span class="op">=</span>col, title<span class="op">=</span>name)</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true"></a>    plots[name].plot(t, data, pen<span class="op">=</span><span class="st">&#39;y&#39;</span>)</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true"></a>    plots[name].showGrid(y<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true"></a>    <span class="cf">if</span> col <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true"></a>        plots[name].hideAxis(<span class="st">&#39;left&#39;</span>)</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true"></a></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true"></a><span class="co"># مزامنة محور الزمن</span></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true"></a><span class="cf">for</span> name, p <span class="kw">in</span> plots.items():</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true"></a>    <span class="cf">if</span> name <span class="op">!=</span> <span class="st">&#39;درجة الحرارة&#39;</span>:</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true"></a>        p.setXLink(plots[<span class="st">&#39;درجة الحرارة&#39;</span>])</span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true"></a></span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;📊 لوحة المراقبة جاهزة للتشغيل اللحظي!&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا النوع من الواجهات يُستخدم في أنظمة SCADA.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-13">🔹 <strong>9. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>GraphicsLayoutWidget</code> دائمًا للرسومات المتعددة.</li>
<li>✅ استخدم <code>setXLink()</code> لربط الرسومات الزمنية.</li>
<li>✅ استخدم <code>hideAxis()</code> لتحسين التصميم.</li>
<li>✅ ضع الرسومات الأكثر أهمية في الزاوية العلوية اليسرى.</li>
<li>✅ استخدم <code>LabelItem</code> لإضافة عناوين.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-12">🔹 <strong>10. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>كيف تُضيف رسمًا في الصف 1 والعمود 0؟</li>
<li>ما وظيفة <code>setXLink()</code>؟</li>
<li>كيف تُخفي محور Y؟</li>
<li>ما الفرق بين <code>GraphicsLayoutWidget</code> و <code>PlotWidget</code>؟</li>
<li>كيف تُجعل نصًا يغطي عمودين؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-12">🔹 <strong>11. مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>العنصر</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>GraphicsLayoutWidget</code></td>
<td>حاوية للرسومات المتعددة</td>
</tr>
<tr class="even">
<td><code>addPlot(row, col)</code></td>
<td>إضافة رسم في موقع معين</td>
</tr>
<tr class="odd">
<td><code>setXLink(p)</code></td>
<td>مزامنة محور X</td>
</tr>
<tr class="even">
<td><code>setYLink(p)</code></td>
<td>مزامنة محور Y</td>
</tr>
<tr class="odd">
<td><code>hideAxis('left')</code></td>
<td>إخفاء محور</td>
</tr>
<tr class="even">
<td><code>LabelItem</code></td>
<td>إضافة نص</td>
</tr>
<tr class="odd">
<td><code>colspan</code></td>
<td>تمديد العنصر على أعمدة</td>
</tr>
</tbody>
</table>
<h1 id="lesson_16">📘 <strong>الدرس 16 (موسع): دمج PyQtGraph في واجهات PyQt/PySide</strong></h1>
<h2 id="مقدمة-لماذا-ندمج-pyqtgraph-في-واجهات-أكبر">🔹 <strong>مقدمة: لماذا ندمج PyQtGraph في واجهات أكبر؟</strong></h2>
<p>حتى الآن، كنا نستخدم <code>PlotWidget</code> و <code>ImageView</code> بشكل منفصل.<br />
لكن في التطبيقات الحقيقية، نادرًا ما تكون الرسومات هي الشيء الوحيد في الواجهة.</p>
<p>غالبًا ما نحتاج إلى: - إضافة <strong>أزرار تحكم</strong> (تشغيل، إيقاف، تحديث) - إضافة <strong>مربعات نصية</strong> (إدخال معلمات) - إضافة <strong>قوائم منسدلة</strong> (اختيار نوع البيانات) - دمج الرسم مع <strong>جداول</strong> أو <strong>نصوص توضيحية</strong></p>
<p>لهذا، يجب أن نتعلم كيفية دمج عناصر PyQtGraph داخل واجهات PyQt/PySide الأكبر، مثل <code>QMainWindow</code> أو <code>QDialog</code>.</p>
<hr />
<h2 id="وضع-plotwidget-داخل-qmainwindow">🔹 <strong>1. وضع <code>PlotWidget</code> داخل <code>QMainWindow</code></strong></h2>
<h3 id="المثال-1-نافذة-رئيسية-مع-رسم-وزر">📌 المثال 1: نافذة رئيسية مع رسم وزر**</h3>
<div class="sourceCode" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> (</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true"></a>    QApplication, QMainWindow, QWidget, QVBoxLayout, QPushButton</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true"></a>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true"></a><span class="im">from</span> PySide6.QtCore <span class="im">import</span> QTimer</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true"></a><span class="kw">class</span> MainWindow(QMainWindow):</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true"></a>        <span class="va">self</span>.setWindowTitle(<span class="st">&quot;تطبيق مراقبة مع أزرار&quot;</span>)</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true"></a>        <span class="va">self</span>.resize(<span class="dv">800</span>, <span class="dv">600</span>)</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true"></a></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true"></a>        <span class="co"># إنشاء عنصر مركزي</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true"></a>        central_widget <span class="op">=</span> QWidget()</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true"></a>        <span class="va">self</span>.setCentralWidget(central_widget)</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true"></a></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true"></a>        <span class="co"># إنشاء تخطيط عمودي</span></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true"></a>        layout <span class="op">=</span> QVBoxLayout(central_widget)</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true"></a></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true"></a>        <span class="co"># إنشاء الرسم</span></span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true"></a>        <span class="va">self</span>.plot_widget <span class="op">=</span> pg.PlotWidget(title<span class="op">=</span><span class="st">&quot;بيانات حية&quot;</span>)</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true"></a>        <span class="va">self</span>.plot_widget.setLabel(<span class="st">&#39;left&#39;</span>, <span class="st">&#39;القيمة&#39;</span>)</span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true"></a>        <span class="va">self</span>.plot_widget.setLabel(<span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;الزمن&#39;</span>)</span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true"></a>        <span class="va">self</span>.curve <span class="op">=</span> <span class="va">self</span>.plot_widget.plot(pen<span class="op">=</span><span class="st">&#39;y&#39;</span>)</span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true"></a></span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true"></a>        <span class="co"># إضافة الرسم إلى التخطيط</span></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true"></a>        layout.addWidget(<span class="va">self</span>.plot_widget)</span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true"></a></span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true"></a>        <span class="co"># إضافة زر</span></span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true"></a>        <span class="va">self</span>.btn_toggle <span class="op">=</span> QPushButton(<span class="st">&quot;إيقاف/تشغيل التحديث&quot;</span>)</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true"></a>        <span class="va">self</span>.btn_toggle.setCheckable(<span class="va">True</span>)</span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true"></a>        <span class="va">self</span>.btn_toggle.setChecked(<span class="va">True</span>)</span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true"></a>        <span class="va">self</span>.btn_toggle.toggled.<span class="ex">connect</span>(<span class="va">self</span>.toggle_timer)</span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true"></a>        layout.addWidget(<span class="va">self</span>.btn_toggle)</span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true"></a></span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true"></a>        <span class="co"># بيانات افتراضية</span></span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true"></a>        <span class="va">self</span>.x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">1000</span>)</span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true"></a>        <span class="va">self</span>.i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true"></a></span>
<span id="cb77-42"><a href="#cb77-42" aria-hidden="true"></a>        <span class="co"># مؤقت التحديث</span></span>
<span id="cb77-43"><a href="#cb77-43" aria-hidden="true"></a>        <span class="va">self</span>.timer <span class="op">=</span> QTimer()</span>
<span id="cb77-44"><a href="#cb77-44" aria-hidden="true"></a>        <span class="va">self</span>.timer.timeout.<span class="ex">connect</span>(<span class="va">self</span>.update_plot)</span>
<span id="cb77-45"><a href="#cb77-45" aria-hidden="true"></a>        <span class="va">self</span>.timer.start(<span class="dv">50</span>)</span>
<span id="cb77-46"><a href="#cb77-46" aria-hidden="true"></a></span>
<span id="cb77-47"><a href="#cb77-47" aria-hidden="true"></a>    <span class="kw">def</span> update_plot(<span class="va">self</span>):</span>
<span id="cb77-48"><a href="#cb77-48" aria-hidden="true"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.btn_toggle.isChecked():</span>
<span id="cb77-49"><a href="#cb77-49" aria-hidden="true"></a>            <span class="cf">return</span></span>
<span id="cb77-50"><a href="#cb77-50" aria-hidden="true"></a>        y <span class="op">=</span> np.sin(<span class="va">self</span>.x[:<span class="va">self</span>.i<span class="op">+</span><span class="dv">1</span>] <span class="op">*</span> <span class="fl">0.5</span>) <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> np.random.randn(<span class="va">self</span>.i<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb77-51"><a href="#cb77-51" aria-hidden="true"></a>        <span class="va">self</span>.curve.setData(<span class="va">self</span>.x[:<span class="va">self</span>.i<span class="op">+</span><span class="dv">1</span>], y)</span>
<span id="cb77-52"><a href="#cb77-52" aria-hidden="true"></a>        <span class="va">self</span>.i <span class="op">=</span> (<span class="va">self</span>.i <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(<span class="va">self</span>.x)</span>
<span id="cb77-53"><a href="#cb77-53" aria-hidden="true"></a></span>
<span id="cb77-54"><a href="#cb77-54" aria-hidden="true"></a>    <span class="kw">def</span> toggle_timer(<span class="va">self</span>, checked):</span>
<span id="cb77-55"><a href="#cb77-55" aria-hidden="true"></a>        <span class="cf">if</span> checked:</span>
<span id="cb77-56"><a href="#cb77-56" aria-hidden="true"></a>            <span class="va">self</span>.timer.start(<span class="dv">50</span>)</span>
<span id="cb77-57"><a href="#cb77-57" aria-hidden="true"></a>        <span class="cf">else</span>:</span>
<span id="cb77-58"><a href="#cb77-58" aria-hidden="true"></a>            <span class="va">self</span>.timer.stop()</span>
<span id="cb77-59"><a href="#cb77-59" aria-hidden="true"></a></span>
<span id="cb77-60"><a href="#cb77-60" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb77-61"><a href="#cb77-61" aria-hidden="true"></a>window <span class="op">=</span> MainWindow()</span>
<span id="cb77-62"><a href="#cb77-62" aria-hidden="true"></a>window.show()</span>
<span id="cb77-63"><a href="#cb77-63" aria-hidden="true"></a>app.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="شرح-الكود-12">🔍 شرح الكود:</h4>
<ul>
<li><code>QMainWindow</code>: النافذة الرئيسية.</li>
<li><code>QWidget</code> + <code>QVBoxLayout</code>: لتنظيم العناصر.</li>
<li><code>setCentralWidget()</code>: لتحديد العنصر المركزي.</li>
<li><code>QPushButton</code> مع <code>setCheckable(True)</code>: زر تبديل.</li>
<li>يتم التحكم في المؤقت من الزر.</li>
</ul>
<blockquote>
<p>✅ هذا هو الشكل الأساسي لأي تطبيق تفاعلي.</p>
</blockquote>
<hr />
<h2 id="استخدام-graphicslayoutwidget-في-التخطيطات-المعقدة">🔹 <strong>2. استخدام <code>GraphicsLayoutWidget</code> في التخطيطات المعقدة</strong></h2>
<h3 id="المثال-2-تخطيط-شبكة-grid-layout">📌 المثال 2: تخطيط شبكة (Grid Layout)</h3>
<div class="sourceCode" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QGridLayout</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true"></a><span class="co"># داخل __init__ بعد إنشاء central_widget</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true"></a>layout <span class="op">=</span> QGridLayout(central_widget)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true"></a><span class="co"># إنشاء رسمين</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true"></a><span class="va">self</span>.plot1 <span class="op">=</span> pg.PlotWidget(title<span class="op">=</span><span class="st">&quot;الرسم 1&quot;</span>)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true"></a><span class="va">self</span>.plot2 <span class="op">=</span> pg.PlotWidget(title<span class="op">=</span><span class="st">&quot;الرسم 2&quot;</span>)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true"></a><span class="co"># إضافة الرسومات إلى التخطيط</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true"></a>layout.addWidget(<span class="va">self</span>.plot1, <span class="dv">0</span>, <span class="dv">0</span>)  <span class="co"># الصف 0، العمود 0</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true"></a>layout.addWidget(<span class="va">self</span>.plot2, <span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># الصف 0، العمود 1</span></span></code></pre></div>
<blockquote>
<p>✅ مثالي للواجهات التي تدمج نصوص، أزرار، ورسومات.</p>
</blockquote>
<hr />
<h2 id="دمج-imageview-مع-عناصر-تحكم">🔹 <strong>3. دمج <code>ImageView</code> مع عناصر تحكم</strong></h2>
<h3 id="المثال-3-عرض-صورة-مع-زر-تحميل">📌 المثال 3: عرض صورة مع زر تحميل</h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QFileDialog</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true"></a><span class="co"># إضافة زر لتحميل صورة</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true"></a><span class="va">self</span>.btn_load <span class="op">=</span> QPushButton(<span class="st">&quot;تحميل صورة&quot;</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true"></a><span class="va">self</span>.btn_load.clicked.<span class="ex">connect</span>(<span class="va">self</span>.load_image)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true"></a>layout.addWidget(<span class="va">self</span>.btn_load)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true"></a><span class="co"># إنشاء ImageView</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true"></a><span class="va">self</span>.image_view <span class="op">=</span> pg.ImageView()</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true"></a>layout.addWidget(<span class="va">self</span>.image_view)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true"></a><span class="kw">def</span> load_image(<span class="va">self</span>):</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true"></a>    file_path, _ <span class="op">=</span> QFileDialog.getOpenFileName(</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true"></a>        <span class="va">self</span>, <span class="st">&quot;اختر صورة&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;Images (*.png *.xpm *.jpg *.bmp)&quot;</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true"></a>    )</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true"></a>    <span class="cf">if</span> file_path:</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true"></a>        <span class="co"># في الواقع، يجب استخدام مكتبة مثل `imageio` أو `Pillow`</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true"></a>        <span class="co"># لكن لهذا المثال، نُنشئ بيانات وهمية</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true"></a>        <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true"></a>        fake_image <span class="op">=</span> np.random.rand(<span class="dv">200</span>, <span class="dv">200</span>) <span class="op">*</span> <span class="dv">255</span></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true"></a>        <span class="va">self</span>.image_view.setImage(fake_image)</span></code></pre></div>
<blockquote>
<p>✅ في التطبيقات الحقيقية، استخدم <code>imageio.imread()</code> أو <code>Pillow</code>.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-14">🔹 <strong>4. الأخطاء الشائعة</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>لا تظهر الرسومات</td>
<td>لم تُضف إلى التخطيط</td>
<td>تأكد من <code>layout.addWidget(plot)</code></td>
</tr>
<tr class="even">
<td>الزر لا يعمل</td>
<td>لم تُربط الإشارة</td>
<td>تأكد من <code>clicked.connect()</code></td>
</tr>
<tr class="odd">
<td><code>PlotWidget</code> لا يأخذ المساحة</td>
<td>لم يتم تعيين التخطيط بشكل صحيح</td>
<td>تأكد من <code>setCentralWidget()</code></td>
</tr>
<tr class="even">
<td><code>QFileDialog</code> لا يظهر</td>
<td>لم يتم استدعاء <code>exec()</code></td>
<td>استخدم <code>getOpenFileName()</code> بشكل صحيح</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-13">🔹 <strong>5. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>أنشئ <code>QMainWindow</code> به <code>PlotWidget</code> وزر “إعادة تعيين”.</li>
<li>أضف قائمة منسدلة لاختيار نوع الخريطة اللونية.</li>
<li>أنشئ تطبيقًا يعرض <code>ImageView</code> مع زر “تحديث البيانات”.</li>
<li>ضع رسمين في تخطيط شبكة 2×2.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-تطبيق-مراقبة-متكامل">🔹 <strong>6. الربط بالواقع: تطبيق مراقبة متكامل</strong></h2>
<h3 id="الهدف-بناء-واجهة-مراقبة-مع-تحكم-كامل">🎯 الهدف: بناء واجهة مراقبة مع تحكم كامل</h3>
<div class="sourceCode" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true"></a><span class="kw">class</span> MonitoringApp(QMainWindow):</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true"></a>        <span class="va">self</span>.setWindowTitle(<span class="st">&quot;لوحة مراقبة متكاملة&quot;</span>)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true"></a>        <span class="va">self</span>.resize(<span class="dv">1200</span>, <span class="dv">800</span>)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true"></a>        central <span class="op">=</span> QWidget()</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true"></a>        <span class="va">self</span>.setCentralWidget(central)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true"></a>        layout <span class="op">=</span> QVBoxLayout(central)</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true"></a></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true"></a>        <span class="co"># تخطيط رئيسي (على شكل شبكة)</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true"></a>        main_layout <span class="op">=</span> QGridLayout()</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true"></a>        layout.addLayout(main_layout)</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true"></a></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true"></a>        <span class="co"># رسومات</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true"></a>        <span class="va">self</span>.temp_plot <span class="op">=</span> pg.PlotWidget(title<span class="op">=</span><span class="st">&quot;درجة الحرارة&quot;</span>)</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true"></a>        <span class="va">self</span>.humi_plot <span class="op">=</span> pg.PlotWidget(title<span class="op">=</span><span class="st">&quot;الرطوبة&quot;</span>)</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true"></a>        <span class="va">self</span>.pres_plot <span class="op">=</span> pg.PlotWidget(title<span class="op">=</span><span class="st">&quot;الضغط&quot;</span>)</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true"></a></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true"></a>        main_layout.addWidget(<span class="va">self</span>.temp_plot, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true"></a>        main_layout.addWidget(<span class="va">self</span>.humi_plot, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true"></a>        main_layout.addWidget(<span class="va">self</span>.pres_plot, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)  <span class="co"># يمتد على عمودين</span></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true"></a></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true"></a>        <span class="co"># عناصر التحكم</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true"></a>        control_layout <span class="op">=</span> QHBoxLayout()</span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true"></a>        <span class="va">self</span>.btn_start <span class="op">=</span> QPushButton(<span class="st">&quot;بدء&quot;</span>)</span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true"></a>        <span class="va">self</span>.btn_stop <span class="op">=</span> QPushButton(<span class="st">&quot;إيقاف&quot;</span>)</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true"></a>        <span class="va">self</span>.btn_reset <span class="op">=</span> QPushButton(<span class="st">&quot;إعادة تعيين&quot;</span>)</span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true"></a>        control_layout.addWidget(<span class="va">self</span>.btn_start)</span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true"></a>        control_layout.addWidget(<span class="va">self</span>.btn_stop)</span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true"></a>        control_layout.addWidget(<span class="va">self</span>.btn_reset)</span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true"></a>        layout.addLayout(control_layout)</span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true"></a></span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true"></a>        <span class="co"># المؤقت</span></span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true"></a>        <span class="va">self</span>.timer <span class="op">=</span> QTimer()</span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true"></a>        <span class="va">self</span>.setup_plots()</span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true"></a></span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true"></a>        <span class="va">self</span>.btn_start.clicked.<span class="ex">connect</span>(<span class="va">self</span>.start_monitoring)</span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true"></a>        <span class="va">self</span>.btn_stop.clicked.<span class="ex">connect</span>(<span class="va">self</span>.stop_monitoring)</span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true"></a>        <span class="va">self</span>.btn_reset.clicked.<span class="ex">connect</span>(<span class="va">self</span>.reset_data)</span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true"></a></span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true"></a>    <span class="kw">def</span> setup_plots(<span class="va">self</span>):</span>
<span id="cb80-43"><a href="#cb80-43" aria-hidden="true"></a>        <span class="co"># إعداد الرسومات</span></span>
<span id="cb80-44"><a href="#cb80-44" aria-hidden="true"></a>        <span class="cf">pass</span></span>
<span id="cb80-45"><a href="#cb80-45" aria-hidden="true"></a></span>
<span id="cb80-46"><a href="#cb80-46" aria-hidden="true"></a>    <span class="kw">def</span> start_monitoring(<span class="va">self</span>):</span>
<span id="cb80-47"><a href="#cb80-47" aria-hidden="true"></a>        <span class="va">self</span>.timer.start(<span class="dv">100</span>)</span>
<span id="cb80-48"><a href="#cb80-48" aria-hidden="true"></a></span>
<span id="cb80-49"><a href="#cb80-49" aria-hidden="true"></a>    <span class="kw">def</span> stop_monitoring(<span class="va">self</span>):</span>
<span id="cb80-50"><a href="#cb80-50" aria-hidden="true"></a>        <span class="va">self</span>.timer.stop()</span>
<span id="cb80-51"><a href="#cb80-51" aria-hidden="true"></a></span>
<span id="cb80-52"><a href="#cb80-52" aria-hidden="true"></a>    <span class="kw">def</span> reset_data(<span class="va">self</span>):</span>
<span id="cb80-53"><a href="#cb80-53" aria-hidden="true"></a>        <span class="co"># إعادة تعيين البيانات</span></span>
<span id="cb80-54"><a href="#cb80-54" aria-hidden="true"></a>        <span class="cf">pass</span></span>
<span id="cb80-55"><a href="#cb80-55" aria-hidden="true"></a></span>
<span id="cb80-56"><a href="#cb80-56" aria-hidden="true"></a><span class="co"># تشغيل التطبيق</span></span>
<span id="cb80-57"><a href="#cb80-57" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb80-58"><a href="#cb80-58" aria-hidden="true"></a>window <span class="op">=</span> MonitoringApp()</span>
<span id="cb80-59"><a href="#cb80-59" aria-hidden="true"></a>window.show()</span>
<span id="cb80-60"><a href="#cb80-60" aria-hidden="true"></a>app.<span class="bu">exec</span>()</span></code></pre></div>
<blockquote>
<p>✅ هذا هو الشكل الذي تُبنى عليه التطبيقات الصناعية.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-14">🔹 <strong>7. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم <code>QMainWindow</code> كنقطة بداية لأي تطبيق كبير.</li>
<li>✅ استخدم <code>QVBoxLayout</code> أو <code>QGridLayout</code> لتنظيم العناصر.</li>
<li>✅ احفظ مراجع لعناصر الرسم (مثل <code>self.plot_widget</code>) للوصول إليها لاحقًا.</li>
<li>✅ استخدم <code>setCheckable(True)</code> للأزرار التي تُغيّر الحالة.</li>
<li>✅ فصل منطق التحديث عن واجهة المستخدم (مبدأ الفصل).</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-13">🔹 <strong>8. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>كيف تُضيف <code>PlotWidget</code> إلى <code>QMainWindow</code>؟</li>
<li>ما الفرق بين <code>QVBoxLayout</code> و <code>QGridLayout</code>؟</li>
<li>كيف تُربط زرًا بحدث؟</li>
<li>كيف تُوقف مؤقتًا عند النقر على زر؟</li>
<li>كيف تُنشئ زر تبديل (Toggle Button)؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-13">🔹 <strong>9. مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>العنصر</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>QMainWindow</code></td>
<td>النافذة الرئيسية</td>
</tr>
<tr class="even">
<td><code>setCentralWidget()</code></td>
<td>تعيين العنصر المركزي</td>
</tr>
<tr class="odd">
<td><code>QVBoxLayout</code></td>
<td>تخطيط عمودي</td>
</tr>
<tr class="even">
<td><code>QGridLayout</code></td>
<td>تخطيط شبكي</td>
</tr>
<tr class="odd">
<td><code>QPushButton</code></td>
<td>زر تحكم</td>
</tr>
<tr class="even">
<td><code>clicked.connect()</code></td>
<td>ربط حدث الزر</td>
</tr>
<tr class="odd">
<td><code>setCheckable(True)</code></td>
<td>جعل الزر قابلاً للتبديل</td>
</tr>
</tbody>
</table>
<h1 id="lesson_17">📘 <strong>الدرس 17 (موسع): التصدير والحفظ</strong></h1>
<h2 id="مقدمة-لماذا-نحتاج-إلى-تصدير-النتائج">🔹 <strong>مقدمة: لماذا نحتاج إلى تصدير النتائج؟</strong></h2>
<p>بعد أن تحلّل البيانات، وتُنظّفها، وتُنتج رؤى قيّمة، يأتي الوقت لـ: - <strong>مشاركة النتائج</strong> مع الفريق أو الإدارة - <strong>استخدام البيانات في تطبيقات أخرى</strong> (مثل: Excel، تقارير Power BI) - <strong>حفظ النتائج الوسيطة</strong> لاستخدامها لاحقًا - <strong>أرشفة التحليل</strong> للرجوع إليه</p>
<p>لهذا، نحتاج إلى أدوات قوية وآمنة لـ <strong>حفظ البيانات وتصدير الرسومات</strong>.</p>
<p>في هذا الدرس، ستتعلم كيفية: - حفظ DataFrame إلى ملفات - أخذ لقطات (Screenshot) من رسومات PyQtGraph - تصدير النتائج بشكل احترافي</p>
<hr />
<h2 id="حفظ-البيانات-إلى-ملفات-مراجعات-وتوسع">🔹 <strong>1. حفظ البيانات إلى ملفات (مراجعات وتوسع)</strong></h2>
<h3 id="المثال-1-حفظ-إلى-csv-مع-دعم-العربية">📌 المثال 1: حفظ إلى CSV (مع دعم العربية)</h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true"></a><span class="co"># أفضل إعدادات لملفات CSV</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true"></a>df.to_csv(<span class="st">&#39;results.csv&#39;</span>, </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true"></a>          index<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true"></a>          encoding<span class="op">=</span><span class="st">&#39;utf-8-sig&#39;</span>,  <span class="co"># ضروري لعرض العربية في إكسل</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true"></a>          sep<span class="op">=</span><span class="st">&#39;,&#39;</span>)</span></code></pre></div>
<blockquote>
<p>✅ <code>utf-8-sig</code>: يحل مشكلة عرض النصوص العربية في Excel.</p>
</blockquote>
<hr />
<h3 id="المثال-2-حفظ-إلى-excel-متعدد-الأوراق">📌 المثال 2: حفظ إلى Excel متعدد الأوراق</h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true"></a><span class="cf">with</span> pd.ExcelWriter(<span class="st">&#39;report.xlsx&#39;</span>, engine<span class="op">=</span><span class="st">&#39;openpyxl&#39;</span>) <span class="im">as</span> writer:</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true"></a>    df_sales.to_excel(writer, sheet_name<span class="op">=</span><span class="st">&#39;المبيعات&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true"></a>    df_summary.to_excel(writer, sheet_name<span class="op">=</span><span class="st">&#39;الملخص&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true"></a>    df_trends.to_excel(writer, sheet_name<span class="op">=</span><span class="st">&#39;الاتجاهات&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<blockquote>
<p>✅ مثالي للتقارير الإدارية.</p>
</blockquote>
<hr />
<h3 id="المثال-3-حفظ-إلى-json-لواجهات-برمجة-التطبيقات">📌 المثال 3: حفظ إلى JSON لواجهات برمجة التطبيقات</h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true"></a>df.to_json(<span class="st">&#39;api_data.json&#39;</span>, </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true"></a>           force_ascii<span class="op">=</span><span class="va">False</span>,  <span class="co"># يسمح بالحروف غير الإنجليزية</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true"></a>           orient<span class="op">=</span><span class="st">&#39;records&#39;</span>,   <span class="co"># كل صف ككائن</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true"></a>           indent<span class="op">=</span><span class="dv">4</span>)           <span class="co"># تنسيق جميل</span></span></code></pre></div>
<blockquote>
<p>✅ جاهز للإرسال عبر API.</p>
</blockquote>
<hr />
<h2 id="أخذ-لقطات-من-رسومات-pyqtgraph-screenshots">🔹 <strong>2. أخذ لقطات من رسومات PyQtGraph (Screenshots)</strong></h2>
<h3 id="المثال-4-حفظ-لقطة-من-plotwidget">📌 المثال 4: حفظ لقطة من <code>PlotWidget</code></h3>
<div class="sourceCode" id="cb84"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QApplication</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true"></a>app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true"></a></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true"></a><span class="co"># إنشاء رسم</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true"></a>win <span class="op">=</span> pg.plot(title<span class="op">=</span><span class="st">&quot;بيانات المبيعات&quot;</span>)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true"></a>y <span class="op">=</span> np.sin(x)</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true"></a>win.plot(x, y, pen<span class="op">=</span><span class="st">&#39;b&#39;</span>)</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true"></a></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true"></a><span class="co"># حفظ لقطة</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true"></a>win.grab().save(<span class="st">&quot;plot_screenshot.png&quot;</span>)</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true"></a></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;✅ تم حفظ اللقطة كـ plot_screenshot.png&quot;</span>)</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true"></a></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true"></a>    pg.<span class="bu">exec</span>()</span></code></pre></div>
<h4 id="شرح-1">🔍 شرح:</h4>
<ul>
<li><code>win.grab()</code>: يلتقط صورة من النافذة.</li>
<li><code>.save("filename.png")</code>: يحفظ الصورة.</li>
</ul>
<blockquote>
<p>✅ التنسيقات المدعومة: PNG, JPG, BMP.</p>
</blockquote>
<hr />
<h3 id="المثال-5-حفظ-لقطة-من-imageview">📌 المثال 5: حفظ لقطة من <code>ImageView</code></h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true"></a>view <span class="op">=</span> pg.ImageView()</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true"></a>view.setImage(np.random.rand(<span class="dv">100</span>, <span class="dv">100</span>))</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true"></a>view.setWindowTitle(<span class="st">&quot;تحليل حرارة&quot;</span>)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true"></a><span class="co"># بعد عرض النافذة</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true"></a>view.show()</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true"></a>view.grab().save(<span class="st">&quot;thermal_analysis.png&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ مثالي لعرض النتائج في التقارير.</p>
</blockquote>
<hr />
<h2 id="أزرار-التحكم-في-الحفظ-دمج-مع-واجهة-pyqt">🔹 <strong>3. أزرار التحكم في الحفظ (دمج مع واجهة PyQt)</strong></h2>
<h3 id="المثال-6-زر-لحفظ-لقطة">📌 المثال 6: زر لحفظ لقطة</h3>
<div class="sourceCode" id="cb86"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> QPushButton, QFileDialog</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true"></a><span class="co"># داخل واجهة المستخدم</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true"></a><span class="va">self</span>.btn_save_plot <span class="op">=</span> QPushButton(<span class="st">&quot;حفظ الرسم كصورة&quot;</span>)</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true"></a><span class="va">self</span>.btn_save_plot.clicked.<span class="ex">connect</span>(<span class="va">self</span>.save_plot_screenshot)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true"></a><span class="kw">def</span> save_plot_screenshot(<span class="va">self</span>):</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true"></a>    <span class="co"># فتح نافذة اختيار الملف</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true"></a>    file_path, _ <span class="op">=</span> QFileDialog.getSaveFileName(</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true"></a>        <span class="va">self</span>, <span class="st">&quot;حفظ الصورة&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;Images (*.png *.jpg *.bmp)&quot;</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true"></a>    )</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true"></a>    <span class="cf">if</span> file_path:</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true"></a>        <span class="va">self</span>.plot_widget.grab().save(file_path)</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true"></a>        <span class="bu">print</span>(<span class="ss">f&quot;تم حفظ الصورة في: </span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ يجعل التطبيق تفاعليًا.</p>
</blockquote>
<hr />
<h2 id="الأخطاء-الشائعة-15">🔹 <strong>4. الأخطاء الشائعة</strong></h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>الخطأ</th>
<th>السبب</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>النص العربي مشوّش في CSV</td>
<td>ترميز خاطئ</td>
<td>استخدم <code>encoding='utf-8-sig'</code></td>
</tr>
<tr class="even">
<td><code>grab()</code> لا يعمل</td>
<td>النافذة لم تُعرض بعد</td>
<td>تأكد من <code>show()</code> قبل <code>grab()</code></td>
</tr>
<tr class="odd">
<td><code>QFileDialog</code> لا يظهر</td>
<td>لم يتم استدعاء <code>exec()</code></td>
<td>استخدم <code>getSaveFileName()</code> بشكل صحيح</td>
</tr>
<tr class="even">
<td>ملف Excel فارغ</td>
<td>لم تُستخدم <code>with</code> أو <code>writer</code></td>
<td>تأكد من إغلاق الـ Writer</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-14">🔹 <strong>5. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>احفظ DataFrame يحتوي على بيانات عربية إلى ملف CSV.</li>
<li>أنشئ تقرير Excel به ورقتين: “الإجماليات” و“التفاصيل”.</li>
<li>أضف زرًا في واجهة PyQtGraph لحفظ لقطة من الرسم.</li>
<li>حوّل DataFrame إلى JSON جاهز لـ API.</li>
</ol>
<hr />
<h2 id="الربط-بالواقع-تصدير-تقرير-شهري">🔹 <strong>6. الربط بالواقع: تصدير تقرير شهري</strong></h2>
<h3 id="الهدف-إرسال-التقرير-للإدارة">🎯 الهدف: إرسال التقرير للإدارة</h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true"></a><span class="co"># افترض أن لديك نتائج تحليل</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true"></a>summary_report <span class="op">=</span> df.groupby(<span class="st">&#39;القسم&#39;</span>)[<span class="st">&#39;الراتب&#39;</span>].agg([<span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sum&#39;</span>, <span class="st">&#39;count&#39;</span>])</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true"></a><span class="co"># 1. حفظ كـ CSV للتحليل الآلي</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true"></a>summary_report.to_csv(<span class="st">&#39;monthly_report.csv&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8-sig&#39;</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true"></a><span class="co"># 2. حفظ كـ Excel لتوزيعه على الإدارة</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true"></a><span class="cf">with</span> pd.ExcelWriter(<span class="st">&#39;monthly_report_manager.xlsx&#39;</span>) <span class="im">as</span> writer:</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true"></a>    summary_report.to_excel(writer, sheet_name<span class="op">=</span><span class="st">&#39;الملخص&#39;</span>)</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true"></a>    df.to_excel(writer, sheet_name<span class="op">=</span><span class="st">&#39;البيانات_الكاملة&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true"></a></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true"></a><span class="co"># 3. أخذ لقطة من الرسم البياني</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true"></a>plot_win.grab().save(<span class="st">&#39;salary_chart.png&#39;</span>)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;✅ التقرير والرسم تم تصديرهما بنجاح.&quot;</span>)</span></code></pre></div>
<blockquote>
<p>✅ هذا هو الشكل النهائي لأي مشروع تحليل بيانات.</p>
</blockquote>
<hr />
<h2 id="نصائح-احترافية-15">🔹 <strong>7. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ استخدم دائمًا <code>index=False</code> ما لم تكن بحاجة للفهرس.</li>
<li>✅ استخدم <code>utf-8-sig</code> لضمان ظهور العربية بشكل صحيح.</li>
<li>✅ استخدم <code>QFileDialog</code> للسماح للمستخدم باختيار الموقع.</li>
<li>✅ وثّق مسار الحفظ في تعليق: <code># تم الحفظ في ./output/</code></li>
<li>✅ احفظ النتائج الوسيطة لتسهيل التصحيح.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-14">🔹 <strong>8. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما الفرق بين <code>utf-8</code> و <code>utf-8-sig</code>؟</li>
<li>كيف تُحفظ لقطة من <code>PlotWidget</code>؟</li>
<li>ما وظيفة <code>orient='records'</code> في <code>to_json()</code>؟</li>
<li>كيف تُنشئ ملف Excel به عدة أوراق؟</li>
<li>كيف تُظهر نافذة حفظ الملف للمستخدم؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-الدرس-14">🔹 <strong>9. مراجعة سريعة (ملخص الدرس)</strong></h2>
<table>
<thead>
<tr class="header">
<th>الوظيفة</th>
<th>الكود</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>حفظ CSV</td>
<td><code>to_csv('file.csv', index=False, encoding='utf-8-sig')</code></td>
</tr>
<tr class="even">
<td>حفظ Excel متعدد الأوراق</td>
<td><code>with pd.ExcelWriter(...) as writer:</code></td>
</tr>
<tr class="odd">
<td>حفظ JSON</td>
<td><code>to_json(..., force_ascii=False, orient='records')</code></td>
</tr>
<tr class="even">
<td>أخذ لقطة</td>
<td><code>widget.grab().save('image.png')</code></td>
</tr>
<tr class="odd">
<td>فتح نافذة حفظ</td>
<td><code>QFileDialog.getSaveFileName()</code></td>
</tr>
</tbody>
</table>
<p>بالطبع! إليك:</p>
<hr />
<h1 id="lesson_18">📘 <strong>الدرس 18 (موسع): مشروع عملي</strong></h1>
<blockquote>
<p>✅ <strong>عدد الكلمات: ~1600</strong></p>
</blockquote>
<hr />
<h2 id="مقدمة-لماذا-نحتاج-إلى-مشروع-عملي">🔹 <strong>مقدمة: لماذا نحتاج إلى مشروع عملي؟</strong></h2>
<p>لقد تعلمت حتى الآن عشرات الأدوات والتقنيات في PyQtGraph.<br />
الآن حان الوقت لدمج كل ما تعلمته في <strong>مشروع تطبيقي واقعي</strong>.</p>
<p>هذا الدرس يُشبه “الامتحان النهائي”، حيث ستُبنى تطبيقًا متكاملًا يُظهر: - عرض بيانات حية - رسومات متعددة - تفاعل مع المستخدم - واجهة مستخدم مخصصة</p>
<blockquote>
<p>🎯 <strong>الهدف النهائي</strong>: بناء تطبيق <strong>مراقبة مستشعرات في الزمن الحقيقي</strong>.</p>
</blockquote>
<hr />
<h2 id="فكرة-المشروع-مراقبة-مستشعرات-في-الزمن-الحقيقي">🔹 <strong>1. فكرة المشروع: مراقبة مستشعرات في الزمن الحقيقي</strong></h2>
<h3 id="السيناريو">📌 <strong>السيناريو</strong></h3>
<p>تخيل أنك تعمل على نظام يراقب بيئة معمل أو مصنع.<br />
هناك 3 مستشعرات: 1. <strong>درجة الحرارة</strong> (°C) 2. <strong>الرطوبة</strong> (%) 3. <strong>الاهتزاز</strong> (وحدة قياس وهمية)</p>
<p>البيانات تصل بشكل لحظي، ويجب عرضها على شاشة مراقبة تحتوي على: - 3 رسومات منفصلة - أزرار للتحكم (تشغيل/إيقاف، إعادة تعيين) - عرض قيم حالية - لون خلفية يُشير إلى حالة النظام (أخضر = طبيعي، أحمر = إنذار)</p>
<hr />
<h2 id="هيكل-المشروع">🔹 <strong>2. هيكل المشروع</strong></h2>
<pre><code>monitoring_app.py
│
├── MainWindow (QMainWindow)
│   ├── Central Widget
│   │   ├── Main Layout (QVBoxLayout)
│   │   │   ├── Control Layout (QHBoxLayout)
│   │   │   │   ├── QPushButton: Start/Stop
│   │   │   │   ├── QPushButton: Reset
│   │   │   │   └── QLabel: القيم الحالية
│   │   │   ├── Temperature Plot (PlotWidget)
│   │   │   ├── Humidity Plot (PlotWidget)
│   │   │   └── Vibration Plot (PlotWidget)
│   │   └── QTimer: لتحديث البيانات
│   └── Data Buffer: لتخزين البيانات</code></pre>
<hr />
<h2 id="الكود-الكامل-للمشروع">🔹 <strong>3. الكود الكامل للمشروع</strong></h2>
<div class="sourceCode" id="cb89"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true"></a><span class="im">import</span> pyqtgraph <span class="im">as</span> pg</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true"></a><span class="im">from</span> PySide6.QtWidgets <span class="im">import</span> (</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true"></a>    QApplication, QMainWindow, QWidget, QVBoxLayout,</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true"></a>    QHBoxLayout, QPushButton, QLabel</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true"></a>)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true"></a><span class="im">from</span> PySide6.QtCore <span class="im">import</span> QTimer</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true"></a><span class="im">from</span> PySide6.QtGui <span class="im">import</span> QFont</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true"></a><span class="im">import</span> sys</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true"></a></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true"></a><span class="kw">class</span> SensorMonitor(QMainWindow):</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true"></a>        <span class="va">self</span>.setWindowTitle(<span class="st">&quot;مراقبة المستشعرات اللحظية&quot;</span>)</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true"></a>        <span class="va">self</span>.resize(<span class="dv">1200</span>, <span class="dv">800</span>)</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true"></a></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true"></a>        <span class="co"># العنصر المركزي</span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true"></a>        central_widget <span class="op">=</span> QWidget()</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true"></a>        <span class="va">self</span>.setCentralWidget(central_widget)</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true"></a></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true"></a>        <span class="co"># التخطيط الرئيسي</span></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true"></a>        main_layout <span class="op">=</span> QVBoxLayout(central_widget)</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true"></a></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true"></a>        <span class="co"># تخطيط عناصر التحكم</span></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true"></a>        control_layout <span class="op">=</span> QHBoxLayout()</span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true"></a>        <span class="va">self</span>.btn_start <span class="op">=</span> QPushButton(<span class="st">&quot;بدء المراقبة&quot;</span>)</span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true"></a>        <span class="va">self</span>.btn_start.setCheckable(<span class="va">True</span>)</span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true"></a>        <span class="va">self</span>.btn_start.setChecked(<span class="va">True</span>)</span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true"></a>        <span class="va">self</span>.btn_start.toggled.<span class="ex">connect</span>(<span class="va">self</span>.toggle_monitoring)</span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true"></a></span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true"></a>        <span class="va">self</span>.btn_reset <span class="op">=</span> QPushButton(<span class="st">&quot;إعادة تعيين&quot;</span>)</span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true"></a>        <span class="va">self</span>.btn_reset.clicked.<span class="ex">connect</span>(<span class="va">self</span>.reset_data)</span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true"></a></span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true"></a>        <span class="co"># عرض القيم الحالية</span></span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true"></a>        <span class="va">self</span>.current_values <span class="op">=</span> QLabel(<span class="st">&quot;القيم الحالية: --, --, --&quot;</span>)</span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true"></a>        <span class="va">self</span>.current_values.setFont(QFont(<span class="st">&quot;Arial&quot;</span>, <span class="dv">12</span>))</span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true"></a>        <span class="va">self</span>.current_values.setStyleSheet(<span class="st">&quot;background-color: #f0f0f0; padding: 10px; border-radius: 5px;&quot;</span>)</span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true"></a></span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true"></a>        control_layout.addWidget(<span class="va">self</span>.btn_start)</span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true"></a>        control_layout.addWidget(<span class="va">self</span>.btn_reset)</span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true"></a>        control_layout.addWidget(<span class="va">self</span>.current_values)</span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true"></a>        main_layout.addLayout(control_layout)</span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true"></a></span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true"></a>        <span class="co"># إعداد المخزن المؤقت</span></span>
<span id="cb89-45"><a href="#cb89-45" aria-hidden="true"></a>        <span class="va">self</span>.buffer_size <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true"></a>        <span class="va">self</span>.time <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">20</span>, <span class="va">self</span>.buffer_size)  <span class="co"># 20 ثانية</span></span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true"></a>        <span class="va">self</span>.temp_data <span class="op">=</span> np.zeros(<span class="va">self</span>.buffer_size)</span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true"></a>        <span class="va">self</span>.humi_data <span class="op">=</span> np.zeros(<span class="va">self</span>.buffer_size)</span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true"></a>        <span class="va">self</span>.vibe_data <span class="op">=</span> np.zeros(<span class="va">self</span>.buffer_size)</span>
<span id="cb89-50"><a href="#cb89-50" aria-hidden="true"></a>        <span class="va">self</span>.ptr <span class="op">=</span> <span class="dv">0</span>  <span class="co"># مؤشر الكتابة</span></span>
<span id="cb89-51"><a href="#cb89-51" aria-hidden="true"></a></span>
<span id="cb89-52"><a href="#cb89-52" aria-hidden="true"></a>        <span class="co"># إعداد الرسومات</span></span>
<span id="cb89-53"><a href="#cb89-53" aria-hidden="true"></a>        <span class="va">self</span>.setup_plots(main_layout)</span>
<span id="cb89-54"><a href="#cb89-54" aria-hidden="true"></a></span>
<span id="cb89-55"><a href="#cb89-55" aria-hidden="true"></a>        <span class="co"># المؤقت</span></span>
<span id="cb89-56"><a href="#cb89-56" aria-hidden="true"></a>        <span class="va">self</span>.timer <span class="op">=</span> QTimer()</span>
<span id="cb89-57"><a href="#cb89-57" aria-hidden="true"></a>        <span class="va">self</span>.timer.timeout.<span class="ex">connect</span>(<span class="va">self</span>.update_plots)</span>
<span id="cb89-58"><a href="#cb89-58" aria-hidden="true"></a>        <span class="va">self</span>.timer.start(<span class="dv">100</span>)  <span class="co"># كل 100 ميلي ثانية</span></span>
<span id="cb89-59"><a href="#cb89-59" aria-hidden="true"></a></span>
<span id="cb89-60"><a href="#cb89-60" aria-hidden="true"></a>    <span class="kw">def</span> setup_plots(<span class="va">self</span>, layout):</span>
<span id="cb89-61"><a href="#cb89-61" aria-hidden="true"></a>        <span class="co">&quot;&quot;&quot;إنشاء وإعداد الرسومات الثلاثة&quot;&quot;&quot;</span></span>
<span id="cb89-62"><a href="#cb89-62" aria-hidden="true"></a>        <span class="co"># درجة الحرارة</span></span>
<span id="cb89-63"><a href="#cb89-63" aria-hidden="true"></a>        <span class="va">self</span>.temp_plot <span class="op">=</span> pg.PlotWidget(title<span class="op">=</span><span class="st">&quot;درجة الحرارة (°C)&quot;</span>)</span>
<span id="cb89-64"><a href="#cb89-64" aria-hidden="true"></a>        <span class="va">self</span>.temp_plot.setLabel(<span class="st">&#39;left&#39;</span>, <span class="st">&#39;درجة الحرارة&#39;</span>)</span>
<span id="cb89-65"><a href="#cb89-65" aria-hidden="true"></a>        <span class="va">self</span>.temp_plot.setLabel(<span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;الزمن (ثانية)&#39;</span>)</span>
<span id="cb89-66"><a href="#cb89-66" aria-hidden="true"></a>        <span class="va">self</span>.temp_plot.showGrid(y<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb89-67"><a href="#cb89-67" aria-hidden="true"></a>        <span class="va">self</span>.temp_curve <span class="op">=</span> <span class="va">self</span>.temp_plot.plot(pen<span class="op">=</span><span class="st">&#39;r&#39;</span>, name<span class="op">=</span><span class="st">&#39;درجة الحرارة&#39;</span>)</span>
<span id="cb89-68"><a href="#cb89-68" aria-hidden="true"></a>        layout.addWidget(<span class="va">self</span>.temp_plot)</span>
<span id="cb89-69"><a href="#cb89-69" aria-hidden="true"></a></span>
<span id="cb89-70"><a href="#cb89-70" aria-hidden="true"></a>        <span class="co"># الرطوبة</span></span>
<span id="cb89-71"><a href="#cb89-71" aria-hidden="true"></a>        <span class="va">self</span>.humi_plot <span class="op">=</span> pg.PlotWidget(title<span class="op">=</span><span class="st">&quot;الرطوبة (%)&quot;</span>)</span>
<span id="cb89-72"><a href="#cb89-72" aria-hidden="true"></a>        <span class="va">self</span>.humi_plot.setLabel(<span class="st">&#39;left&#39;</span>, <span class="st">&#39;الرطوبة&#39;</span>)</span>
<span id="cb89-73"><a href="#cb89-73" aria-hidden="true"></a>        <span class="va">self</span>.humi_plot.setLabel(<span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;الزمن (ثانية)&#39;</span>)</span>
<span id="cb89-74"><a href="#cb89-74" aria-hidden="true"></a>        <span class="va">self</span>.humi_plot.showGrid(y<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb89-75"><a href="#cb89-75" aria-hidden="true"></a>        <span class="va">self</span>.humi_curve <span class="op">=</span> <span class="va">self</span>.humi_plot.plot(pen<span class="op">=</span><span class="st">&#39;b&#39;</span>, name<span class="op">=</span><span class="st">&#39;الرطوبة&#39;</span>)</span>
<span id="cb89-76"><a href="#cb89-76" aria-hidden="true"></a>        layout.addWidget(<span class="va">self</span>.humi_plot)</span>
<span id="cb89-77"><a href="#cb89-77" aria-hidden="true"></a></span>
<span id="cb89-78"><a href="#cb89-78" aria-hidden="true"></a>        <span class="co"># الاهتزاز</span></span>
<span id="cb89-79"><a href="#cb89-79" aria-hidden="true"></a>        <span class="va">self</span>.vibe_plot <span class="op">=</span> pg.PlotWidget(title<span class="op">=</span><span class="st">&quot;الاهتزاز&quot;</span>)</span>
<span id="cb89-80"><a href="#cb89-80" aria-hidden="true"></a>        <span class="va">self</span>.vibe_plot.setLabel(<span class="st">&#39;left&#39;</span>, <span class="st">&#39;الاهتزاز&#39;</span>)</span>
<span id="cb89-81"><a href="#cb89-81" aria-hidden="true"></a>        <span class="va">self</span>.vibe_plot.setLabel(<span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;الزمن (ثانية)&#39;</span>)</span>
<span id="cb89-82"><a href="#cb89-82" aria-hidden="true"></a>        <span class="va">self</span>.vibe_plot.showGrid(y<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb89-83"><a href="#cb89-83" aria-hidden="true"></a>        <span class="va">self</span>.vibe_curve <span class="op">=</span> <span class="va">self</span>.vibe_plot.plot(pen<span class="op">=</span><span class="st">&#39;m&#39;</span>, name<span class="op">=</span><span class="st">&#39;الاهتزاز&#39;</span>)</span>
<span id="cb89-84"><a href="#cb89-84" aria-hidden="true"></a>        layout.addWidget(<span class="va">self</span>.vibe_plot)</span>
<span id="cb89-85"><a href="#cb89-85" aria-hidden="true"></a></span>
<span id="cb89-86"><a href="#cb89-86" aria-hidden="true"></a>    <span class="kw">def</span> generate_sensor_data(<span class="va">self</span>):</span>
<span id="cb89-87"><a href="#cb89-87" aria-hidden="true"></a>        <span class="co">&quot;&quot;&quot;توليد بيانات وهمية للمستشعرات&quot;&quot;&quot;</span></span>
<span id="cb89-88"><a href="#cb89-88" aria-hidden="true"></a>        <span class="co"># درجة الحرارة: 25 ± 5 مع تذبذب</span></span>
<span id="cb89-89"><a href="#cb89-89" aria-hidden="true"></a>        temp <span class="op">=</span> <span class="dv">25</span> <span class="op">+</span> <span class="dv">5</span> <span class="op">*</span> np.sin(<span class="fl">0.1</span> <span class="op">*</span> <span class="va">self</span>.ptr) <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb89-90"><a href="#cb89-90" aria-hidden="true"></a>        <span class="co"># الرطوبة: 60 ± 10</span></span>
<span id="cb89-91"><a href="#cb89-91" aria-hidden="true"></a>        humi <span class="op">=</span> <span class="dv">60</span> <span class="op">+</span> <span class="dv">10</span> <span class="op">*</span> np.cos(<span class="fl">0.08</span> <span class="op">*</span> <span class="va">self</span>.ptr) <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb89-92"><a href="#cb89-92" aria-hidden="true"></a>        <span class="co"># الاهتزاز: عادة منخفض، لكن به قفزات عرضية</span></span>
<span id="cb89-93"><a href="#cb89-93" aria-hidden="true"></a>        vibe <span class="op">=</span> <span class="fl">0.5</span> <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.1</span>)</span>
<span id="cb89-94"><a href="#cb89-94" aria-hidden="true"></a>        <span class="cf">if</span> np.random.rand() <span class="op">&lt;</span> <span class="fl">0.05</span>:  <span class="co"># 5% فرصة لاهتزاز عالي</span></span>
<span id="cb89-95"><a href="#cb89-95" aria-hidden="true"></a>            vibe <span class="op">+=</span> np.random.rand() <span class="op">*</span> <span class="dv">5</span></span>
<span id="cb89-96"><a href="#cb89-96" aria-hidden="true"></a></span>
<span id="cb89-97"><a href="#cb89-97" aria-hidden="true"></a>        <span class="cf">return</span> temp, humi, vibe</span>
<span id="cb89-98"><a href="#cb89-98" aria-hidden="true"></a></span>
<span id="cb89-99"><a href="#cb89-99" aria-hidden="true"></a>    <span class="kw">def</span> update_plots(<span class="va">self</span>):</span>
<span id="cb89-100"><a href="#cb89-100" aria-hidden="true"></a>        <span class="co">&quot;&quot;&quot;تحديث جميع الرسومات&quot;&quot;&quot;</span></span>
<span id="cb89-101"><a href="#cb89-101" aria-hidden="true"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.btn_start.isChecked():</span>
<span id="cb89-102"><a href="#cb89-102" aria-hidden="true"></a>            <span class="cf">return</span></span>
<span id="cb89-103"><a href="#cb89-103" aria-hidden="true"></a></span>
<span id="cb89-104"><a href="#cb89-104" aria-hidden="true"></a>        temp, humi, vibe <span class="op">=</span> <span class="va">self</span>.generate_sensor_data()</span>
<span id="cb89-105"><a href="#cb89-105" aria-hidden="true"></a></span>
<span id="cb89-106"><a href="#cb89-106" aria-hidden="true"></a>        <span class="co"># تحديث المخزن</span></span>
<span id="cb89-107"><a href="#cb89-107" aria-hidden="true"></a>        <span class="va">self</span>.temp_data[<span class="va">self</span>.ptr] <span class="op">=</span> temp</span>
<span id="cb89-108"><a href="#cb89-108" aria-hidden="true"></a>        <span class="va">self</span>.humi_data[<span class="va">self</span>.ptr] <span class="op">=</span> humi</span>
<span id="cb89-109"><a href="#cb89-109" aria-hidden="true"></a>        <span class="va">self</span>.vibe_data[<span class="va">self</span>.ptr] <span class="op">=</span> vibe</span>
<span id="cb89-110"><a href="#cb89-110" aria-hidden="true"></a></span>
<span id="cb89-111"><a href="#cb89-111" aria-hidden="true"></a>        <span class="co"># تحديث المنحنيات</span></span>
<span id="cb89-112"><a href="#cb89-112" aria-hidden="true"></a>        <span class="va">self</span>.update_curve(<span class="va">self</span>.temp_curve, <span class="va">self</span>.temp_data)</span>
<span id="cb89-113"><a href="#cb89-113" aria-hidden="true"></a>        <span class="va">self</span>.update_curve(<span class="va">self</span>.humi_curve, <span class="va">self</span>.humi_data)</span>
<span id="cb89-114"><a href="#cb89-114" aria-hidden="true"></a>        <span class="va">self</span>.update_curve(<span class="va">self</span>.vibe_curve, <span class="va">self</span>.vibe_data)</span>
<span id="cb89-115"><a href="#cb89-115" aria-hidden="true"></a></span>
<span id="cb89-116"><a href="#cb89-116" aria-hidden="true"></a>        <span class="co"># تحديث العرض</span></span>
<span id="cb89-117"><a href="#cb89-117" aria-hidden="true"></a>        <span class="va">self</span>.current_values.setText(</span>
<span id="cb89-118"><a href="#cb89-118" aria-hidden="true"></a>            <span class="ss">f&quot;القيم الحالية: </span><span class="sc">{</span>temp<span class="sc">:.1f}</span><span class="ss">°C, </span><span class="sc">{</span>humi<span class="sc">:.1f}</span><span class="ss">%, </span><span class="sc">{</span>vibe<span class="sc">:.2f}</span><span class="ss">&quot;</span></span>
<span id="cb89-119"><a href="#cb89-119" aria-hidden="true"></a>        )</span>
<span id="cb89-120"><a href="#cb89-120" aria-hidden="true"></a></span>
<span id="cb89-121"><a href="#cb89-121" aria-hidden="true"></a>        <span class="co"># تغيير لون الخلفية إذا كانت هناك إنذار</span></span>
<span id="cb89-122"><a href="#cb89-122" aria-hidden="true"></a>        <span class="cf">if</span> vibe <span class="op">&gt;</span> <span class="fl">3.0</span>:</span>
<span id="cb89-123"><a href="#cb89-123" aria-hidden="true"></a>            <span class="va">self</span>.current_values.setStyleSheet(<span class="st">&quot;background-color: #ffcccc; padding: 10px; border-radius: 5px;&quot;</span>)</span>
<span id="cb89-124"><a href="#cb89-124" aria-hidden="true"></a>        <span class="cf">else</span>:</span>
<span id="cb89-125"><a href="#cb89-125" aria-hidden="true"></a>            <span class="va">self</span>.current_values.setStyleSheet(<span class="st">&quot;background-color: #ccffcc; padding: 10px; border-radius: 5px;&quot;</span>)</span>
<span id="cb89-126"><a href="#cb89-126" aria-hidden="true"></a></span>
<span id="cb89-127"><a href="#cb89-127" aria-hidden="true"></a>        <span class="co"># تقدم المؤشر</span></span>
<span id="cb89-128"><a href="#cb89-128" aria-hidden="true"></a>        <span class="va">self</span>.ptr <span class="op">=</span> (<span class="va">self</span>.ptr <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="va">self</span>.buffer_size</span>
<span id="cb89-129"><a href="#cb89-129" aria-hidden="true"></a></span>
<span id="cb89-130"><a href="#cb89-130" aria-hidden="true"></a>    <span class="kw">def</span> update_curve(<span class="va">self</span>, curve, data):</span>
<span id="cb89-131"><a href="#cb89-131" aria-hidden="true"></a>        <span class="co">&quot;&quot;&quot;تحديث منحنى معين&quot;&quot;&quot;</span></span>
<span id="cb89-132"><a href="#cb89-132" aria-hidden="true"></a>        ptr <span class="op">=</span> <span class="va">self</span>.ptr</span>
<span id="cb89-133"><a href="#cb89-133" aria-hidden="true"></a>        <span class="co"># عرض البيانات من المؤشر إلى النهاية، ثم من البداية إلى المؤشر (للسلاسة)</span></span>
<span id="cb89-134"><a href="#cb89-134" aria-hidden="true"></a>        y_view <span class="op">=</span> np.concatenate([data[ptr:], data[:ptr]])</span>
<span id="cb89-135"><a href="#cb89-135" aria-hidden="true"></a>        curve.setData(<span class="va">self</span>.time, y_view)</span>
<span id="cb89-136"><a href="#cb89-136" aria-hidden="true"></a></span>
<span id="cb89-137"><a href="#cb89-137" aria-hidden="true"></a>    <span class="kw">def</span> reset_data(<span class="va">self</span>):</span>
<span id="cb89-138"><a href="#cb89-138" aria-hidden="true"></a>        <span class="co">&quot;&quot;&quot;إعادة تعيين جميع البيانات&quot;&quot;&quot;</span></span>
<span id="cb89-139"><a href="#cb89-139" aria-hidden="true"></a>        <span class="va">self</span>.temp_data[:] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb89-140"><a href="#cb89-140" aria-hidden="true"></a>        <span class="va">self</span>.humi_data[:] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb89-141"><a href="#cb89-141" aria-hidden="true"></a>        <span class="va">self</span>.vibe_data[:] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb89-142"><a href="#cb89-142" aria-hidden="true"></a>        <span class="va">self</span>.ptr <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb89-143"><a href="#cb89-143" aria-hidden="true"></a>        <span class="va">self</span>.current_values.setText(<span class="st">&quot;القيم الحالية: --, --, --&quot;</span>)</span>
<span id="cb89-144"><a href="#cb89-144" aria-hidden="true"></a>        <span class="va">self</span>.current_values.setStyleSheet(<span class="st">&quot;background-color: #f0f0f0; padding: 10px; border-radius: 5px;&quot;</span>)</span>
<span id="cb89-145"><a href="#cb89-145" aria-hidden="true"></a></span>
<span id="cb89-146"><a href="#cb89-146" aria-hidden="true"></a>    <span class="kw">def</span> toggle_monitoring(<span class="va">self</span>, checked):</span>
<span id="cb89-147"><a href="#cb89-147" aria-hidden="true"></a>        <span class="cf">if</span> checked:</span>
<span id="cb89-148"><a href="#cb89-148" aria-hidden="true"></a>            <span class="va">self</span>.btn_start.setText(<span class="st">&quot;إيقاف المراقبة&quot;</span>)</span>
<span id="cb89-149"><a href="#cb89-149" aria-hidden="true"></a>        <span class="cf">else</span>:</span>
<span id="cb89-150"><a href="#cb89-150" aria-hidden="true"></a>            <span class="va">self</span>.btn_start.setText(<span class="st">&quot;بدء المراقبة&quot;</span>)</span>
<span id="cb89-151"><a href="#cb89-151" aria-hidden="true"></a></span>
<span id="cb89-152"><a href="#cb89-152" aria-hidden="true"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb89-153"><a href="#cb89-153" aria-hidden="true"></a>    app <span class="op">=</span> QApplication(sys.argv)</span>
<span id="cb89-154"><a href="#cb89-154" aria-hidden="true"></a>    window <span class="op">=</span> SensorMonitor()</span>
<span id="cb89-155"><a href="#cb89-155" aria-hidden="true"></a>    window.show()</span>
<span id="cb89-156"><a href="#cb89-156" aria-hidden="true"></a>    app.<span class="bu">exec</span>()</span></code></pre></div>
<hr />
<h2 id="شرح-الكود-خطوة-بخطوة">🔹 <strong>4. شرح الكود خطوة بخطوة</strong></h2>
<h3 id="الهيكل-العام">✅ <strong>1. الهيكل العام</strong></h3>
<ul>
<li><code>QMainWindow</code>: النافذة الرئيسية.</li>
<li><code>QVBoxLayout</code>: تخطيط رئيسي عمودي.</li>
<li><code>QHBoxLayout</code>: تخطيط أفقي للعناصر العليا.</li>
</ul>
<h3 id="عناصر-التحكم">✅ <strong>2. عناصر التحكم</strong></h3>
<ul>
<li>زر “بدء/إيقاف”: يستخدم <code>setCheckable(True)</code> لتبديل الحالة.</li>
<li>زر “إعادة تعيين”: يعيد البيانات إلى الصفر.</li>
<li><code>QLabel</code>: يعرض القيم الحالية بلون خلفية ديناميكي.</li>
</ul>
<h3 id="إدارة-البيانات">✅ <strong>3. إدارة البيانات</strong></h3>
<ul>
<li><code>buffer_size</code>: حجم المخزن (200 نقطة).</li>
<li><code>time</code>: مصفوفة زمن ثابتة.</li>
<li><code>ptr</code>: مؤشر يدور حول المخزن (Circular Buffer).</li>
</ul>
<h3 id="الرسومات">✅ <strong>4. الرسومات</strong></h3>
<ul>
<li>تم إنشاء 3 <code>PlotWidget</code> لكل مستشعر.</li>
<li>تم تفعيل الشبكة (<code>showGrid</code>) لتحسين القراءة.</li>
</ul>
<h3 id="التحديث-اللحظي">✅ <strong>5. التحديث اللحظي</strong></h3>
<ul>
<li><code>QTimer</code> يُنفّذ <code>update_plots</code> كل 100 ميلي ثانية.</li>
<li><code>setData()</code> يُستخدم لتحديث البيانات بسرعة.</li>
<li><code>np.concatenate</code> يُستخدم لجعل الرسم يتدفق بشكل دائري.</li>
</ul>
<hr />
<h2 id="الأخطاء-الشائعة-والتصحيح">🔹 <strong>5. الأخطاء الشائعة والتصحيح</strong></h2>
<table>
<thead>
<tr class="header">
<th>المشكلة</th>
<th>الحل</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>الرسومات لا تُحدّث</td>
<td>تأكد من أن <code>timer.start()</code> يعمل</td>
</tr>
<tr class="even">
<td>البيانات تتوقف عند 200</td>
<td>تأكد من أن <code>ptr</code> يتم تدويره <code>% buffer_size</code></td>
</tr>
<tr class="odd">
<td>الألوان لا تتغير</td>
<td>تأكد من <code>setStyleSheet()</code></td>
</tr>
<tr class="even">
<td><code>QLabel</code> لا يعرض القيم</td>
<td>تأكد من <code>setText()</code></td>
</tr>
<tr class="odd">
<td>المؤشر لا يظهر</td>
<td>تأكد من <code>show()</code> للنافذة</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="تمارين-تطبيقية-15">🔹 <strong>6. تمارين تطبيقية</strong></h2>
<ol type="1">
<li>أضف مؤشرًا يُظهر “النظام طبيعي” أو “إنذار!” بناءً على الاهتزاز.</li>
<li>احفظ أحدث 1000 قيمة من البيانات إلى ملف CSV عند الإغلاق.</li>
<li>أضف خريطة لونية لعرض الاهتزاز في <code>ImageView</code>.</li>
<li>أضف زرًا لتصدير لقطة من كل رسم.</li>
</ol>
<hr />
<h2 id="توسيع-المشروع-أفكار-متقدمة">🔹 <strong>7. توسيع المشروع (أفكار متقدمة)</strong></h2>
<ul>
<li><strong>إضافة <code>ImageView</code></strong>: لعرض مصفوفة حرارة تمثل توزيع الحرارة.</li>
<li><strong>إضافة <code>GLViewWidget</code></strong>: لعرض نموذج ثلاثي الأبعاد للمصنع.</li>
<li><strong>ربط بمنفذ تسلسلي (Serial)</strong>: لقراءة بيانات حقيقية من أجهزة Arduino.</li>
<li><strong>إضافة تنبيه صوتي</strong>: عند تجاوز الحدود.</li>
<li><strong>تسجيل البيانات</strong>: حفظها إلى قاعدة بيانات.</li>
</ul>
<hr />
<h2 id="نصائح-احترافية-16">🔹 <strong>8. نصائح احترافية</strong></h2>
<ol type="1">
<li>✅ فصل منطق البيانات عن واجهة المستخدم.</li>
<li>✅ استخدام <code>Circular Buffer</code> للبيانات الحية.</li>
<li>✅ استخدام <code>setData()</code> بدل <code>plot()</code> في الحلقات.</li>
<li>✅ استخدام <code>QTimer</code> بدل <code>time.sleep()</code>.</li>
<li>✅ توثيق الكود جيدًا.</li>
</ol>
<hr />
<h2 id="أسئلة-مراجعة-15">🔹 <strong>9. أسئلة مراجعة</strong></h2>
<ol type="1">
<li>ما دور <code>ptr</code> في الكود؟</li>
<li>كيف تُحدث منحنى بشكل لحظي؟</li>
<li>ما الفرق بين <code>QVBoxLayout</code> و <code>QHBoxLayout</code>؟</li>
<li>كيف تُغير لون خلفية <code>QLabel</code> ديناميكيًا؟</li>
<li>لماذا نستخدم <code>np.concatenate</code> في <code>update_curve</code>؟</li>
</ol>
<hr />
<h2 id="مراجعة-سريعة-ملخص-المشروع">🔹 <strong>10. مراجعة سريعة (ملخص المشروع)</strong></h2>
<table>
<thead>
<tr class="header">
<th>العنصر</th>
<th>الوظيفة</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>QMainWindow</code></td>
<td>النافذة الرئيسية</td>
</tr>
<tr class="even">
<td><code>QTimer</code></td>
<td>التحديث اللحظي</td>
</tr>
<tr class="odd">
<td><code>Circular Buffer</code></td>
<td>تخزين البيانات</td>
</tr>
<tr class="even">
<td><code>setData()</code></td>
<td>تحديث الرسم بسرعة</td>
</tr>
<tr class="odd">
<td><code>setStyleSheet()</code></td>
<td>تغيير مظهر العناصر</td>
</tr>
<tr class="even">
<td><code>QLabel</code></td>
<td>عرض القيم الحالية</td>
</tr>
</tbody>
</table>
<h1 id="جدول-مرجعي-سريع-أهم-دوال-pyqtgraph">✅ <strong>جدول مرجعي سريع: أهم دوال PyQtGraph</strong></h1>
<table>
<thead>
<tr class="header">
<th>الدالة</th>
<th>الوصف</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pg.plot()</code></td>
<td>إنشاء رسم سريع</td>
</tr>
<tr class="even">
<td><code>pg.PlotWidget()</code></td>
<td>حاوية رسم</td>
</tr>
<tr class="odd">
<td><code>pg.GraphicsLayoutWidget()</code></td>
<td>تخطيط متعدد الرسومات</td>
</tr>
<tr class="even">
<td><code>curve.setData()</code></td>
<td>تحديث بيانات الرسم</td>
</tr>
<tr class="odd">
<td><code>view.setMouseEnabled()</code></td>
<td>التحكم في التفاعل</td>
</tr>
<tr class="even">
<td><code>scatter.sigClicked.connect()</code></td>
<td>ربط حدث النقر</td>
</tr>
<tr class="odd">
<td><code>imageView.setImage()</code></td>
<td>عرض صورة</td>
</tr>
<tr class="even">
<td><code>imageView.setColorMap()</code></td>
<td>تطبيق خريطة لونية</td>
</tr>
<tr class="odd">
<td><code>GLViewWidget()</code></td>
<td>نافذة 3D</td>
</tr>
<tr class="even">
<td><code>QTimer()</code></td>
<td>التحديث اللحظي</td>
</tr>
</tbody>
</table>
  </div>
</body>
</html>
